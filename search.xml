<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[2018ï¼Œä¸ä¼šé‡æ¥]]></title>
      <url>/2018/12/31/2018%EF%BC%8C%E4%B8%8D%E4%BC%9A%E9%87%8D%E6%9D%A5/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯2018å¹´çš„æœ€åä¸€å¤©ï¼Œå³2018å¹´12æœˆ31æ—¥ã€‚æå‰ç¥æ„¿æ‰€æœ‰äºº2019èº«ä½“å¥åº·ï¼Œä¸‡äº‹å¦‚æ„ï¼Œé˜–å®¶å¹¸ç¦ï¼</p>
<p>è¿™ç¯‡æ–‡ç«  <a href="http://www.veryitman.com/2016/12/31/%E5%86%8D%E8%A7%81-2016/" target="_blank" rel="noopener">å†è§ 2016</a> æ˜¯åœ¨2016å¹´æœ«å†™çš„ï¼Œç®—æ˜¯ä¸€ä¸ªhinéšå¿ƒçš„å°ç»“ã€‚æ¯”è¾ƒé—æ†¾çš„æ˜¯åœ¨2017å¹´æ²¡æœ‰ç»™è‡ªå·±å†™ä¸ªæ€»ç»“ï¼Œæ‰€ä»¥ï¼Œä¸èƒ½å†é”™è¿‡2018äº†ï¼Œæˆ‘æ€•è€äº†æ²¡æœ‰å¯ä»¥å¯»è¿¹çš„å›å¿†ï¼</p>
<p>2018 æœ‰å¤ªå¤šéœ€è¦æ„Ÿè°¢çš„äººäº†ï¼Œæ„Ÿè°¢æ‰€æœ‰å·¥ä½œä¸Šï¼Œç”Ÿæ´»ä¸Šå…³å¿ƒã€æ”¯æŒå’Œé¼“åŠ±æˆ‘çš„äººä»¬ï¼Œæ„Ÿè°¢æˆ‘çš„å®¶äººç»™äºˆäº†æˆ‘å¤ªå¤šçš„ç†è§£å’ŒåŒ…å®¹ï¼Œéå¸¸æ„Ÿè°¢ä½ ä»¬ï¼</p>
<h2 id="å·¥ä½œ"><a href="#å·¥ä½œ" class="headerlink" title="å·¥ä½œ"></a>å·¥ä½œ</h2><p>2018å¹´æˆ‘çš„èŒä¸šæ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ï¼Œä»ç„¶æ˜¯å¥‹æ–—åœ¨ä¸€çº¿å·¥ä½œå²—ä½ä¸Šçš„ä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œæˆ‘å–œæ¬¢è¿™ä»½èŒä¸šï¼Œå®ƒæ²¡æœ‰è¿‡å¤šçš„çº·äº‰ï¼Œå·¥ç¨‹å¸ˆä¹‹é—´çš„æ²Ÿé€šç®€å•ã€ç›´æ¥ï¼</p>
<p>å”¯ä¸€å’Œä»¥å‰ä¸åŒçš„æ˜¯è‡ªå·±å¼€å§‹è´Ÿè´£ä¸€ä¸ªå›¢é˜Ÿäº†ï¼Œè´£ä»»æ¯”ä»¥å‰è¦å¤§äº†å¾ˆå¤šï¼Œå‹åŠ›ä¹Ÿéšä¹‹å‰§å¢ã€‚æ…¢æ…¢åœ°ï¼Œå†™ä»£ç å˜æˆäº†å¯æœ›ä¸å¯æ±‚çš„äº‹æƒ…äº†ï¼Œå› ä¸ºä½ è¦å¤„ç†æ¯”å†™ä»£ç æ›´é‡è¦çš„äº‹æƒ…ï¼Œæ¯”å¦‚å›¢é˜Ÿçš„ç£¨åˆï¼Œç›®æ ‡çš„åˆ¶å®šï¼Œä»»åŠ¡çš„è§„åˆ’ç­‰ç­‰ä¸€ç³»åˆ—å·¥ä½œã€‚</p>
<p>åœ¨ <code>ã€Šèš‚èšé‡‘æœï¼šç§‘æŠ€é‡‘èç‹¬è§’å…½çš„å´›èµ·ã€‹</code> è¿™æœ¬ä¹¦é‡Œè®²åˆ°è¿‡ï¼š</p>
<blockquote>
<p>ä½œä¸ºé¢†å¯¼ï¼Œå›¢é˜Ÿé‡Œæ¯ä¸€ä¸ªäººçš„é”™è¯¯éƒ½æ˜¯è‡ªå·±çš„é”™è¯¯ï¼Œä½†å›¢é˜Ÿé‡Œæ¯ä¸€ä¸ªäººçš„æˆæœæœªå¿…æ˜¯è‡ªå·±çš„æˆæœï¼Œè¿™æ—¶æ•´ä¸ªäººçš„å¿ƒæ€å°±éœ€è¦é‡æ–°è°ƒæ•´ã€‚</p>
</blockquote>
<p>æˆ‘ç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¹¸è¿çš„äººï¼Œå› ä¸ºå›¢é˜Ÿä¸­æœ‰å¾ˆå¤šæ¯”è‡ªå·±æ›´ä¼˜ç§€çš„äººï¼Œä»–ä»¬æœ‰æƒ³æ³•ï¼Œæœ‰æ‰§è¡Œï¼Œæ€»æ˜¯èƒ½å¸¦åŠ¨å…¶ä»–äººç§¯æçš„å·¥ä½œã€‚è¿™äº›äººæ˜¯å›¢é˜Ÿå­¦ä¹ çš„æ¦œæ ·ï¼Œæ›´æ˜¯æˆ‘ä»¬å›¢é˜Ÿçš„è´¢å¯Œã€‚</p>
<p>å…¬å¸åœ¨æ”¹å˜ï¼Œå„ä¸ªæ–¹é¢ä¹Ÿè¶Šæ¥è¶Šæˆç†Ÿï¼Œæ— è®ºæ˜¯å…¬å¸æ–‡åŒ–è¿˜æ˜¯æŠ€æœ¯èƒ½åŠ›éƒ½åœ¨æ­¥æ­¥é«˜å‡ï¼Œä»Šå¹´å°¤ä¸ºçœ‹åˆ°çš„æ˜¯ CTO å¯¹æŠ€æœ¯ä¸­å°ä¸‹å®šçš„ä¸€äº›å†³å¿ƒï¼Œè¿™æ˜¯è®©äººå…´å¥‹çš„ã€‚å…¬å¸ä¸€ç›´åœ¨å¼ºè°ƒèµ‹èƒ½ï¼ŒæŠŠæ›´å¤šä¼˜ç§€ã€æœ‰æ‹…å½“ã€æœ‰è´£ä»»å¿ƒçš„äººææ‹”ä¸Šæ¥ï¼Œç»™ä»–ä»¬é…å¤‡èµ„æºï¼Œä»¥ä¾¿å‘æŒ¥ä»–ä»¬æ›´å¤§çš„æ½œèƒ½ï¼Œå¤§å®¶å·¥ä½œçš„çƒ­æƒ…ä¹Ÿæ›´ä¸Šä¸€å±‚æ¥¼ï¼Œå› ä¸ºå…¬å¸ç›¸ä¿¡ä»–ä»¬ã€‚</p>
<p>å¾ˆå¤šæ—¶å€™ï¼Œå¹¶ä¸æ˜¯ä½ èº«è¾¹æ²¡æœ‰ä¼˜ç§€çš„äººï¼Œåªæ˜¯ä½ ä¸æ„¿æ„ç›¸ä¿¡ä»–ä»¬ï¼Œå‰æ€•ç‹¼åæ€•è™çš„å¿ƒæ€é˜»æ­¢äº†è¿™äº›ä¼˜ç§€äººçš„å‘æŒ¥ã€‚å…¶å®ï¼Œä»–ä»¬åªæ˜¯éœ€è¦ä½ ä¸€ä¸ªè‚¯å®šçš„ç­”å¤ï¼Œæ‰€ä»¥è¯•ç€å»æ”¹å˜è‡ªå·±ï¼Œç›¸ä¿¡å›¢é˜Ÿé‡Œé¢çš„æ¯ä¸ªäººï¼Œç»™ä»–ä»¬æ›´å¤šçš„è‚¯å®šï¼Œé¼“åŠ±å’Œæ”¯æŒä»–ä»¬ï¼Œç»“æœä¸ä¼šè®©ä½ å¤±æœ›çš„ã€‚</p>
<h2 id="ç”Ÿæ´»"><a href="#ç”Ÿæ´»" class="headerlink" title="ç”Ÿæ´»"></a>ç”Ÿæ´»</h2><p>è‡ªä»è€å©†å­©å­å›è€å®¶ä¹‹åï¼Œæˆ‘å°±è¿‡ä¸Šäº†â€œå•èº«â€œçš„ç”Ÿæ´»ï¼Œæ¯å¤©æ—©å‡ºæ™šå½’ï¼ŒåŠªåŠ›ç”¨å·¥ä½œæ¥ä»£æ›¿å¯¹ä»–ä»¬çš„æ€å¿µã€‚</p>
<p>æˆ‘å®¶çš„å¤§å®æ˜¯ä¸ªå¤©ç”Ÿçš„è¿åŠ¨ç‹‚ï¼Œæ„Ÿè§‰ä»–æ€»æ˜¯æœ‰ç”¨ä¸å®Œçš„åŠ›æ°”ï¼Œé™¤éä»–è‡ªå·±åœ¨æ‹¼å›¾æˆ–è€…ç”»ç”»ï¼Œå¦åˆ™ä½ ç”­æƒ³æ¸…é™ã€‚ä¸€ä¼šåœ¨å®¶é‡Œç©¿ä¸Šæºœå†°é‹ç»™ä½ è¡¨æ¼”å„ç§æºœå†°æŠ€èƒ½ï¼Œä¸€ä¼šæ‹¿èµ·ç¯®çƒç»™ä½ è¡¨æ¼”çƒæŠ€ï¼Œå†ä¸æ˜¯å°±è®©ä½ é™ªä»–ç©è·³æ£‹ã€‚</p>
<p>è€å©†å¤§äººåœ¨å®¶å¾…äº§äº†ï¼Œè‡ªå·±ä¸€ä¸ªäººæŒºç€è‚šå­è¿˜æœ‰ç»™å¤§å®åšé¥­ï¼Œæ¯å¤©æ¥é€ä»–å»å­¦æ ¡ï¼ŒçŸ¥é“å¥¹ä¸€ä¸ªäººåœ¨å®¶ä¸å®¹æ˜“ï¼Œæˆ‘ä¹Ÿç»å¸¸é¼“åŠ±å¥¹ï¼Œå¥¹è¯´ï¼šâ€œä¸ºäº†å­©å­ï¼Œè¿™ç‚¹è‹¦ä¸ç®—ä»€ä¹ˆï¼â€ã€‚æœ‰æ—¶å€™ï¼Œæƒ³ä¸€æƒ³äºŒå®å¿«è¦è·Ÿæˆ‘ä»¬è§é¢äº†ï¼ŒæŒºå…´å¥‹çš„ã€‚</p>
<p>æœ‰æ—¶å€™æŒºæƒ³å¿µä»–ä»¬å¨˜ä¿©çš„ï¼Œå·¥ä½œä¸å¿™çš„æ—¶å€™æˆ‘ä¹Ÿä¼šè¯·å‡å›è€å®¶ï¼Œè®°å¾—ä¸Šæ¬¡å›å»ç¦»å¼€çš„æ—¶å€™ï¼Œå„¿å­é—®äº†æˆ‘ä¸€ä¸ªé—®é¢˜ï¼Œä»–è¯´ï¼šâ€œçˆ¸çˆ¸ï¼Œä½ è¯´æ˜¯é’±é‡è¦ï¼Œè¿˜æ˜¯äººé‡è¦ï¼Ÿâ€ï¼Œæˆ‘å½“æ—¶æ„£äº†ä¸€ä¸‹ï¼Œå‘Šè¯‰ä»–ï¼šâ€œå½“ç„¶æ˜¯äººé‡è¦å‘€ï¼â€ï¼Œä»–ä¸å¼€å¿ƒçš„ç‚¹äº†ç‚¹å¤´ã€‚æ˜¾ç„¶ï¼Œè¿™å®¶ä¼™å¯¹æˆ‘çš„ç¦»å¼€å¾ˆä¸æ»¡æ„ï¼Œé‚£å¤©æ™šä¸Šæˆ‘èµ¶ç«è½¦èµ°çš„æ—¶å€™ï¼Œå¤§å®åœ¨è¢«çªé‡Œå“­äº†å¾ˆä¹…ï¼Œå…¶å®ï¼Œæˆ‘ä¹Ÿæµæ³ªäº†ï¼Œåªæ˜¯ä¸æ„¿æ„æ‰¿è®¤ç½¢äº†ï¼</p>
<p>ä½ è‡ªå·±é™¤äº†æ˜¯ä¸€åå‘˜å·¥ä¹‹å¤–ï¼Œè¿˜æ˜¯ä¸€åå„¿å­ã€å¥³å„¿ï¼Œæˆ–è€…æ˜¯ä¸€åçˆ¶äº²ã€æ¯äº²ï¼Œä¸€åä¸ˆå¤«ã€å¦»å­ï¼Œåªæœ‰å¤„ç†å¥½ç”Ÿæ´»ä¸Šé¢çš„äº‹æƒ…ï¼Œæ‰èƒ½æ›´å¥½çš„æŠ•å…¥åˆ°å·¥ä½œå½“ä¸­æ¥ã€‚æ— è®ºå¦‚ä½•ï¼Œäººè¿˜æ˜¯éœ€è¦æœ‰æ¢¦æƒ³çš„ï¼æˆ‘çš„æ¢¦æƒ³å°±æ˜¯åŠªåŠ›å­¦ä¹ æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†ï¼Œç„¶åç”¨è‡ªå·±çš„çŸ¥è¯†å»æ•™è‚²è‡ªå·±çš„å­å¥³ï¼Œè®©ä»–ä»¬å°†æ¥èƒ½æœ‰æ›´å¥½çš„ç”Ÿæ´»ï¼Œåšä¸€ä¸ªæœ‰ç”¨çš„ç¤¾ä¼šäººã€‚</p>
<p>ç”¨ç”µå½±ã€Šä¸­å›½åˆä¼™äººã€‹æˆä¸œé’çš„ä¸€å¥è¯æ¥è¯´ï¼šâ€œæ¢¦æƒ³æ˜¯ä»€ä¹ˆï¼Œæ¢¦æƒ³å°±æ˜¯ä¸€ç§è®©ä½ æ„Ÿåˆ°åšæŒå°±æ˜¯å¹¸ç¦çš„ä¸œè¥¿ï¼â€ã€‚</p>
<h2 id="é˜…è¯»"><a href="#é˜…è¯»" class="headerlink" title="é˜…è¯»"></a>é˜…è¯»</h2><p>è¿™äº›å¹´ï¼Œè‡ªå·±å”¯ä¸€æ²¡æœ‰ä¸¢å¼ƒçš„çˆ±å¥½å°±æ˜¯é˜…è¯»ã€‚</p>
<p>å·¥ä½œä¸Šçš„å¿™ç¢Œï¼Œç”Ÿæ´»ä¸Šçš„ç–²æƒ«ï¼Œå¾ˆå¤šæ—¶å€™è®©æˆ‘ä»¬æ— æ³•é™ä¸‹å¿ƒæ¥å»é˜…è¯»ï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šè§‰å¾—é˜…è¯»ç®€ç›´åœ¨æµªè´¹æ—¶é—´ï¼Œæµªè´¹ç”Ÿå‘½ã€‚å¦‚æœä½ æœ‰è¿™ç§æƒ³æ³•ï¼Œå»ºè®®ä½ è¯·å‡å»å¥½å¥½ä¼‘æ¯å‡ å¤©ï¼ŒæŠ›å¼€å–§åš£çš„å°˜ä¸–ï¼Œæ”¾ç©ºä¸€ä¸‹è‡ªå·±ã€‚</p>
<p>æˆ‘ä¸€ç›´åšæŒé˜…è¯»ï¼Œæ— è®ºæ˜¯æŠ€æœ¯ä¹¦ç±è¿˜æ˜¯äººæ–‡å†å²ï¼ŒæŠ‘æˆ–äººç‰©ä¼ è®°ï¼Œå¹³æ—¶å·¥ä½œä¹Ÿå¾ˆå¿™ï¼Œæˆ‘å°±åˆ©ç”¨é›¶æ•£çš„æ—¶é—´æ¥é˜…è¯»ï¼Œå°±ç®—è¿™æ ·ï¼Œæ¯å‘¨æ¯ä¸ªæœˆç´¯è®¡ä¸‹æ¥é˜…è¯»é‡ä¹Ÿä¸å°‘äº†ï¼Œéšç€é˜…è¯»é‡çš„å¢å¤šï¼Œæ„Ÿè§‰è‡ªå·±çš„æ°”è‰²å¥½äº†å¾ˆå¤šï¼Œå› ä¸ºå¿ƒæ€å¥½äº†ï¼Œé‡äº‹æ¯”ä»¥å‰æ›´åŠ æ²‰ç€å†·é™äº†ï¼Œä¹Ÿæ›´åŠ ç†æ€§äº†ã€‚</p>
<blockquote>
<p>æ‚¨çš„æ°”è´¨é‡Œè—ç€ä½ è¯»è¿‡çš„é‚£äº›ä¹¦ã€‚</p>
</blockquote>
<p>ä»Šå¹´è¯»åˆ°è‡ªè®¤ä¸ºä¸é”™çš„ä¹¦ç±ï¼Œæ¨èç»™å¤§å®¶ï¼š</p>
<p><strong>1. èš‚èšé‡‘æœï¼šç§‘æŠ€é‡‘èç‹¬è§’å…½çš„å´›èµ·</strong><br><img src="/upload/images/2018/12/31/1.jpg" alt=""></p>
<p><strong>2. èµ‹èƒ½ï¼šæ‰“é€ åº”å¯¹ä¸ç¡®å®šæ€§çš„æ•æ·å›¢é˜Ÿ</strong><br><img src="/upload/images/2018/12/31/2.jpg" alt=""></p>
<p><strong>3. æˆ‘çš„æƒ…ç»ªä¸ºä½•æ€»è¢«ä»–äººå·¦å³</strong><br><img src="/upload/images/2018/12/31/3.jpg" alt=""></p>
<p><strong>4. ç»ˆèº«æˆé•¿</strong><br><img src="/upload/images/2018/12/31/4.jpg" alt=""></p>
<h2 id="2019"><a href="#2019" class="headerlink" title="2019"></a>2019</h2><p><strong>1. åŠ å¼ºå¯¹ä¸Šæ²Ÿé€š</strong></p>
<p>æ²Ÿé€šä¸èƒ½ä»…é™äºå¯¹ä¸‹æ²Ÿé€šï¼Œå¯¹ä¸Šæ²Ÿé€šå°¤ä¸ºé‡è¦ï¼Œè®©ä¸Šçº§çŸ¥é“ç›®å‰é¡¹ç›®çš„è¿›åº¦å’Œè§„åˆ’ï¼Œä»¥åŠé‡åˆ°çš„é—®é¢˜ã€‚è¿™ä¸€ç‚¹è‡ªå·±åšçš„è¿˜ä¸å¤Ÿå¥½ï¼Œåœ¨2019å¹´è¦åŠ å¼ºã€‚</p>
<p><strong>2. åŠ å¼ºè‡ªæˆ‘ç®¡ç†</strong></p>
<p>ç®¡ç†ï¼Œä¸æ˜¯ç®¡ç†åˆ«äººï¼Œè€Œæ˜¯è¦ç®¡ç†å¥½è‡ªå·±ï¼Œæ²¡æœ‰äººæ„¿æ„è¢«ç®¡ç†ï¼Œå¦‚æœæœ‰éœ€è¦è¢«ä¸¥æ ¼ç®¡ç†çš„ï¼Œä»–å¯èƒ½ä¸é€‚åˆåœ¨ä½ çš„å›¢é˜Ÿä¸­ç”Ÿå­˜ã€‚åŠ å¼ºè‡ªæˆ‘ç®¡ç†æ˜¯æˆ‘ä»¬æ¯ä¸ªäººçš„ç›®æ ‡ã€‚</p>
<p><strong>3. ä¸ªäººã€å›¢é˜ŸæŠ€æœ¯èƒ½åŠ›å†ä¸Šä¸€å±‚æ¥¼</strong></p>
<p>è¡¥é½è‡ªå·±çš„çŸ­æ¿ï¼Œæƒ³å°½ä¸€åˆ‡åŠæ³•æé«˜è‡ªå·±å’Œå›¢é˜Ÿå…¶ä»–æŠ€æœ¯äººå‘˜çš„æŠ€æœ¯èƒ½åŠ›ï¼Œåœ¨ç¨³å®šã€é«˜æ•ˆçš„åŒæ—¶å¯»æ‰¾æ›´å¤šè‡ªæˆ‘æˆé•¿çš„é€”å¾„å’Œæ–¹æ³•ã€‚</p>
<p><strong>4.æ›´åŠ å…³å¿ƒè‡ªå·±çš„å®¶äººå’Œèº«è¾¹çš„æœ‹å‹</strong></p>
<p>æ²¡æœ‰å®¶äººçš„æ”¯æŒå’Œé¼“åŠ±ï¼Œä½ å¾ˆéš¾å»æŠ•å…¥å·¥ä½œï¼Œæ‰€ä»¥è¦å¥½å¥½çš„å¯¹å¾…è‡ªå·±çš„å®¶äººï¼Œå¤šå…³å¿ƒä»–ä»¬ï¼Œå®¶äººå¯¹ä½ çš„è¦æ±‚ä¸å¤šï¼Œå¾€å¾€åªéœ€è¦çŸ¥é“ä½ æœ‰æ²¡æœ‰æƒ¦è®°ä»–ä»¬å°±å¤Ÿäº†ã€‚å½“ç„¶äº†ï¼Œæˆ‘å¾ˆæœŸå¾…å’Œæˆ‘ä»¬å®¶çš„äºŒå®è§é¢ï¼Œå˜¿å˜¿ğŸ˜œï¼</p>
<p>æœ‹å‹å¤šäº†ï¼Œè·¯æ‰å¥½èµ°ï¼Œè®°å¾—è·Ÿæœ‹å‹å¤šèŠå¤©ï¼Œå¤šå¬å¬ä»–ä»¬çš„æ•…äº‹ï¼Œæœ€é‡è¦çš„æ˜¯ç»å¸¸çº¦ä»–ä»¬å–å–é…’ã€‚</p>
<hr>
<p>æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯ï¼Œå…±å‹‰ï¼š</p>
<blockquote>
<p>ä½ çš„ç›®çš„ä¸æ˜¯ç»™è°æ‰“å·¥ï¼Œè€Œæ˜¯æˆä¸ºæ›´å¥½çš„è‡ªå·±ï¼Œå»ºè®¾æ›´å¥½çš„æœªæ¥ï¼æ‰€ä»¥å°½å¿«å»è°ƒæ•´å¿ƒæ€ï¼Œåœæ­¢æŠ±æ€¨ï¼Œç«‹å³è¡ŒåŠ¨ï¼Œç§¯ææ²Ÿé€šï¼</p>
</blockquote>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[NSStringã€NSMutableString å¯å˜ä¸ä¸å¯å˜çš„é‚£äº›äº‹å„¿]]></title>
      <url>/2018/12/30/NSString%E3%80%81NSMutableString-%E5%8F%AF%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/</url>
      <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¿™ç¯‡æ–‡ç« çš„ä¸»è¦åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡</li>
<li>NSString çš„ copy å’Œ mutableCopy</li>
<li>NSMutableString çš„ copy å’Œ mutableCopy</li>
<li>property ä¸­ copyã€strong ä¿®é¥° NSString</li>
<li>property ä¸­ copyã€strong ä¿®é¥° NSMutableString</li>
</ul>
<p>å¾ˆå¤š iOS å¼€å‘çš„æœ‹å‹ä¼šäº‰è®ºä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ç”¨ <code>copy</code> å’Œ <code>strong</code> æ¥ä¿®é¥° <code>NSString</code> å¯¹è±¡éƒ½æ˜¯ä¸€æ ·çš„æ•ˆæœï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œè¿™äºŒè€…ç¡®å®æ˜¯æ²¡æœ‰åŒºåˆ«ï¼Œä½†æ˜¯åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼ŒäºŒè€…æˆªç„¶ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ææ¸…æ¥šé‡Œé¢çš„é“é“ã€‚</p>
<p>æˆ‘å·²ç»å°½åŠ›ç®€åŒ–äº†è¿™ç¯‡æ–‡ç« çš„å†…å®¹äº†ï¼Œä½†ä¾ç„¶éœ€è¦ä½ èŠ±ä¸ª15åˆ†é’Ÿå·¦å³çš„æ—¶é—´ï¼Œæ‰€ä»¥å½“ä½ å¿ƒæƒ…ä¸é”™åˆæ²¡æœ‰å…¶ä»–äº‹æƒ…çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥æ¥é˜…è¯»äº†ã€‚</p>
<h2 id="å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡"><a href="#å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡" class="headerlink" title="å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡"></a>å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡</h2><p>åœ¨ <code>Objective-C</code> ä¸­æœ€å¸¸ç”¨æ¥å¤„ç†å­—ç¬¦ä¸²çš„æ˜¯ <code>NSString</code> ä¸ <code>NSMutableString</code> è¿™ä¸¤ä¸ªç±»ï¼Œ<code>NSString</code> è¢«åˆ›å»ºèµ‹å€¼åå­—ç¬¦ä¸²çš„å†…å®¹ä¸é•¿åº¦ä¸èƒ½å†åšåŠ¨æ€çš„ä¿®æ”¹ï¼Œé™¤éé‡æ–°ç»™è¿™ä¸ªå­—ç¬¦ä¸²èµ‹å€¼ã€‚è€Œ <code>NSMutableString</code> è¢«åˆ›å»ºèµ‹å€¼åå¯ä»¥åŠ¨æ€çš„ä¿®æ”¹å­—ç¬¦ä¸²çš„å†…å®¹ã€‚</p>
<p>é‚£ä¹ˆç®€å•æ¥è¯´ï¼Œå¯å˜å¯¹è±¡æ˜¯æŒ‡ï¼Œå¯¹è±¡çš„å†…å®¹æ˜¯å¯å˜çš„ï¼Œä¾‹å¦‚ <code>NSMutableString</code> å¯¹è±¡ã€‚ä¸å¯å˜çš„å¯¹è±¡åˆ™ç›¸åï¼Œè¡¨ç¤ºå…¶å†…å®¹ä¸å¯å˜ï¼Œä¾‹å¦‚ <code>NSString</code> å¯¹è±¡ã€‚</p>
<p>å¯å˜ä¸ä¸å¯å˜æ˜¯é’ˆå¯¹å¯¹è±¡æ¥è¯´çš„ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¦æ ¹æ®å®é™…çš„ä¸šåŠ¡åœºæ™¯æ¥é€‰æ‹©ä½¿ç”¨å¯å˜è¿˜æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚ä»Šå¤©æˆ‘ä»¬åªè®¨è®º <code>Objective-C</code> ä¸­ <code>NSString</code> ä¸ <code>NSMutableString</code> è¿™ä¸¤ä¸ªç±»ï¼Œå…³äºå…¶ä»–é›†åˆç±»çš„å¯å˜ä¸ä¸å¯å˜ç‰¹æ€§ï¼Œåé¢ä¸“é—¨å†æ¥å†™æ–‡ç« åˆ†äº«ã€‚</p>
<h2 id="NSString-çš„-copy-å’Œ-mutableCopy"><a href="#NSString-çš„-copy-å’Œ-mutableCopy" class="headerlink" title="NSString çš„ copy å’Œ mutableCopy"></a>NSString çš„ copy å’Œ mutableCopy</h2><p>åœ¨ <code>NSString.h</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSString</span> : <span class="title">NSObject</span> &lt;<span class="title">NSCopying</span>, <span class="title">NSMutableCopying</span>, <span class="title">NSSecureCoding</span>&gt;</span></div></pre></td></tr></table></figure>
<p><code>NSString.h</code> æœ¬èº«å®ç°äº† <code>NSCopying</code>, <code>NSMutableCopying</code> è¿™ä¸¤ä¸ªåè®®ï¼Œåè®®çš„å®šä¹‰å¦‚ä¸‹å†…å®¹æ‰€ç¤ºï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">NSCopying</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="keyword">nullable</span> <span class="built_in">NSZone</span> *)zone;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">NSMutableCopying</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">id</span>)mutableCopyWithZone:(<span class="keyword">nullable</span> <span class="built_in">NSZone</span> *)zone;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹ <code>NSString</code> å¯¹è±¡è¿›è¡Œ <code>copy</code> å’Œ <code>mutableCopy</code> çš„æ“ä½œï¼Œå¦¥å¦¥çš„ã€‚</p>
<p>ä¸¾ä¸€ä¸ªç®€å•çš„æ —å­ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *name = <span class="string">@"www."</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name addr: %p, name content: %@"</span>, name, name);</div><div class="line">    </div><div class="line"><span class="built_in">NSString</span> *name1 = name;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name1 addr: %p, name1 content: %@"</span>, name1, name1);</div><div class="line">    </div><div class="line"><span class="built_in">NSString</span> *name2 = [name <span class="keyword">copy</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name2 addr: %p, name2 content: %@"</span>, name2, name2);</div></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">name  addr: <span class="number">0x10090ecf8</span>, name  content: www.</div><div class="line">name1 addr: <span class="number">0x10090ecf8</span>, name1 content: www.</div><div class="line">name2 addr: <span class="number">0x10090ecf8</span>, name2 content: www.</div></pre></td></tr></table></figure>
<p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œä¸‰ä¸ªå¯¹è±¡çš„å†…å®¹å’Œåœ°å€éƒ½æ˜¯ä¸€æ ·çš„ï¼Œç»è¿‡ <code>name</code> å¯¹è±¡ <code>copy</code> åçš„ <code>name2</code> ä¸ <code>name</code> è¿˜æ˜¯æŒ‡å‘åŒä¸€å—å†…å­˜åœ°å€ã€‚</p>
<p>åœ¨æ–­ç‚¹è¿‡ç¨‹ä¸­ï¼Œå‘ç°æ— è®ºæ˜¯ <code>name</code> è¿˜æ˜¯ <code>name1</code>ã€<code>name2</code> å¯¹è±¡ï¼Œå…¶éƒ½æ˜¯ <code>ConstantString</code>ï¼Œè¡¨æ˜ä¸‰è€…éƒ½æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/12/30/1.jpg" alt=""></p>
<p>ä»è¿™å¼ å›¾ä¹Ÿè¯´æ˜äº†ä¸€ä¸ªé—®é¢˜ï¼Œ<code>NSString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åä»ç„¶æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚</p>
<p>ç´§æ¥ç€ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ <code>mutableCopy</code> çš„ä½¿ç”¨æƒ…å†µï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *name = <span class="string">@"www."</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name addr: %p, name content: %@"</span>, name, name);</div><div class="line">    </div><div class="line"><span class="built_in">NSString</span> *name1 = name;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name1 addr: %p, name1 content: %@"</span>, name1, name1);</div><div class="line">    </div><div class="line"><span class="built_in">NSString</span> *name2 = [name <span class="keyword">copy</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name2 addr: %p, name2 content: %@"</span>, name2, name2);</div><div class="line">    </div><div class="line"><span class="keyword">id</span> name3 = [name mutableCopy];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name3 addr: %p, name3 content: %@"</span>, name3, name3);</div></pre></td></tr></table></figure>
<p>å¯¹è±¡ <code>name3</code> æ˜¯ç»è¿‡ <code>name</code> å¯¹è±¡ <code>mutableCopy</code> åçš„ï¼Œè¿™ä¸ªæ—¶å€™å› ä¸ºæˆ‘ä¸ç¡®å®š <code>name3</code> åˆ°åº•æ˜¯å¯å˜çš„è¿˜æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥é‡‡ç”¨äº† <code>id</code> æ¥ä¿®é¥° <code>name3</code> å¯¹è±¡ã€‚</p>
<p>å¯ä»¥çœ‹ä¸€ä¸‹è¾“å‡ºå†…å®¹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">name  addr: <span class="number">0x104a6acf8</span>, name  content: www.</div><div class="line">name1 addr: <span class="number">0x104a6acf8</span>, name1 content: www.</div><div class="line">name2 addr: <span class="number">0x104a6acf8</span>, name2 content: www.</div><div class="line">name3 addr: <span class="number">0x1c0052cf0</span>, name3 content: www.</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œ<code>name3</code> çš„åœ°å€å˜äº†ï¼Œå†çœ‹ä¸€ä¸‹æ–­ç‚¹çš„æˆªå›¾ï¼š<br><img src="/upload/images/2018/12/30/2.jpg" alt=""></p>
<p>å……åˆ†è¯´æ˜äº† <code>name3</code> ç»è¿‡ä¸å¯å˜çš„ <code>name</code> è¿›è¡Œ<code>mutableCopy</code> åå˜æˆäº†å¯å˜å¯¹è±¡ã€‚é‚£ä¹ˆå¯ä»¥å°†ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ç¨ä½œä¿®æ”¹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSMutableString</span> *name3 = [name mutableCopy];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name3 addr: %p, name3 content: %@"</span>, name3, name3);</div><div class="line">[name3 appendString:<span class="string">@"veryitman.com"</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name3 addr: %p, name3 content: %@"</span>, name3, name3);</div></pre></td></tr></table></figure>
<p>ä»ä¸‹é¢çš„è¾“å‡ºç»“æœä¹Ÿå……åˆ†è¯´æ˜äº† <code>name3</code> ç»è¿‡ä¸å¯å˜çš„ <code>name</code> è¿›è¡Œ <code>mutableCopy</code> åå˜æˆäº†å¯å˜å¯¹è±¡ã€‚è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name3 addr: <span class="number">0x1d0058270</span>, name3 content: www.veryitman.com</div></pre></td></tr></table></figure>
<p><strong>ç»“è®º 1ï¼š</strong></p>
<ul>
<li>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åï¼Œè¿˜æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚</li>
<li>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ç»è¿‡ <code>mutableCopy</code> åï¼Œå˜æˆäº†å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</li>
</ul>
<h2 id="NSMutableString-çš„-copy-å’Œ-mutableCopy"><a href="#NSMutableString-çš„-copy-å’Œ-mutableCopy" class="headerlink" title="NSMutableString çš„ copy å’Œ mutableCopy"></a>NSMutableString çš„ copy å’Œ mutableCopy</h2><p>ç±» <code>NSMutableString</code> ç»§æ‰¿è‡ª <code>NSString</code> çš„ï¼Œå…¶å½“ç„¶ä¹Ÿæ˜¯å®ç°äº† <code>NSCopying</code>, <code>NSMutableCopying</code> è¿™ä¸¤ä¸ªåè®®çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@interface NSMutableString : NSString</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿˜æ˜¯çœ‹ä¾‹å­ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSMutableString</span> *name = [<span class="built_in">NSMutableString</span> stringWithString:<span class="string">@"www."</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name  addr: %p, name  content: %@"</span>, name, name);</div><div class="line"></div><div class="line"><span class="comment">// ç®€å•èµ‹å€¼</span></div><div class="line"><span class="built_in">NSMutableString</span> *name1 = name;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name1 addr: %p, name1 content: %@"</span>, name1, name1);</div><div class="line">   </div><div class="line"><span class="comment">// ä½¿ç”¨ copy    </span></div><div class="line"><span class="keyword">id</span> name2 = [name <span class="keyword">copy</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name2 addr: %p, name2 content: %@"</span>, name2, name2);</div><div class="line"> </div><div class="line"><span class="comment">// ä½¿ç”¨ mutableCopy   </span></div><div class="line"><span class="keyword">id</span> name3 = [name mutableCopy];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name3 addr: %p, name3 content: %@"</span>, name3, name3);</div></pre></td></tr></table></figure>
<p>å› ä¸ºäº‹å…ˆæˆ‘ä»¬ä¸çŸ¥é“ <code>NSMutableString</code> ç»è¿‡ <code>copy</code> å’Œ <code>mutableCopy</code> ä¹‹ååˆ°åº•ä¼šå˜æˆå¯å˜è¿˜æ˜¯ä¸å¯å˜ï¼Œä¸Šé¢çš„ä¾‹å­æš‚æ—¶å°† <code>name2</code> å’Œ <code>name3</code> ç”¨ <code>id</code> æ¥è¡¨ç¤ºã€‚</p>
<p>æ–­ç‚¹æˆªå›¾å¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/12/30/3.jpg" alt=""></p>
<p>ç»“åˆä¸€ä¸‹è¾“å‡ºçš„æ—¥å¿—ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">name  addr: <span class="number">0x1d044a980</span>, name  content: www.</div><div class="line">name1 addr: <span class="number">0x1d044a980</span>, name1 content: www.</div><div class="line">name2 addr: <span class="number">0xa0000002e7777774</span>, name2 content: www.</div><div class="line">name3 addr: <span class="number">0x1d044a5f0</span>, name3 content: www.</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡º <code>name2</code> æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ï¼Œ <code>name</code>ã€<code>name1</code> å’Œ <code>name3</code> éƒ½æ˜¯å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</p>
<p>ä¹Ÿå¯ä»¥ä»å¦å¤–ä¸€ä¸ªè§’åº¦æ¥éªŒè¯ä¸€ä¸‹ä¸Šé¢çš„è¯´æ³•ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSMutableString</span> *name2 = [name <span class="keyword">copy</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name2 addr: %p, name2 content: %@"</span>, name2, name2);</div><div class="line">[name2 appendString:<span class="string">@"veryitman.com"</span>];</div><div class="line">    </div><div class="line"><span class="built_in">NSMutableString</span> *name3 = [name mutableCopy];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name3 addr: %p, name3 content: %@"</span>, name3, name3);</div><div class="line">[name3 appendString:<span class="string">@"veryitman.com"</span>];</div></pre></td></tr></table></figure>
<p>è¿è¡Œåï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä»£ç  <code>[name2 appendString:@&quot;veryitman.com&quot;]</code> è¿™é‡Œä¼šå¼•èµ· Crashï¼ŒæŠ¥é”™å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> -[<span class="built_in">NSTaggedPointerString</span> appendString:]: unrecognized selector sent to instance <span class="number">0xa0000002e7777774</span></div><div class="line"> </div><div class="line">*** Terminating app due to uncaught exception 'NSInvalidArgumentException'</div><div class="line"></div><div class="line">reason: '-[NSTaggedPointerString appendString:]: unrecognized selector sent to instance 0xa0000002e7777774'</div></pre></td></tr></table></figure>
<p>ä¹Ÿå……åˆ†è¯´æ˜äº†ï¼Œ<code>name2</code> æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ã€‚</p>
<p><strong>ç»“è®º 2ï¼š</strong></p>
<ul>
<li>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åï¼Œä¼šå˜æˆä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ã€‚</li>
<li>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ç»è¿‡ <code>mutableCopy</code> åï¼Œä»ç„¶æ˜¯å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</li>
</ul>
<h2 id="copyã€strong-ä¿®é¥°-NSString"><a href="#copyã€strong-ä¿®é¥°-NSString" class="headerlink" title="copyã€strong ä¿®é¥° NSString"></a>copyã€strong ä¿®é¥° NSString</h2><p>åˆ›å»º Employee æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Employee</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *userName;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>å…¶ <code>userName</code> å±æ€§æ˜¯ <code>copy</code>ã€‚</p>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">Employee *employee = [Employee new];</div><div class="line">employee.userName = <span class="string">@"John"</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"--before-- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div><div class="line">        </div><div class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå¯å˜å¯¹è±¡</span></div><div class="line"><span class="built_in">NSMutableString</span> *newUserName = [[<span class="built_in">NSMutableString</span> alloc] initWithString:<span class="string">@"new_user_name"</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"newUserName addr: %p, newUserName content: %@"</span>, newUserName, newUserName);</div><div class="line">    </div><div class="line"><span class="comment">// å°†ä¸€ä¸ªæ–°çš„å¯¹åƒèµ‹å€¼ç»™ employee.userNameï¼Œæ­¤æ—¶ employee.userName çš„åœ°å€è‚¯å®šä¼šå˜åŒ–</span></div><div class="line">employee.userName = newUserName;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"---after1--- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div><div class="line">    </div><div class="line"><span class="comment">// è¯•å›¾æ”¹å˜ newUserName çš„å†…å®¹ï¼Œçœ‹ employee.userName çš„å†…å®¹æ˜¯å¦æ”¹å˜</span></div><div class="line">[newUserName appendString:<span class="string">@"_hello"</span>];</div><div class="line"></div><div class="line"><span class="comment">// newUserName çš„å†…å®¹è¢«æ”¹å˜æˆäº† new_user_name_hello</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"newUserName addr: %p, newUserName content: %@"</span>, newUserName, newUserName);</div><div class="line"></div><div class="line"><span class="comment">// employee.userName çš„å†…å®¹æœªå˜åŒ–</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"---after2--- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div><div class="line">    </div><div class="line"><span class="comment">// Crashï¼Œå› ä¸º employee.userName è¿˜æ˜¯ä¸å¯å˜å¯¹è±¡</span></div><div class="line"><span class="comment">// [(NSMutableString *)(employee.userName) appendString:@"nana"];</span></div></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæ•…æ„å°† <code>NSMutableString</code> å¯¹è±¡ <code>newUserName</code> èµ‹å€¼ç»™ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ <code>employee.userName</code>ï¼Œçœ‹ä¸€ä¸‹è¾“å‡ºç»“æœï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">--before-- employee.userName addr: <span class="number">0x100096cf8</span>, employee.userName content: John</div><div class="line"></div><div class="line">newUserName addr: <span class="number">0x174070a00</span>, newUserName content: new_user_name</div><div class="line"></div><div class="line">---after1--- employee.userName addr: <span class="number">0x174023b80</span>, employee.userName content: new_user_name</div><div class="line"></div><div class="line">newUserName addr: <span class="number">0x174070a00</span>, newUserName content: new_user_name_hello</div><div class="line"></div><div class="line">---after2--- employee.userName addr: <span class="number">0x174023b80</span>, employee.userName content: new_user_name</div></pre></td></tr></table></figure>
<p>æŒ‰ç…§ </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">å¯å˜çš„ `<span class="built_in">NSMutableString</span>` å¯¹è±¡ç»è¿‡ `<span class="keyword">copy</span>` åï¼Œä¼šå˜æˆä¸å¯å˜çš„ `<span class="built_in">NSString</span>` å¯¹è±¡ã€‚</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªç»“è®ºæ¥çœ‹ï¼Œ<code>employee.userName</code> è‚¯å®šæ˜¯ä¸å¯å˜çš„å¯¹è±¡ï¼Œå³ä½¿æ”¹å˜ <code>newUserName</code> çš„å†…å®¹ä¹Ÿä¸ä¼šå½±å“ <code>employee.userName</code> è¿™ä¸ªå¯¹è±¡çš„å†…å®¹ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°† <code>employee.userName</code> çš„å±æ€§ä¿®é¥°ç¬¦ <code>copy</code> æ”¹ä¸º <code>strong</code>ï¼Œåˆä¼šæ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬ä¿®æ”¹ä¸¤å¤„ä»£ç </p>
<p><strong>Employee.h</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Employee</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="comment">//@property (nonatomic, copy) NSString *userName;</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *userName;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä»£ç ï¼Œåªæ˜¯æ‰“å¼€ä¹‹å‰ä¼š crash çš„éƒ¨åˆ†</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// employee.userName ç»è¿‡ strong ä¿®é¥°è¿‡åï¼Œ å½»åº•å˜æˆäº†å¯å˜å¯¹è±¡</span></div><div class="line">[(<span class="built_in">NSMutableString</span> *)(employee.userName) appendString:<span class="string">@"_oc"</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"---after3--- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div></pre></td></tr></table></figure>
<p>çœ‹ä¸€ä¸‹è¾“å‡ºæ—¥å¿—ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">--before-- employee.userName addr: <span class="number">0x1000a6cf8</span>, employee.userName content: John</div><div class="line"></div><div class="line">newUserName addr: <span class="number">0x17426b280</span>, newUserName content: new_user_name</div><div class="line"></div><div class="line">---after1--- employee.userName addr: <span class="number">0x17426b280</span>, employee.userName content: new_user_name</div><div class="line"></div><div class="line">newUserName addr: <span class="number">0x17426b280</span>, newUserName content: new_user_name_hello</div><div class="line"></div><div class="line">---after2--- employee.userName addr: <span class="number">0x17426b280</span>, employee.userName content: new_user_name_hello</div><div class="line"></div><div class="line">---after3--- employee.userName addr: <span class="number">0x17426b280</span>, employee.userName content: new_user_name_hello_oc</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ° <code>employee.userName</code> æœ€ç»ˆå’Œ <code>newUserName</code> çš„åœ°å€ã€å†…å®¹å®Œå…¨ç›¸åŒäº†ï¼Œå½»åº•å˜æˆäº†å¯å˜å¯¹è±¡ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœä¸æ˜¯å°†å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡èµ‹å€¼ç»™ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ï¼Œæ¢å¥è¯è¯´ï¼Œ<code>NSString</code> å¯¹ <code>NSString</code> èµ‹å€¼ï¼Œé‚£ä¹ˆä½¿ç”¨ <code>strong</code> å’Œ <code>copy</code> æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼ˆæ— è®º <code>employee.userName</code> ä½¿ç”¨ <code>strong</code> è¿˜æ˜¯ <code>copy</code>ï¼Œæ•ˆæœéƒ½æ˜¯ <code>employee.userName</code> ä¸å¯å˜çš„ï¼‰ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Employee *employee = [Employee new];</div><div class="line">employee.userName = <span class="string">@"John"</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"--before-- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div><div class="line">    </div><div class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªä¸å¯å˜å¯¹è±¡</span></div><div class="line"><span class="built_in">NSString</span> *newUserName = <span class="string">@"new_user_name"</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"newUserName addr: %p, newUserName content: %@"</span>, newUserName, newUserName);</div><div class="line">    </div><div class="line"><span class="comment">// å°†ä¸€ä¸ªæ–°çš„å¯¹åƒèµ‹å€¼ç»™ employee.userNameï¼Œæ­¤æ—¶ employee.userName çš„åœ°å€è‚¯å®šä¼šå˜åŒ–</span></div><div class="line">employee.userName = newUserName;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"---after1--- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div></pre></td></tr></table></figure>
<h2 id="copyã€strong-ä¿®é¥°-NSMutableString"><a href="#copyã€strong-ä¿®é¥°-NSMutableString" class="headerlink" title="copyã€strong ä¿®é¥° NSMutableString"></a>copyã€strong ä¿®é¥° NSMutableString</h2><p>åœ¨ property çš„ä¿®é¥°è¯­ä¸­ï¼Œåªæœ‰ <code>copy</code> ä¿®é¥°è¯­è€Œæ²¡æœ‰ <code>mutableCopy</code> çš„ä¿®é¥°è¯­ã€‚</p>
<p><strong>Employee.h</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@interface Employee : NSObject</div><div class="line"></div><div class="line">@property (nonatomic, copy) NSMutableString *userName;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">Employee *employee = [Employee new];</div><div class="line">employee.userName = [NSMutableString stringWithString:@&quot;John&quot;];</div><div class="line">NSLog(@&quot;--before-- employee.userName addr: %p, employee.userName content: %@&quot;, employee.userName, employee.userName);</div><div class="line"></div><div class="line">// åˆ›å»ºä¸€ä¸ªå¯å˜å¯¹è±¡</div><div class="line">NSMutableString *newUserName = [NSMutableString stringWithFormat:@&quot;new_user_name&quot;];</div><div class="line">NSLog(@&quot;newUserName addr: %p, newUserName content: %@&quot;, newUserName, newUserName);</div><div class="line"></div><div class="line">// å°†ä¸€ä¸ªæ–°çš„å¯¹åƒèµ‹å€¼ç»™ employee.userNameï¼Œæ­¤æ—¶ employee.userName çš„åœ°å€è‚¯å®šä¼šå˜åŒ–</div><div class="line">employee.userName = newUserName;</div><div class="line">NSLog(@&quot;---after1--- employee.userName addr: %p, employee.userName content: %@&quot;, employee.userName, employee.userName);</div><div class="line">    </div><div class="line">// employee.userName è™½ç„¶æ˜¯ NSMutableString å¯¹è±¡ï¼Œä½†ç»è¿‡ copy ä¿®é¥°è¿‡åï¼Œä»ç„¶æ˜¯ä¸å¯å˜å¯¹è±¡</div><div class="line">// æ‰€ä»¥ï¼Œè¿è¡Œåˆ°è¿™é‡Œä¼šå¼•èµ· crash</div><div class="line">[employee.userName appendString:@&quot;_oc&quot;];</div><div class="line">NSLog(@&quot;---after2--- employee.userName addr: %p, employee.userName content: %@&quot;, employee.userName, employee.userName);</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡º <code>copy</code> åçš„çš„å¯å˜å¯¹è±¡è¿˜æ˜¯ä¸å¯å˜çš„ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°† <code>employee.userName</code> çš„å±æ€§ä¿®é¥°ç¬¦ <code>copy</code> æ”¹ä¸º <code>strong</code>ï¼Œåˆä¼šæ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿ</p>
<p><strong>Employee.h</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Employee</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *userName;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">Employee *employee = [Employee new];</div><div class="line">employee.userName = [<span class="built_in">NSMutableString</span> stringWithString:<span class="string">@"John"</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"--before-- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå¯å˜å¯¹è±¡</span></div><div class="line"><span class="built_in">NSMutableString</span> *newUserName = [<span class="built_in">NSMutableString</span> stringWithFormat:<span class="string">@"new_user_name"</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"newUserName addr: %p, newUserName content: %@"</span>, newUserName, newUserName);</div><div class="line"></div><div class="line"><span class="comment">// å°†ä¸€ä¸ªæ–°çš„å¯¹åƒèµ‹å€¼ç»™ employee.userNameï¼Œæ­¤æ—¶ employee.userName çš„åœ°å€è‚¯å®šä¼šå˜åŒ–</span></div><div class="line">employee.userName = newUserName;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"---after1--- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div><div class="line">    </div><div class="line"><span class="comment">// employee.userName è™½ç„¶æ˜¯ NSMutableString å¯¹è±¡ï¼Œä½†ç»è¿‡ strong ä¿®é¥°è¿‡åï¼Œå˜æˆäº†å¯å˜å¯¹è±¡</span></div><div class="line">[employee.userName appendString:<span class="string">@"_hello"</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"---after2--- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div><div class="line">    </div><div class="line">[newUserName appendString:<span class="string">@"_oc"</span>];</div><div class="line"><span class="comment">// newUserName çš„å†…å®¹è¢«æ”¹å˜æˆäº† new_user_name_hello_oc</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"newUserName addr: %p, newUserName content: %@"</span>, newUserName, newUserName);</div><div class="line"><span class="comment">// employee.userName çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"---after2--- employee.userName addr: %p, employee.userName content: %@"</span>, employee.userName, employee.userName);</div></pre></td></tr></table></figure>
<p>ç»è¿‡ <code>strong</code> ä¿®é¥°åï¼Œå¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡è¿˜æ˜¯å¯å˜çš„å¯¹è±¡ã€‚</p>
<p>åœ¨è¿™ä¸ªéƒ¨åˆ†çš„å¼€å§‹ï¼Œè¯´è¿‡åœ¨ property ä¸­æ²¡æœ‰ <code>mutableCopy</code> çš„ä¿®é¥°è¯­ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½å¦è¾¾åˆ° <code>mutableCopy</code> çš„æ•ˆæœå‘¢ï¼Ÿ</p>
<p>å¾ˆæ˜¾ç„¶æ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡å†™å±æ€§çš„ <code>set</code> æ–¹æ³•ï¼Œæ”¹é€ ä¸€ä¸‹ <code>Employee</code> çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<p><strong>Employee.h</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@interface Employee : NSObject</div><div class="line"></div><div class="line">@property (nonatomic, copy) NSMutableString *userName;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p><strong>Employee.m</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#import &quot;Employee.h&quot;</div><div class="line"></div><div class="line">@implementation Employee</div><div class="line"></div><div class="line">- (void)setUserName:(NSMutableString *)userName</div><div class="line">&#123;</div><div class="line">    _userName = [userName mutableCopy];</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œå°±è¾¾åˆ°äº†å’Œæ˜¯ <code>strong</code> ä¿®é¥°è¯­ä¸€æ ·çš„æ•ˆæœäº†ã€‚</p>
<p>å¤§å®¶ï¼Œå¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹æ³•æ¥å®è·µä¸€ä¸‹ <code>NSArray</code>ã€<code>NSMutableArry</code> ç­‰é›†åˆæ•°æ®çš„ <code>copy</code> ä»¥åŠ <code>mutableCopy</code> çš„æ•ˆæœäº†ã€‚</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ul>
<li><p>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åï¼Œè¿˜æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚</p>
</li>
<li><p>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ç»è¿‡ <code>mutableCopy</code> åï¼Œå˜æˆäº†å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</p>
</li>
<li><p>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ç»è¿‡ <code>copy</code> åï¼Œä¼šå˜æˆä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡ã€‚</p>
</li>
<li><p>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ç»è¿‡ <code>mutableCopy</code> åï¼Œä»ç„¶æ˜¯å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡ã€‚</p>
</li>
<li><p>ä¸å¯å˜çš„ <code>NSString</code> å¯¹è±¡åœ¨ property ä¸­ï¼Œå°½é‡ä½¿ç”¨ <code>copy</code> æ¥ä¿®é¥°ï¼Œå› ä¸ºä½¿ç”¨ <code>strong</code> ä¿®é¥°ç¬¦å¯å˜å­—ç¬¦ä¸²å¦‚æœç»™ä¸å¯å˜å­—ç¬¦ä¸²èµ‹å€¼åï¼Œä¼šå¯¼è‡´ä½ åŸæœ¬é¢„æœŸå‘ç”Ÿäº†å˜åŒ–ï¼Œé™¤éä½ æœ‰ç‰¹æ®Šçš„ç›®çš„æ‰ä½¿ç”¨ <code>strong</code> ä¿®é¥°ç¬¦ã€‚</p>
</li>
<li><p>å¯å˜çš„ <code>NSMutableString</code> å¯¹è±¡åœ¨ property ä¸­ï¼Œå°½é‡ä½¿ç”¨ <code>strong</code> æ¥ä¿®é¥°ï¼Œé™¤éä½ æœ‰ç‰¹æ®Šçš„ç›®çš„æ‰ä½¿ç”¨ <code>copy</code> ä¿®é¥°ç¬¦ã€‚</p>
</li>
<li><p>è™½ç„¶åœ¨ property ä¸­æ²¡æœ‰ <code>mutableCopy</code> ä¿®é¥°ç¬¦ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡é‡å†™å…¶ <code>set</code> æ–¹æ³•æ¥è¾¾åˆ°ç›®çš„ã€‚</p>
</li>
</ul>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> NSString NSMutableString copy mutableCopy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OC: self]]></title>
      <url>/2018/12/23/OC-self/</url>
      <content type="html"><![CDATA[<p>ä¸ºäº†æ›´å¥½çš„è¯´æ˜ Objective-C ä¸­çš„ <code>self</code>ï¼Œæˆ‘ä»¬å…ˆä» Java çš„ <code>this</code> å…³é”®å­—å¼€å§‹æ¥å¼•å…¥è¯é¢˜ã€‚</p>
<h2 id="Java-ä¸­çš„-this"><a href="#Java-ä¸­çš„-this" class="headerlink" title="Java ä¸­çš„ this"></a>Java ä¸­çš„ this</h2><p>åœ¨ Java ä¸­ <code>this</code> å…³é”®å­—è¡¨ç¤ºå½“å‰ç±»å¯¹è±¡ï¼Œå…¶åªèƒ½åœ¨ç±»çš„éé™æ€æ–¹æ³•ä¸­ä½¿ç”¨ï¼Œé™æ€æ–¹æ³•å’Œé™æ€çš„ä»£ç å—ä¸­ç»å¯¹ä¸èƒ½å‡ºç° <code>this</code>ï¼Œ<code>this</code> åªå’Œç‰¹å®šçš„å¯¹è±¡å…³è”ï¼Œè€Œä¸å’Œç±»å…³è”ï¼ŒåŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡æœ‰ä¸åŒçš„ <code>this</code>.</p>
<p>å…ˆçœ‹ä¸€ä¸ª Java ç¤ºä¾‹ï¼Œèƒ½è¯´æ˜ä¸Šé¢çš„é—®é¢˜ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// é™æ€ä»£ç å—ä¸­ä¹Ÿä¸å¯ä»¥ä½¿ç”¨ this</span></div><div class="line"><span class="comment">// Error: non-static variable this cannot be referenced from a static context</span></div><div class="line"><span class="keyword">static</span> &#123;</div><div class="line">    <span class="comment">// this.eat();</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"play()"</span>);</div><div class="line"></div><div class="line">    <span class="comment">// this è°ƒç”¨ç±»æ–¹æ³•</span></div><div class="line">    <span class="keyword">this</span>.eat();</div><div class="line"></div><div class="line">    <span class="comment">// this è°ƒç”¨å®ä¾‹æ–¹æ³•</span></div><div class="line">    <span class="keyword">this</span>.finish();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"static eat()"</span>);</div><div class="line"></div><div class="line">    <span class="comment">// ä¸å¯ä»¥åœ¨ç±»æ–¹æ³•ä¸­ä½¿ç”¨ this</span></div><div class="line">    <span class="comment">// Error: non-static variable this cannot be referenced from a static context</span></div><div class="line">    <span class="comment">// this.play();</span></div><div class="line">    <span class="comment">// System.out.println(this);</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">finish</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"finish()"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡å®é™…çš„ Java ä¾‹å­ï¼ŒåŸºæœ¬è¡¨æ˜äº†åœ¨é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ä¸­ <code>this</code> çš„ä½¿ç”¨åœºæ™¯ã€‚</p>
<h2 id="Objective-C-ä¸­çš„-self"><a href="#Objective-C-ä¸­çš„-self" class="headerlink" title="Objective-C ä¸­çš„ self"></a>Objective-C ä¸­çš„ self</h2><p>åœ¨ <code>Objective-C</code> ä¸­ï¼Œ<code>self</code> æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å¯¹è±¡ï¼Œå®ƒæ—¢å¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯ç±»å¯¹è±¡ï¼Œæœ‰ç‚¹ç±»ä¼¼äºä¸Šé¢ Java ä¸­çš„ <code>this</code> å…³é”®å­—ã€‚</p>
<p>ä¸‹é¢ç»“åˆå®é™…ä¾‹å­ï¼Œæ¥è¯´æ˜ <code>self</code> è¿™ä¸ªå…³é”®å­—ã€‚</p>
<h3 id="1ã€å®ä¾‹æ–¹æ³•ä¸­çš„-self"><a href="#1ã€å®ä¾‹æ–¹æ³•ä¸­çš„-self" class="headerlink" title="1ã€å®ä¾‹æ–¹æ³•ä¸­çš„ self"></a>1ã€å®ä¾‹æ–¹æ³•ä¸­çš„ self</h3><p>å®ä¾‹æ–¹æ³•ä¸­çš„ <code>self</code> å¯ä»¥ç›´æ¥è°ƒç”¨å®ä¾‹æ–¹æ³•ä½†ä¸å¯ä»¥ç›´æ¥è°ƒç”¨ç±»æ–¹æ³•ï¼Œå¦‚ä¸‹ç¤ºä¾‹ä¸­ï¼Œè°ƒç”¨å®ä¾‹æ–¹æ³• <code>finish</code>æ²¡æœ‰é—®é¢˜ï¼Œè€Œè°ƒç”¨ç±»æ–¹æ³• <code>eat</code> ç›´æ¥æŠ¥ç¼–è¯‘é”™è¯¯ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)play</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '- (void)play' ------------------"</span>);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"self: %@, self -&gt; %p"</span>, <span class="keyword">self</span>, <span class="keyword">self</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// æ— æ³•ä½¿ç”¨ self æ¥è°ƒç”¨ç±»æ–¹æ³•</span></div><div class="line">    <span class="comment">// Error: No visible @interface for 'MZPerson' declares the selector 'eat'</span></div><div class="line">    <span class="comment">// [self eat];</span></div><div class="line">    </div><div class="line">    <span class="comment">// è°ƒç”¨å®ä¾‹æ–¹æ³•</span></div><div class="line">    [<span class="keyword">self</span> finish];</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)eat</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '+ (void)eat' ------------------"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)finish</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"--------------- '- (void)finish' ----------------"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å®ä¾‹æ–¹æ³•ä¸­å¯ä»¥ç›´æ¥é€šè¿‡<code>`[ç±» ç±»æ–¹æ³•]</code> çš„æ–¹å¼æ¥è°ƒç”¨ç±»æ–¹æ³•ï¼Œé‚£ä¹ˆå¦‚æœæƒ³åœ¨å®ä¾‹æ–¹æ³•ä¸­ä½¿ç”¨ <code>self</code> å…³é”®å­—ï¼Œå¦‚ä½•åŠå‘¢ï¼Ÿ</p>
<p>å¾ˆç®€å•ï¼Œä½¿ç”¨ <code>[self class]</code> å³å¯ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)play</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '- (void)play' ------------------"</span>);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"self: %@, self -&gt; %p"</span>, <span class="keyword">self</span>, <span class="keyword">self</span>);</div><div class="line">    </div><div class="line">    [[<span class="keyword">self</span> <span class="keyword">class</span>] eat];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…³äº <code>class</code> åç»­å†åˆ†äº«ç»™å¤§å®¶ï¼Œè¿™é‡Œåªéœ€è¦çŸ¥é“å¯ä»¥è¿™ä¹ˆä½¿ç”¨å°±å¥½äº†ã€‚</p>
<h3 id="2ã€ç±»æ–¹æ³•ä¸­çš„-self"><a href="#2ã€ç±»æ–¹æ³•ä¸­çš„-self" class="headerlink" title="2ã€ç±»æ–¹æ³•ä¸­çš„ self"></a>2ã€ç±»æ–¹æ³•ä¸­çš„ self</h3><p>è¿™ä¸ªè·Ÿ Java çš„ <code>this</code> æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œä¸Šé¢çš„ Java ç¤ºä¾‹ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ— è®ºæ˜¯æ‰“å° <code>this</code> è¿˜æ˜¯ä½¿ç”¨ <code>this</code> è°ƒç”¨æ–¹æ³•éƒ½ä¸å¯ä»¥ï¼Œä½†æ˜¯åœ¨ <code>Objective-C</code> ä¸­å´å¯ä»¥ä½¿ç”¨ <code>self</code>ï¼Œåªæ˜¯ä¸èƒ½ä½¿ç”¨ <code>self</code> æ¥è°ƒç”¨å®ä¾‹æ–¹æ³•å’Œå®ä¾‹å˜é‡ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)eat</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '+ (void)eat' ------------------"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// No known class method for selector 'finish'</span></div><div class="line">    <span class="comment">// [self finish];</span></div><div class="line">    </div><div class="line">    <span class="comment">// è°ƒç”¨ç±»æ–¹æ³•</span></div><div class="line">    [<span class="keyword">self</span> beat];</div><div class="line">    </div><div class="line">    <span class="comment">// æ‰“å° self</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"self: %@"</span>, <span class="keyword">self</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)beat</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '+ (void)beat' ------------------"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨ç±»æ–¹æ³•ä¸­å¯ä»¥ä½¿ç”¨ <code>self</code> å‘¢ï¼Ÿ</p>
<p>åˆ«ç€æ€¥ï¼Œæ¥ç€å¾€ä¸‹çœ‹ã€‚</p>
<h3 id="3ã€å®ä¾‹å’Œç±»æ–¹æ³•ä¸­çš„-self-åŒºåˆ«"><a href="#3ã€å®ä¾‹å’Œç±»æ–¹æ³•ä¸­çš„-self-åŒºåˆ«" class="headerlink" title="3ã€å®ä¾‹å’Œç±»æ–¹æ³•ä¸­çš„ self åŒºåˆ«"></a>3ã€å®ä¾‹å’Œç±»æ–¹æ³•ä¸­çš„ self åŒºåˆ«</h3><p>å…¶å®ï¼Œåœ¨ç±»æ–¹æ³•ä¸­ï¼Œ<code>self</code> è¡¨ç¤ºå½“å‰ç±»å¯¹è±¡ï¼Œåœ¨å®ä¾‹æ–¹æ³•ä¸­ <code>self</code> è¡¨ç¤ºå®ä¾‹å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¯æœ¬è´¨åŒºåˆ«ï¼ŒåŠ¡å¿…è¦ç†è§£é€å½»ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)play</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '- (void)play' ------------------"</span>);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"self: %@, self -&gt; %p"</span>, <span class="keyword">self</span>, <span class="keyword">self</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// æ‰“å°å¯¹åº”çš„ç±»åœ°å€</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"self class: %p"</span>, [<span class="keyword">self</span> <span class="keyword">class</span>]);</div><div class="line">    </div><div class="line">    [[<span class="keyword">self</span> <span class="keyword">class</span>] eat];</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)eat</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '+ (void)eat' ------------------"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// No known class method for selector 'finish'</span></div><div class="line">    <span class="comment">// [self finish];</span></div><div class="line">    </div><div class="line">    <span class="comment">// æ‰“å° self åœ°å€</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"self: %p"</span>, <span class="keyword">self</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// è°ƒç”¨ç±»æ–¹æ³•</span></div><div class="line">    [<span class="keyword">self</span> beat];</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)beat</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '+ (void)beat' ------------------"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// æ‰“å° self åœ°å€</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"self: %p"</span>, <span class="keyword">self</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨å®ä¾‹æ–¹æ³• <code>play</code> ä¸­æ‰“å°ç±»åœ°å€ï¼Œåœ¨ç±»æ–¹æ³• <code>eat</code> å’Œ <code>beat</code> ä¸­æ‰“å° <code>self</code> çš„åœ°å€ï¼Œè¾“å‡ºç»“æœæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ <code>0x10adb3f98</code> è¿™ä¸ªåœ°å€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">---------------- &apos;- (void)play&apos; ------------------</div><div class="line">self: &lt;MZPerson: 0x6000000d8f90&gt;, self -&gt; 0x6000000d8f90</div><div class="line">self class: 0x10adb3f98</div><div class="line">---------------- &apos;+ (void)eat&apos; ------------------</div><div class="line">self: 0x10adb3f98</div><div class="line">---------------- &apos;+ (void)beat&apos; ------------------</div><div class="line">self: 0x10adb3f98</div></pre></td></tr></table></figure>
<p>ä¸ºäº†æ›´å¥½çš„è¯´æ˜ï¼Œæˆ‘ç»™å¤§å®¶å†ä¸¾ä¸€ä¸ªå½¢è±¡çš„ä¾‹å­å¸®åŠ©å¤§å®¶ç†è§£ã€‚</p>
<p>åœ¨ <code>MZPerson</code> ä¸­å£°æ˜ä¸¤ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•åŒåï¼Œä¸€ä¸ªæ˜¯å®ä¾‹æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯ç±»æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MZPerson</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)play;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)play;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)eat;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)finish;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MZPerson</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)play</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '- (void)play' ------------------"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)play</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '+ (void)play' ------------------"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)eat</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '+ (void)eat' ------------------"</span>);</div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> play];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)finish</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---------------- '- (void)finish' ------------------"</span>);</div><div class="line">    [<span class="keyword">self</span> play];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>åœ¨ç±»æ–¹æ³• <code>eat</code> ä¸­è°ƒç”¨ <code>[self play]</code> åœ¨å®ä¾‹æ–¹æ³• <code>finish</code> ä¸­ä¹Ÿè°ƒç”¨ <code>[self play]</code>ï¼Œé‚£ä¹ˆç»“æœå¦‚ä½•å‘¢ï¼Ÿ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">---------------- &apos;- (void)finish&apos; ---------------</div><div class="line">---------------- &apos;- (void)play&apos; -----------------</div><div class="line"></div><div class="line">---------------- &apos;+ (void)eat&apos; ------------------</div><div class="line">---------------- &apos;+ (void)play&apos; -----------------</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºç¬¦åˆå¦‚æœŸï¼Œç±»å’Œå®ä¾‹æ–¹æ³•ä¸­çš„ self åˆ†åˆ«ä»£è¡¨ç±»æœ¬èº«å’Œå®ä¾‹å¯¹è±¡ã€‚</p>
<p><code>self</code> è¡¨ç¤ºè°ï¼Œåœ¨è¿è¡Œæ—¶æ˜¯ç”±ç¼–è¯‘å™¨æ¥å†³å®šçš„ã€‚</p>
<h3 id="4ã€æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„-self-éƒ½æ˜¯ä¸ä¸€æ ·çš„"><a href="#4ã€æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„-self-éƒ½æ˜¯ä¸ä¸€æ ·çš„" class="headerlink" title="4ã€æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„ self éƒ½æ˜¯ä¸ä¸€æ ·çš„"></a>4ã€æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„ self éƒ½æ˜¯ä¸ä¸€æ ·çš„</h3><p>è¿™ä¸ªè·Ÿ Java çš„ <code>this</code> æ˜¯ä¸€æ ·çš„ï¼Œæ¯ä¸ªç±»çš„å®ä¾‹å¯¹è±¡å¯¹åº”çš„ <code>this</code> éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œ<code>self</code> äº¦å¦‚æ­¤ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­ï¼Œåˆ†åˆ«åˆ›å»ºä¸¤ä¸ª MZPerson å®ä¾‹å¯¹è±¡ï¼Œç„¶ååˆ†åˆ«è°ƒç”¨<code>play</code> æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">MZPerson *iperson1 = [MZPerson new];</div><div class="line">[iperson1 play];</div><div class="line">    </div><div class="line">MZPerson *iperson2 = [MZPerson new];</div><div class="line">[iperson2 play];</div></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœè¡¨æ˜äº†ä¸Šé¢è¯´æ³•çš„æ­£ç¡®æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">---------------- &apos;- (void)play&apos; ------------------</div><div class="line">self: &lt;MZPerson: 0x600000576ee0&gt;, self -&gt; 0x600000576ee0</div><div class="line">---------------- &apos;- (void)play&apos; ------------------</div><div class="line">self: &lt;MZPerson: 0x600000576f40&gt;, self -&gt; 0x600000576f40</div></pre></td></tr></table></figure>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>åœ¨ç»§æ‰¿å…³ç³»ä¸­ï¼Œä½¿ç”¨ <code>self</code> è°ƒç”¨æ–¹æ³•æ—¶ï¼Œé¦–å…ˆä»å½“å‰ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å¼€å§‹å¯»æ‰¾ï¼Œå¦‚æœæ²¡æœ‰å†ä»çˆ¶ç±»ä¸­å¯»æ‰¾ã€‚</p>
<p>è¿è¡Œæ—¶(runtime)ä¼šä½¿ç”¨ <code>objc_msgSend</code> å‘å¯¹è±¡å‘é€æ¶ˆæ¯ï¼Œè¿™ä¸ªä¹Ÿæ˜¯è°ƒç”¨æ–¹æ³•çš„æœ¬è´¨ã€‚</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Objective-C self keyword </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Wireshark: åˆ†æ TCP å››æ¬¡æŒ¥æ‰‹]]></title>
      <url>/2018/12/16/Wireshark-%E5%88%86%E6%9E%90-TCP-%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/</url>
      <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>é¦–å…ˆè¦æ˜ç™½ <code>TCP</code> åè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚</p>
<p>å…¶æ¬¡ï¼Œ<code>TCP</code> æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œéœ€è¦ä¸¤è¾¹çš„è¿æ¥å…¨éƒ¨å…³é—­ï¼Œæ­¤ TCP ä¼šè¯æ‰ç®—å®Œå…¨å…³é—­ï¼Œå››æ¬¡æŒ¥æ‰‹ä½¿å¾— <code>TCP</code> çš„å…¨åŒå·¥è¿æ¥èƒ½å¤Ÿå¯é çš„ç»ˆæ­¢ã€‚</p>
<p>ä¸‹é¢æ ¹æ®å®¢æˆ·ç«¯(IP: 10.4.17.176)è¯·æ±‚æœåŠ¡ç«¯(IP: 116.211.186.208) æ¥åˆ†æå››æ¬¡æŒ¥æ‰‹(four-way handshake)çš„è¿‡ç¨‹ã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œä»»ä½•ä¸€æ–¹æ‰§è¡Œ <code>close()</code> æ“ä½œå³å¯äº§ç”ŸæŒ¥æ‰‹æ“ä½œï¼Œæ‰€ä»¥æ–­å¼€è¿æ¥ç«¯å¯ä»¥æ˜¯ <code>Client</code> ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ <code>Server</code> ç«¯ã€‚</p>
<p>åœ¨é˜…è¯»ä¸‹é¢å†…å®¹ä¹‹å‰ï¼Œæˆ‘å‡è®¾ä½ å·²ç»é˜…è¯»è¿‡ <a href="http://www.veryitman.com/2018/09/09/Wireshark-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-TCP-%E4%B8%89%E6%AC%A1%E6%8C%A5%E6%89%8B/" target="_blank" rel="noopener">Wireshark: ç®€å•åˆ†æ TCP ä¸‰æ¬¡æŒ¥æ‰‹</a> è¿™ç¯‡æ–‡ç« ã€‚</p>
<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ä½¿ç”¨ iOS è®¾å¤‡çš„æµè§ˆå™¨å®¢æˆ·ç«¯ <code>Safari</code> è®¿é—® <code>116.211.186.208</code> è¿™ä¸ªç½‘ç«™ï¼Œå…³äºå¦‚ä½•å¼€å¯ iOS è®¾å¤‡çš„è™šæ‹Ÿç½‘å¡å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/" target="_blank" rel="noopener">åˆè¯† Wireshark</a> è¿™ç¯‡æ–‡ç« ã€‚</p>
<p>é’ˆå¯¹ <code>HTTP</code> çš„è¯·æ±‚ï¼Œå¯ä»¥è¿›è¡Œ <code>Follow</code>ï¼Œé€‰æ‹© <code>TCP Stream</code> å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/12/16/1.jpg" alt=""></p>
<p>æ­¤æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å››æ¬¡æŒ¥æ‰‹çš„æŠ“åŒ…æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/12/16/2.jpg" alt=""><br>å¦å¤–ï¼Œä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œé¦–å…ˆå‘èµ· <code>Close</code> çš„æ˜¯æœåŠ¡ç«¯ã€‚</p>
<p><strong>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹</strong>ï¼Œå‘é€ <code>FIN</code> å’Œ <code>ACK</code> æŠ¥æ–‡ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/12/16/3.jpg" alt=""></p>
<p><strong>ç¬¬äºŒæ¬¡æŒ¥æ‰‹</strong>ï¼Œå®¢æˆ·ç«¯å‘é€ <code>ACK</code> æŠ¥æ–‡ç»™æœåŠ¡ç«¯ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/12/16/4.jpg" alt=""></p>
<p><strong>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹</strong>ï¼Œå®¢æˆ·ç«¯å‘é€ <code>FIN</code> å’Œ <code>ACK</code> æŠ¥æ–‡ç»™æœåŠ¡ç«¯ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/12/16/5.jpg" alt=""></p>
<p><strong>ç¬¬å››æ¬¡æŒ¥æ‰‹</strong>ï¼ŒæœåŠ¡ç«¯å‘é€ <code>ACK</code> æŠ¥æ–‡ç»™å®¢æˆ·ç«¯ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/12/16/6.jpg" alt=""></p>
<p>ä»å›¾ä¸­æŠ“åŒ…æ¥çœ‹ï¼Œ<strong>seq</strong> å’Œ <strong>ack</strong> çš„å€¼å˜åŒ–å¦‚ä¸‹è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>æ¬¡æ•°</th>
<th>seq å€¼</th>
<th>ack å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>140</td>
<td>447</td>
</tr>
<tr>
<td>2</td>
<td>447</td>
<td>141</td>
</tr>
<tr>
<td>3</td>
<td>447</td>
<td>141</td>
</tr>
<tr>
<td>4</td>
<td>141</td>
<td>448</td>
</tr>
</tbody>
</table>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>ç»“åˆä¸Šé¢æŠ“åŒ…çš„ç¤ºä¾‹ï¼Œå°ç»“ä¸€ä¸‹å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ã€‚</p>
<p>åœ¨å‰é¢è¯´è¿‡ï¼Œæ–­å¼€è¿æ¥ç«¯å¯ä»¥æ˜¯ <code>Client</code> ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ <code>Server</code> ç«¯ï¼Œæˆ‘ä¸Šé¢çš„ä¾‹å­é¦–å…ˆå‘èµ· <code>close</code> çš„ä¸€æ–¹æ˜¯ <code>Server</code> ç«¯ã€‚</p>
<p><strong>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š</strong><br>æœåŠ¡ç«¯å‘é€ä¸€ä¸ª <code>[FIN+ACK]</code> æŠ¥æ–‡ï¼Œè¡¨ç¤ºè‡ªå·±æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œæƒ³æ–­å¼€è¿æ¥ï¼Œå¹¶è¿›å…¥ <code>fin_wait_1</code> çŠ¶æ€ï¼ˆä¸èƒ½å†å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯ï¼Œä½†èƒ½å¤Ÿå‘é€æ§åˆ¶ä¿¡æ¯ <code>ACK</code> åˆ°å®¢æˆ·ç«¯ï¼‰ã€‚</p>
<p><strong>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼š</strong><br>å®¢æˆ·ç«¯æ”¶åˆ° <code>[FIN]</code> æŠ¥æ–‡åï¼Œå®¢æˆ·ç«¯çŸ¥é“ä¸ä¼šå†æœ‰æ•°æ®ä»æœåŠ¡ç«¯ä¼ æ¥ï¼Œå‘é€ <code>ACK</code> è¿›è¡Œç¡®è®¤ï¼Œå®¢æˆ·ç«¯è¿›å…¥ <code>close_wait</code> çŠ¶æ€ã€‚æ­¤æ—¶æœåŠ¡ç«¯æ”¶åˆ°äº†å®¢æˆ·ç«¯å¯¹ <code>FIN</code> çš„ <code>ACK</code> åï¼Œè¿›å…¥ <code>fin_wait2</code> çŠ¶æ€ã€‚</p>
<p><strong>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼š</strong><br>å®¢æˆ·ç«¯å‘é€ <code>[FIN ACK]</code> æŠ¥æ–‡ç»™å¯¹æ–¹ï¼Œè¡¨ç¤ºè‡ªå·±æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œå®¢æˆ·ç«¯è¿›å…¥ <code>last_ack</code> çŠ¶æ€ã€‚æœåŠ¡ç«¯æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„ <code>FIN</code> ä¿¡ä»¤åï¼Œè¿›å…¥ <code>time_wait</code> çŠ¶æ€ï¼Œå¹¶å‘é€ <code>ACK</code> ç¡®è®¤æ¶ˆæ¯ã€‚</p>
<p><strong>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼š</strong><br>æœåŠ¡ç«¯åœ¨ <code>time_wait</code> çŠ¶æ€ä¸‹ï¼Œç­‰å¾… 2MSL(MSLæ˜¯æ•°æ®åˆ†èŠ‚åœ¨ç½‘ç»œä¸­å­˜æ´»çš„æœ€é•¿æ—¶é—´) ä¸€æ®µæ—¶é—´ï¼Œæ²¡æœ‰æ•°æ®åˆ°æ¥çš„ï¼Œå°±è®¤ä¸ºå¯¹é¢å·²ç»æ”¶åˆ°äº†è‡ªå·±å‘é€çš„ <code>ACK</code> å¹¶æ­£ç¡®å…³é—­äº†è¿›å…¥ <code>close</code> çŠ¶æ€ï¼Œè‡ªå·±ä¹Ÿæ–­å¼€äº†åˆ°å®¢æˆ·ç«¯çš„ <code>TCP</code> è¿æ¥ï¼Œé‡Šæ”¾æ‰€æœ‰èµ„æºã€‚å½“å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„<code>ACK</code> å›åº”åï¼Œä¼šè¿›å…¥ <code>close</code> çŠ¶æ€ï¼Œå¹¶å…³é—­æœ¬ç«¯çš„ä¼šè¯æ¥å£ï¼Œé‡Šæ”¾ç›¸åº”èµ„æºã€‚</p>
<p>æ ¹æ® wireshark æŠ“åŒ…å’Œä¸Šé¢æµç¨‹çš„åˆ†æï¼Œå¯ä»¥ç”»å‡ºå¦‚ä¸‹ç¤ºæ„æµç¨‹å›¾ï¼š<br><img src="/upload/images/2018/12/16/7.jpg" alt=""></p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Wireshark tcp ip udp http https </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å½“ NTFS é‡ä¸Š MacOS]]></title>
      <url>/2018/11/24/%E5%BD%93-NTFS-%E9%81%87%E4%B8%8A-MacOS/</url>
      <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è‡ªå·±ä½¿ç”¨çš„ <code>MacBook Pro</code> ç”µè„‘æ˜¯ <code>256G</code> çš„ï¼Œè¿™ä¸ªæœ¬é™ªäº†æˆ‘5ä¸ªæ˜¥ç§‹ï¼Œæ€§èƒ½ä¾æ—§å¼ºåŠ²ï¼Œä¸€ç›´èˆä¸å¾—æŠ›å¼ƒæ¢æ–°(å¥½å§ï¼Œæˆ‘æ‰¿è®¤è‡ªå·±ç©·)ã€‚</p>
<p>ç”±äºå·¥ä½œéœ€è¦ï¼Œé‡Œé¢å®‰è£…äº†ä¸å°‘è½¯ä»¶ï¼Œä¹Ÿå­˜å‚¨äº†ä¸å°‘èµ„æ–™ï¼Œé€æ¸å‘ç°ç¡¬ç›˜å®¹é‡ä¸è¶³ï¼Œæˆ‘ä¹Ÿä¸€ç›´åœ¨åˆ é™¤ä¸€äº›éå¿…è¦çš„ä¸œè¥¿ï¼Œå‘ç°è¿˜æ˜¯æ¯æ°´è½¦è–ªï¼Œæ²¡åŠæ³•ï¼Œåˆä¹°äº†ä¸€å—ç§»åŠ¨ç¡¬ç›˜ï¼Œç½‘ç›˜ç”¨èµ·æ¥è¿˜æ˜¯æ²¡æœ‰ç¡¬ç›˜æ–¹ä¾¿ï¼Œæˆ‘ä½¿ç”¨ç½‘ç›˜çš„é¢‘ç‡å¾ˆä½ã€‚</p>
<h2 id="MacOS-æŒ‚è½½"><a href="#MacOS-æŒ‚è½½" class="headerlink" title="MacOS æŒ‚è½½"></a>MacOS æŒ‚è½½</h2><p>æˆ‘è§‰å¾—ç§»åŠ¨ç¡¬ç›˜ä¹°å›æ¥ï¼Œç›´æ¥æ’åœ¨ç”µè„‘ä¸Šå°±å¯ä»¥ä½¿ç”¨äº†ï¼Œæœ€åå‘ç°ç¡¬ç›˜åªèƒ½è¯»ä¸èƒ½å†™ï¼Œå§æ§½ï¼</p>
<p>ä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>NTFS</code> æ ¼å¼çš„ç¡¬ç›˜æ’å…¥åˆ° <code>MacOS</code> é‡Œï¼Œæ˜¯åªèƒ½è¯»ä¸èƒ½å†™çš„ï¼Œéœ€è¦æŒ‚è½½ã€‚</p>
<p>äºæ˜¯ç»“åˆç½‘ä¸Šå‰è¾ˆçš„ç»éªŒï¼Œå¼„äº†ä¸€ä¸ª <code>shell</code> è„šæœ¬ï¼Œç”¨äº†ä¸€æ®µæ—¶é—´ï¼Œå‘ç°æŒºå¥½ç”¨çš„ï¼Œä½†æ˜¯ç”µè„‘é‡å¯åï¼Œè„šæœ¬å°±éœ€è¦ä¿®æ”¹ï¼Œè¿˜è¦æŸ¥æ‰¾å½“å‰ç¡¬ç›˜åˆ°åº•åœ¨ <code>disk0</code> è¿˜æ˜¯åœ¨ <code>disk2</code> ä¸Šé¢ï¼Œéº»çƒ¦ã€‚</p>
<p>è¿˜å¥½æœ‰ä¸€äº›æ¯”è¾ƒæˆç†Ÿçš„å·¥å…·å¸®æˆ‘ä»¬è§£å†³é—®é¢˜ï¼Œ<a href="http://www.ntfsformac.cn/" target="_blank" rel="noopener">Paragon NTFS for MAC</a> å°±æ˜¯å…¶ä¸­ä¸€ä¸ªã€‚</p>
<p><img src="/upload/images/2018/11/24/1.jpg" alt=""></p>
<p>è¿™ä¸ªå·¥å…·æ˜¯æ”¶è´¹çš„ï¼Œæˆ‘è¯•ç”¨äº†ä¸€æ®µæ—¶é—´ï¼Œæ„Ÿè§‰åŠŸèƒ½æŒºå¼ºå¤§çš„ï¼Œå› ä¸ºç©·ä¹Ÿæ‡’å¾—æŠ˜è…¾ç ´è§£ï¼Œå°±æ‰¾äº†å¦å¤–ä¸€ä¸ªå·¥å…· <a href="https://mounty.app/" target="_blank" rel="noopener">mounty</a>ï¼Œå°å·§å¯çˆ±å…³é”®å…è´¹ï¼Œåœ¨å…¬ä¼—å·ä¸Šé¢æ”¶åˆ°çš„èµèµæˆ‘ä¹Ÿä¼š donate ç»™ä»–ä»¬ã€‚</p>
<p><img src="/upload/images/2018/11/24/2.jpg" alt=""></p>
<p><a href="https://mounty.app/" target="_blank" rel="noopener">mounty</a> æœ€æ–°ç‰ˆæœ¬æ˜¯ 1.9ï¼Œä»‹ç»å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">A tiny tool to re-mount write-protected NTFS volumes under Mac OS X 10.9+ in read-write mode.</div></pre></td></tr></table></figure>
<h2 id="mounty-å¤±æ•ˆ"><a href="#mounty-å¤±æ•ˆ" class="headerlink" title="mounty å¤±æ•ˆ"></a>mounty å¤±æ•ˆ</h2><p>åœ¨ä½¿ç”¨ mounty æŒ‚è½½ç§»åŠ¨ç¡¬ç›˜æ—¶, å¼¹æ¡†æç¤ºä»¥ä¸‹é”™è¯¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">The volume My Passport is not re-mountable in read/write mode.</div><div class="line">Probably it was not clean unmounted before.</div></pre></td></tr></table></figure>
<p>è¿™ç§é”™è¯¯çš„åŸå› å¤§éƒ¨åˆ†æ˜¯å› ä¸ºåœ¨ <code>Windows</code> ä¸Šé¢ä½¿ç”¨åæ²¡æœ‰å®‰å…¨é€€å‡º(ç›´æ¥æ‹¨å‡º)è€Œé€ æˆçš„ï¼Œç½‘ä¸Šæœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<p><strong>æ–¹æ¡ˆ 1</strong></p>
<ol>
<li>æ’å…¥ç§»åŠ¨ç¡¬ç›˜åˆ° <code>Windows</code> ä¸‹é¢</li>
<li>æ‰“å¼€ <code>dos</code> å‘½ä»¤è¡Œï¼Œè¾“å…¥ <code>chkdsk /f</code>, ç„¶åå›è½¦ï¼Œè¾“å…¥ <code>Y</code></li>
<li>ä½¿ç”¨å³ä¸‹è§’çš„å®‰å…¨åˆ é™¤åå†æ‹”å‡ºç§»åŠ¨ç¡¬ç›˜</li>
<li>å°†ç§»åŠ¨ç¡¬ç›˜å†æ¬¡æ’å…¥ <code>Mac</code> æ‰“å¼€ <code>mounty</code>é‡æ–°æŒ‚è½½å°±å¯ä»¥äº†</li>
</ol>
<p>åæ­£è¿™ç§æ–¹æ¡ˆæˆ‘æ˜¯æ²¡æœ‰æˆåŠŸï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p>
<p><img src="/upload/images/2018/11/24/3.jpg" alt=""></p>
<p><strong>æ–¹æ¡ˆ 2</strong></p>
<p>åœ¨ <code>Windows</code> ç³»ç»Ÿä¸­ï¼Œå°†ç§»åŠ¨ç¡¬ç›˜æ’å…¥ï¼Œä½¿ç”¨ <code>360è½¯ä»¶</code> ç‚¹å‡» <code>å®‰å…¨é€€å‡º</code> é€€å‡ºç¡¬ç›˜ï¼Œä¸è¦ç›´æ¥æ‹”æ‰ï¼Œå†åœ¨ <code>Mac</code> ä¸­æ’å…¥ä½¿ç”¨ <code>mounty</code> é‡æ–°æŒ‚è½½å°±è§£å†³é—®é¢˜äº†ã€‚</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> MacOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> NTFS MacOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è§‚å¯Ÿè€…æ¨¡å¼]]></title>
      <url>/2018/10/28/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>ç»„ä»¶é—´é€šä¿¡ï¼Œæˆ‘ä¼šä¼˜å…ˆä½¿ç”¨è·¯ç”±çš„é€šä¿¡æ–¹å¼(iOSä¸­éœ€è¦ç”¨åˆ° runtimeï¼ŒAndroid ä¸­éœ€è¦ç”¨åˆ°åå°„å’Œæ³¨è§£)ï¼Œç»„ä»¶ä¹‹é—´æŒ‰ç…§è·¯ç”±åè®®(ç±»ä¼¼ url)å®ç°å„è‡ªçš„èŒè´£å³å¯ï¼Œç»„ä»¶é—´çš„æ¾è€¦åˆæ€§å¢å¼ºäº†è½¯ä»¶è®¾è®¡çš„å¼¹æ€§å’Œé«˜å¯ç”¨æ€§ã€‚</p>
<p>è·¯ç”±ç»“åˆè§‚å¯Ÿè€…æ¨¡å¼ï¼Œå¯ä»¥è®©ä½ çš„ç»„ä»¶è®¾è®¡æ›´ä¸Šä¸€å±‚æ¥¼ã€‚è·¯ç”±å¯ä»¥è§£å†³å•å‘è°ƒç”¨çš„é—®é¢˜ï¼Œè®©ç»„ä»¶ä¹‹é—´æ— éœ€çŸ¥é“å¯¹æ–¹æ˜¯å¦å­˜åœ¨ã€‚è§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥è®©è°ƒç”¨è€…(ä½¿ç”¨ä½ æ¡†æ¶çš„)å¯ä»¥å¾ˆæ–¹ä¾¿çš„çŸ¥é“ç»„ä»¶çš„å†…éƒ¨äº‹ä»¶ã€‚</p>
<blockquote>
<p>æ­¦æ—è‡³å°Šï¼Œå®åˆ€å± é¾™ï¼Œå·ä»¤å¤©ä¸‹ï¼Œè«æ•¢ä¸ä»ï¼Œå€šå¤©ä¸å‡ºï¼Œè°ä¸äº‰é”‹?</p>
</blockquote>
<p>åœ¨è¯´è§‚å¯Ÿè€…æ¨¡å¼ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹ iOS ä¸­çš„ä»£ç†(delegate).</p>
<h2 id="ä»£ç†-delegate"><a href="#ä»£ç†-delegate" class="headerlink" title="ä»£ç† delegate"></a>ä»£ç† delegate</h2><p>åœ¨ iOS ä¸­ï¼Œä»£ç†(delegate)çš„æœ¬è´¨æ˜¯ protocolï¼Œç±»ä¼¼ java ä¸­çš„ Interfaceï¼Œä¸€èˆ¬ç”¨æ¥å¤„ç† <code>ä¸€å¯¹ä¸€</code> çš„å…³ç³»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/upload/images/2018/10/28/1.jpg" alt=""></p>
<p>ä¸‹é¢çš„ä¾‹å­æ¨¡æ‹Ÿäº†è°ƒç”¨å’Œå®ç°è¿‡ç¨‹ï¼Œä½¿ç”¨ <code>Bank</code> å¯¹è±¡å’Œ <code>BankDelegate</code> ä»£ç†æ¥æ¨¡æ‹Ÿè¿™ç§æ¨¡å¼ã€‚<code>Bank</code> æœ‰å˜åŠ¨çš„æ—¶å€™ï¼Œé€šè¿‡ <code>notifyAccount</code> æ¥æˆæƒ <code>onAccountChanged</code> é€šçŸ¥ç”¨æˆ·ã€‚</p>
<p><strong>BankDelegate.h</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">BankDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)onAccountChanged:(<span class="built_in">NSUInteger</span>)account;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p><strong>Bank.h</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Bank</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span>&lt;BankDelegate&gt; delegate;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)notifyAccount;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p><strong>Bank.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Bank</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)notifyAccount</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(onAccountChanged:)]) &#123;</div><div class="line">        [<span class="keyword">self</span>.delegate onAccountChanged:<span class="number">100</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p><strong>ä½¿ç”¨è€…å®ç° delegate</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line"></div><div class="line">    Bank *bank = [Bank new];</div><div class="line">    bank.delegate = <span class="keyword">self</span>;</div><div class="line">    [bank notifyAccount];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)onAccountChanged:(<span class="built_in">NSUInteger</span>)account</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Bank tell me that account is changed. %zd"</span>, account);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œdelegate ä¹Ÿå¯ä»¥åšåˆ° <code>ä¸€å¯¹å¤š</code>ï¼Œæ”¹é€ ä¸€ä¸‹ <code>Bank</code> å°±å¯ä»¥å®ç°ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Bank</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addBankDelegate:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)notifyAccount;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p><code>Bank</code> å†…éƒ¨ä½¿ç”¨æ•°ç»„å°† <code>addBankDelegate</code> å¾—åˆ°çš„ <code>delegate</code> å­˜èµ·æ¥ï¼Œ<code>notifyAccount</code> ä¸­å°±å¯ä»¥è¿›è¡Œé€šçŸ¥äº†ã€‚</p>
<figure class="highlight obj-c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Bank *bank = [Bank new];</div><div class="line"><span class="comment">// æ¨¡æ‹Ÿæ·»åŠ å¤šä¸ª delegate</span></div><div class="line">[bank addBankDelegate:<span class="keyword">self</span>];</div><div class="line">[bank addBankDelegate:<span class="keyword">self</span>];</div><div class="line">[bank notifyAccount];</div></pre></td></tr></table></figure>
<h2 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h2><p>ç†è§£äº† delegateï¼Œè§‚å¯Ÿè€…æ¨¡å¼å°±å¾ˆå¥½ç†è§£äº†ã€‚</p>
<p>å½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–ç€éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œè¿™æ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„å¸¸è§„å®šä¹‰ã€‚</p>
<p>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§ <code>ä¸€å¯¹å¤š</code> çš„è®¾è®¡æ¨¡å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/10/28/2.jpg" alt=""></p>
<p>ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œä½¿ç”¨ <code>Bank</code> å¯¹è±¡å’Œ <code>BankDelegate</code> æ¥æ¨¡æ‹Ÿè¿™ç§æ¨¡å¼ï¼Œ<code>Bank</code> æœ‰å˜åŠ¨çš„æ—¶å€™ï¼Œé€šè¿‡ <code>notifyAccount</code> æ¥æˆæƒ <code>onAccountChanged</code> é€šçŸ¥æ‰€æœ‰æ³¨å†Œäº† <code>BankDelegate</code> çš„ç”¨æˆ·ã€‚</p>
<p><strong>Talk is cheap. Show me the code</strong></p>
<p><strong>BankDelegate.h</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">BankDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)onAccountChanged:(<span class="built_in">NSUInteger</span>)account;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p><strong>Bank.h</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Bank</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addBankObserver:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)removeBankObserver:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)notifyAccount;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p><strong>Bank.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)notifyAccount</div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">id</span>&lt;BankDelegate&gt; delegate <span class="keyword">in</span> <span class="keyword">self</span>.delegates) &#123;</div><div class="line">        <span class="keyword">if</span> ([delegate respondsToSelector:<span class="keyword">@selector</span>(onAccountChanged:)]) &#123;</div><div class="line">            [delegate onAccountChanged:<span class="number">100</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addBankObserver:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == delegate) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    [<span class="keyword">self</span>.delegates addObject:delegate];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)removeBankObserver:(<span class="keyword">id</span>&lt;BankDelegate&gt;)delegate</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.delegates.count &gt; <span class="number">0</span>) &#123;</div><div class="line">        [<span class="keyword">self</span>.delegates removeObject:delegate];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>è°ƒç”¨è€…</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> registerObserver];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)onAccountChanged:(<span class="built_in">NSUInteger</span>)account</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Bank tell me that account is changed. %zd"</span>, account);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)registerObserver</div><div class="line">&#123;</div><div class="line">    Bank *bank = [Bank new];</div><div class="line">    [bank addBankObserver:<span class="keyword">self</span>];</div><div class="line">    [bank addBankObserver:<span class="keyword">self</span>];</div><div class="line">    [bank notifyAccount];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>çœ‹åˆ°è¿™é‡Œï¼Œä½ åº”è¯¥å‘ç° delegate çš„è®¾è®¡å…¶å®å°±æ˜¯è§‚å¯Ÿè€…çš„ä¸€ç§è®¾è®¡æ‰‹æ®µè€Œå·²ï¼Œå®ƒæœ¬èº«ä¹Ÿæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p>
<p>åœ¨ iOS ä¸­ï¼Œé™¤äº† delegateï¼Œè¿˜æœ‰å¾ˆå¤šè¿™ç§è®¾è®¡æ¨¡å¼çš„ä½“ç°ï¼Œå¦‚ KVOã€Notificationã€Observerã€Block ç­‰ã€‚</p>
<h2 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</h2><p>è§‚å¯Ÿè€…æ¨¡å¼ä¸­è§‚å¯Ÿè€…å¯¹è¢«è§‚å¯Ÿè€…(Bank)æ˜¯æœ‰æ„ŸçŸ¥çš„ï¼Œè‡³å°‘éœ€è¦å®ç°å¯¹åº”çš„ <code>BankDelegate</code>ï¼ŒäºŒè€…ä¹‹é—´è¿˜æ˜¯æ˜¯æœ‰ä¸€å®šçš„è€¦åˆåº¦ã€‚</p>
<p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•å†æ¥é™ä½è¿™ç§è€¦åˆï¼Œè®©åŒæ–¹éƒ½ä¸ç”¨å»å…³å¿ƒå¯¹æ–¹çš„å­˜åœ¨å‘¢ï¼Ÿå‘å¸ƒ-è®¢é˜…æ¨¡å¼æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p>
<p>å‘å¸ƒ-è®¢é˜…æœ¬è´¨ä¹Ÿæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä½†æ˜¯ä»–æ›´åŠ çš„æ¾è€¦åˆï¼Œå‘å¸ƒè€…å’Œè®¢é˜…è€…éƒ½ä¸ç”¨æ¸…æ¥šå¯¹æ–¹ï¼Œå…¨éƒ¨ç”±è®¢é˜…ä¸­å¿ƒåšå¤„ç†ï¼Œè¿™æ ·è€¦åˆåº¦å°±å‡ ä¹æ²¡æœ‰äº†ã€‚</p>
<p>å¦‚å›¾å±•ç¤ºå‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼š<br><img src="/upload/images/2018/10/28/3.jpg" alt=""></p>
<p>åœ¨ iOS ä¸­ï¼ŒNotification å°±æ˜¯å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¸€ç§å®ç°ï¼ŒNSNotificationCenter å°±ç±»ä¼¼è®¢é˜…ä¸­å¿ƒã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‘å¸ƒ</span></div><div class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="string">@"name_protocol"</span> object:<span class="literal">nil</span>];</div><div class="line"></div><div class="line"><span class="comment">// è®¢é˜…</span></div><div class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span></div><div class="line">                                         selector:<span class="keyword">@selector</span>(onUpdate:)</div><div class="line">                                             name:<span class="string">@"name_protocol"</span></div><div class="line">                                           object:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h2 id="äº‰è®º"><a href="#äº‰è®º" class="headerlink" title="äº‰è®º"></a>äº‰è®º</h2><p>ç½‘ä¸Šæœ‰å¾ˆå¤šäººè¯´ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼æ˜¯ä¸¤ç§ä¸åŒçš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒä»¬å‹æ ¹å°±æ˜¯ä¸¤ç äº‹ï¼Œä¸èƒ½æ··ä¸ºä¸€è°ˆã€‚ä¹Ÿæœ‰å¾ˆå¤šäººè¯´ï¼Œä¸¤è€…å…¶å®éƒ½æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œåªæ˜¯å®ç°æ‰‹æ®µæœ‰ç‚¹ä¸ä¸€æ ·ç½¢äº†ï¼Œæœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æ±Ÿæ¹–çº·äº‰ï¼Œä¼—è¯´çº·çº­ï¼</p>
<p>è®¾è®¡æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œåœ¨è§‚å¯Ÿè€…æ¨¡å¼åŸºç¡€ä¸Šä½ å¯ä»¥è¡ç”Ÿæ›´å¤šçš„è®¾è®¡æ¨¡å¼å’Œæ›´å¤šçš„è®¾è®¡æ€æƒ³ã€‚æ¨¡å¼çš„å®ç°æ‰‹æ®µå¯ä»¥å¤šæ ·åŒ–ï¼Œæ²¡æœ‰æœ€å¥½åªæœ‰æ›´å¥½ï¼Œå°±å¥½æ¯” MVCã€MVPã€MVVM ç­‰ï¼Œä½ è¯´å®ƒä»¬æ˜¯è®¾è®¡æ¨¡å¼ä¹Ÿå¥½ï¼Œæ˜¯è®¾è®¡æ€è·¯ä¹Ÿç½¢ï¼Œå…³é”®æ˜¯åˆ©ç”¨å®ƒä»¬æœ‰æ²¡æœ‰è§£å†³ä¸šåŠ¡éœ€æ±‚ï¼Œä¸ºäº†æ¨¡å¼è€Œæ¨¡å¼çš„è®¾è®¡åè€Œä¸å®ï¼</p>
<p>ä¸ªäººè§‰å¾—ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼åªæ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸€ç§å®ç°æ‰‹æ®µï¼Œå®ƒæœ¬è´¨è¿˜æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Philosophy </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æ¶æ„ æ¨¡å—åŒ– ç»„ä»¶åŒ– Observer </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[macOS ä¸­ç¥ç§˜çš„ GCC]]></title>
      <url>/2018/10/13/macOS-%E4%B8%AD%E7%A5%9E%E7%A7%98%E7%9A%84-GCC/</url>
      <content type="html"><![CDATA[<p>è¿™ä¸ªäº‹æƒ…è¦ä»ç¼–è¯‘ä¸€ä¸ªç®€å•çš„ä»£ç å¼€å§‹è¯´èµ·ã€‚</p>
<hr>
<h2 id="gcc-å’Œ-g-çš„åŒºåˆ«"><a href="#gcc-å’Œ-g-çš„åŒºåˆ«" class="headerlink" title="gcc å’Œ g++ çš„åŒºåˆ«"></a>gcc å’Œ g++ çš„åŒºåˆ«</h2><p><code>gcc</code> æ˜¯ GCC ä¸­çš„ GUN C Compilerï¼ŒC ç¼–è¯‘å™¨ã€‚</p>
<p><code>g++</code> æ˜¯ GCC ä¸­çš„ GUN C++ Compilerï¼ŒC++ç¼–è¯‘å™¨ã€‚</p>
<p>å°±æœ¬è´¨è€Œè¨€ï¼Œ<code>gcc</code> å’Œ <code>g++</code> å¹¶ä¸æ˜¯ç¼–è¯‘å™¨ï¼Œä¹Ÿä¸æ˜¯ç¼–è¯‘å™¨çš„é›†åˆï¼Œå®ƒä»¬åªæ˜¯ä¸€ç§é©±åŠ¨å™¨ï¼Œæ ¹æ®å‚æ•°ä¸­è¦ç¼–è¯‘çš„æ–‡ä»¶çš„ç±»å‹ï¼Œè°ƒç”¨å¯¹åº”çš„ GUN ç¼–è¯‘å™¨è€Œå·²ã€‚</p>
<p><code>gcc</code> ä¸ <code>g++</code> éƒ½å¯ä»¥ç¼–è¯‘ C å’Œ C++ æ–‡ä»¶ï¼Œåªæ˜¯å¤„ç†æ–¹å¼ä¸åŒã€‚ å¯ä»¥å‚è€ƒ <a href="https://www.cnblogs.com/wb118115/p/5969775.html" target="_blank" rel="noopener">GCCçš„gccå’Œg++åŒºåˆ«</a> è¿™ç¯‡æ–‡ç« ã€‚</p>
<h2 id="äº¤æ¢å˜é‡-æŒ‡é’ˆ"><a href="#äº¤æ¢å˜é‡-æŒ‡é’ˆ" class="headerlink" title="äº¤æ¢å˜é‡-æŒ‡é’ˆ"></a>äº¤æ¢å˜é‡-æŒ‡é’ˆ</h2><p>ä¸‹é¢è¿™æ®µä»£ç å¾ˆç®€å•ï¼Œåˆ©ç”¨ C æŒ‡é’ˆå®ç°äº¤æ¢ä¸¤ä¸ªå˜é‡çš„ç›®çš„ã€‚</p>
<p><strong>æºæ–‡ä»¶ï¼šmz_swap.c</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">// ä½¿ç”¨æŒ‡é’ˆçš„æ–¹å¼äº¤æ¢ä¸¤ä¸ªå˜é‡</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mz_swap</span><span class="params">(<span class="keyword">int</span> *ap, <span class="keyword">int</span> *bp)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> xp = <span class="number">901</span>;</div><div class="line">    <span class="keyword">int</span> yp = <span class="number">902</span>;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"--Before-- xp = %i, yp = %i\n"</span>, xp, yp);</div><div class="line">    </div><div class="line">    mz_swap(&amp;xp, &amp;yp);</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"--After--- xp = %i, yp = %i\n"</span>, xp, yp);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mz_swap</span><span class="params">(<span class="keyword">int</span> *ap, <span class="keyword">int</span> *bp)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == ap || <span class="literal">NULL</span> == bp) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> tp = *ap;</div><div class="line"></div><div class="line">    *ap = *bp;</div><div class="line"></div><div class="line">    *bp = tp;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ macOS ä¸‹ä½¿ç”¨ <code>gcc</code> ç¼–è¯‘ <code>mz_swap.c</code>ï¼Œäº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ <code>exec_main.out</code>ï¼Œå¦‚ä¸‹æ“ä½œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc mz_swap.c -o exec_main.out</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘æˆåŠŸï¼Œæ‰§è¡Œ <code>./exec_main.out</code>ï¼Œæ­£å¸¸è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">--Before-- xp = <span class="number">901</span>, yp = <span class="number">902</span></div><div class="line">--After--- xp = <span class="number">902</span>, yp = <span class="number">901</span></div></pre></td></tr></table></figure>
<p>é‡‡ç”¨ g++ æ¥ç¼–è¯‘ï¼Œå¦‚ä¸‹æ“ä½œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">g++ mz_swap.c -o exec_main.out</div></pre></td></tr></table></figure>
<p>æŠ¥å‡ºå¦‚ä¸‹è­¦å‘Šï¼Œè¯¥è­¦å‘Šçš„æ„æ€æ˜¯åœ¨ C++ æ¨¡å¼ä¸‹å¼ºåˆ¶ç¼–è¯‘ C æ–‡ä»¶ï¼Œè¿™é‡Œå¯ä»¥ä¸äºˆç†ä¼šã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">clang: warning: treating 'c' input as 'c++' when in C++ mode, this behavior is deprecated [-Wdeprecated]</div></pre></td></tr></table></figure>
<p>è™½ç„¶æœ‰è­¦å‘Šï¼Œä½†æ˜¯ç¼–è¯‘å¯ä»¥äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ <code>exec_main.out</code> ä¸”å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ï¼Œæ‰§è¡Œç»“æœè·Ÿä¸Šé¢ä¸€æ ·ã€‚</p>
<h2 id="äº¤æ¢å˜é‡-å¼•ç”¨"><a href="#äº¤æ¢å˜é‡-å¼•ç”¨" class="headerlink" title="äº¤æ¢å˜é‡-å¼•ç”¨"></a>äº¤æ¢å˜é‡-å¼•ç”¨</h2><p>å¤§å®¶éƒ½çŸ¥é“ï¼ŒC æ²¡æœ‰ <code>å¼•ç”¨</code> è¿™ä¸ªæ¦‚å¿µï¼Œè€Œ C++ æ˜¯æœ‰ <code>å¼•ç”¨</code> æ¦‚å¿µçš„ï¼Œå¯ä»¥åœ¨æ­¤äº†è§£ <a href="http://www.runoob.com/cplusplus/cpp-references.html" target="_blank" rel="noopener">C++ å¼•ç”¨</a>.</p>
<p>è¯•ä¸€ä¸‹ä½¿ç”¨ <code>gcc</code> ç¼–è¯‘ä½¿ç”¨ <code>å¼•ç”¨</code> æ–¹å¼ç¼–å†™çš„ C ä»£ç ï¼ŒæŒ‰ç…§è¯´æ³•ï¼Œ<code>gcc</code> æ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ã€‚</p>
<p><strong>æºæ–‡ä»¶ï¼šmz_swap_ref.c</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">// ä½¿ç”¨å¼•ç”¨çš„æ–¹å¼äº¤æ¢ä¸¤ä¸ªå˜é‡</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mz_swap_ref</span><span class="params">(<span class="keyword">int</span> &amp;ap, <span class="keyword">int</span> &amp;bp)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> xp = <span class="number">901</span>;</div><div class="line">    <span class="keyword">int</span> yp = <span class="number">902</span>;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"--Before-- xp = %i, yp = %i\n"</span>, xp, yp);</div><div class="line"></div><div class="line">    mz_swap_ref(xp, yp);</div><div class="line">    </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"--After--- xp = %i, yp = %i\n"</span>, xp, yp);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mz_swap_ref</span><span class="params">(<span class="keyword">int</span> &amp;ap, <span class="keyword">int</span> &amp;bp)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> tp = ap;</div><div class="line"></div><div class="line">    ap = bp;</div><div class="line"></div><div class="line">    bp = tp;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc mz_swap_ref.c -o exec_main.out</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mz_swap_ref.c:<span class="number">4</span>:<span class="number">21</span>: error: expected <span class="string">')'</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mz_swap_ref</span><span class="params">(<span class="keyword">int</span> &amp;ap, <span class="keyword">int</span> &amp;bp)</span></span>;</div><div class="line">                    ^</div><div class="line">mz_swap_ref.c:<span class="number">4</span>:<span class="number">16</span>: note: to match <span class="keyword">this</span> <span class="string">'('</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mz_swap_ref</span><span class="params">(<span class="keyword">int</span> &amp;ap, <span class="keyword">int</span> &amp;bp)</span></span>;</div></pre></td></tr></table></figure>
<p>æ—¢ç„¶æŒ‰ç…§ C çš„ç¼–è¯‘æ–¹å¼ä¸è¡Œï¼Œé‚£å°±æ¢æˆ <code>g++</code> æ¥ç¼–è¯‘ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">g++ mz_swap_ref.c -o exec_main.out</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘æˆåŠŸï¼Œæ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./exec_main.out</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">--Before-- xp = 901, yp = 902</div><div class="line">--After--- xp = 902, yp = 901</div></pre></td></tr></table></figure>
<p>å¤§å®¶å¯ä»¥è‡ªå·±åŠ¨æ‰‹è¯•è¯•ï¼Œä½¿ç”¨ clang æ¥ç¼–è¯‘ <code>mz_swap_ref.c</code> å’Œä½¿ç”¨ <code>gcc</code> æ¥ç¼–è¯‘éƒ½æ˜¯æŠ¥é”™ï¼Œä½¿ç”¨ <code>clang++</code> å’Œ <code>g++</code> ç¼–è¯‘éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p>
<p>åœ¨åšå®¢ <a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/" target="_blank" rel="noopener">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a> ä¸­ï¼Œæˆ‘å·²ç»åˆ†äº«äº†åœ¨ macOS ä¸­çš„ <code>gcc</code> å’Œ <code>g++</code> ä¸æ˜¯ GNU æä¾›çš„ï¼Œè€Œæ˜¯ Apple è‡ªå·±çš„ clangã€‚</p>
<p>è¿™é‡Œè¦è¯´æ˜çš„æ˜¯å³ä½¿ä½¿ç”¨è‡ªå·±å®‰è£…çš„ gcc(<code>gcc-4.9</code>) æ¥ç¼–è¯‘ <code>mz_swap_ref.c</code> ä¹Ÿæ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ï¼ŒéªŒè¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc-4.9 mz_swap_ref.c -o exec_main.out</div></pre></td></tr></table></figure>
<p>é”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mz_swap_ref.c:4:21: error: expected &apos;;&apos;, &apos;,&apos; or &apos;)&apos; before &apos;&amp;&apos; token</div><div class="line"> int mz_swap_ref(int &amp;ap, int &amp;bp);</div><div class="line">                     ^</div><div class="line">mz_swap_ref.c:20:21: error: expected &apos;;&apos;, &apos;,&apos; or &apos;)&apos; before &apos;&amp;&apos; token</div><div class="line"> int mz_swap_ref(int &amp;ap, int &amp;bp) &#123;              ^</div></pre></td></tr></table></figure>
<h2 id="gccã€g-å’Œ-clang-çš„å…³ç³»"><a href="#gccã€g-å’Œ-clang-çš„å…³ç³»" class="headerlink" title="gccã€g++ å’Œ clang çš„å…³ç³»"></a>gccã€g++ å’Œ clang çš„å…³ç³»</h2><p>åœ¨ macOS ä¸­ï¼Œ<code>gcc</code> ä»¥æŸç§æ–¹å¼æŒ‡å‘ <code>llvm-gcc</code> ç¼–è¯‘å™¨ï¼Œ<code>g++</code> äº¦å¦‚æ­¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">In Apple&apos;s version of GCC, both cc and gcc are actually symbolic links to the llvm-gcc compiler. Similarly, c++ and g++ are links to llvm-g++.</div></pre></td></tr></table></figure>
<p><code>llvm-gcc</code> æ˜¯ c/c++/oc çš„ç¼–è¯‘å™¨ï¼Œç”¨äº† <code>gcc</code> å‰ç«¯å’Œå‘½ä»¤è¡Œç•Œé¢çš„ llvm.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">llvm-gcc is a C, C++, Objective-C and Objective-C++ compiler. llvm-g++ is a compiler driver for C++. llvm-gcc uses gcc front-end and gcc&apos;s command line interface.</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ <code>llvm-gcc</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>which llvm-gcc</code> çœ‹ä¸€ä¸‹ <code>llvm-gcc</code> æ‰€åœ¨ä½ç½®æ˜¯ <code>/usr/bin/llvm-gcc</code>ï¼Œæ‰“å¼€ç›®å½•å¯ä»¥çœ‹å‡ºå…¶å®æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/10/13/1.jpg" alt="1"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ls -l /usr/bin/llvm-gcc</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/llvm-gcc -&gt; clang</div></pre></td></tr></table></figure>
<p>å®ƒä»¬æ˜¯ç»Ÿä¸€æŒ‡å‘ <code>clang</code> çš„ç¬¦å·é“¾æ¥ï¼Œå¯ä»¥çœ‹å…¶åŸå§‹æŒ‡å‘ï¼Œ<code>llvm-gcc</code> æŒ‡å‘ <code>clang</code>ï¼Œ<code>llvm-g++</code> æŒ‡å‘ <code>clang++</code>ã€‚</p>
<p>äºŒè€…éƒ½åœ¨ <code>/usr/bin/</code> ç›®å½•ä¸‹ï¼š<br><img src="/upload/images/2018/10/13/2.jpg" alt="1"></p>
<p>å…¶å®åœ¨ macOS ä¸­ <code>cc</code> ç¼–è¯‘å™¨ä¹ŸæŒ‡å‘ <code>clang</code>ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬è‡³å°‘å¯ä»¥å­¦åˆ°å¦‚ä¸‹å‡ ç‚¹çŸ¥è¯†ï¼š</p>
<p><strong>1. C è¯­è¨€è§„èŒƒä¸­æ²¡æœ‰ <code>å¼•ç”¨</code> çš„æ¦‚å¿µï¼Œä½¿ç”¨ C ç¼–è¯‘å™¨æ— æ³•ä½¿å…¶ç¼–è¯‘é€šè¿‡ï¼Œä½†æ˜¯ä½¿ç”¨ C++ ç¼–è¯‘å™¨æ˜¯å¯ä»¥ç¼–è¯‘é€šè¿‡çš„ã€‚è¿™æ˜¯å› ä¸ºå„è‡ªçš„ç¼–è¯‘å™¨æ˜¯éµå¾ªè¯­è¨€è§„èŒƒçš„ã€‚</strong></p>
<p><strong>2. macOS ä¸­çš„ <code>gcc</code> å’Œ <code>g++</code> è‹¹æœå¼€å‘è€…ä»¬å¹¶æ²¡æœ‰å»æ”¹é€ å’Œé‡å†™å®ƒä»¬ï¼Œåªæ˜¯åˆ†åˆ«æŒ‡å‘ <code>clang</code> å’Œ <code>clang++</code> ç¼–è¯‘å™¨ã€‚</strong></p>
<p><strong>3. å¦‚æœä¸æƒ³ä½¿ç”¨ macOS ä¸­çš„ <code>gcc</code> å’Œ <code>g++</code>ï¼Œå°±éœ€è¦è‡ªå·±é‡æ–°å®‰è£… GNU çš„ï¼Œå®‰è£…å’Œä½¿ç”¨æ–¹æ³•å·²ç»åœ¨åšå®¢ä¸­æœ‰è¯´æ˜ã€‚</strong></p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> C/C++ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> gcc g++ clang clang++ cc </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[SVN æ£€å‡ºæ–‡ä»¶]]></title>
      <url>/2018/10/06/SVN-%E6%A3%80%E5%87%BA%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>å¯¹äºä¸€äº›å¤§å·¥ç¨‹, æ•´ä¸ª svn ä»“åº“æ–‡ä»¶è¿‡å¤§(åŠ¨è¾„å‡ åä¸ªGçš„éƒ½æœ‰)ï¼Œä¸æƒ³æŠŠæ•´ä¸ª checkout ä¸‹æ¥ï¼Œä½†æ˜¯åˆæƒ³ç»´æŒæ•´ä¸ªç›®å½•ç»“æ„ä»¥æ–¹ä¾¿åç»­ä½¿ç”¨ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <code>Subversion1.5</code> ä¹‹åçš„ <code>--depth</code> å‚æ•°æ¥åª checkout éœ€è¦çš„å­ç›®å½•.</p>
<p>å¦‚æœåªæƒ³æŠŠ svn ä»“åº“é‡Œé¢æŸä¸ªæ–‡ä»¶ checkout åˆ°æœ¬åœ°, ä¸æƒ³ checkout æ•´ä¸ªç›®å½•, å¦‚ä½•æ“ä½œå‘¢?</p>
<h2 id="å®æ–½"><a href="#å®æ–½" class="headerlink" title="å®æ–½"></a>å®æ–½</h2><p>å‡è®¾éœ€è¦ checkout å‡ºæ¥çš„æ–‡ä»¶æ˜¯ <code>ReadMe.md</code>, å…¶ svn åœ°å€æ˜¯: <code>http://svn.xxx.com/path/ReadMe.md</code>ï¼Œå…¶ä¸Šçº§ç›®å½•çš„è¿œç¨‹åœ°å€æ˜¯ <code>http://svn.xxx.com/path</code>.</p>
<p><strong>æ³¨æ„</strong>ï¼šä»¥ä¸‹å‡ºç° <code>svn co</code> å°±æ˜¯ <code>svn checkout</code> çš„ç¼©å†™.</p>
<h3 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h3><p>å¤§éƒ¨åˆ†äººéƒ½ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æƒ³åˆ°å¦‚ä¸‹çš„æ“ä½œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svn co http://svn.xxx.com/path/ReadMe.md</div></pre></td></tr></table></figure>
<p>å®é™…ä¸Šè¿™æ ·æ“ä½œä¼šæŠ¥é”™çš„, æŠ¥é”™ä¿¡æ¯å¤§æ¦‚æ„æ€æ˜¯ <code>ä¸å¯ä»¥ checkout ä¸€ä¸ªæ–‡ä»¶, åªèƒ½ checkout ç›®å½•</code>ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¯¥æ–¹æ¡ˆä¸å¯è¡Œã€‚</p>
<h3 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h3><p><strong>ç¬¬ä¸€æ­¥: checkout ç›®å½•</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svn co --depth=empty http://svn.xxx.com/path/ ./</div></pre></td></tr></table></figure>
<blockquote>
<p><code>./</code> è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ<code>--depth=empty</code> è¡¨ç¤ºæ£€å‡ºç©ºç›®å½•ã€‚</p>
</blockquote>
<p><strong>ç¬¬äºŒæ­¥: æ›´æ–°æ–‡ä»¶</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svn up ReadMe.md</div></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œç›´æ¥ svn up å°±å¯ä»¥å°†ä½ éœ€è¦çš„æ–‡ä»¶ checkout å‡ºæ¥äº†ã€‚</p>
</blockquote>
<p>ä¿®æ”¹æ–‡ä»¶å, ä¹Ÿå¯ä»¥ç›´æ¥æäº¤åˆ° svn ä»“åº“. ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svn ci ReadMe.md -m &quot;update.&quot;</div></pre></td></tr></table></figure>
<h3 id="æ–¹æ¡ˆä¸‰"><a href="#æ–¹æ¡ˆä¸‰" class="headerlink" title="æ–¹æ¡ˆä¸‰"></a>æ–¹æ¡ˆä¸‰</h3><p>ä½¿ç”¨ <code>svn export</code> å‘½ä»¤å°†æ–‡ä»¶å¯¼å‡ºï¼Œç„¶åå°† <code>svn import</code> å‘½ä»¤å¯¼å…¥æ–‡ä»¶åˆ° svn ä»“åº“ã€‚</p>
<p>ä¸€èˆ¬ä¸´æ—¶æƒ³ checkout ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šä½¿ç”¨ <code>æ–¹æ¡ˆä¸‰</code>, æ¯”è¾ƒæ­£å¼çš„æ“ä½œï¼Œæˆ‘ä¼šé€‰æ‹© <code>æ–¹æ¡ˆäºŒ</code>ï¼Œå› ä¸º <code>æ–¹æ¡ˆäºŒ</code> è¿™æ ·æ—¢å¯åœ¨ä¸å¢åŠ ç£ç›˜å¤§å°çš„æƒ…å†µä¸‹ä¿æŒ svn ä»“åº“çš„ç›®å½•ç»“æ„ï¼Œåˆå¯ä»¥ä»»æ„ checkout æ–‡ä»¶ã€‚</p>
<h2 id="ç¨€ç–ç›®å½•"><a href="#ç¨€ç–ç›®å½•" class="headerlink" title="ç¨€ç–ç›®å½•"></a>ç¨€ç–ç›®å½•</h2><p>ä¸Šé¢çš„ <code>æ–¹æ¡ˆäºŒ</code>ï¼Œå…¶å®å°±æ˜¯ svn çš„ä¸€ç§ç¨€ç–æ£€å‡ºçš„æ“ä½œã€‚</p>
<blockquote>
<p>Subversion 1.5 å¼€å§‹æ”¯æŒç¨€ç–æ£€å‡ºï¼Œå…è®¸å¯¹ç›®å½•è®¾ç½®æ·±åº¦ï¼ˆdepthï¼‰ã€‚</p>
</blockquote>
<p><strong>å…³äº depth å‡ ä¸ªå‚æ•°çš„å«ä¹‰</strong>:</p>
<p>â€“depth emptyï¼šåªåŒ…å«ç›®å½•è‡ªèº«ï¼Œä¸åŒ…å«ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶å’Œå­ç›®å½•ã€‚</p>
<p>â€“depth filesï¼šåŒ…å«ç›®å½•å’Œç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¸åŒ…å«å­ç›®å½•ã€‚</p>
<p>â€“depth immediatesï¼šåŒ…å«ç›®å½•å’Œç›®å½•ä¸‹çš„æ–‡ä»¶åŠå­ç›®å½•ã€‚ä½†ä¸å¯¹å­ç›®å½•é€’å½’ã€‚</p>
<p>â€“depth infinityï¼šè¿™æ˜¯é»˜è®¤çš„ï¼ŒåŒ…å«æ•´ä¸ªç›®å½•æ ‘ã€‚</p>
<p>ä½¿ç”¨æ ¼å¼å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svn checkout URL --depth empty|files|immediates|infinity</div></pre></td></tr></table></figure>
<p>æˆ–è€… </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svn checkout URL --depth=empty|files|immediates|infinity</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> svn depth ç¨€ç–ç›®å½• </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Cocoapods: ç§æœ‰ä»“åº“]]></title>
      <url>/2018/09/24/Cocoapods-%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/</url>
      <content type="html"><![CDATA[<h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>åœ¨æˆ‘ä¹‹å‰çš„åšå®¢ä¸­åˆ†äº«äº†å‡ ç¯‡å…³äº Cocoapods çš„æ–‡ç« ï¼ˆæ–‡æœ«æœ‰é“¾æ¥ï¼‰ï¼Œä»Šå¤©åˆ†äº«å¦å¤–ä¸€ä¸ªä¸»é¢˜å³å¦‚ä½•åˆ›å»ºä½ è‡ªå·±çš„ç§æœ‰ä»“åº“ä»¥åŠå¦‚ä½•ä½¿ç”¨ç§æœ‰ä»“åº“ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§éœ€æ±‚å‘¢ï¼Ÿ</p>
<p>å¼€å‘ç»„å†…æˆ–è€…å…¬å¸å†…ï¼Œä¸å¸Œæœ›æŠŠä¸€äº›æ ¸å¿ƒçš„å…¬ç”¨ä»£ç ç»™åˆ°å¤–ç•Œä½¿ç”¨ï¼ˆä¸å¼€æºï¼‰ï¼Œä½†æ˜¯è¿™äº›ä»£ç åŸºæœ¬å¾ˆç¨³å®šå¾ˆæˆç†Ÿï¼Œå¯ä»¥åšæˆç»„ä»¶ç»™åˆ°å…¶ä»–äººæˆ–è€…ç»„å†…ä½¿ç”¨ã€‚</p>
<p>é‚£ä¹ˆï¼Œå°±å¯ä»¥ä½¿ç”¨ Cocoapods æ¥åˆ›å»ºè‡ªå·±çš„ç§æœ‰ä»“åº“ï¼Œè®©å¤§å®¶å…±äº«ä»£ç ï¼Œä¹Ÿæ˜¯ç»„ä»¶åŒ–çš„ä¸€ç§æ–¹æ¡ˆã€‚</p>
<p>ä¸‹é¢çš„åˆ†äº«å…¨æ˜¯åŸºäºå®è·µæ‰€å¾—ï¼Œä¸­é—´ä¹Ÿé‡åˆ°å¾ˆå¤šå‘ï¼Œéƒ½è¢«æˆ‘ä¸€ä¸€è§£å†³äº†ï¼Œå¸Œæœ›èƒ½å¸®åˆ°æ­£åœ¨é˜…è¯»æ–‡ç« çš„ä½ ã€‚</p>
<h2 id="åˆ›å»ºä»“åº“"><a href="#åˆ›å»ºä»“åº“" class="headerlink" title="åˆ›å»ºä»“åº“"></a>åˆ›å»ºä»“åº“</h2><p>è¿™é‡Œçš„åˆ›å»ºä»“åº“ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªä»“åº“ï¼Œä¸€ä¸ªæ˜¯ä»£ç ä»“åº“ï¼Œå¦ä¸€ä¸ªæ˜¯ pod æºçš„ä»“åº“ã€‚</p>
<p>åœ¨ <a href="https://github.com/" target="_blank" rel="noopener">Github</a> åˆ›å»º repositoryï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/09/24/1.jpg" alt="1"></p>
<p><img src="/upload/images/2018/09/24/2.jpg" alt="1"></p>
<p>åˆ›å»ºåä¸º <code>iOS_private_lib</code> çš„ repositoryï¼Œè¿™ä¸ªä¸»è¦ç”¨æ¥å­˜æ”¾æˆ‘ä»¬çš„ä»£ç ã€‚</p>
<p>åŒæ ·é“ç†ï¼Œåˆ›å»ºä¸€ä¸ª Repo ç”¨äºå­˜æ”¾ç§æœ‰çš„ SpecRepo æºï¼Œæˆ‘åˆ›å»ºçš„æ˜¯ <code>https://github.com/veryitman/private_spec_repo.git</code> è¿™ä¸ªä»“åº“ã€‚</p>
<p>ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº† <code>Public</code> æ¥æ¨¡æ‹Ÿ <code>Private</code> ä»“åº“ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨å…¬å¸è‡ªå·±æ­å»ºçš„ç§æœ‰ git æœåŠ¡å™¨æ¥åšï¼Œæˆ‘è¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†è¯´æ˜é—®é¢˜ã€‚</p>
<h2 id="åˆ›å»ºä»£ç å·¥ç¨‹"><a href="#åˆ›å»ºä»£ç å·¥ç¨‹" class="headerlink" title="åˆ›å»ºä»£ç å·¥ç¨‹"></a>åˆ›å»ºä»£ç å·¥ç¨‹</h2><p><strong>1. å…ˆ clone åˆšæ‰åˆ›å»ºçš„ repo åˆ°æœ¬åœ°</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace/</div><div class="line"></div><div class="line">git clone https://github.com/veryitman/iOS_private_lib</div></pre></td></tr></table></figure>
<p><strong>2. åˆ›å»ºå·¥ç¨‹</strong></p>
<p>åœ¨ <code>~/workspace/iOS_private_lib</code> ä¸‹ä½¿ç”¨ <code>pod lib create</code> åˆ›å»ºå·¥ç¨‹ï¼Œå·¥ç¨‹åå­—ä¸º <code>CoreHTTP</code>ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace/iOS_private_lib</div><div class="line"></div><div class="line">pod lib create CoreHTTP</div></pre></td></tr></table></figure>
<p>æ ¹æ®æç¤ºè¾“å…¥å¯¹åº”çš„ä¿¡æ¯å³å¯å®Œæˆåˆ›å»ºï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/09/24/3.jpg" alt="1"></p>
<p>åˆ›å»ºæˆåŠŸåï¼ŒåŒ…å«ä¸€ä¸ª <strong>Example</strong> ä¾‹å­å·¥ç¨‹ï¼Œå·¥ç¨‹ç›®å½•å¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/24/4.jpg" alt="1"></p>
<p>ä½¿ç”¨ Xcode æ‰“å¼€ä¾‹å­å·¥ç¨‹ï¼Œåœ¨ <code>CoreHTTP/Classes</code> ä¸­åˆ›å»ºæ–‡ä»¶å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/24/5.jpg" alt="1"></p>
<p><strong>3. ç¼–è¾‘ podspec æ–‡ä»¶</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Pod::Spec.new do |s|</div><div class="line">  s.name             = &apos;CoreHTTP&apos;</div><div class="line">  s.version          = &apos;0.1.0&apos;</div><div class="line">  s.summary          = &apos;CoreHTTP for create private pod, it is a demo only.&apos;</div><div class="line">  s.description      = &lt;&lt;-DESC</div><div class="line">                       The project of CoreHTTP is a private pod, it is a demo only.</div><div class="line">                       DESC</div><div class="line"></div><div class="line">  s.homepage         = &apos;https://github.com/veryitman/iOS_private_lib.git&apos;</div><div class="line">  s.license          = &#123; :type =&gt; &apos;MIT&apos;, :file =&gt; &apos;LICENSE&apos; &#125;</div><div class="line">  s.author           = &#123; &apos;veryitman@126.com&apos; =&gt; &apos;veryitman@126.com&apos; &#125;</div><div class="line">  s.platform         = :ios, &quot;7.0&quot;</div><div class="line">  s.source           = &#123; :git =&gt; &apos;https://github.com/veryitman/iOS_private_lib.git&apos;, :tag =&gt; s.version.to_s &#125;</div><div class="line"></div><div class="line">  s.ios.deployment_target = &apos;8.0&apos;</div><div class="line"></div><div class="line">  s.source_files = &apos;CoreHTTP/Classes/**/*&apos;</div><div class="line">  s.requires_arc = true</div><div class="line">end</div></pre></td></tr></table></figure>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœ <code>s.source_files</code> å†™çš„ä¸å¯¹ï¼Œä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- ERROR | [iOS] file patterns: The `source_files` pattern did not match any file.</div></pre></td></tr></table></figure>
<p><code>CoreHTTP</code> çš„åå­—å¿…é¡»æ˜¯ä½ ä»£ç å­˜æ”¾çš„æ–‡ä»¶å¤¹åï¼Œè€Œä¸”è¿™ä¸ªæ–‡ä»¶ä»¶è¦ä¸ <code>podspec</code> æ–‡ä»¶åœ¨åŒä¸€çº§æ–‡ä»¶ç›®å½•ä¸‹ï¼Œä»ä¸Šé¢æˆªå›¾çš„ç›®å½•ç»“æ„å¯ä»¥çœ‹å‡ºã€‚</p>
<p>å¦å¤–ä¸€ä¸ªæç¤ºçš„é”™è¯¯ç‚¹ï¼Œå¯èƒ½æ˜¯å› ä¸ºç©ºç›®å½•çš„é—®é¢˜é€ æˆçš„ï¼Œå¦‚æœè¿™æ ·çš„è¯ï¼Œå¯ä»¥åœ¨å„ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»º <code>.gitkeep</code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„ä½œç”¨æ˜¯ä¸ºäº†æäº¤ç©ºæ–‡ä»¶å¤¹ï¼Œå› ä¸º git é»˜è®¤æ˜¯ä¸ä¼šæ·»åŠ ç©ºæ–‡ä»¶å¤¹åˆ°ä»“åº“çš„ã€‚</p>
<p>åˆ›å»º <code>.gitkeep</code> æ–‡ä»¶çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd æ–‡ä»¶å¤¹ä¸‹</div><div class="line"></div><div class="line">touch .gitkeep</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘æŠ˜è…¾äº†è›®ä¹…ï¼Œæœ€åæ€è€ƒå’Œå‚è€ƒäº†è‡ªå·±ä¹‹å‰çš„å¼€æºé¡¹ç›®ç®¡ç†åšå®¢ï¼Œæ‰è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p><strong>4. æ£€æŸ¥å’ŒéªŒè¯æœ¬åœ° podspec æ–‡ä»¶</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd CoreHTTP </div><div class="line"></div><div class="line">pod lib lint CoreHTTP.podspec</div></pre></td></tr></table></figure>
<p>éªŒè¯é€šè¿‡ä¼šæ˜¾ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤ºçš„æˆåŠŸæç¤º<br><img src="/upload/images/2018/09/24/6.jpg" alt="1"></p>
<p>ä½¿ç”¨ Xcode æ‰“å¼€å·¥ç¨‹ï¼Œåˆ é™¤å¯¹åº”ä»¥ <code>Testå¼€å¤´</code> çš„ç›¸å…³çš„åº“å’Œæ–‡ä»¶å¤¹ï¼Œç¡®ä¿ Xcode èƒ½ç¼–è¯‘é€šè¿‡ï¼Œé€‰æ‹©æ¨¡æ‹Ÿå™¨å³å¯ã€‚</p>
<p><strong>è¿™é‡Œä¸€å®šè¦å…ˆæ¸…ç©º cocoapods çš„ç¼“å­˜ï¼Œå¦åˆ™åé¢è¿œç¨‹éªŒè¯è¿˜æ˜¯æŠ¥é”™ï¼Œæ— æ³•é€šè¿‡éªŒè¯ã€‚</strong></p>
<p>æ¸…ç©º cocoapods çš„ç¼“å­˜ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rm ~/Library/Caches/CocoaPods/Pods/External/CoreHTTP</div><div class="line"></div><div class="line">rm ~/Library/Caches/CocoaPods/Pods/Specs/External/CoreHTTP</div></pre></td></tr></table></figure>
<p><strong>5. ä¸Šä¼ å·¥ç¨‹åˆ° Github è¿œç¨‹ä»£ç ä»“åº“</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace/iOS_private_lib</div><div class="line"></div><div class="line">git add CoreHTTP/</div><div class="line"></div><div class="line">git commit -m "Add lib."</div><div class="line"></div><div class="line">git push</div></pre></td></tr></table></figure>
<p><strong>6. ç»™ç‰ˆæœ¬æ·»åŠ  tag</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace/iOS_private_lib</div><div class="line"></div><div class="line">git tag 0.1.0 -m "Add lib and example project."</div><div class="line"></div><div class="line">git push --tags</div></pre></td></tr></table></figure>
<p><strong>7. è¿›è¡Œè¿œç¨‹éªŒè¯</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace/iOS_private_lib</div><div class="line"></div><div class="line">pod spec lint CoreHTTP/CoreHTTP.podspec --verbose --use-libraries --allow-warnings</div></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ï¼š</strong><code>--verbose</code> é€‰é¡¹æ˜¯ä¸ºäº†çœ‹ç¼–è¯‘å’ŒéªŒè¯ä¿¡æ¯ï¼Œ<code>--use-libraries</code> æ˜¯ä¸ºäº†èƒ½æ”¯æŒ i386 æ¶æ„ï¼Œå¦‚æœä¸åŠ æ­¤å‚æ•°ï¼Œç§æœ‰åº“æ— æ³•é€šè¿‡éªŒè¯ï¼Œ<code>--allow-warnings</code> å‚æ•°æ˜¯å…è®¸æœ‰è­¦å‘Šã€‚</p>
<p>éªŒè¯æˆåŠŸçš„ç¤ºæ„å›¾ï¼š<br><img src="/upload/images/2018/09/24/7.jpg" alt="1"></p>
<h2 id="æäº¤ç§æœ‰-podspec"><a href="#æäº¤ç§æœ‰-podspec" class="headerlink" title="æäº¤ç§æœ‰ podspec"></a>æäº¤ç§æœ‰ podspec</h2><p><strong>1. å‘æœ¬åœ°çš„ cocoapods ä»“åº“æ·»åŠ ç§æœ‰ Spec Repo</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace/iOS_private_lib</div><div class="line"></div><div class="line">pod repo add PrivateSpec https://github.com/veryitman/private_spec_repo.git</div></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸€å®šè¦æ³¨æ„ï¼šå¯¹åº”çš„åœ°å€æ˜¯ SpecRepo ä»“åº“åœ°å€è€Œä¸æ˜¯ä»£ç ä»“åº“åœ°å€ã€‚</p>
<p>æœ¬åœ°å­˜æ”¾ spec çš„ç§æœ‰ä»“åº“åç§°ï¼Œæˆ‘è¿™é‡Œå–åä¸º <code>PrivateSpec</code>ï¼Œä½ ä¹Ÿå¯ä»¥å–å…¶ä»–åå­—ï¼Œä½†æ˜¯è®°ä½åœ¨ä¸‹é¢çš„æ­¥éª¤ä¸­è¦ä¿æŒä¸€è‡´ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ls -alt ~/.cocoapods/repos/</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸæ·»åŠ æœ¬åœ° repo ä¸­ï¼Œå…¶ä»– master æ˜¯ cocoapods å®˜æ–¹å…¬å¼€çš„æºï¼Œå…¶ä»–ä¸ºç§æœ‰æºã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/24/8.jpg" alt="1"></p>
<p><strong>2. å‘ç§æœ‰çš„ Spec Repo ä¸­æäº¤ podspec</strong></p>
<p>ä¸‹é¢çš„ <code>PrivateSpec</code> æ˜¯ä¸ä¸Šé¢çš„åç§°å¯¹åº”çš„ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace/iOS_private_lib</div><div class="line"></div><div class="line">pod repo push PrivateSpec ./CoreHTTP/CoreHTTP.podspec --verbose --use-libraries --allow-warnings</div></pre></td></tr></table></figure>
<p>è¿™é‡Œè¦æ³¨æ„ï¼Œæ·»åŠ ç§æœ‰åº“å’Œä¹‹å‰åšæ–‡ <a href="http://www.veryitman.com/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/" target="_blank" rel="noopener">Cocoapods ç®¡ç†å¼€æºé¡¹ç›®</a> ä¸­æåˆ°çš„ <code>pod trunk push</code> æ˜¯ä¸ä¸€æ ·çš„æ“ä½œã€‚</p>
<h2 id="ä½¿ç”¨ç§æœ‰åº“"><a href="#ä½¿ç”¨ç§æœ‰åº“" class="headerlink" title="ä½¿ç”¨ç§æœ‰åº“"></a>ä½¿ç”¨ç§æœ‰åº“</h2><p><strong>1. æœç´¢åº“</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod search CoreHTTP</div></pre></td></tr></table></figure>
<p>å¦‚æœæœç´¢ä¸åˆ°ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„ä¸¤æ¡å‘½ä»¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rm ~/Library/Caches/CocoaPods/search_index.json</div><div class="line"></div><div class="line">pod setup</div></pre></td></tr></table></figure>
<p>ç„¶åç»§ç»­æœç´¢å°±å¯ä»¥äº†ï¼Œæœç´¢æˆåŠŸä¼šæ˜¾ç¤ºå¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">CoreHTTP (0.1.0)</div><div class="line">   CoreHTTP for create private pod, it is a demo only.</div><div class="line">   pod &apos;CoreHTTP&apos;, &apos;~&gt; 0.1.0&apos;</div><div class="line">   - Homepage: https://github.com/veryitman/iOS_private_lib.git</div><div class="line">   - Source:   https://github.com/veryitman/iOS_private_lib.git</div><div class="line">   - Versions: 0.1.0 [PrivateSpec repo]</div></pre></td></tr></table></figure>
<p>ä¸ºäº†é¿å…å’Œå…¶ä»–ç§æœ‰åº“å‘½åå†²çªï¼Œå»ºè®®åœ¨è‡ªå·±çš„ç§æœ‰åº“å‰é¢åŠ ä¸Šå…¬å¸æˆ–è€…å…¶ä»–æ ‡ç¤ºï¼Œå¦‚ TepdCoreHTTPã€FphCoreHTTP ç­‰ã€‚</p>
<p><strong>2. åœ¨ Podfile æ–‡ä»¶çš„é¡¶éƒ¨æ·»åŠ  source</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">source &apos;https://github.com/veryitman/private_spec_repo.git&apos;</div><div class="line">source &apos;https://github.com/CocoaPods/Specs.git&apos;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸€ä¸ªæ˜¯æˆ‘ä»¬ç§æœ‰ SpecRepo åœ°å€ï¼ˆéç§æœ‰ä»£ç åº“åœ°å€ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯å®˜æ–¹å…¬æœ‰æºåœ°å€ã€‚</p>
<p>ä½¿ç”¨ç§æœ‰åº“çš„å·¥ç¨‹çš„ Podfile å†™æ³•ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">source &apos;https://github.com/veryitman/private_spec_repo.git&apos;</div><div class="line">source &apos;https://github.com/CocoaPods/Specs.git&apos;</div><div class="line"></div><div class="line">platform :ios, &apos;7.0&apos;</div><div class="line"></div><div class="line">target &apos;TestCoreHTTP&apos; do</div><div class="line">    pod &apos;CoreHTTP&apos;, &apos;~&gt; 0.1.0&apos;</div><div class="line">end</div></pre></td></tr></table></figure>
<p>åœ¨å·¥ç¨‹ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ç§æœ‰åº“äº†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">#import &quot;ViewController.h&quot;</div><div class="line">#import &lt;CoreHTTPHeader.h&gt;</div><div class="line"></div><div class="line">@interface ViewController ()</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation ViewController</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [super viewDidLoad];</div><div class="line">    NSString *lib_desc = [CoreHTTPHeader libDesc];</div><div class="line">    NSLog(@&quot;The HTTP&apos;s library desc: %@&quot;, lib_desc);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<h2 id="pod-å‘½ä»¤"><a href="#pod-å‘½ä»¤" class="headerlink" title="pod å‘½ä»¤"></a>pod å‘½ä»¤</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//å°†å·¥ç¨‹æ·»åŠ åˆ°æœ¬åœ° repo ä¸­ </div><div class="line">pod repo add [æœ¬åœ°ç§æœ‰ä»“åº“å] [è¿œç¨‹ä»“åº“åœ°å€]</div><div class="line"></div><div class="line">//ç§»é™¤æœ¬åœ° repo</div><div class="line">pod repo remove [æœ¬åœ°ç§æœ‰ä»“åº“å]</div><div class="line"></div><div class="line">//æŸ¥çœ‹æœ¬åœ° repo</div><div class="line">pod repo</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//åªä»æœ¬åœ°éªŒè¯ä½ çš„podèƒ½å¦é€šè¿‡éªŒè¯</div><div class="line">pod lib lint *.podspec</div><div class="line"></div><div class="line">//ä»æœ¬åœ°å’Œè¿œç¨‹éªŒè¯ä½ çš„podèƒ½å¦é€šè¿‡éªŒè¯</div><div class="line">pod spec lint *.podspec</div></pre></td></tr></table></figure>
<h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://guides.cocoapods.org/making/private-cocoapods.html" target="_blank" rel="noopener">Private Pods</a></p>
<h2 id="æˆ‘çš„å…¶ä»–æ–‡ç« "><a href="#æˆ‘çš„å…¶ä»–æ–‡ç« " class="headerlink" title="æˆ‘çš„å…¶ä»–æ–‡ç« "></a>æˆ‘çš„å…¶ä»–æ–‡ç« </h2><p><a href="http://www.veryitman.com/2016/11/08/Mac-install-Cocoapods/" target="_blank" rel="noopener">Mac install Cocoapods</a></p>
<p><a href="http://www.veryitman.com/2016/11/08/Cocoapods-%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6/" target="_blank" rel="noopener">Cocoapods é—®é¢˜é›†é”¦</a></p>
<p><a href="http://www.veryitman.com/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/" target="_blank" rel="noopener">Cocoapods ç®¡ç†å¼€æºé¡¹ç›®</a></p>
<p><a href="http://www.veryitman.com/2016/09/25/iOS-%E9%A1%B9%E7%9B%AE-%E6%89%93%E9%80%A0%E6%9C%AC%E5%9C%B0-pod-%E5%BA%93/" target="_blank" rel="noopener">iOS é¡¹ç›®: æ‰“é€ æœ¬åœ° pod åº“</a></p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS cocoapods </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æµ…è°ˆå®¢æˆ·ç«¯æ¨¡å—åŒ–]]></title>
      <url>/2018/09/23/%E6%B5%85%E8%B0%88%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
      <content type="html"><![CDATA[<h2 id="å›å¿†"><a href="#å›å¿†" class="headerlink" title="å›å¿†"></a>å›å¿†</h2><p>å¤§å­¦é‚£ä¼šå–œæ¬¢è·Ÿç€è€å¸ˆåœ¨å®éªŒå®¤æŠ˜è…¾ï¼Œæ„Ÿè§‰æ¯å¤©å¤§è„‘ä¸­éƒ½æœ‰æ–°çŸ¥è¯†é±¼è´¯è€Œå…¥ã€‚</p>
<p>å½“æˆ‘è¢«å‘ŠçŸ¥è¦åšä¸€ä¸ªæœ€å°å•ç‰‡æœºç³»ç»Ÿçš„æ—¶å€™ï¼Œå…´å¥‹è€Œåˆç´§å¼ ï¼</p>
<p>æœ€å°å•ç‰‡æœºç³»ç»Ÿç¤ºæ„å›¾ï¼š<br><img src="/upload/images/2018/09/23/1.jpg" alt=""></p>
<p>ä»ç”» <a href="https://baike.baidu.com/item/PCB/146397?fr=aladdin" target="_blank" rel="noopener">PCB</a> åˆ°åˆ¶æ¿ã€æ´—æ¿ï¼Œå†åˆ°é€‰æ‹©å…ƒå™¨ä»¶ï¼Œæœ€åç»„è£…è°ƒè¯•å’Œå†™ä»£ç ï¼Œæˆ‘èŠ±è´¹äº†ä¸¤ä¸ªå¤šæœˆçš„æ—¶é—´ï¼Œå½“æ¿å­ä¸Šé¢çš„è·‘é©¬ç¯äº®èµ·æ¥çš„é‚£ä¸€åˆ»ï¼Œæˆ‘æ¿€åŠ¨çš„æ— æ³•è¨€è¯­ã€‚</p>
<p>å¤§å®¶å¯ä»¥çœ‹åˆ°è¿™ä¸ªæœ€å°å•ç‰‡æœºç³»ç»Ÿä¸Šé¢æœ‰å¾ˆå¤šç»„ä»¶ç»„æˆï¼Œæœ‰ç”µé˜»ã€ç”µå®¹ã€ç”µé˜»ã€äºŒæç®¡å’Œå¡æ§½ç­‰ï¼Œå½“ç„¶è¿˜æœ‰æœ€æ ¸å¿ƒçš„ç»„ä»¶å°±æ˜¯å•ç‰‡æœºï¼Œå½“æ—¶ç”¨çš„æ˜¯51å•ç‰‡æœºã€‚</p>
<p>å„ä¸ªå…ƒå™¨ä»¶å°±å¥½æ¯”ç»„ä»¶ï¼ŒåŠŸèƒ½å•ä¸€ï¼ŒèŒè´£æ˜æ˜¾ï¼Œç»„ä»¶ä¹‹é—´éµå¾ªåè®®æ„æˆæ¨¡å—ï¼Œæœ€ç»ˆç»„åˆæˆä¸ºï¼ˆæœ€å°å•ç‰‡æœºï¼‰ç³»ç»Ÿã€‚</p>
<p>ä¸Šé¢çš„å›å¿†æ˜¯ä¸ºäº†å¼•å‡ºä»Šå¤©çš„åˆ†äº«ï¼Œåˆ†äº«çš„ä¸»è¦å†…å®¹æ˜¯å®¢æˆ·ç«¯å¼€å‘ä¸­å¸¸ç”¨çš„<strong>æ¨¡å—åŒ–</strong>ã€<strong>ç»„ä»¶åŒ–</strong>ã€<strong>æ’ä»¶åŒ–</strong>ä»¥åŠ<strong>çƒ­æ›´æ–°</strong>ç­‰æŠ€æœ¯è¾è—»ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠåˆ°å…·ä½“çš„æŠ€æœ¯é—®é¢˜ã€‚</p>
<h2 id="æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–"><a href="#æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–" class="headerlink" title="æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–"></a>æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–</h2><p>ä»ç¨‹åºè®¾è®¡çš„è§’åº¦å‡ºå‘ï¼Œæ— è®ºæ˜¯æ¨¡å—åŒ–è¿˜æ˜¯ç»„ä»¶åŒ–ï¼Œéƒ½æ˜¯æŒ‡è½¯ä»¶æ¶æ„çš„èŒƒç•´ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ã€‚ä¸¤è€…å¹¶æ²¡æœ‰ä¸¥æ ¼æ„ä¹‰ä¸Šé¢çš„åŒºåˆ†ï¼ŒäºŒè€…çš„ç›®çš„ä¸€è‡´ï¼Œå°±æ˜¯å°†å·¥ç¨‹ç»“æ„åŒ–ï¼Œè¾¾åˆ°å¯å¤ç”¨å¯ä¼¸ç¼©çš„èƒ½åŠ›ï¼Œæœ€ç»ˆæä¾›å·¥ä½œæ•ˆç‡ã€‚</p>
<p>åœ¨è¯´æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–ä¹‹å‰ï¼Œå…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯é«˜å†…èšä½è€¦åˆã€‚</p>
<p>é«˜å†…èšï¼šç»„ä»¶å†…å°½å¯èƒ½ç‹¬ç«‹å®Œæˆè‡ªå·±çš„åŠŸèƒ½ï¼ŒåšæŒå•ä¸€èŒè´£çš„åŸåˆ™ <a href="https://baike.baidu.com/item/%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/9456515" target="_blank" rel="noopener">SRP</a>ï¼Œä¸ä¾èµ–äºå…¶ä»–ç»„ä»¶çš„ä»£ç ã€‚</p>
<p>ä½è€¦åˆï¼šæ¨¡å—ä¸æ¨¡å—ä¹‹é—´å°½é‡ä¸è¦äº’ç›¸å¼•ç”¨ï¼Œæ¨¡å—ä¹‹é—´è”ç³»è¶Šå¤æ‚è€¦åˆåº¦è¶Šé«˜ï¼Œä¿®æ”¹çš„æˆæœ¬å°±è¶Šé«˜ã€‚</p>
<p><strong>ç»„ä»¶</strong>æ›´åŠ å¼ºè°ƒå¯æ›¿æ¢å¯å¤ç”¨çš„ç‰¹æ€§ï¼ŒèŒè´£å’ŒåŠŸèƒ½æ¯”è¾ƒå•ä¸€ã€ç‹¬ç«‹ï¼Œä¸å…¶ä»–ç»„ä»¶ä¹‹é—´æ²¡æœ‰è€¦åˆæ€§ã€‚</p>
<p><strong>æ¨¡å—</strong>æ›´åŠ å¼ºè°ƒç»„åˆç‰¹æ€§ï¼Œæ›´åŠ åé‡äºä¸šåŠ¡ï¼Œæ¯”å¦‚ä¸€ä¸ªç¤¾åŒºé¡¹ç›®ï¼Œç™»å½•æ³¨å†Œã€è®ºå›å’Œä¸ªäººä¸­å¿ƒéƒ½æ˜¯æ¨¡å—ï¼Œè¿™äº›ä¸šåŠ¡æ¨¡å—åˆæ˜¯æœ‰å¾ˆå¤šä¸ªç»„ä»¶ç»„åˆè€Œæˆã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºçš„æ˜¯ä¸€ä¸ªç®€æ˜“çš„è®ºå›ç³»ç»Ÿç¤ºä¾‹å›¾ï¼Œå¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/23/2.jpg" alt=""></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œå„ä¸ªç»„ä»¶å¯ä»¥å•ç‹¬ä½¿ç”¨åˆ°å…¶ä»–æ¨¡å—å½“ä¸­ï¼Œå„ä¸ªæ¨¡å—ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹ï¼Œåªè¦å®šä¹‰å¥½æ¨¡å—ä¹‹é—´çš„é€šä¿¡åè®®ï¼Œå°±å¯ä»¥åšåˆ°å¹¶è¡Œå¼€å‘ï¼Œå„ä¸ªæ¨¡å—ç”šè‡³å¯ä»¥å¤ç”¨åˆ°å…¶ä»–ç³»ç»Ÿä¹‹ä¸­ã€‚</p>
<h2 id="é€šä¿¡æœºåˆ¶"><a href="#é€šä¿¡æœºåˆ¶" class="headerlink" title="é€šä¿¡æœºåˆ¶"></a>é€šä¿¡æœºåˆ¶</h2><p>è¿™é‡Œè¯´çš„é€šä¿¡æœºåˆ¶å¹¶ä¸æ˜¯æŒ‡ HTTP æˆ– TCP çš„é€šä¿¡æ–¹å¼ï¼Œè€Œæ˜¯æŒ‡ç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´ï¼Œæ¨¡å—å’Œæ¨¡å—ä¹‹é—´çš„äº¤äº’æ–¹å¼ã€‚</p>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå†™ä¸šåŠ¡åŠŸèƒ½çš„ä»£ç ï¼Œåœ¨ä¸åŒç»„ä»¶ä¹‹é—´éœ€è¦ç›¸äº’è°ƒç”¨ï¼Œè¿™æ ·å°±éœ€è¦ <strong>import</strong> å…¶ä»–ç»„ä»¶ï¼Œæ— å½¢ä¹‹ä¸­å°±å¢åŠ äº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ã€‚</p>
<p>æœ‰å¼€å‘ç»éªŒçš„åŒå­¦ï¼Œå¯èƒ½ä¼šç”¨åˆ°ç±»ä¼¼ java çš„åå°„æœºåˆ¶ï¼Œæˆ–è€…ä¸€äº›åŠ¨æ€è¯­è¨€çš„è¿è¡Œæ—¶æœºåˆ¶å¦‚ Objective-C Runtimeï¼Œå¯¹å®ƒä»¬ä¸è¿›è¡Œ <strong>import</strong>ï¼Œè€Œæ˜¯åŠ¨æ€çš„è§£æä»£ç ï¼Œè¾¾åˆ°ç»„ä»¶ä¹‹é—´æˆ–è€…æ˜¯ç±»ä¹‹é—´ç›¸äº’è°ƒç”¨çš„ç›®çš„ã€‚</p>
<p>ç°åœ¨æå€¡ä¹Ÿæ˜¯æ¯”è¾ƒçƒ­é—¨çš„æŠ€æœ¯æ˜¯é€šè¿‡<strong>è·¯ç”±</strong>é€šä¿¡æœºåˆ¶ï¼Œæ¥è¿›è¡Œç»„ä»¶ä¹‹é—´çš„é€šä¿¡ã€‚è¿™é‡Œä¸¾ä¸€ä¸ªå®é™…ä½¿ç”¨åœºæ™¯ã€‚</p>
<p>ç”¨æˆ·å®‰è£…äº†æˆ‘ä»¬çš„ APPï¼Œè¿è¥åŒäº‹åœ¨æŸä¸ªèŠ‚æ—¥æ¥ä¸´ä¹‹é™…åšä¸€ä¸ªä¿ƒæ´»è·ƒçš„æ´»åŠ¨ï¼ŒæœŸæœ›ç”¨æˆ·ç‚¹åœ¨æ‰“å¼€æ¨é€é€šçŸ¥çš„æ—¶å€™ï¼Œæ‰“å¼€ APP åå¯ä»¥ç›´æ¥è·³è½¬åˆ°å¯¹åº”çš„æ´»åŠ¨è¯¦æƒ…é¡µé¢ã€‚å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/23/3.jpg" alt=""></p>
<p>è¿™æ˜¯ä¸€ä¸ªå†å¸¸è§„ä¸è¿‡çš„éœ€æ±‚äº†ï¼Œç›¸ä¿¡ç»å†è¿‡äº§å“å¼€å‘çš„æœ‹å‹éƒ½è§è¿‡è¿™ç§éœ€æ±‚ã€‚</p>
<p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>è·¯ç”±</strong>çš„é€šä¿¡æœºåˆ¶æ¥å®Œæˆè¿™ä¸ªéœ€æ±‚ï¼Œå¼€å‘çš„æµç¨‹å›¾å¤§è‡´å¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/23/4.jpg" alt=""></p>
<p>è¿™é‡Œå…³é”®çš„æ ¸å¿ƒå¾—ç›Šäº iOS å’Œ Android å¹³å°çš„ <strong>scheme</strong> æœºåˆ¶ï¼Œå¯¹äº <strong>scheme</strong>ï¼Œé€šä¿—çš„è®²å°±æ˜¯ä¸€ç§å¯ä»¥è·¨è¿›ç¨‹æˆ–è€…è¿›ç¨‹å†…çš„é€šä¿¡åè®®ï¼Œä¾‹å¦‚å¯ä»¥åœ¨ APP ä¸­æ‰“å¼€æŸä¸ªåº”ç”¨å•†åº—ã€‚</p>
<p>ä¾‹å¦‚ä¸‹é¢çš„ URLï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bbs://page/activity/activity_detail?id=8978&amp;user_id=67890432</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>bbs</code> å°±æ˜¯ <strong>scheme</strong>ï¼Œå¯ä»¥çœ‹åˆ°è¯¥ URL å®Œå…¨å¯ä»¥è¢«å„è‡ªå¹³å°æ¥è§£æã€‚</p>
<p>iOS å’Œ Android å¹³å°å„æœ‰å¾ˆå¤šå¼€æºçš„è·¯ç”±æ–¹æ¡ˆï¼Œå®ç°æ‰‹æ³•å„æœ‰å·®å¼‚ï¼Œä½†æ˜¯æ€æƒ³æ˜¯ä¸€æ ·çš„ï¼Œå»ºè®®å¤§å®¶å»äº†è§£å’Œå­¦ä¹ ã€‚</p>
<p>ä¸è¿‡ï¼Œç°åœ¨ä½ åªè¦çŸ¥é“ï¼Œè·¯ç”±çš„é€šä¿¡æœºåˆ¶å¤§å¤§é™ä½äº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆæ€§å°±å¤Ÿäº†ã€‚</p>
<h2 id="æ’ä»¶åŒ–"><a href="#æ’ä»¶åŒ–" class="headerlink" title="æ’ä»¶åŒ–"></a>æ’ä»¶åŒ–</h2><p><strong>æ’ä»¶</strong>è¿™ä¸ªè¯ï¼Œå¤§å®¶åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œä¾‹å¦‚ Chrome æµè§ˆå™¨ä¸­å¯ä»¥å®‰è£…å„ç§å°å·¥å…·ï¼Œè¿™äº›å°å·¥å…·å°±æ˜¯æ’ä»¶ï¼Œè¿˜æœ‰å„ç§å¼€å‘ä½¿ç”¨çš„ IDE ä¹Ÿæ”¯æŒæ’ä»¶å®‰è£…ï¼Œä¾¿äºæé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚Chrome å’Œ IDE è¢«ç§°ä¹‹ä¸ºå®¿ä¸»ï¼Œæ’ä»¶å¯„ç”Ÿäºä»–ä»¬ã€‚</p>
<p>æ”¯ä»˜å®å’Œå¾®ä¿¡é‡Œé¢çš„å°ç¨‹åºä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªä¸ªæ’ä»¶ï¼Œä½†æ˜¯ä»–ä»¬ä¸èƒ½è„±ç¦»æ”¯ä»˜å®å’Œå¾®ä¿¡ç‹¬ç«‹è¿è¡Œã€‚</p>
<p>å¯ä»¥å‘ç°è¿™äº›æ’ä»¶å³ä½¿è¢«å¸è½½æˆ–è€…è¢«åˆ é™¤ï¼Œå¹¶ä¸ä¼šè®© Chrome æˆ–è€… IDE å—åˆ°å½±å“ï¼Œæ¢å¥è¯è¯´ï¼Œæ’ä»¶è®©å®¿ä¸»é”¦ä¸Šæ·»èŠ±ã€‚ </p>
<p>è¿™ç§æ’ä»¶æ€æƒ³å½“ç„¶å¯ä»¥è¿ç”¨åˆ° APP ä¸­æ¥ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæŸä¸ª APP åœ¨çº¿ä¸Šç»è¿‡åŠ¨æ€ä¸‹è½½å°±å…·æœ‰äº†ä¸€ä¸ªå¼ºå¤§æˆ–è€…å¥½ç”¨çš„åŠŸèƒ½ï¼Œå²‚ä¸ç¾å“‰ï¼Ÿï¼</p>
<p><strong>æ’ä»¶åŒ–</strong>ï¼Œå°† APP æ‹†åˆ†æˆå¾ˆå¤šæ¨¡å—ï¼Œè¿™äº›æ¨¡å—åŒ…æ‹¬ä¸€ä¸ªå®¿ä¸»å’Œå¤šä¸ªæ’ä»¶ï¼Œå®¿ä¸»æä¾›æ’ä»¶çš„ç®¡ç†å’Œé€šä¿¡åè®®åŠè§„èŒƒï¼Œæ¯ä¸ªæ¨¡å—éƒ½æ˜¯ä¸€ä¸ªçš„åº“æˆ–è€…åŠŸèƒ½åŒ…ã€‚</p>
<p><strong>æ’ä»¶åŒ–</strong>æ˜¯ä¸€ç§ç¼–ç¨‹å’Œè§£å†³é—®é¢˜çš„æ€æƒ³ï¼Œæ²¡æœ‰ç»Ÿä¸€çš„å®šä¹‰ã€‚åœ¨ Android ä¸Šé¢è¿ç”¨æ¯”è¾ƒå¤šï¼ŒiOS ä¸Šé¢å¾ˆå°‘ï¼Œå¹¶ä¸æ˜¯ iOS æ²¡æœ‰è¿™æ ·çš„æŠ€æœ¯ï¼Œä¸»è¦æ˜¯å› ä¸ºè‹¹æœå®¡æ ¸ç­‰å„æ–¹é¢çš„é™åˆ¶ã€‚åœ¨ iOS8 ä¸Šçš„ <code>App Extension</code> åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥çœ‹åšæ˜¯æ’ä»¶åŒ–äº†ã€‚</p>
<p>åœ¨ Android å¹³å°ä¸­ï¼Œæ’ä»¶åŒ–å·²ç»ä¸æ˜¯å¾ˆæ–°é²œçš„æŠ€æœ¯äº†ï¼Œ<strong>VirtualAPKã€Atlasã€Replugin</strong> ç­‰æ¡†æ¶ç›¸ç»§å¼€æºï¼Œæ’ä»¶åŒ–æŠ€æœ¯å·²ç»è¿›å…¥äº†æ¯”è¾ƒæˆç†Ÿçš„é˜¶æ®µäº†ã€‚</p>
<p>æ’ä»¶åŒ–çš„ç¼–ç¨‹æ€æƒ³å’Œå®ç°ï¼Œåœ¨ä¸åŒçš„å¹³å°æœ‰æ‰€å·®å¼‚ï¼Œå³ä½¿åœ¨åŒä¸€ä¸ªå¹³å°ä¸Šé¢éƒ½ä¼šæœ‰ä¸åŒçš„å®ç°æ‰‹æ®µï¼Œå»ºè®®é€‰æ‹©ä¸€ä¸ªå¼€æºæ–¹æ¡ˆå»äº†è§£å…¶åŸç†ï¼Œç„¶åè¯•ç€åŠ¨æ‰‹å»å®ç°ä¸€ä¸ªï¼Œåƒé‡Œä¹‹è¡Œå§‹äºè¶³ä¸‹ï¼</p>
<h2 id="çƒ­æ›´æ–°"><a href="#çƒ­æ›´æ–°" class="headerlink" title="çƒ­æ›´æ–°"></a>çƒ­æ›´æ–°</h2><p>â€œä¸å¥½äº†ï¼Œæ˜¨å¤©æœ‰å¾ˆå¤šç”¨æˆ·åé¦ˆæˆ‘ä»¬çš„ APP å‡ºç°é—ªé€€ã€‚â€œ å°ç‹ä¸€å¤§æ—©çš„å¼€å§‹æ’•å–Šï¼Œååœ¨ä»–æ—è¾¹çš„å¼€å‘å¤§ç¥ä»¬é¡¿æ—¶å¾®ç¬‘å‡å›ºï¼Œé©¬ä¸Šå»åå°çœ‹ä¸ŠæŠ¥çš„å´©æºƒæ—¥å¿—ï¼Œç´§æ¥ç€å¼€å§‹å¤ç°å’Œè§£å†³é—®é¢˜ï¼Œæœ€ç»ˆå¾—å‡ºç»“è®ºï¼Œéœ€è¦é‡æ–°æå®¡ APPï¼Œå¹¶å‘¨çŸ¥æ¸ é“éƒ¨é—¨åšå¥½æ›´æ–°å‡†å¤‡ã€‚</p>
<p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªæ¸¸æˆå‡ Gçš„å¤§å°ï¼Œä½ è®©ç”¨æˆ·ä¸ºäº†ä½ çš„ä¸€ä¸ªå°å¤±è¯¯æ¥æ•´åŒ…æ›´æ–°æ¸¸æˆï¼Œç”¨æˆ·å’Œä½ ä¼°è®¡éƒ½è¦ç–¯äº†ã€‚</p>
<p>æœ€è¿‘å‡ å¹´ï¼Œéšç€ä¸šåŠ¡å‘å±•çš„éœ€æ±‚ï¼Œ<strong>çƒ­æ›´æ–°</strong>æŠ€æœ¯ä¹Ÿæ˜¯å¾—åˆ°äº†çªé£çŒ›è¿›çš„å‘å±•ã€‚ç±»ä¼¼äºä¸Šé¢çš„åœºæ™¯ï¼Œèƒ½åœ¨ç”¨æˆ·ç¥ä¸çŸ¥é¬¼ä¸è§‰çš„æƒ…å†µä¸‹ä½¿ç”¨çƒ­æ›´æ–°çš„æŠ€æœ¯è§£å†³å´©æºƒçš„é—®é¢˜ï¼Œå²‚ä¸æ˜¯ä¸¤å…¨å…¶ç¾ã€‚</p>
<p>Android çš„çƒ­æ›´æ–°æŠ€æœ¯å¦‚ç«å¦‚è¼çš„å‘å±•ç€ï¼Œè€Œè‹¹æœè¿™è¾¹ä¸¥å‰ç¦æ­¢<strong>çƒ­æ›´æ–°</strong>ï¼Œä¸€æ—¦æ£€æŸ¥åˆ°ç«‹å³ä¼šè´£ä»¤ä½ ä¿®æ”¹æˆ–è€…ä¸‹æ¶ APPã€‚æˆ‘ä»¬è¿˜æ˜¯ä»æŠ€æœ¯çš„è§’åº¦æ¥çœ‹è¿™ä¸ªé—®é¢˜ï¼Œå­¦ä¹ å’Œäº†è§£ä¸€ä¸‹å¯¹åº”çš„æŠ€æœ¯æ€»å½’æ²¡æœ‰é”™ï¼Œ<a href="https://juejin.im/post/5a5821b6f265da3e3f4c9e2a" target="_blank" rel="noopener">è¿™é‡Œ</a> æœ‰ iOS ä¸Šé¢çš„çƒ­æ›´æ–°æ–¹æ¡ˆï¼Œå¦å¤– <a href="https://www.jianshu.com/p/eec0ab6800a4" target="_blank" rel="noopener">Androidçƒ­ä¿®å¤æ–¹æ¡ˆæ¯”è¾ƒ</a> ä»‹ç»äº†å¾ˆå¤š Android çƒ­æ›´æ–°çš„å¼€æºçš„æ–¹æ¡ˆï¼Œå¯ä»¥äº†è§£å­¦ä¹ ä¸€ä¸‹ã€‚</p>
<p>ç«™åœ¨è·¨å¹³å°çš„è§’åº¦ï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒæ¨èä½¿ç”¨ Lua å®ç°<strong>çƒ­æ›´æ–°</strong>ï¼ŒLua ä¸ä»…ç®€å•é«˜æ•ˆï¼Œè€Œä¸”å¯ä»¥å¾ˆå¥½çš„å’Œ C/C++ ç»“åˆåœ¨ä¸€èµ·ï¼Œè€Œ Android ä¸Šé¢é€šè¿‡ JNI åˆèƒ½ä¸ C/C++ é€šä¿¡ï¼ŒiOS ä¸Šé¢å°±æ›´åŠ ä¸ç”¨è¯´äº†ã€‚è¿™åªæ˜¯æˆ‘ä¸ªäººçš„ä¸€ç‚¹çœ‹æ³•ï¼Œä¸å–œå‹¿å–·ã€‚</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Philosophy </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æ¶æ„ æ¨¡å—åŒ– ç»„ä»¶åŒ– çƒ­æ›´æ–° æ’ä»¶åŒ– </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[HTTP æ¼”è¿›å²]]></title>
      <url>/2018/09/16/HTTP-%E6%BC%94%E8%BF%9B%E5%8F%B2/</url>
      <content type="html"><![CDATA[<h2 id="ç²¾é€š-HTTP-å—ï¼Ÿ"><a href="#ç²¾é€š-HTTP-å—ï¼Ÿ" class="headerlink" title="ç²¾é€š HTTP å—ï¼Ÿ"></a>ç²¾é€š HTTP å—ï¼Ÿ</h2><p>åœ¨é¢è¯•ç›¸å…³å¼€å‘å²—ä½çš„åŒå­¦ä¸­ï¼Œæˆ‘ç»å¸¸ä¼šé—®ä¸€äº›è·Ÿç¼–ç¨‹è¯­è¨€ä¸ç›¸å…³çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ä¸‹é¢è¿™äº›é—®é¢˜ï¼š</p>
<p><strong>1. ä½ å¹³æ—¶æ˜¯æ€ä¹ˆå­¦ä¹ çš„ï¼Ÿå­¦ä¹ æ¸ é“æœ‰å“ªäº›ï¼Ÿ</strong><br><strong>2. é¡¹ç›®ç»„ä¸­ï¼Œä½ è®¤ä¸ºæœ€é‡è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br><strong>3. ä½ åœ¨é¡¹ç›®ç»„ä¸­é‡åˆ°çš„æœ€å¤§å›°éš¾ï¼ˆéç¼–ç¨‹é—®é¢˜ï¼‰æ˜¯ä»€ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿ</strong><br><strong>4. é¡¹ç›®æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶ä»–åŒäº‹é‡åˆ°å›°éš¾ï¼Œä½ æ˜¯å¦‚ä½•åšçš„ï¼Ÿ</strong></p>
<p>è¿™äº›é—®é¢˜å¯ä»¥è®©é¢è¯•è€…è‡ªç”±å‘æŒ¥çš„é¢˜ç›®ï¼Œå¹¶æ²¡æœ‰å›ºå®šçš„æ ‡å‡†çš„ç­”æ¡ˆã€‚è¿™æ ·çš„é—®é¢˜é—®å‡ºæ¥æœ‰è¯¸å¤šå¥½å¤„ï¼Œé¦–å…ˆå¯ä»¥è®©é¢è¯•è€…ç¨³å®šä¸€ä¸‹å¿ƒæ€ä¸è‡³äºå¤ªç´§å¼ ï¼Œå…¶æ¬¡å¯ä»¥çœ‹çœ‹ä»–çš„è¯­è¨€ç»„ç»‡èƒ½åŠ›å’Œè¡¨è¾¾èƒ½åŠ›ï¼Œä»ä¸­ä¹Ÿèƒ½çœ‹å‡ºä»–æœ‰æ²¡æœ‰è¿‡å®é™…çš„é¡¹ç›®ç»éªŒã€‚</p>
<p>å¾ˆå¤šäººçš„ç®€å†ä¸Šé¢å†™çš„å¾ˆå®Œç¾ï¼Œåšè¿‡è¯¸å¤šé¡¹ç›®ï¼Œç²¾é€šæŸæŸè¯­è¨€çš„ç¼–ç¨‹ï¼Œç²¾é€šå„ç§ç½‘ç»œåè®®ï¼Œç†Ÿæ‚‰å„å¤§æ“ä½œç³»ç»Ÿç­‰ç­‰ï¼Œå½“æ·±å…¥é—®ä»–ä»¬ç†Ÿæ‚‰çš„çŸ¥è¯†æ—¶ï¼Œå‘ç°ä»–ä»¬çš„å›ç­”å´å«ç³Šä¸æ¸…ã€‚ä¸æ’é™¤ä¸–ç•Œä¸Šæœ‰è¿™æ ·çš„å…¨æ‰ï¼Œä½†æ˜¯è‚¯å®šä¸ä¼šè¢«æˆ‘ä»¬è½»æ˜“é‡åˆ°ï¼Œè‡³å°‘æˆ‘è§‰å¾—è‡ªå·±è¿˜æ²¡æœ‰è¾¾åˆ°é‚£ä¸ªèƒ½åŠ›ã€‚</p>
<p>å¦‚æœä½ è¿˜æ²¡æœ‰ä½†åˆæƒ³ç²¾é€šå„ç§çŸ¥è¯†ï¼Œå°±æ…¢æ…¢å»å­¦ä¹ å¹¶ç²¾é€šç›¸å…³çš„çŸ¥è¯†ï¼Œå¾ªåºæ¸è¿›ï¼Œç›¸ä¿¡è‡ªå·±ä¼šåšåˆ°çš„ã€‚å¥½äº†ï¼Œä¸æ‰¯äº†ï¼Œä»Šå¤©èŠèŠ HTTP çš„å‘å±•å†å²ã€‚</p>
<p>æˆ‘æ•¢ä¿è¯æœ‰ç»å¤§éƒ¨åˆ†çš„äººä¸çŸ¥é“ HTTP/2ï¼Œè™½ç„¶ä»–æ—©å°±æ¥ä¸´.</p>
<h2 id="HTTP-0-x-åˆ°-HTTP-2"><a href="#HTTP-0-x-åˆ°-HTTP-2" class="headerlink" title="HTTP 0.x åˆ° HTTP/2"></a>HTTP 0.x åˆ° HTTP/2</h2><p>HTTP/1 æ˜¯ HTTP 1.0 å’Œ HTTP 1.1 çš„ç»Ÿç§°ï¼Œåˆ†åˆ«æŒ‡ HTTP åè®®çš„ç‰ˆæœ¬æ˜¯ 1.0 å’Œ 1.1.</p>
<p>1960å¹´ç¾å›½äºº <a href="https://baike.baidu.com/item/Ted%20Nelson" target="_blank" rel="noopener">Ted Nelson</a> æ„æ€äº†ä¸€ç§é€šè¿‡è®¡ç®—æœºå¤„ç†æ–‡æœ¬ä¿¡æ¯çš„æ–¹æ³•ï¼Œå¹¶ç§°ä¹‹ä¸ºè¶…æ–‡æœ¬ï¼ˆhypertextï¼‰, è¿™æˆä¸ºäº† HTTP è¶…æ–‡æœ¬ä¼ è¾“åè®®æ ‡å‡†æ¶æ„çš„å‘å±•æ ¹åŸºï¼Œæ‰€ä»¥ä»–è¢«ç§°ä¹‹ä¸º <code>HTTP ä¹‹çˆ¶</code>ã€‚</p>
<p>1989å¹´3æœˆåœ¨ CERNï¼ˆæ¬§æ´²æ ¸å­ç ”ç©¶ç»„ç»‡ï¼‰å·¥ä½œçš„ <a href="ä¸‡ç»´ç½‘ä¹‹çˆ¶">Tim Berners-Leeï¼ˆè’‚å§†.ä¼¯çº³æ–¯.æï¼‰</a> æäº¤äº†ä¸€ä¸ªææ¡ˆ <code>Information Management: A Proposal</code>ï¼Œè¯¥ææ¡ˆæç»˜äº†å…¶å¯¹ä¸‡ç»´ç½‘ï¼ˆWorld Wide Webï¼‰æœ€åˆçš„è®¾æƒ³å³èƒ½è®©è¿œéš”ä¸¤åœ°çš„äººä»¬å…±äº«çŸ¥è¯†ï¼ŒTim æ˜¯ <code>ä¸‡ç»´ç½‘ä¹‹çˆ¶</code>ï¼Œæˆå°±å’Œè´¡çŒ®ä¹Ÿæ˜¯ä¸è®¡å…¶æ•°ã€‚</p>
<p>ç›´åˆ°1990å¹´ HTTP æ‰ç®—æ˜¯é—®ä¸–ï¼Œå§‘ä¸”ç§°ä¹‹ä¸º HTTP 0.x ç‰ˆæœ¬ï¼Œä¹Ÿæœ‰äº›åœ°æ–¹ç§°ä¹‹ä¸º HTTP 0.9 ç‰ˆæœ¬ï¼Œæ€»ä¹‹è¿™ä¸æ˜¯ä¸€ä¸ªæ­£å¼ç‰ˆã€‚1996å¹´5æœˆï¼ŒHTTP 1.0 ä½œä¸º HTTP çš„ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬æ­£å¼å…¬å¸ƒï¼Œå¹¶è®°è½½äº <a href="https://tools.ietf.org/html/rfc1945" target="_blank" rel="noopener">RFC1945</a> ä¸­ã€‚</p>
<p>éšç€äººä»¬å¯¹äº’è”ç½‘çš„è®¤çŸ¥å’ŒæŠ€æœ¯çš„å‘å±•ï¼ˆå°¤å…¶æ˜¯æµè§ˆå™¨ç­‰ç›¸å…³çš„æŠ€æœ¯ï¼‰ï¼Œå‘ç° HTTP 1.0 ç¼ºç‚¹è¿˜æ˜¯æ¯”è¾ƒå¤šï¼Œæ— æ³•æ»¡è¶³å¿«é€Ÿçš„äº’è”ç½‘å‘å±•éœ€æ±‚ã€‚äºæ˜¯åœ¨1997å¹´1æœˆå‘å¸ƒäº† HTTP 1.1 ç‰ˆæœ¬ï¼Œå¹¶è®°è½½äº <a href="https://www.ietf.org/rfc/rfc2068.txt" target="_blank" rel="noopener">RFC2068</a> ä¸­ï¼Œåæ¥åœ¨1999å¹´6æœˆï¼Œå¯¹ RFC2068 åˆåšäº†è¡¥å……å’Œä¿®æ­£ï¼Œç§°ä¹‹ä¸º <a href="https://www.ietf.org/rfc/rfc2616.txt" target="_blank" rel="noopener">RFC2616</a>, è‡³æ­¤ HTTP 1.1 å¼€å§‹ä¸€ç»Ÿå¤©ä¸‹ï¼Œç›´åˆ°ç°åœ¨ç»å¤§æ•°å¼€å‘è€…ä½¿ç”¨çš„éƒ½æ˜¯ HTTP 1.1 ç‰ˆæœ¬ã€‚</p>
<p>å¦å¤–ä¸€ä¸ªç‰ˆæœ¬ <a href="https://zh.wikipedia.org/wiki/HTTP/2" target="_blank" rel="noopener">HTTP/2</a> æ ‡å‡†äº2015å¹´5æœˆä»¥ <a href="https://tools.ietf.org/html/rfc7540" target="_blank" rel="noopener">RFC 7540</a> æ­£å¼å‘è¡¨ï¼Œå¤šæ•°ä¸»æµæµè§ˆå™¨å·²ç»åœ¨2015å¹´åº•æ”¯æŒäº†è¯¥åè®®ï¼Œæ—¶éš”å¤šå¹´ï¼ŒHTTP/2 æ‰é—®ä¸–ã€‚</p>
<p>è‹¹æœä» iOS9 å¼€å§‹æ”¯æŒ HTTP2.0ï¼Œå¯¹ iOS å¼€å‘äººå‘˜æ¥è¯´ä» iOS9 å¼€å§‹ NSURLSession å¯ä»¥æ”¯æŒ HTTP2.0 äº†ã€‚ç›®å‰ Android ç»å¤§éƒ¨åˆ†ç³»ç»Ÿä¸æ”¯æŒ HTTP/2ï¼ŒAndroid åŸç”Ÿ HttpURLConnection æ¡†æ¶å¹¶ä¸æ”¯æŒ HTTP/2ï¼Œä½†å¯ä»¥é€‰ç”¨ä¸‰æ–¹å¼€æºåº“ <a href="http://square.github.io/okhttp/" target="_blank" rel="noopener">okhttp</a> ä½œä¸ºç½‘ç»œæ¡†æ¶ï¼ŒAndroid 5.0+ï¼ˆç³»ç»Ÿç‰ˆæœ¬ï¼‰è®¾å¤‡æ‰æ”¯æŒ HTTP/2ã€‚æ‰€ä»¥æƒ³å…¨é¢ä½¿ç”¨ HTTP/2 è¿˜æ˜¯è¦ä»˜å‡ºä¸€å®šçš„ä»£ä»·ï¼Œä¸è¿‡éšç€æŠ€æœ¯çš„é©æ–°ï¼Œç›¸ä¿¡ HTTP/2 å°†ä¼šå¤§æ”¾å…‰å½©ã€‚</p>
<h2 id="HTTP-ä¸æ–­çš„æ”¹è¿›"><a href="#HTTP-ä¸æ–­çš„æ”¹è¿›" class="headerlink" title="HTTP ä¸æ–­çš„æ”¹è¿›"></a>HTTP ä¸æ–­çš„æ”¹è¿›</h2><p>ç”¨ä¸€å¼ å›¾æ¥æè¿° HTTP çš„ä¸æ–­æ”¹è¿›å’Œæ¼”å˜å²ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/16/1.jpg" alt=""></p>
<p>ä¸‹é¢å…·ä½“çœ‹çœ‹è¿™äº›åè®®ç‰ˆæœ¬çš„æ¼”è¿›è¿‡ç¨‹ä¸­ï¼Œç©¶ç«Ÿæ˜¯æ–°å¢å’Œæ”¹è¿›äº†å“ªäº›ä¸œè¥¿ï¼Ÿ</p>
<h3 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP 0.9"></a>HTTP 0.9</h3><p>HTTP 0.9 å¹¶éå‡ºè‡ªæŸä¸ªæ ‡å‡†åŒ–ç»„ç»‡ï¼Œåªæ˜¯ Tim çš„ä¸ªäººä½œå“è€Œå·²ï¼Œæ¯”è¾ƒç®€å•ã€‚å¯ä»¥å‚é˜…è¿™ç¯‡æ–‡ç«  <a href="https://www.w3.org/Protocols/HTTP/AsImplemented.html" target="_blank" rel="noopener">The Original HTTP as defined in 1991</a> ï¼Œè¯¥ç‰ˆæœ¬è§„å®šäº† HTTP ä½¿ç”¨ TCP/IP è¿æ¥ï¼ŒHTTP è¯·æ±‚åªæœ‰ä¸€ä¸ªè¯·æ±‚è¡Œï¼Œåªæœ‰ä¸€ä¸ª GET æ–¹æ³•åŠ ä¸Šè¯·æ±‚çš„URIã€‚HTTP å“åº”åˆ™ç›´æ¥è¿”å› HTML æ–‡æœ¬ï¼Œæ²¡æœ‰çŠ¶æ€ç ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰åŠæ³•åŒºåˆ†é”™è¯¯æ¶ˆæ¯å’Œæ­£å¸¸çš„æ–‡æœ¬ã€‚å¯ä»¥çœ‹å‡ºï¼ŒHTTP/0.9å¹¶ä¸å®Œå–„ï¼Œä¹Ÿä¸æ˜¯é‚£ä¹ˆå®Œç¾ï¼Œä½†æ˜¯è¿™çš„ç¡®æ˜¯ Tim åšæŒä¸‹æ¥çš„ç»“æ™¶ã€‚</p>
<h3 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP 1.0"></a>HTTP 1.0</h3><p>HTTP 1.0 å¢åŠ äº†è¯·æ±‚å¤´åŸŸå’Œå“åº”å¤´åŸŸï¼Œå¢åŠ äº† HEAD å’Œ POST æ–¹æ³•ï¼Œå“åº”å¯¹è±¡ä¸å†å±€é™äº HTML æ–‡æœ¬ï¼Œæ”¯æŒé•¿è¿æ¥å’Œç¼“å­˜æœºåˆ¶ç­‰ç­‰ã€‚</p>
<blockquote>
<p>HTTP 1.0 å…·ä½“ç‰¹ç‚¹</p>
</blockquote>
<p>1.å¯ä»¥å‘é€æ›´å¤šæ ¼å¼çš„å†…å®¹ï¼Œå¦‚å›¾åƒã€è§†é¢‘ã€äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸ä»…ä»…å±€é™äºæ–‡å­—äº†ã€‚</p>
<p>2.å¢åŠ äº† POST å’Œ HEAD æ–¹æ³•ã€‚</p>
<p>3.æ”¹å˜äº† HTTP è¯·æ±‚å’Œå›åº”çš„æ ¼å¼ã€‚é™¤äº†æ•°æ®éƒ¨åˆ†ï¼Œæ¯æ¬¡é€šä¿¡éƒ½å¿…é¡»åŒ…æ‹¬å¤´ä¿¡æ¯ï¼ˆHTTP headerï¼‰ï¼Œç”¨æ¥æè¿°ä¸€äº›å…ƒæ•°æ®ï¼Œå³å¢åŠ äº†è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå“åº”æ•°æ®ä¸å†å±€é™äº HTML æ–‡æœ¬ã€‚</p>
<p>4.æ–°å¢çŠ¶æ€ç ï¼ˆstatus codeï¼‰ã€å¤šå­—ç¬¦é›†æ”¯æŒã€å¤šéƒ¨åˆ†å‘é€ï¼ˆmulti-part typeï¼‰ã€æƒé™ï¼ˆauthorizationï¼‰ã€ç¼“å­˜ï¼ˆcacheï¼‰ã€å†…å®¹ç¼–ç ï¼ˆcontent encodingï¼‰ç­‰åŠŸèƒ½ã€‚</p>
<p>5.å¢åŠ äº†é•¿è¿æ¥çš„æ”¯æŒï¼Œä¸è¿‡ HTTP 1.0 éœ€è¦åœ¨ request ä¸­å¢åŠ  â€Connectionï¼š keep-aliveâ€œ header æ‰èƒ½å¤Ÿæ”¯æŒï¼Œåé¢è¦è¯´åˆ°çš„ HTTP 1.1 é»˜è®¤å°±æ”¯æŒäº†ã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼ŒHTTP 1.0åœ¨ HTTP 0.9 çš„åŸºç¡€ä¸Šåšäº†å¤§é‡çš„æ‰©å……å’Œæ”¹è¿›ã€‚</p>
<blockquote>
<p>HTTP 1.0 ä¸»è¦ç¼ºç‚¹</p>
</blockquote>
<p>1.æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦å»ºç«‹ TCP è¿æ¥ï¼Œå³æ¯å¯¹ Request/Response éƒ½ä½¿ç”¨ä¸€ä¸ªæ–°çš„è¿æ¥ã€‚</p>
<p>2.ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ ã€‚</p>
<h3 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP 1.1"></a>HTTP 1.1</h3><p>æ¯ä¸ªæ–°ç‰ˆæœ¬çš„è¯ç”ŸåŸºæœ¬éƒ½æ˜¯å¯¹ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„è¡¥å……å’Œæ”¹è¿›ï¼Œå°±åƒæˆ‘ä»¬çš„è½¯ä»¶å¼€å‘ä¸€æ ·ï¼Œåè®®ä¹Ÿéœ€è¦è¿­ä»£ã€‚</p>
<blockquote>
<p>HTTP 1.1 å…·ä½“ç‰¹ç‚¹</p>
</blockquote>
<p>1.åŠ å¼ºå’Œä¼˜åŒ–äº†æŒä¹…è¿æ¥å³é•¿è¿æ¥ã€‚</p>
<p>HTTP 1.1 æ”¯æŒé•¿è¿æ¥ï¼ˆPersistent Connectionï¼‰å’Œè¯·æ±‚çš„æµæ°´çº¿ï¼ˆPipeliningï¼‰å¤„ç†ï¼Œåœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ª HTTP è¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿï¼Œåœ¨ HTTP 1.1 ä¸­é»˜è®¤å¼€å¯ <code>Connectionï¼š keep-alive</code>ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº† HTTP 1.0 æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚</p>
<p>2.å¢å¼ºäº†ç¼“å­˜æœºåˆ¶ã€‚</p>
<p>å¼•å…¥äº†æ›´å¤šçš„ç¼“å­˜æ§åˆ¶ç­–ç•¥ä¾‹å¦‚ Entity tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Match ç­‰å¯ä¾›é€‰æ‹©çš„ç¼“å­˜å¤´ã€‚</p>
<p>3.è¯·æ±‚å¤´å¼•å…¥äº† range å¤´åŸŸã€‚</p>
<p>å®ƒå…è®¸åªè¯·æ±‚èµ„æºçš„æŸä¸ªéƒ¨åˆ†ï¼Œå³è¿”å›ç æ˜¯ 206ï¼ˆPartial Contentï¼‰ï¼Œè¿™æ ·å°±æ–¹ä¾¿äº†å¼€å‘è€…è‡ªç”±çš„é€‰æ‹©ä»¥ä¾¿äºå……åˆ†åˆ©ç”¨å¸¦å®½å’Œè¿æ¥ã€‚</p>
<p>4.å°† Content-length å­—æ®µçš„ä½œç”¨è¿›è¡Œæ‰©å……ï¼Œå³å£°æ˜æœ¬æ¬¡å›åº”çš„æ•°æ®é•¿åº¦ï¼ˆä¸€ä¸ªTCPè¿æ¥ç°åœ¨å¯ä»¥ä¼ é€å¤šä¸ªå›åº”ï¼ŒåŠ¿å¿…å°±è¦æœ‰ä¸€ç§æœºåˆ¶ï¼ŒåŒºåˆ†æ•°æ®åŒ…æ˜¯å±äºå“ªä¸€ä¸ªå›åº”çš„ï¼‰ã€‚</p>
<p>5.é‡‡ç”¨åˆ†å—ä¼ è¾“ç¼–ç ã€‚</p>
<p>å¯¹äºä¸€äº›å¾ˆè€—æ—¶çš„åŠ¨æ€æ“ä½œï¼ŒæœåŠ¡å™¨éœ€è¦ç­‰åˆ°æ‰€æœ‰æ“ä½œå®Œæˆï¼Œæ‰èƒ½å‘é€æ•°æ®ï¼Œæ˜¾ç„¶è¿™æ ·çš„æ•ˆç‡ä¸é«˜ã€‚æ›´å¥½çš„å¤„ç†æ–¹æ³•æ˜¯ï¼Œäº§ç”Ÿä¸€å—æ•°æ®ï¼Œå°±å‘é€ä¸€å—ï¼Œé‡‡ç”¨æµæ¨¡å¼ï¼ˆstreamï¼‰å–ä»£ç¼“å­˜æ¨¡å¼ï¼ˆbufferï¼‰ã€‚</p>
<p>6.æ–°å¢äº†è®¸å¤šåŠ¨è¯æ–¹æ³•ï¼šPUTã€PATCHã€HEADã€OPTIONSã€DELETEã€‚å¦å¤–ï¼Œå®¢æˆ·ç«¯è¯·æ±‚çš„å¤´ä¿¡æ¯æ–°å¢äº† Host å­—æ®µï¼Œç”¨æ¥æŒ‡å®šæœåŠ¡å™¨çš„åŸŸåã€‚</p>
<p>7.æ–°å¢äº† 24 ä¸ªé”™è¯¯çŠ¶æ€å“åº”ç ã€‚</p>
<blockquote>
<p>HTTP 1.0 ä¸»è¦ç¼ºç‚¹</p>
</blockquote>
<p>HTTP 1.1 è™½ç„¶å¢åŠ äº†å¾ˆå¤šåŠŸèƒ½ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå·²ç»å¾ˆå¼ºå¤§äº†ï¼Œä½†æ˜¯ä»–è‡ªèº«ä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œæ¢å¥è¯è¯´æœ‰ä¼˜åŒ–çš„ç©ºé—´ï¼Œä¸»è¦é—®é¢˜å¦‚ä¸‹ï¼š</p>
<p>1.é˜Ÿå¤´å µå¡ï¼ˆHead-of-line blockingï¼‰ï¼Œå„ä¸ªè¯·æ±‚åˆ°è¾¾çš„æœåŠ¡å™¨çš„é€Ÿåº¦æ˜¯ä¸åŒçš„ï¼Œå¦‚æœå…ˆå‘çš„è¯·æ±‚å…ˆåˆ°è¾¾å¯èƒ½ä¼šå‘ç”Ÿé˜»å¡ï¼Œå‰©ä¸‹æ‰€æœ‰çš„å·¥ä½œéƒ½ä¼šè¢«é˜»å¡åœ¨é‚£æ¬¡è¯·æ±‚åº”ç­”ä¹‹åï¼Œè¿™æ ·å°±é™ä½äº†å¸¦å®½ã€‚</p>
<p>ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼šä¸€æ˜¯å‡å°‘è¯·æ±‚æ•°ï¼ŒäºŒæ˜¯åŒæ—¶å¤šå¼€æŒä¹…è¿æ¥ã€‚</p>
<p>2.è‡ƒè‚¿çš„æ¶ˆæ¯å¤´éƒ¨</p>
<p>3.ä¸æ”¯æŒæœåŠ¡ç«¯æ¨é€ï¼Œä¾‹å¦‚è¦æ±‚ä½¿ç”¨ HTTP åè®®åšä¸€ä¸ªæœåŠ¡ç«¯æ•°æ®å˜åŠ¨é¡µé¢ç«‹å³æ”¹å˜çš„ç»„ä»¶å°±ä¸å¥½åšï¼Œå¯ç”¨è½®è¯¢çš„æ–¹å¼è¿›è¡Œï¼Œè¿™æ ·å°±ä¼šå¯¹å¸¦å®½å½±å“è¾ƒå¤§ã€‚</p>
<h3 id="SPDY"><a href="#SPDY" class="headerlink" title="SPDY"></a>SPDY</h3><p>åœ¨è¯´åˆ° HTTP/2 ä¹‹å‰ï¼Œå¿…é¡»è¦å…ˆè¯´è¯´ <a href="https://zh.wikipedia.org/wiki/SPDY" target="_blank" rel="noopener">SPDY</a>ã€‚SPDY æ˜¯ç”± Google å…¬å¸æ¨å‡ºçš„ï¼ŒSPDY çš„æ¨å‡ºæ˜¯ä¸ºäº†è§£å†³ HTTP 1.1 ä¸­å­˜åœ¨çš„ä¸€äº›é—®é¢˜çš„ã€‚</p>
<p>1.å¤šè·¯å¤ç”¨ï¼ˆmultiplexingï¼‰</p>
<p>å¤šè·¯å¤ç”¨é€šè¿‡å¤šä¸ªè¯·æ±‚ stream å…±äº«ä¸€ä¸ª TCP è¿æ¥çš„æ–¹å¼ï¼Œè§£å†³äº†HOL blocking çš„é—®é¢˜ï¼Œé™ä½äº†å»¶è¿ŸåŒæ—¶æé«˜äº†å¸¦å®½çš„åˆ©ç”¨ç‡ã€‚</p>
<p>2.å¯ä»¥å¯¹è¯·æ±‚è®¾ç½®ä¼˜å…ˆçº§</p>
<p>å¤šè·¯å¤ç”¨å¸¦æ¥ä¸€ä¸ªæ–°çš„é—®é¢˜æ˜¯ï¼Œåœ¨è¿æ¥å…±äº«çš„åŸºç¡€ä¹‹ä¸Šæœ‰å¯èƒ½ä¼šå¯¼è‡´å…³é”®è¯·æ±‚è¢«é˜»å¡ã€‚SPDYå…è®¸ç»™æ¯ä¸ªrequestè®¾ç½®ä¼˜å…ˆçº§ï¼Œè¿™æ ·é‡è¦çš„è¯·æ±‚å°±ä¼šä¼˜å…ˆå¾—åˆ°å“åº”ã€‚æ¯”å¦‚æµè§ˆå™¨åŠ è½½é¦–é¡µï¼Œé¦–é¡µçš„htmlå†…å®¹åº”è¯¥ä¼˜å…ˆå±•ç¤ºï¼Œä¹‹åæ‰æ˜¯å„ç§é™æ€èµ„æºæ–‡ä»¶ï¼Œè„šæœ¬æ–‡ä»¶ç­‰åŠ è½½ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ç”¨æˆ·èƒ½ç¬¬ä¸€æ—¶é—´çœ‹åˆ°ç½‘é¡µå†…å®¹ã€‚</p>
<p>3.å¯¹è¯·æ±‚å¤´çš„å‹ç¼©</p>
<p>é€‰æ‹©åˆé€‚çš„å‹ç¼©ç®—æ³•å¯ä»¥å‡å°åŒ…çš„å¤§å°å’Œæ•°é‡ï¼Œè¿™æ ·åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥æé«˜ç½‘ç»œä½¿ç”¨æ•ˆç‡ã€‚</p>
<p>4.ä¸ºäº†æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ï¼Œå¼ºåˆ¶ä½¿ç”¨åŸºäº HTTPS çš„åŠ å¯†åè®®ä¼ è¾“ã€‚</p>
<p>5.æ”¯æŒæœåŠ¡ç«¯æ¨é€ã€‚</p>
<p>ç§°ä¹‹ä¸º Server Push åŠŸèƒ½ï¼ŒæœåŠ¡å™¨åœ¨è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥æŠŠå„ç§èµ„æºæ¨é€ç»™å®¢æˆ·ç«¯ã€‚</p>
<p>æ¯”å¦‚ï¼Œå®¢æˆ·ç«¯åªè¯·æ±‚äº† index.htmlï¼Œä½†æ˜¯æœåŠ¡å™¨æŠŠ index.htmlã€x.cssã€x.jpg ç­‰èµ„æºå…¨éƒ¨å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¿™æ ·çš„è¯ï¼Œåªéœ€è¦ä¸€è½® HTTP é€šä¿¡ï¼Œå®¢æˆ·ç«¯å°±å¾—åˆ°äº†å…¨éƒ¨èµ„æºï¼Œæé«˜äº†é€šä¿¡çš„æ€§èƒ½ï¼Œä¹Ÿæé«˜äº†ç”¨æˆ·ä½“éªŒã€‚</p>
<h3 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP/2"></a>HTTP/2</h3><p>æœ¬è´¨ä¸Šæ¥è®²ï¼ŒHTTP/2 æ˜¯å»ºç«‹åœ¨ SPDY åŸºç¡€ä¹‹ä¸Šçš„ï¼Œå€Ÿé‰´äº†å¾ˆå¤š SPDY çš„è®¾è®¡æ€æƒ³å’Œç­–ç•¥ã€‚ HTTP å…·æœ‰ SPDY çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿæœ‰ä¸ SPDY çš„ä¸åŒç‚¹ï¼Œä¸»è¦å¦‚ä¸‹ï¼š</p>
<p>1.HTTP/2 æ”¯æŒæ˜æ–‡ HTTP ä¼ è¾“ï¼Œè€Œ SPDY å¼ºåˆ¶ä½¿ç”¨ HTTPSã€‚è¿™ä¸€ç‚¹ HTTP/2 ç›¸å¯¹äººæ€§åŒ–ä¸€äº›ã€‚</p>
<p>2.HTTP/2 ä¼šå¯¹è¯·æ±‚å¤´å’Œå“åº”å¤´åšå‹ç¼©ä»¥æå‡è¯·æ±‚æ€§èƒ½ï¼ŒHTTP/2 æ¶ˆæ¯å¤´çš„å‹ç¼©ç®—æ³•ä¸åŒäº SPDYã€‚ HTTP/2 é‡‡ç”¨ <a href="http://http2.github.io/http2-spec/compression.html" target="_blank" rel="noopener">HPACK</a>ï¼ŒSPDY é‡‡ç”¨çš„ <a href="http://zh.wikipedia.org/wiki/DEFLATE" target="_blank" rel="noopener">DEFLATE</a> ç®—æ³•ã€‚</p>
<p>HTTP/2 æ”¯æŒæ‰€æœ‰çš„ HTTP 1.1 çš„æ ¸å¿ƒç‰¹å¾ï¼Œå…¶æä¾›äº† HTTP è¯­ä¹‰çš„ä¼ è¾“ä¼˜åŒ–ï¼Œå¹¶ä¸”åœ¨å„æ–¹é¢åšåˆ°æ›´é«˜æ•ˆã€‚HTTP/2 çš„å¤´ä¿¡æ¯æ˜¯ä¸€ä¸ªå½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸ºå¸§ï¼ˆframeï¼‰ï¼Œå³å¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚å¯¹ HTTP/2 æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹ä¸€ä¸‹ <a href="https://www.jianshu.com/p/40378501d1fc" target="_blank" rel="noopener">HTTP2 åè®®åˆè¯†</a> è¿™ç¯‡æ–‡ç« ã€‚</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> ç½‘ç»œåè®® </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Wireshark udp http https spdy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Wireshark: ç®€å•åˆ†æ TCP ä¸‰æ¬¡æŒ¥æ‰‹]]></title>
      <url>/2018/09/09/Wireshark-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-TCP-%E4%B8%89%E6%AC%A1%E6%8C%A5%E6%89%8B/</url>
      <content type="html"><![CDATA[<h2 id="è¯è¯´æ¡æ‰‹"><a href="#è¯è¯´æ¡æ‰‹" class="headerlink" title="è¯è¯´æ¡æ‰‹"></a>è¯è¯´æ¡æ‰‹</h2><p>ä½ è¦æ˜¯å¼€å‘äººå‘˜ï¼Œç›¸ä¿¡ä½ ä¸€å®šå¬è¯´è¿‡ TCPï¼ˆTransmission Control Protocol ä¼ è¾“æ§åˆ¶åè®®ï¼‰æˆ–æ˜¯ TCP æ¡æ‰‹çš„è¯´æ³•ã€‚</p>
<p>æ‰€è°“<strong>æ¡æ‰‹</strong>ï¼Œé€šä¿—æ¥è®²å°±æ˜¯é€šä¿¡åŒæ–¹åå•†åœ¨åç»­é€šä¿¡è¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨çš„é€šä¿¡ä¿¡æ¯çš„è¿‡ç¨‹ã€‚TCP ä¸ºäº†å»ºç«‹å¯é çš„è¿æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œåç»­ç»™å¤§å®¶åˆ†äº« TLS ä¸ºäº†å®ç°åŠ å¯†ã€æ ¡éªŒã€èº«ä»½è®¤è¯åŒæ ·éœ€è¦æ¡æ‰‹çš„è¿‡ç¨‹ã€‚</p>
<p>TCP ä¸‰æ¬¡æ¡æ‰‹å¯ä»¥ä½¿ç”¨ä¸‹å›¾æ¥è¡¨è¾¾ï¼š<br><img src="/upload/images/2018/09/09/1.jpg" alt=""></p>
<p>æœ¬ç¯‡ç»™å¤§å®¶åˆ†äº«å¦‚ä½•ä½¿ç”¨ <code>Wireshark</code> æ¥è·Ÿè¸ª HTTP åŒ…ï¼ŒæŸ¥çœ‹ TCP æ¡æ‰‹çš„è¿‡ç¨‹ã€‚</p>
<p>åœ¨çœ‹ä¸‹é¢å†…å®¹ä¹‹å‰ï¼Œå…ˆç®€å•çœ‹ä¸€ä¸‹ TCP åè®®æŠ¥å¤´ã€‚</p>
<p>ä¸‹å›¾æ˜¯ TCP æŠ¥å¤´çš„æ ¼å¼ï¼š<br><img src="/upload/images/2018/09/09/2.png" alt=""></p>
<p>å…¶ä¸­ï¼ŒSeq(Sequence Number) æ˜¯ 32 ä½çš„åºåˆ—å·ï¼Œ<code>Acknowledgment number</code> ç§°ä¹‹ä¸ºç¡®è®¤åºå·ï¼Œä¹Ÿæ˜¯ 32 ä½çš„ï¼Œä½†æ˜¯ä»–ä¸æ˜¯æ ‡å¿—ä½ ACKï¼Œè¿™ä¸ªè¦åŒºåˆ«å¼€ï¼Œå½“ ACK ç½® 1 æ—¶ <code>Acknowledgment number</code> æ‰æœ‰æ•ˆï¼ŒæŒ‡æ¥æ”¶æ–¹æœŸå¾…çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºåˆ—å·ã€‚</p>
<p>TCP æŠ¥å¤´ä¿¡æ¯ä¸­æœ‰å…­ä¸ªæ§åˆ¶ä½(æ ‡å¿—ä½)ï¼Œåˆ†åˆ«æ˜¯ï¼šSYNã€ACKã€PSHã€FINã€RST å’Œ URGã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">SYN: è¡¨ç¤ºå»ºç«‹è¿æ¥</div><div class="line">FIN: è¡¨ç¤ºå…³é—­è¿æ¥</div><div class="line">ACK: è¡¨ç¤ºå“åº”</div><div class="line">PSH: è¡¨ç¤ºæœ‰æ•°æ®ä¼ è¾“</div><div class="line">RST: è¡¨ç¤ºè¿æ¥é‡ç½®</div><div class="line">URG: è¡¨ç¤ºç´§æ€¥æ•°æ®</div></pre></td></tr></table></figure>
<p><strong>Seq åºåˆ—å·æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</strong><br>ç¬¬ä¸€ï¼Œåœ¨ SYN ç½® 1 æ—¶ï¼Œæ­¤ä¸ºå½“å‰è¿æ¥çš„åˆå§‹åºåˆ—å·(Initial Sequence Number, ISN)ï¼Œæ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚åºå·ä¸ºæ­¤ ISN+1ã€‚<br>ç¬¬äºŒï¼Œåœ¨ SYN ç½® 0 æ—¶ï¼Œä¸ºå½“å‰è¿æ¥æŠ¥æ–‡æ®µçš„ç´¯è®¡æ•°æ®åŒ…å­—èŠ‚æ•°ã€‚</p>
<p>TCP åè®®è®¾è®¡æ¯”è¾ƒå¤æ‚ï¼Œå…¶æ¶‰åŠçš„çŸ¥è¯†è¾ƒå¤šï¼Œè¿™é‡Œå¤§å®¶æ•´ä¸æ˜ç™½ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå¹¶ä¸å½±å“ä½ é˜…è¯»ä¸‹é¢çš„å†…å®¹ï¼Œå¦‚æœå¯¹ TCP åè®®æœ¬èº«æ„Ÿå…´è¶£ï¼Œå¯ä»¥å»æ‹œè¯»ã€TCP/IP è¯¦è§£ï¼Œå· 1ï¼šåè®®ã€‘è¿™æœ¬ä¹¦ã€‚</p>
<h2 id="ç½‘ç»œæ¨¡å‹"><a href="#ç½‘ç»œæ¨¡å‹" class="headerlink" title="ç½‘ç»œæ¨¡å‹"></a>ç½‘ç»œæ¨¡å‹</h2><p>æ¯æ¬¡è¯´åˆ°ç½‘ç»œå±‚ï¼Œå°±è¦æ‹¿å‡ºç±»ä¼¼ä¸‹é¢çš„ç½‘ç»œæ¨¡å‹å›¾ï¼ŒOSI å°†ç½‘ç»œæ¨¡å‹åˆ†ä¸º7å±‚ï¼ŒTCP/IP æ¨¡å‹å°†ç½‘ç»œæ¨¡å‹åˆ†ä¸º 4 å±‚ï¼Œç½‘ç»œ 4 å±‚æ¨¡å‹ç”± 7 å±‚æ¨¡å‹ç®€åŒ–åˆå¹¶è€Œæ¥ï¼Œæ²¡æœ‰æœ¬è´¨çš„åŒºåˆ«ï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/09/09/3.jpg" alt=""></p>
<p>HTTP ä»…ä»…æ˜¯ä¸ªåè®®ï¼Œå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œä»ä¸Šå›¾å¯ä»¥çœ‹å‡º HTTP æ˜¯åœ¨ TCP åŸºç¡€ä¹‹ä¸Šçš„ã€‚</p>
<blockquote>
<p>HTTP åè®®ä¸€å…±æœ‰äº”å¤§ç‰¹ç‚¹</p>
</blockquote>
<p><em>1ã€æ”¯æŒå®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼</em><br><em>2ã€ç®€å•å¿«é€Ÿ</em><br><em>3ã€çµæ´»</em><br><em>4ã€æ— è¿æ¥</em><br><em>5ã€æ— çŠ¶æ€</em></p>
<p>è¿™é‡Œå¼ºè°ƒä¸€ä¸‹ <strong>æ— è¿æ¥</strong> å’Œ <strong>æ— çŠ¶æ€</strong> è¿™ä¸¤ä¸ªç‰¹ç‚¹ã€‚</p>
<p><strong>æ— è¿æ¥</strong>ï¼ŒæŒ‡çš„æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·ç«¯çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚<code>Keep-Alive</code> ç‰¹æ€§ä¸åœ¨æœ¬ç¯‡è®¨è®ºèŒƒå›´ï¼Œæš‚æ—¶ä½ å¯ä»¥å°†å…¶å¿½ç•¥ã€‚</p>
<p><strong>æ— çŠ¶æ€</strong>ï¼ŒæŒ‡çš„æ˜¯åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆçŠ¶æ€ã€‚å³æˆ‘ä»¬ç»™æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ä¹‹åï¼ŒæœåŠ¡å™¨æ ¹æ®è¯·æ±‚ï¼Œä¼šç»™æˆ‘ä»¬å‘é€æ•°æ®è¿‡æ¥ï¼Œä½†æ˜¯å‘é€å®Œï¼Œä¸ä¼šè®°å½•ä»»ä½•ä¿¡æ¯ã€‚</p>
<p>å¯ä»¥åˆ©ç”¨ HTTP çš„è¿™ä¸¤ä¸ªç‰¹ç‚¹æ¥åˆ†æ TCP ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ã€‚</p>
<h2 id="ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹"></a>ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹</h2><p>ä»¥ GET è¯·æ±‚ä¸‹é¢åœ°å€ä¸ºä¾‹ï¼Œä½¿ç”¨ <code>Wireshark</code> æŠ“åŒ…ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://www.baidu.com/news/detailV3.html?id=1279391&amp;COMMON_ACCESS_TOKEN=(null)&amp;COMMON_ACCESS_TOKEN_SECRET=(null)&amp;_cT=IOS&amp;_cV=3.1.3&amp;_cA=PM</div></pre></td></tr></table></figure>
<p>çœ‹è¿”å›ç»“æœï¼Œé€‰ä¸­ <code>HTTP/1.1 200 OK</code> å³é”®, åœ¨å¼¹å‡ºæ¡†ä¸­é€‰æ‹© <code>Follow/TCP Stream</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/09/4.jpg" alt=""></p>
<p>å…³é—­å¼¹å‡ºçš„å¼¹çª—ï¼Œå›åˆ°ä¸»ç•Œé¢ï¼Œçœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸‰æ¬¡ï¼ˆçº¢è‰² 1ã€2ã€3å¤„ï¼‰ TCP æ¡æ‰‹è¿‡ç¨‹ï¼š<br><img src="/upload/images/2018/09/09/5.jpg" alt=""></p>
<p>ç¬¬ä¸€æ¬¡ï¼Œè¯·æ±‚å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª [SYN] åŒ…ï¼Œåºåˆ—å·æ˜¯ 0ï¼ˆSeq=0ï¼‰ã€‚</p>
<p>ç¬¬äºŒæ¬¡ï¼ŒæœåŠ¡å™¨ä¼šå‘é€ä¸€ä¸ª [SYN, ACK] åŒ…ï¼Œåºåˆ—å·æ˜¯ 0ï¼ŒACK æ˜¯ 1ï¼ˆSeq=0ï¼ŒAck=1ï¼‰ã€‚</p>
<p>ç¬¬ä¸‰æ¬¡ï¼Œå®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯ä¼šå‘é€ä¸€ä¸ª [ACK] åŒ…ï¼Œåºåˆ—å·æ˜¯ 1ï¼ŒAck æ˜¯ 1ï¼ˆSeq=1ï¼ŒAck=1ï¼‰æ¥å›å¤æœåŠ¡å™¨ã€‚</p>
<p>ç®€å•çš„ç”»ä¸€ä¸ªè‰å›¾ï¼Œå¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/09/6.jpg" alt=""></p>
<p><strong>è¿™ä¸ªè¿‡ç¨‹ï¼Œç®€å•æè¿°ä¸ºä¸‹é¢ä¸‰ä¸ªæ­¥éª¤ï¼š</strong></p>
<p>1.å‘é€æ–¹ç»™æ¥æ”¶æ–¹å‘é€ SYN ä¿¡å·<br>2.æ¥æ”¶æ–¹ç¡®è®¤å¹¶å›å¤ç»™å‘é€æ–¹ SYN/ACK ä¿¡å·<br>3.å‘é€æ–¹ç»™æ¥æ”¶æ–¹å‘é€ç¡®è®¤ ACK ä¿¡å·</p>
<p>ä¸Šé¢è¿™ä¸ªæ­¥éª¤ï¼Œå»ºè®®æ„Ÿå…´è¶£çš„æœ‹å‹å®é™…æ“ä½œä¸€ä¸‹ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹</h2><p>å›å¤´å†æ¥æƒ³ä¸€æƒ³ï¼ŒTCP çš„è¿æ¥ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹å‘¢ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯ä¸€æ¬¡ï¼Œä¸¤æ¬¡å‘¢ï¼Ÿä¸€æ¬¡ä¸å°±æŒºå¥½å—ï¼Œä¸‰æ¬¡æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤šæ­¤ä¸€ä¸¾äº†ï¼Ÿ</p>
<p>TCP åè®®ä¸æ˜¯ä¸€ä¸ªäººå®šå‡ºæ¥çš„è€Œæ˜¯ä¸€ç¾¤äººæ‹Ÿå®šçš„ï¼Œè®¾è®¡ä¸‰æ¬¡æ¡æ‰‹å›ºç„¶æœ‰å®ƒçš„æ„ä¹‰ï¼Œæ˜¯ç»è¿‡ç²¾å¿ƒè®¾è®¡ä¸”åœ¨æ€§èƒ½å’Œæ•ˆç‡ä¸Šé¢è¡¡é‡è¿‡çš„ã€‚</p>
<p>åœ¨çŸ¥ä¹ <a href="https://www.zhihu.com/question/24853633" target="_blank" rel="noopener">TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ</a> ä¸Šé¢æœ‰ä¸é”™çš„ç­”æ¡ˆï¼Œè™½ç„¶æœ‰äº›å›ç­”æ¯”è¾ƒæç¬‘ï¼Œä½†æ˜¯å¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚è¿™ä½ä»å…„ï¼š<br><img src="/upload/images/2018/09/09/7.jpg" alt=""></p>
<p>æˆ‘ä»¬ä¸å¦¨æ¢ä¸ªæ€è·¯æ¥æƒ³è¿™ä¸ªé—®é¢˜ï¼ŒTCP åè®®è®¾è®¡åˆè¡·æ˜¯ <code>è®©æ•°æ®è¿›è¡Œå¯é ï¼Œé«˜æ•ˆï¼Œå®‰å…¨çš„ä¼ è¾“</code>ï¼Œå¦‚æœæ¡æ‰‹æ˜¯ä¸€æ¬¡ï¼Œä¸¤æ¬¡æˆ–å››æ¬¡ï¼Œå°±æ— æ³•å¾ˆå¥½çš„ä¿è¯ TCP çš„ <code>å¯é ï¼Œå®‰å…¨åŠé«˜æ•ˆ</code> çš„ä¼ è¾“ï¼Œè¯´ä¸å®šå“ªå¤©æœ‰äººè®¾è®¡å‡ºæ¥ä¸€ç§å¯æ›¿ä»£ TCP åè®®çš„å…¶ä»–åè®®å°±æ˜¯ä¸¤æ¬¡æ¡æ‰‹æˆ–è€…ä¸éœ€è¦æ¡æ‰‹ï¼Œå“ˆå“ˆï¼</p>
<h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><p><a href="https://cloud.tencent.com/info/d6b27fce815445c3c5f783a39ec204f6.html" target="_blank" rel="noopener">å¦‚ä½•ç†è§£HTTPåè®®çš„â€œæ— è¿æ¥ï¼Œæ— çŠ¶æ€â€ç‰¹ç‚¹?</a></p>
<p><a href="https://www.zhihu.com/question/24853633" target="_blank" rel="noopener">TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ</a></p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Wireshark tcp ip udp http https </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Wiresharkï¼šæŠ“å– HTTP åŒ…]]></title>
      <url>/2018/09/01/Wireshark%EF%BC%9A%E6%8A%93%E5%8F%96-HTTP-%E5%8C%85/</url>
      <content type="html"><![CDATA[<h2 id="å¼€ç¯‡ç®€è¦"><a href="#å¼€ç¯‡ç®€è¦" class="headerlink" title="å¼€ç¯‡ç®€è¦"></a>å¼€ç¯‡ç®€è¦</h2><p><a href="http://www.veryitman.com/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/" target="_blank" rel="noopener">åˆè¯† Wireshark</a> ç®€å•ä»‹ç»äº†å¼ºå¤§çš„ <code>Wireshark</code> å·¥å…·ï¼Œæƒ³ç”¨å¥½æˆ–è€…æ˜¯è¯´æƒ³å‘æŒ¥ <code>Wireshark</code> çš„å·¨å¤§å¨åŠ›ï¼Œè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼ˆå¯¹æˆ‘æ¥è¯´ï¼‰ã€‚å­¦ä¹  <code>Wireshark</code> çš„æˆæœ¬è¦æ¯”å…¶ä»–ç½‘ç»œæŠ“åŒ…å·¥å…·çš„æˆæœ¬é«˜ï¼Œæ‰€ä»¥è¯·åšå¥½å­¦ä¹ çš„å‡†å¤‡ã€‚</p>
<p>æˆ‘èº«è¾¹å¾ˆå¤šå¼€å‘åŒäº‹ï¼Œç”šè‡³åŒ…æ‹¬ä¸€äº›åˆšå…¥èŒçš„æµ‹è¯•å·¥ç¨‹å¸ˆéƒ½ä¸å–œæ¬¢ä½¿ç”¨æŠ“åŒ…å·¥å…·ï¼Œé‡åˆ°é—®é¢˜å‡­ç€è‡ªå·±çš„æ„Ÿè§‰åœ¨é‚£é‡Œä¾ƒä¾ƒè€Œè°ˆï¼Œæ—¢è€½è¯¯æ—¶é—´åˆæ²¡æœ‰è§£å†³é—®é¢˜ï¼Œæœ‰æ—¶å€™è¿˜ä¼¤äº†å’Œæ°”ï¼Œæ˜æ˜å¯ä»¥ä½¿ç”¨å·¥å…·å¯ä»¥è§£å†³çš„é—®é¢˜ï¼Œååè¦å„æŠ’å·±è§ã€‚</p>
<p>è¯´åˆ° <code>Wireshark</code> æ›´æ˜¯å¾ˆå°‘äººä½¿ç”¨ï¼Œè‡³å°‘æˆ‘èº«è¾¹çš„åŒäº‹æ˜¯è¿™æ ·ã€‚å¦‚æœè®©ä½ ä¸€ç›´å»çœ‹é‚£äº› RFC ç­‰ç½‘ç»œåè®®ï¼Œä¸åˆ°åŠå°æ—¶ä¼°è®¡ä½ å°±ä¼šæ„Ÿåˆ°ç–²æƒ«ï¼Œä½†æ˜¯ç»“åˆ <code>Wireshark</code> æ¥ç†è§£ç½‘ç»œåè®®å°±ä¼šæ„Ÿåˆ°æ— æ¯”çš„å¿«ä¹ï¼Œä½•ä¹è€Œä¸ä¸ºå‘¢ï¼Ÿï¼</p>
<p>ç»§ç»­é˜…è¯»ä¸‹å»ï¼Œä½ å¯ä»¥äº†è§£åˆ°å¦‚ä¸‹å‡ ä¸ªçŸ¥è¯†ï¼š</p>
<p><strong>1. å¦‚ä½•æŠ“å– PC ç«¯ã€iOS è®¾å¤‡çš„ç½‘ç»œåŒ…ï¼Ÿ</strong><br><strong>2. ä½¿ç”¨ä¸€äº›è¿‡æ»¤æ¡ä»¶å¦‚ä½•æŸ¥çœ‹åŒ…çš„å†…å®¹ï¼Ÿ</strong><br><strong>3. å¦‚ä½•åœ¨ <code>Wireshark</code> ä¸­æ˜¾ç¤ºåŸŸåï¼Ÿ</strong></p>
<h2 id="PC-ç«¯çš„-HTTP-è¯·æ±‚"><a href="#PC-ç«¯çš„-HTTP-è¯·æ±‚" class="headerlink" title="PC ç«¯çš„ HTTP è¯·æ±‚"></a>PC ç«¯çš„ HTTP è¯·æ±‚</h2><p>æ‰“å¼€ <code>Wireshark</code>ï¼Œé€‰æ‹©å¯¹åº”çš„ç½‘å£ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯æ— çº¿ç½‘ç»œï¼ˆWiFiï¼‰ï¼Œæ‰€ä»¥é€‰æ‹© <code>Wi-Fiï¼šen0</code> è¿™ä¸ªç½‘å£ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„ç½‘ç»œä½¿ç”¨æƒ…å†µæ¥é€‰æ‹©å¯¹åº”çš„ç½‘å£ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="/upload/images/2018/09/01/1.jpg" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°å¯¹åº”æœ‰ç½‘ç»œæ•°æ®çš„ç½‘å£ï¼Œ<code>Wireshark</code> è¿˜åœ¨å³ä¾§æ˜¾ç¤ºå¯¹åº”çš„æ³¢æµªï¼Œå¾ˆäººæ€§åŒ–çš„è®¾è®¡ã€‚åŒå‡»å¯¹åº”çš„ç½‘å£ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>Wireshark</code> æ¥æŠ“åŒ…çœ‹æ•°æ®äº†ã€‚</p>
<p>ä¸‹é¢æˆ‘å°±ä»¥ PC ç«¯è®¿é—® <code>www.veryitman.com</code> æ¥æ¼”ç¤º HTTP è¯·æ±‚çš„æŠ“åŒ…æƒ…å†µã€‚</p>
<p>æŸ¥çœ‹æœ¬æœºçš„ ip åœ°å€ï¼Œæˆ‘çš„æ˜¯ <code>10.4.17.7</code>, å†æ¥çœ‹ä¸€ä¸‹ <code>www.veryitman.com</code> å¯¹åº”çš„ ip åœ°å€ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ping ww.veryitman.com</div></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">64 bytes from 185.199.110.153: icmp_seq=0 ttl=52 time=317.074 ms</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆï¼Œ <code>185.199.110.153</code> å°±æ˜¯å…¶å¯¹åº”çš„ ip åœ°å€ã€‚æ€»çš„æ¥è¯´ï¼Œå¯¹äº PC ç«¯ï¼Œæºåœ°å€æ˜¯ <code>10.4.17.7</code>ï¼Œç›®çš„åœ°å€æ˜¯ <code>185.199.110.153</code>ï¼Œå¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œæ­£å¥½åè¿‡æ¥ã€‚</p>
<p>é¦–å…ˆåœ¨è¿‡æ»¤å™¨ä¸­è¾“å…¥ <code>http</code>, å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/upload/images/2018/09/01/2.jpg" alt=""></p>
<p>ç„¶åæ‰“å¼€æµè§ˆå™¨ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ Chromeï¼Œæ‰“å¼€ <code>http://www.veryitman.com/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/</code> ç½‘ç«™ç«™ç‚¹ï¼Œ<code>Wireshark</code> æ˜¾ç¤ºå¦‚ä¸‹ï¼ˆéƒ¨åˆ†æˆªå›¾ï¼‰ï¼š<br><img src="/upload/images/2018/09/01/3.jpg" alt=""></p>
<p>æ”¹å˜ä¸€ä¸‹è¿‡æ»¤è¯­å¥ï¼Œå°†ä¹‹å‰çš„ <code>http</code> æ”¹ä¸º <code>ip.src==10.4.17.7 &amp;&amp; http &amp;&amp; ip.dst==185.199.109.153</code>ï¼Œ æ˜¾ç¤ºå¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/01/4.jpg" alt=""></p>
<p>å¯ä»¥é€‰æ‹©ä»»ä½•ä¸€ä¸ªè¯·æ±‚ï¼Œå±•ç¤ºåŒºåŸŸå¦‚ä¸‹ï¼š<br><img src="/upload/images/2018/09/01/5.jpg" alt=""></p>
<p>ä¸Šå›¾ä¸­çš„ä¸‰ä¸ªåŒºåŸŸåˆ†åˆ«å¯¹åº”çš„æ˜¯ <code>View</code> ä¸­çš„ <code>Packet List</code>ï¼Œ <code>Packet Details</code>ï¼Œ<code>Packet Bytes</code> ä¸‰ä¸ªè§†å›¾ã€‚<br><img src="/upload/images/2018/09/01/6.jpg" alt=""></p>
<p>é€‰æ‹©ä»»ä½•ä¸€ä¸ªè¯·æ±‚ï¼Œåœ¨å¯¹åº”çš„ <code>åŒºåŸŸ2</code> å¯ä»¥çœ‹åˆ°è¯¥è¯·æ±‚çš„è¯¦æƒ…ã€‚</p>
<p>åˆšæ‰ä½¿ç”¨çš„è¿‡æ»¤æ¡ä»¶åªçœ‹åˆ° PCï¼ˆå®¢æˆ·ç«¯ï¼‰çš„è¯·æ±‚ï¼Œæ²¡æœ‰çœ‹åˆ°æœåŠ¡å™¨è¿”å›ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹è¿‡æ»¤æ¡ä»¶ä¸º <code>ip.src==185.199.109.153 &amp;&amp; http &amp;&amp; ip.dst==10.4.17.7</code>ï¼Œè¿™æ ·å°±çœ‹ä»¥çœ‹åˆ°æœåŠ¡å™¨çš„å›åŒ…ä¿¡æ¯äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/01/7.jpg" alt=""></p>
<p>åŒå‡»è¿›å…¥è¯¥å“åº”ï¼Œå°±å¯ä»¥çœ‹åˆ°å¯¹åº”çš„å“åº”æ•°æ®è¯¦æƒ…äº†ã€‚</p>
<h2 id="iOS-è®¾å¤‡çš„-HTTP-è¯·æ±‚"><a href="#iOS-è®¾å¤‡çš„-HTTP-è¯·æ±‚" class="headerlink" title="iOS è®¾å¤‡çš„ HTTP è¯·æ±‚"></a>iOS è®¾å¤‡çš„ HTTP è¯·æ±‚</h2><p>è·ŸæŸ¥çœ‹ PC ç«¯çš„ HTTP è¯·æ±‚æ–¹å¼åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯æ­¤æ—¶çš„æœ¬æœº ip åœ°å€æ˜¯æ‰‹æœºç«¯çš„è€Œä¸æ˜¯ pc ç«¯çš„ã€‚</p>
<p><a href="http://www.veryitman.com/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/" target="_blank" rel="noopener">åˆè¯† Wireshark</a> ä¸­å·²ç»è·Ÿå¤§å®¶åˆ†äº«è¿‡å¦‚ä½•å»è¿æ¥ iOS è®¾å¤‡åˆ° <code>Wireshark</code> æŠ“åŒ…äº†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p>
<p>è‡³äºæŸ¥çœ‹ iOS è®¾å¤‡çš„ ip åœ°å€ï¼Œå°±å¾ˆç®€å•äº†ï¼Œæ‰“å¼€ <code>è®¾ç½®/wifi</code> çœ‹ä¸€ä¸‹è¯¦æƒ…å°±çŸ¥é“äº†ã€‚</p>
<h2 id="æ˜¾ç¤ºåŸŸå"><a href="#æ˜¾ç¤ºåŸŸå" class="headerlink" title="æ˜¾ç¤ºåŸŸå"></a>æ˜¾ç¤ºåŸŸå</h2><p>å¦‚æœä½ ç»å¸¸ä½¿ç”¨ <code>Charles</code> æŠ“åŒ…ï¼Œå°±å¯ä»¥å‘ç° <code>Charles</code> å±•ç¤ºçš„è¯·æ±‚ä¸­éƒ½æ˜¯ä»¥åŸŸåæ¥æ˜¾ç¤ºçš„ï¼Œä½†æ˜¯åœ¨ <code>Wireshark</code> éƒ½æ˜¯æ˜¾ç¤º ip åœ°å€ï¼Œæˆ–è®¸å› æ­¤æ„Ÿåˆ°ä¸é€‚ï¼Œé‚£ä¹ˆï¼Œ<code>Wireshark</code> èƒ½å¦å±•ç¤ºåŸŸåå‘¢ï¼Ÿ</p>
<p><code>Wireshark</code> æ˜¯å¯ä»¥åƒ <code>Charles</code> é‚£æ ·å±•ç¤ºåŸŸåçš„ï¼Œåªæ˜¯å®ƒé»˜è®¤æ˜¾ç¤º ip åœ°å€ç½¢äº†ã€‚</p>
<p>æ‰“å¼€ Preferencesï¼Œå¦‚å›¾ï¼š<br><img src="/upload/images/2018/09/01/8.jpg" alt=""><br><img src="/upload/images/2018/09/01/9.jpg" alt=""></p>
<p>è¿™æ · <code>Wireshark</code> çš„æ˜¾ç¤ºå°±æ˜¯å¦ä¸€ç•ªæ™¯è±¡äº†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/09/01/10.jpg" alt=""></p>
<p>å½“ç„¶ï¼Œä½ ä¹Ÿçœ‹å‡ºæ¥äº†ï¼Œè¿‡æ»¤æ¡ä»¶è¿˜æ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚</p>
<p>ä½ è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–çš„è¿‡æ»¤æ¡ä»¶ï¼Œå¦‚ä¸‹é¢çš„ä¸€äº›è¿‡æ»¤æ¡ä»¶ï¼Œèƒ½å¸®ä½ å¿«é€Ÿå®šä½ä½ è¦çš„æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">http.host == &quot;veryitman.com&quot;</div><div class="line"></div><div class="line">http.host contains &quot;veryitman.com&quot;</div><div class="line"></div><div class="line">http contains &quot;HTTP/1.1 200 OK&quot;</div></pre></td></tr></table></figure>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Wireshark tcp ip udp http https </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å–åºŸå“çš„ä¸€æ¬¡ç»å†]]></title>
      <url>/2018/08/26/%E5%8D%96%E5%BA%9F%E5%93%81%E7%9A%84%E4%B8%80%E6%AC%A1%E7%BB%8F%E5%8E%86/</url>
      <content type="html"><![CDATA[<h2 id="å¶é‡"><a href="#å¶é‡" class="headerlink" title="å¶é‡"></a>å¶é‡</h2><p>è¿™ä¸¤å¤©åœ¨æ”¶æ‹¾å±‹å­ï¼Œæœ¬æ¥æƒ³æŠŠä¸€äº›ä¸é‡è¦çš„ç‰©å“ç›´æ¥å–æ‰ï¼Œçœå¾—ç»™è‡ªå·±å¢åŠ è¿è¾“æˆæœ¬ã€‚ä½†æ˜¯åˆæœ‰äº›ä¸èˆï¼Œæ¯•ç«Ÿè·Ÿè‡ªå·±åœ¨ä¸€èµ·ç”Ÿæ´»äº†è¿™ä¹ˆå¤šå¹´ï¼Œæ¯ä¸€æœ¬ä¹¦ï¼Œæ¯å¯¹æ¡Œæ¤…ï¼Œæ¯ä»¶è¡£æœéƒ½æ˜¯æˆ‘å’Œè€å©†åŠªåŠ›æŒ£é’±ä¹°å›æ¥çš„ï¼Œé‡Œé¢éƒ½åŒ…å«ç€å¥‹æ–—çš„æ•…äº‹ã€‚</p>
<p>è¯åˆè¯´å›æ¥ï¼Œæ— èˆæ— å¾—ã€‚äºæ˜¯ï¼Œæˆ‘å°±å¼€å§‹å°†ç‰©å“åˆ†ç±»ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§æŒ‘é€‰ï¼Œé‡è¦çš„ä¸œè¥¿å°±æ”¾åˆ°ç®±å­ä¸­ï¼Œæ¬¡è¦çš„å°±æ”¾åˆ°æ²™å‘ä¸Šï¼Œä¸é‡è¦çš„å°±æ‰”åˆ°å¤§å…é‡Œï¼Œæœ€åå†æ¥å®¡è§†ä¸€éè¿™äº›ä¸é‡è¦çš„ç‰©å“æ˜¯å¦è¿˜æœ‰ç•™ä¸‹æ¥çš„å¿…è¦ï¼Œæœ€ç»ˆæˆ‘æŠŠä¸é‡è¦çš„ä¸œè¥¿æ”¾åˆ°ä¸€ä¸ªå¤§è¢‹å­ä¸­ï¼Œå‡†å¤‡æŠŠå®ƒä»¬å–ç»™åºŸå“ç«™ã€‚</p>
<p>åœ¨ç™¾åº¦ä¸Šé¢æ‰¾äº†å¥½å‡ å®¶é™„è¿‘æ”¶åºŸå“çš„ï¼Œæ‰“ç”µè¯è¿‡å»éƒ½è¦æ±‚å–å®¶è‡ªå·±æŠŠä¸œè¥¿æ‹¿è¿‡å»ï¼Œæ€åº¦ååˆ†ä¸å‹å¥½ï¼Œæˆ‘ä¹Ÿå°±æ²¡å†å¤šé—®ï¼Œå°±æŒ‚æ‰äº†ç”µè¯ã€‚</p>
<p>æ— ç‹¬æœ‰å¶ï¼Œä¸­åˆä¸‹æ¥¼å»ä¹°ä¸œè¥¿å›æ¥çš„æ—¶å€™ï¼Œæ­£å¥½çœ‹åˆ°ä¸€ä¸ªå¤§çˆ·éª‘ç€ä¸‰è½®è½¦åœ¨æˆ‘å‰é¢é©°éª‹ï¼Œå¤§çˆ·çš„è½¦æŠ€è´¼æºœï¼Œåœ¨å°å··å­ä¸­å¼€å‡ºäº†èµ›è½¦çš„æ„Ÿè§‰ã€‚è¿˜æ²¡ç­‰æˆ‘å¼ å˜´ï¼Œä»–å°±å³å°†è¦ç¦»å¼€æˆ‘çš„è§†çº¿ï¼Œæ€¥ä¸­ç”Ÿæ™ºï¼Œæˆ‘çœ‹åˆ°ä»–è½¦å­åé¢ç•™æœ‰ç”µè¯ï¼Œäºæ˜¯æˆ‘å°±æ€¥å¿™çš„åŠªåŠ›çš„è¿½èµ¶ç€å»è®°ä½ä»–çš„ç”µè¯ï¼Œæœ€åè¿«ä¸åŠå¾…çš„æ”¾ä¸‹æ‰‹ä¸­çš„ä¸œè¥¿ï¼Œæ‹¿å‡ºæ‰‹æœºæ‹¨æ‰“äº†ä»–çš„ç”µè¯ã€‚</p>
<p>å¤§çˆ·åŠäº‹åˆ©è½ï¼Œä¸ä¸€ä¼šå°±åˆ°äº†æ¥¼ä¸‹ï¼Œä¸‰ä¸‹äº”é™¤äºŒçš„æŠŠåºŸå“æ”¶æ‹¾äº†ä¸€ç•ªï¼Œåƒæ˜¯æ”¶è·äº†ä¸€æ‰¹æˆ˜åˆ©å“ä¸€æ ·ã€‚ä»–å¾ˆæƒŠè¯§ä¸ºä»€ä¹ˆæˆ‘çŸ¥é“ä»–çš„ç”µè¯ï¼Œæˆ‘è¯´æˆ‘çœ‹åˆ°äº†ä½ è½¦ä¸Šçš„ç”µè¯å·ç äº†ï¼Œå°±è®°ä¸‹æ¥äº†ã€‚</p>
<p>å¤§çˆ·è¯´ï¼šâ€œå°ä¼™å­ï¼Œä½ çš„è®°æ€§è¿˜çœŸå¥½ï¼Œä¸æ„§æ˜¯ä¸Šè¿‡å¤§å­¦çš„äººã€‚â€œï¼Œæˆ‘è¯´ï¼šâ€œæ˜¯å‘€ï¼Œæˆ‘è¿‡ç›®ä¸å¿˜ï¼å“ˆå“ˆï¼â€ã€‚</p>
<p>é‚£å¤©ä¸­åˆï¼Œæˆ‘æŠŠä¸œè¥¿åŠå–åŠé€çš„éƒ½ç»™è¿™ä½å¤§çˆ·äº†ï¼Œè°å«ä»–å¤¸æˆ‘å‘¢ï¼</p>
<h2 id="æ€é‡"><a href="#æ€é‡" class="headerlink" title="æ€é‡"></a>æ€é‡</h2><p>ä¸Šé¢è¿™ä»¶äº‹ç®—ä¸ä¸Šä»€ä¹ˆå¤§äº‹ï¼Œé¡¶å¤šä¹Ÿå°±ç®—ä¸ªé¸¡æ¯›è’œçš®çš„å°äº‹ï¼Œä½†æ˜¯ç»™äº†æˆ‘å¾ˆå¤šå›å¿†å’Œæ€è€ƒã€‚</p>
<p>å¾ˆå¤šé«˜ä¸­ç”Ÿä¹ŸåŒ…æ‹¬ä»–ä»¬çš„å®¶é•¿ä»¬ï¼Œéƒ½ç»å¸¸ä¼šè¯´ç­‰ä¸Šäº†å¤§å­¦å°±å¥½äº†ï¼Œä¸ç”¨é‚£ä¹ˆç´¯äº†ï¼Œåœ¨å¤§å­¦çš„æ®¿å ‚é‡Œå¯ä»¥æ— å¿§æ— è™‘çš„ <code>äº«å—</code> äº†ã€‚åœ¨æˆ‘çœ‹æ¥è¿™æ˜¯ä¸å¯¹çš„ï¼Œé«˜ä¸­ä¹‹æ‰€ä»¥ç´¯æ˜¯å› ä¸ºæœ‰è¿ç»µä¸ç»çš„ä½œä¸šå’Œæ²¡æœ‰å°½å¤´çš„è€ƒè¯•ï¼Œå½“ç„¶è¿˜æœ‰ç­ä¸»ä»»å–‹å–‹ä¸ä¼‘çš„æ•™å¯¼ï¼Œè®©ä½ çš„ç¥ç»æ—¶é•¿å¤„äºç´§ç»·çš„çŠ¶æ€ã€‚é«˜ä¸­æ˜¯äººç”Ÿä¸­å¿…ç»çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œè‡³å°‘æˆ‘è§‰å¾—å®ƒé”»ç‚¼äº†æˆ‘çš„æ„å¿—å’Œè€åŠ›ï¼ŒåŒ…æ‹¬å¯¹å¿ƒç†ä¸Šçš„è€ƒéªŒï¼Œæˆ‘å¾ˆæ„Ÿæ¿€é«˜ä¸­ä¸‰å¹´çš„ç”Ÿæ´»ã€‚</p>
<p>å¤§å­¦ç”Ÿæ´»å’Œå­¦ä¹ çš„ç¡®æ˜¯ä¸€ä¸ªå€¼å¾—å‘å¾€å’Œæƒ³è±¡çš„ï¼Œä½ å¯ä»¥åŠå„¿éƒå½“çš„è¿‡å®Œå‡ å¹´å¤§å­¦ç”Ÿæ´»ï¼Œä¹Ÿå¯ä»¥åŠªåŠ›æ‹¼æè¿‡æ¥ï¼Œæ²¡æœ‰äººé€¼ä½ å»æ€ä¹ˆåšï¼Œå®Œå…¨å–å†³äºä½ è‡ªå·±ã€‚</p>
<p>æˆ‘å¤§å­¦çš„æˆç»©ç®—æ˜¯ä¼˜å¼‚ï¼Œæ¯æ¬¡çœ‹åˆ°å¥–å­¦é‡‘åå•ä¸Šæœ‰è‡ªå·±çš„åå­—ï¼ŒåŒå­¦ä»¬éƒ½ä¼šè¯´ä½ çœŸå‰å®³ï¼Œå±…ç„¶è€ƒè¿™ä¹ˆå¥½çš„æˆç»©ã€‚æˆ‘ä¼šè¯´ï¼Œå¦‚æœä½ å†åŠªåŠ›ä¸€ä¸‹è‚¯å®šæ¯”æˆ‘è€ƒçš„æ›´å¥½ï¼Œå°±åƒé‚£ä¸ªå¤§çˆ·è¯´æˆ‘å¥½è®°æ€§ä¸€æ ·ï¼Œå…¶å®å¹¶ä¸æ˜¯æˆ‘è¿‡ç›®ä¸å¿˜ï¼Œè€Œæ˜¯è‡ªå·±åŠªåŠ›çš„ç»“æœï¼Œå› ä¸ºæˆ‘çŸ¥é“è‡ªå·±å¹¶ä¸æ˜¯å¤©æ‰ã€‚</p>
<p>å¾ˆå¤šäººè¿›å…¥ç¤¾ä¼šå‚åŠ å·¥ä½œåï¼Œå‘ç°å·¥ä½œå¹¶ä¸æ˜¯æƒ³è±¡ä¸­çš„é‚£èˆ¬ä¸€å¸†é£é¡ºï¼Œè‡ªå·±ä¸€èµ·è¿›å…¬å¸çš„åŒäº‹ï¼Œæ˜æ˜èƒ½åŠ›å’Œè‡ªå·±ç›¸å½“ç”šè‡³è¿˜ä¸å¦‚è‡ªå·±ï¼Œä¸ºä»€ä¹ˆåˆ«äººå°±å‡èŒåŠ è–ªï¼Œé©¬ä¸Šå°±è¦èµ°ä¸Šäººç”Ÿå·…å³°äº†ï¼Œè‡ªå·±å´è¿˜æ˜¯åŸåœ°è¸æ­¥æˆ–è€…ä¸¾æ­¥ç»´è‰°å‘¢ï¼Ÿæ€»æ˜¯æƒ³ä¸æ˜ç™½è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Œé‚£æ˜¯å› ä¸ºä½ è‡ªå·±æ²¡æœ‰çœ‹åˆ°åˆ«äººæ¯”ä½ æ›´åŠ åŠªåŠ›ã€‚</p>
<p>è¿˜æœ‰ä¸å°‘äººä¼šæŠ±æ€¨ä¸ºä»€ä¹ˆåˆ«äººèƒ½åŠ›æ²¡æœ‰æˆ‘å¼ºï¼Œé¢†å¯¼ååæŠŠä¸€äº›é‡è¦çš„äº‹æƒ…äº¤ç»™äº†ä»–ï¼Œå¼€å§‹æ€€ç–‘å¯¹æ–¹æ˜¯ä¸æ˜¯å¯¹é¢†å¯¼æ–½äº†ä»€ä¹ˆé­”æ³•ï¼Œè€Œè‡ªå·±ä»æ¥éƒ½æ²¡æœ‰æƒ³è¿‡æ€ä¹ˆå»å‘å¯¹æ–¹è¯·æ•™ï¼Œæˆ–è€…æ€è€ƒè‡ªå·±æ˜¯ä¸æ˜¯çœŸçš„åšå¥½äº†æœ¬èŒå·¥ä½œã€‚</p>
<p><strong><em>è¿™ä»¶å°äº‹ç»™äº†æˆ‘å‡ ä¸ªå¯å‘ï¼š</em></strong></p>
<p><strong>1. ä¸€å®šè¦ç»™è‡ªå·±æ ‘ç«‹ä¸€ä¸ªé•¿è¿œç›®æ ‡å’ŒçŸ­æœŸç›®æ ‡ï¼Œä¸æ–­çš„å®ŒæˆçŸ­æœŸç›®æ ‡ï¼Œå‘é•¿è¿œç›®æ ‡å‰è¿›ã€‚</strong></p>
<p><strong>2. å¯¹äºåˆ«äººçš„èµç¾æˆ–æ˜¯è¯‹æ¯ï¼Œè¦ä¿æŒä¸€é¢—å¹³å¸¸å¿ƒï¼Œæˆ’éª„æˆ’èºã€‚</strong></p>
<p><strong>3. ä¸è¦æ€»æ˜¯å¤¸ä½ çš„å­©å­èªæ˜ï¼Œè¦å¤¸ä»–æ¯”åˆ«äººæ›´åŠªåŠ›ï¼Œå› ä¸ºåŠªåŠ›æ¯”èªæ˜æ›´é‡è¦ã€‚</strong></p>
<p><strong>4. ä¸è¦æ€»æ˜¯æŠ±æ€¨å‘½è¿çš„ä¸å…¬ï¼Œå¤šå»å®¡è§†è‡ªå·±çš„ä¸è¶³ï¼Œæƒ³åŠæ³•å»è¡¥å…¨ã€‚</strong></p>
<p><strong>5. æœ‰ä¸ªå¯ä»¥äº¤å¿ƒçš„æœ‹å‹å°¤ä¸ºé‡è¦ï¼Œå¯ä»¥è®©å½¼æ­¤æ•å¼€å¿ƒæ‰‰ï¼Œæ— æ‰€é¡¾å¿Œçš„äº¤è°ˆã€‚</strong></p>
<p>è¿™ä¸ªä¸–ä¸Šæ²¡æœ‰å…è´¹çš„åˆé¤ï¼Œä¸€åˆ‡éƒ½è¦é ä½ è‡ªå·±å»å¥‹æ–—å»äº‰å–ï¼Œæœºä¼šæ€»æ˜¯ç•™ç»™æœ‰å‡†å¤‡çš„äººï¼ŒåšæŒè‡ªå·±çš„ç›®æ ‡ä¸€ç›´å‰è¡Œï¼Œç›¸ä¿¡è‡ªå·±ï¼Œæœºä¼šæ€»æœ‰ä¸€å¤©ä¼šå’Œä½ ä¸æœŸè€Œé‡ã€‚</p>
<p>ç›¸ä¿¡æ€»æœ‰ä¸€å¤©ï¼Œä½ ä¼šæ„Ÿæ¿€æ­£åœ¨åŠªåŠ›çš„è‡ªå·±ï¼</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç”Ÿæ´» æ„Ÿæ‚Ÿ å­¦ä¹  é˜…è¯» </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åˆè¯† Wireshark]]></title>
      <url>/2018/08/20/%E5%88%9D%E8%AF%86-Wireshark/</url>
      <content type="html"><![CDATA[<p><a href="http://www.veryitman.com/2017/07/23/%E4%BD%BF%E7%94%A8-Charles/" target="_blank" rel="noopener">ä½¿ç”¨ Charles</a> ä»‹ç»äº†åœ¨ MacOS ä¸Šé¢çš„ä½¿ç”¨ <code>Charles</code> å·¥å…·, è™½ç„¶ <code>Charles</code> å¾ˆä¸é”™, ä½†æ˜¯å…¶åªèƒ½æŠ“ HTTP/HTTPS çš„åŒ…, å¯¹ TCPã€UDP ç­‰å…¶ä»–åè®®çš„ç½‘ç»œåŒ…, çˆ±è«èƒ½åŠ©ã€‚</p>
<p>ä»Šå¤©ç»™å¤§å®¶åˆ†äº«å¼ºå¤§çš„ç½‘ç»œæŠ“åŒ…å·¥å…· <code>Wireshark</code>ï¼Œç®—æ˜¯åˆæ­¥è®¤è¯†ä¸€ä¸‹è¿™ä¸ªå·¥å…·ï¼Œåç»­åˆ†äº«æ›´å¤šå…³äº <code>Wireshark</code> çš„å†…å®¹ã€‚</p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>Wireshark</code> æ˜¯å…è´¹çš„ï¼Œæ”¯æŒ Windowsã€MacOS å’Œ Linuxï¼Œæä¾›ä¸°å¯Œçš„ GUI äº¤äº’ï¼Œèƒ½åˆ†ææ‰€æœ‰çš„ç½‘ç»œåè®®ï¼Œå¹¶ä¸”æ˜¯å¼€æºçš„ã€‚</p>
<p><img src="/upload/images/2018/08/20/1.jpg" alt=""></p>
<p>æŒæ¡å¥½ <code>Wireshark</code>ï¼Œèƒ½å¯¹ç»å¤§éƒ¨åˆ†çš„ç½‘ç»œåè®®è¿›è¡Œåˆ†æäº†ï¼Œæ‰€ä»¥å­¦ä¹ å®ƒçš„ä½¿ç”¨å¯¹ä½ çš„å·¥ä½œä¸æ— è£¨ç›Šã€‚</p>
<p>å…³äº <code>Wireshark</code> æœ¬èº« UIï¼ˆå±•ç¤ºçš„ç•Œé¢å†…å®¹ï¼‰ çš„éƒ¨åˆ†ä¸åœ¨æœ¬æ–‡çš„è®¨è®ºèŒƒå›´å†…ï¼Œæ›´å¤šå…³äº <code>Wireshark</code> çš„ä»‹ç»å’Œç‰¹æ€§ï¼Œå¯ä»¥å» <a href="https://www.wireshark.org/" target="_blank" rel="noopener">Wireshark å®˜ç½‘</a> æŸ¥é˜…ã€‚</p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>æˆ‘çš„ MacOS ç‰ˆæœ¬:<br><img src="/upload/images/2018/08/20/2.jpg" alt=""></p>
<p>ç‚¹å‡» <code>Wireshark</code> çš„ <a href="https://www.wireshark.org/download.html" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a>, å¯ä»¥å»ä¸‹è½½å¯¹åº”çš„å¹³å°ç‰ˆæœ¬ã€‚</p>
<p><img src="/upload/images/2018/08/20/3.jpg" alt=""></p>
<blockquote>
<p>æ³¨æ„: ä¹‹å‰çš„ Mac ç³»ç»Ÿç‰ˆæœ¬å¯èƒ½éœ€è¦å®‰è£… <code>x11</code>, ç°åœ¨æ–°ç³»ç»Ÿä¸éœ€è¦å®‰è£…äº†.</p>
</blockquote>
<h2 id="æŠ“-iOS-è®¾å¤‡çš„æ•°æ®åŒ…"><a href="#æŠ“-iOS-è®¾å¤‡çš„æ•°æ®åŒ…" class="headerlink" title="æŠ“ iOS è®¾å¤‡çš„æ•°æ®åŒ…"></a>æŠ“ iOS è®¾å¤‡çš„æ•°æ®åŒ…</h2><p>æƒ³æŠ“ iOS è®¾å¤‡çš„ç½‘ç»œæ•°æ®ï¼Œéœ€è¦è®© iOS è®¾å¤‡æ•°æ®é€šè¿‡ MacOS æ‰è¡Œï¼Œå› ä¸º <code>Wireshark</code> æ˜¯é’ˆå¯¹ç½‘å£è¿›è¡ŒæŠ“åŒ…çš„ã€‚</p>
<p>å½“ç„¶äº†ï¼Œä½ çš„ iOS è®¾å¤‡ä¸éœ€è¦è¶Šç‹±.</p>
<p>é€šè¿‡ usb è¿æ¥ iOS è®¾å¤‡åï¼Œæ¥ä¸‹æ¥åˆ›å»ºè¿œç¨‹è™šæ‹Ÿæ¥å£ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rvictl -s è®¾å¤‡id(udid)</div></pre></td></tr></table></figure>
<blockquote>
<p>rvictl å³ Remote Virtual Interface Toolã€‚å®ƒå¯ä»¥é€šè¿‡ iOS è®¾å¤‡çš„ UDID åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œç„¶åé€šè¿‡è¿™ä¸ªè™šæ‹Ÿç½‘å¡ç›‘å¬è®¾å¤‡ä¸Šæ‰€æœ‰çš„ç½‘ç»œæµé‡ã€‚</p>
</blockquote>
<p>æ‰§è¡ŒæˆåŠŸåï¼ŒMac ä¼šå‡ºç°ä¸€ä¸ªå¯¹åº”çš„è™šæ‹Ÿç½‘ç»œæ¥å£ï¼Œåå­—æ˜¯ rvi0ï¼ˆå¦‚æœæœ‰å¤šä¸ª iOS è®¾å¤‡ï¼Œ åˆ™ç´¯åŠ ï¼Œrvi1ï¼Œrvi2â€¦ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/08/20/4.jpg" alt=""></p>
<p>åªè¦å¯åŠ¨ <code>Wireshark</code>ï¼Œç›‘å¬ rvi0 æ¥å£å°±èƒ½æŠ“åˆ° iOS è®¾å¤‡çš„æ•°æ®äº†ã€‚</p>
<blockquote>
<p>å…³äºè·å– iOS è®¾å¤‡ ID(UDID)ï¼Œå¯ä»¥ä½¿ç”¨ Xcode, åœ¨ <code>Window/Devices and Simulators</code> ä¸­é€‰æ‹©ç›¸åº”è®¾å¤‡ï¼Œå³é¢è®¾å¤‡ä¿¡æ¯çš„ identifier é‡Œå°±æ˜¯å¯¹åº”çš„ UDID. ä¹Ÿå¯ä»¥é€šè¿‡ iTunes æˆ–è€…ç¬¬ä¸‰æ–¹å·¥å…·å¦‚ iTools è·å–.</p>
</blockquote>
<p>ä½ å¯ä»¥å®‰è£… <code>ideviceinstaller</code> æ¥æŸ¥çœ‹è®¾å¤‡ ID.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install ideviceinstaller</div></pre></td></tr></table></figure>
<p>ç„¶åæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">idevice_id -l</div></pre></td></tr></table></figure>
<p>ä»¥æŠ“å–ä¸‹é¢çš„ä¸€ä¸ª HTTP è¯·æ±‚ä¸ºä¾‹ï¼Œç®€å•è¯´æ˜ä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ã€‚</p>
<p>GET è¯·æ±‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/news/detailV3.html?id=1279391&amp;COMMON_ACCESS_TOKEN=(null)&amp;COMMON_ACCESS_TOKEN_SECRET=(null)&amp;_cT=IOS&amp;_cV=3.1.3&amp;_cA=PM</div></pre></td></tr></table></figure>
<p>çœ‹è¿”å›ç»“æœï¼Œé€‰ä¸­ Rsponse(200 OK) å³é”®, Follow/HTTP Streamï¼Œå¦‚å›¾æ‰€ç¤ºï¼š<br><img src="/upload/images/2018/08/20/5.jpg" alt=""></p>
<p>åœ¨å¼¹å‡ºçš„çª—å£ä¸­å°±å¯ä»¥çœ‹åˆ°å…·ä½“çš„å“åº”å†…å®¹ï¼Œä»¥åŠå“åº”çš„ json æ•°æ®ã€‚</p>
<h2 id="è¿‡æ»¤å™¨è¿‡æ»¤"><a href="#è¿‡æ»¤å™¨è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤å™¨è¿‡æ»¤"></a>è¿‡æ»¤å™¨è¿‡æ»¤</h2><p>åœ¨ <code>Wireshark</code> ä¸­æ˜¾ç¤ºè¿‡æ»¤å™¨ä¼šæ˜¾ç¤ºå¾ˆå¤šå½“å‰ç½‘ç»œçš„æ•°æ®åŒ…ï¼Œå¦‚æœä½ æƒ³çœ‹æŒ‡å®šè§„åˆ™çš„æ•°æ®åŒ…æ€ä¹ˆåŠï¼Ÿ</p>
<p>åˆ«æ‹…å¿ƒï¼Œ<code>Wireshark</code> ç»™æˆ‘ä»¬æä¾›äº†è¿‡æ»¤åŠŸèƒ½ï¼ŒæŒ‰ç…§ä¸€å®šçš„è¿‡æ»¤è§„åˆ™å°±å¯ä»¥è¾¾åˆ°ä½ çš„ç›®çš„ã€‚</p>
<p><strong>1. ç½‘ç»œåè®®è¿‡æ»¤</strong></p>
<p>æ¯”å¦‚ TCPï¼Œåªæ˜¾ç¤º TCP åè®®ï¼ŒHTTP åªæ˜¾ç¤º HTTP åè®®ç­‰ã€‚åœ¨è¿‡æ»¤å™¨è¾“å…¥æ¡†ä¸­ç›´æ¥è¾“å…¥åè®®åç§°å³å¯ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
<p><strong>2. IP åœ°å€è¿‡æ»¤</strong></p>
<p>å¦‚ ip.src == 192.168.1.102 æ˜¾ç¤ºæºåœ°å€ä¸º <code>192.168.1.102</code>ï¼Œ<br>è€Œ ip.dst == 192.168.1.102, ç›®æ ‡åœ°å€ä¸º <code>192.168.1.102</code>ã€‚</p>
<p><strong>3. ç«¯å£è¿‡æ»¤</strong></p>
<p>tcp.port == 80, ç«¯å£ä¸º 80 çš„</p>
<p>tcp.srcport == 80, åªæ˜¾ç¤º TCP åè®®çš„åŸç«¯å£ä¸º 80 çš„ã€‚</p>
<p><strong>4. Http æ¨¡å¼è¿‡æ»¤</strong></p>
<p>http.request.method == â€œGETâ€ï¼Œåªæ˜¾ç¤º HTTP GET æ–¹æ³•çš„ã€‚</p>
<p><strong>5. ç»“åˆé€»è¾‘è¿ç®—ç¬¦ AND/OR ç»„æˆå¤æ‚çš„è¡¨è¾¾å¼</strong></p>
<blockquote>
<p>AND/OR ä¹Ÿå¯ä»¥å†™æˆ <code>&amp;&amp;</code> / <code>||</code></p>
</blockquote>
<p>ä¸‹é¢ä¸¾å‡ ä¸ªå¸¸ç”¨çš„ç¤ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">//æºåœ°å€æˆ–è€…ç›®æ ‡åœ°å€æ˜¯192.168.1.103</div><div class="line">ip.src == 192.168.1.103 or ip.dst == 192.168.1.103</div><div class="line"></div><div class="line">//æ˜¾ç¤ºæ‰€æœ‰ç›®æ ‡æˆ–æºåœ°å€æ˜¯192.168.1.1çš„æ•°æ®åŒ…</div><div class="line">ip.addr == 192.168.1.1 </div><div class="line"></div><div class="line">//æ˜¾ç¤ºç›®æ ‡åœ°å€æ˜¯192.168.1.1çš„æ•°æ®åŒ…</div><div class="line">ip.dst == 192.168.1.1 </div><div class="line"></div><div class="line">//æ˜¾ç¤ºæºåœ°å€æ˜¯192.168.1.1çš„æ•°æ®åŒ…</div><div class="line">ip.src == 192.168.1.1 </div><div class="line"></div><div class="line">//tcp è¿æ¥ç«¯å£ä¸º9101çš„æ•°æ®åŒ…</div><div class="line">tcp.port == 9101</div></pre></td></tr></table></figure>
<p>æ›´å¤šçš„è¿‡æ»¤è§„åˆ™å¯ä»¥å» <a href="https://www.wireshark.org/docs/man-pages/wireshark-filter.html" target="_blank" rel="noopener">å®˜æ–¹æ‰‹å†Œ</a> å’Œ <a href="https://wiki.wireshark.org/CaptureFilters" target="_blank" rel="noopener">CaptureFilters</a> æŸ¥é˜…å’Œå­¦ä¹ ã€‚</p>
<h2 id="ç¾ä¸­ä¸è¶³"><a href="#ç¾ä¸­ä¸è¶³" class="headerlink" title="ç¾ä¸­ä¸è¶³"></a>ç¾ä¸­ä¸è¶³</h2><p><code>Wireshark</code> åªèƒ½æŸ¥çœ‹å°åŒ…ï¼Œè€Œä¸èƒ½ä¿®æ”¹å°åŒ…çš„å†…å®¹ï¼Œæˆ–è€…å‘é€å°åŒ…ã€‚</p>
<p>å¯¹äº HTTPã€HTTPS ç½‘ç»œå°åŒ…ï¼Œ<code>Wireshark</code> éƒ½å¯ä»¥æ•è·ï¼Œ ä½†ä¸èƒ½ç›´æ¥è§£å¯† HTTPSï¼Œæ‰€ä»¥æƒ³ä½¿ç”¨ <code>Wireshark</code> æ¥åˆ†æ HTTPS åŒ…ä¸­çš„å†…å®¹ï¼Œéœ€è¦å»é¢å¤–é…ç½®ï¼Œè¾ƒéº»çƒ¦ï¼Œåç»­ç ”ç©¶å†åˆ†äº«ç»™å¤§å®¶ã€‚</p>
<p>æ‰€ä»¥å»ºè®®å¤§å®¶ï¼Œåˆ†æ HTTP/HTTPS å»ä½¿ç”¨å„è‡ªå¹³å°ä¸Šé¢çš„å…¶ä»–å·¥å…·ï¼Œ å¦‚ <code>Fiddler</code> å’Œ <code>Charles</code> ç­‰ä¼˜ç§€çš„æŠ“åŒ…å·¥å…·ã€‚</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Wireshark tcp ip udp http https </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[é…ç½® php7 + Nginx]]></title>
      <url>/2018/08/19/%E9%85%8D%E7%BD%AE-php7-Nginx/</url>
      <content type="html"><![CDATA[<h2 id="PHP7"><a href="#PHP7" class="headerlink" title="PHP7"></a>PHP7</h2><p>ä¹‹å‰ä¸ºäº†é…åˆå®Œæˆä¸€ä¸ªé¡¹ç›®ï¼ˆPHP ç‰ˆæœ¬ä¸º5.6ï¼‰ï¼Œåœ¨æœ¬æœºæ­å»ºäº† PHP56 çš„ç¯å¢ƒï¼Œåé¢è‡ªå·±ç³»ç»Ÿå‡çº§ä¸º <code>macOS High Sierra</code>ï¼Œå‘ç°ç³»ç»Ÿè‡ªå¸¦çš„ PHP ç‰ˆæœ¬å·²ç»æ˜¯ 7.1 äº†ï¼Œäºæ˜¯å°±å¼€å§‹ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ PHP ç‰ˆæœ¬äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php -v</div></pre></td></tr></table></figure>
<p>æ˜¾ç¤º PHP ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">PHP 7.1.16 (cli) (built: Apr  1 2018 13:14:42) ( NTS )</div><div class="line">Copyright (c) 1997-2018 The PHP Group</div><div class="line">Zend Engine v3.1.0, Copyright (c) 1998-2018 Zend Technologies</div></pre></td></tr></table></figure>
<p>ç³»ç»Ÿè‡ªå¸¦çš„ PHP7.1 æ²¡æœ‰é»˜è®¤çš„ <code>php.ini</code> æ–‡ä»¶ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥æ‰¾ä¸€ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php -r &quot;echo php_ini_loaded_file();&quot;</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶å¹¶æ²¡æœ‰æ‰“å°å¯¹åº”çš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»å¤åˆ¶ä¸€ä»½ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo cp /private/etc/php.ini.default /private/etc/php.ini</div></pre></td></tr></table></figure>
<p>å†æ¬¡æ‰§è¡Œä¸Šé¢å‘½ä»¤ï¼Œå³å¯çœ‹åˆ°é…ç½®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„äº†ã€‚æˆ–è€…æ‰§è¡Œ <code>php --ini</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">php --ini</div><div class="line"></div><div class="line">Configuration File (php.ini) Path: /etc</div><div class="line">Loaded Configuration File:         /etc/php.ini</div><div class="line">Scan for additional .ini files in: (none)</div><div class="line">Additional .ini files parsed:      (none)</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼Œ<code>php.ini</code> æ–‡ä»¶å¤åˆ¶æˆåŠŸåï¼Œéœ€è¦ä¸‹é¢ä¸¤æ­¥æ“ä½œï¼Œå¦åˆ™åœ¨ php ä»£ç å‘ç”Ÿè‡´å‘½é”™è¯¯çš„æ—¶å€™ï¼Œé¡µé¢ä¸ä¼šè¾“å‡ºä»»ä½•å†…å®¹ï¼Œåªæ˜¯æŠ¥ <code>HTTP ERROR 500</code> çš„é”™è¯¯ã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼Œä¿®æ”¹ <code>php.ini</code> æ–‡ä»¶çš„æƒé™ï¼Œå¦åˆ™æ— æ³•ç¼–è¾‘ä¿å­˜ï¼Œé»˜è®¤æ˜¯åªè¯»å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod 777 /private/etc/php.ini</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥ï¼Œç¼–è¾‘ <code>php.ini</code> æ–‡ä»¶ï¼Œå°† <code>display_errors = Off</code> æ”¹ä¸ºä¸‹é¢ <code>on</code> å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display_errors = On</div></pre></td></tr></table></figure>
<p>è®°å¾—æ¯æ¬¡ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶ï¼Œéœ€è¦é‡å¯ <code>php-fpm</code> å’Œ <code>nginx</code> æœåŠ¡ã€‚</p>
<h2 id="PHP56"><a href="#PHP56" class="headerlink" title="PHP56"></a>PHP56</h2><p><strong>1. å®‰è£… PHP56</strong> </p>
<p>å¯ä»¥å‚è€ƒä¸‹é¢ä¸¤ç¯‡æ–‡ç« ã€‚</p>
<ul>
<li><p><a href="http://www.veryitman.com/2017/02/02/PHP-%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" target="_blank" rel="noopener">PHPå¼€å‘å‡†å¤‡</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2017/02/02/%E5%AE%89%E8%A3%85-PHP-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">å®‰è£… PHP é‡åˆ°çš„é—®é¢˜</a></p>
</li>
</ul>
<p><strong>2. å¸è½½ï¼ˆåˆ é™¤ï¼‰PHP56</strong></p>
<p>æ‰§è¡Œ brew uninstall </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew uninstall php</div></pre></td></tr></table></figure>
<p>å³å¯å®Œæˆå¸è½½ã€‚</p>
<p>å¦‚æœå¸è½½é‡åˆ°é—®é¢˜ï¼Œå°±æ‰“å¼€ <code>/usr/local/Cellar/</code> ç›®å½•ï¼Œåˆ é™¤å¯¹åº”çš„ PHP ç›®å½•å³å¯ã€‚</p>
<h2 id="é…ç½®-php-fpm"><a href="#é…ç½®-php-fpm" class="headerlink" title="é…ç½® php-fpm"></a>é…ç½® php-fpm</h2><p>ç°åœ¨æ–°ç‰ˆæœ¬çš„ PHP å…¶å†…æ ¸å·²ç»é›†æˆäº† php-fpmï¼Œæˆ‘ä»¬ä¸éœ€è¦å¦å¤–å®‰è£…äº†ã€‚</p>
<p>é…ç½® php-fpm é…ç½®æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo cp /private/etc/php-fpm.conf.default /private/etc/php-fpm.conf</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /private/etc/php-fpm.conf</div></pre></td></tr></table></figure>
<p>æ‰¾åˆ° error_log é¡¹ï¼Œæ·»åŠ ä¸‹é¢ä¸¤ä¸ªé…ç½®é¡¹ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">error_log = /usr/local/var/log/php-fpm.log</div><div class="line">pid = /usr/local/var/run/php-fpm.pid</div></pre></td></tr></table></figure>
<p>å¦‚æœä¸é…ç½®ä¸Šé¢çš„é…ç½®é¡¹ï¼Œå¯åŠ¨ php-fpm ä¼šæŠ¥é”™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ERROR: failed to open error_log (/usr/var/log/php-fpm.log): No such file or directory (2)</div><div class="line">ERROR: failed to post process the configuration</div><div class="line">ERROR: FPM initialization failed</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥, ç»§ç»­é…ç½®ï¼Œå°† <code>www.conf.default</code> å¤åˆ¶ä¸€ä»½å‘½åä¸º <code>www.conf</code> å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /private/etc/php-fpm.d/</div><div class="line"></div><div class="line">sudo cp www.conf.default www.conf</div></pre></td></tr></table></figure>
<p>ä¸é…ç½®ä¸Šé¢çš„ï¼Œä¼šæŠ¥å¦‚ä¸‹é”™è¯¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ERROR: No pool defined. at least one pool section must be specified in config file</div><div class="line">ERROR: FPM initialization failed</div></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œå¯ä»¥å¯åŠ¨ php-fpm äº†ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo php-fpm -D</div></pre></td></tr></table></figure>
<p>ä¸å‡ºæ„å¤–çš„è¯ï¼Œå·²ç»æˆåŠŸå¯åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netstat -an | grep 9000</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ åœ¨å¯åŠ¨ php-fpm é‡åˆ°ä¸‹é¢çš„é”™è¯¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ERROR: unable to bind listening socket for address &apos;127.0.0.1:9000&apos;: Address already in use (48)</div><div class="line">ERROR: FPM initialization failed</div></pre></td></tr></table></figure>
<p>æœ‰ä¸¤ç§æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜</p>
<p><strong>1.</strong>ä¿®æ”¹ php-fpm ä½¿ç”¨çš„ç«¯å£å·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /private/etc/php-fpm.d/www.conf</div></pre></td></tr></table></figure>
<p>å°† <code>listen = 127.0.0.1:9000</code> æ”¹ä¸º <code>listen = 127.0.0.1:9001</code> å³å¯ã€‚</p>
<p><strong>2.</strong>æ€æ‰9000ç«¯å£å ç”¨çš„è¿›ç¨‹</p>
<p>å…³é—­æ‰€æœ‰ä¹‹å‰å¯åŠ¨çš„ php-fpm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">killall php-fpm</div></pre></td></tr></table></figure>
<p>æ‰¾åˆ°å ç”¨ç«¯å£çš„è¿›ç¨‹å·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netstat -an | grep 9000</div></pre></td></tr></table></figure>
<p>ç„¶å <code>kill -9 pid</code>ï¼Œé‡æ–°å¯åŠ¨ php-fpm å³å¯ã€‚</p>
<h2 id="å®‰è£…å’Œé…ç½®-Nginx"><a href="#å®‰è£…å’Œé…ç½®-Nginx" class="headerlink" title="å®‰è£…å’Œé…ç½® Nginx"></a>å®‰è£…å’Œé…ç½® Nginx</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install nginx</div></pre></td></tr></table></figure>
<p>åˆ›å»ºæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mkdir -p /usr/local/var/log/nginx</div><div class="line">mkdir -p /usr/local/etc/nginx/sites-available</div><div class="line">mkdir -p /usr/local/etc/nginx/sites-enabled</div><div class="line">mkdir -p /usr/local/etc/nginx/conf.d</div><div class="line">mkdir -p /usr/local/etc/nginx/ssl</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">sudo mkdir -p /var/www</div><div class="line">sudo chown :staff /var/www</div><div class="line">sudo chmod 775 /var/www</div><div class="line">vi /var/www/info.php</div><div class="line">vi /var/www/index.html</div><div class="line">vi /var/www/403.html</div><div class="line">vi /var/www/404.html</div></pre></td></tr></table></figure>
<p>æ”¹å˜ nginx.conf é…ç½®æ–‡ä»¶</p>
<p>è¯¥é…ç½®æ–‡ä»¶åœ¨ <code>/usr/local/etc/nginx/nginx.conf</code> ä¸‹é¢.</p>
<p>æˆ‘çš„é…ç½®:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">worker_processes  1;</div><div class="line"> </div><div class="line">error_log  /usr/local/etc/nginx/logs/error.log debug;</div><div class="line">pid        /usr/local/var/run/nginx.pid;</div><div class="line"> </div><div class="line">events &#123;</div><div class="line">    worker_connections  256;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">http &#123;</div><div class="line">    include             mime.types;</div><div class="line">    default_type        application/octet-stream;</div><div class="line"> </div><div class="line">    log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</div><div class="line">                      &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</div><div class="line">                      &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</div><div class="line"> </div><div class="line">    access_log  /usr/local/etc/nginx/logs/access.log  main;</div><div class="line"> </div><div class="line">    sendfile            on;</div><div class="line"> </div><div class="line">    keepalive_timeout   65;</div><div class="line"> </div><div class="line">    index index.html index.php;</div><div class="line"> </div><div class="line">    include /usr/local/etc/nginx/sites-enabled/*; </div><div class="line">    include /usr/local/etc/nginx/conf.d/*;</div><div class="line">     server &#123;</div><div class="line">        listen       8080;</div><div class="line">        server_name  localhost;</div><div class="line">        #charset koi8-r;</div><div class="line">        #access_log  logs/host.access.log  main;</div><div class="line">        location / &#123;</div><div class="line">            root   ~/projs/phpdev/nginx/nginx_sites/; #webçš„æ ¹ç›®å½•</div><div class="line">            index  index.php index.html index.htm; #åŠ index.php</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">location / &#123;</div><div class="line">    root   ~/projs/phpdev/nginx/nginx_sites/; #webçš„æ ¹ç›®å½•</div><div class="line">    index  index.php index.html index.htm; #åŠ index.php</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é…ç½®äº†æˆ‘çš„ web ç›®å½•å’Œæ”¯æŒçš„æ–‡ä»¶.</p>
<h2 id="è¿è¡Œ-PHP"><a href="#è¿è¡Œ-PHP" class="headerlink" title="è¿è¡Œ PHP"></a>è¿è¡Œ PHP</h2><ul>
<li><p>åˆ›å»º index.php</p>
</li>
<li><p>å¯åŠ¨ php-fpm</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo php-fpm</div></pre></td></tr></table></figure>
<p>æˆ–è€…ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼æ¥å¯åŠ¨ PHP-fpm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo php-fpm -D</div></pre></td></tr></table></figure>
<ul>
<li>å¯åŠ¨ Nginx</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nginx</div></pre></td></tr></table></figure>
<ul>
<li>ç¼–è¾‘ index.php</li>
</ul>
<p>åœ¨ web ç›®å½•(æˆ‘é…ç½®çš„) <code>~/projs/phpdev/nginx/nginx_sites/</code> æ–°å»ºæ–‡ä»¶ <code>index.php</code>.</p>
<p>index.php é‡Œé¢å¯ä»¥ç¼–å†™ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;!-- lang: php --&gt;</div><div class="line">&lt;!-- ~/nginx_sites/index.php --&gt;</div><div class="line">&lt;?php</div><div class="line">    echo &quot;Hello PHP&quot;;</div><div class="line">    echo &quot;&lt;/br&gt;&quot;;</div><div class="line">    </div><div class="line">    echo &quot;å­¦ä¹  php&quot;;</div><div class="line">    echo &quot;&lt;/br&gt;&quot;;</div><div class="line">    echo phpinfo();</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>æ‰“å¼€æµè§ˆå™¨, è¾“å…¥åœ°å€ï¼š<a href="http://localhost:8080/index.php" target="_blank" rel="noopener">http://localhost:8080/index.php</a> ä½ ä¼šçœ‹åˆ°ä¸‹é¢çš„é¡µé¢:<br><img src="/upload/images/2018/08/19/1.jpg" alt=""></p>
<p>ä¹Ÿå¯ä»¥åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºå…¶ä»– PHP æ–‡ä»¶, å¦‚ <code>m.php</code> æ–‡ä»¶.</p>
<p>æµè§ˆå™¨ä¸­è¾“å…¥ <a href="http://localhost:8080/m.php" target="_blank" rel="noopener">http://localhost:8080/m.php</a> å¯ä»¥æ‰§è¡Œç›¸å¯¹åº”çš„æ–‡ä»¶.</p>
<p><strong>æ³¨æ„ï¼š</strong>è¿™é‡Œçš„ <code>m.php</code> æ˜¯æ–°å»ºçš„ PHP æ–‡ä»¶.</p>
<h2 id="é‡è¦æ–‡ä»¶"><a href="#é‡è¦æ–‡ä»¶" class="headerlink" title="é‡è¦æ–‡ä»¶"></a>é‡è¦æ–‡ä»¶</h2><p><strong>1. php é…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/private/etc/php.ini</div></pre></td></tr></table></figure>
<p><strong>2. nginx log æ–‡ä»¶</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">/usr/local/var/log/nginx/access.log</div><div class="line"></div><div class="line">/usr/local/var/log/nginx/error.log</div><div class="line"></div><div class="line">/usr/local/etc/nginx/logs/error.log</div></pre></td></tr></table></figure>
<p><strong>3. nginx é…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/etc/nginx/nginx.conf</div></pre></td></tr></table></figure>
<p><strong>4. php-fpm é…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/private/etc/php-fpm.d/www.conf</div></pre></td></tr></table></figure>
<h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><p><strong>502 bad gateaway</strong></p>
<p>æˆ‘æ˜¯ç»å¸¸çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æ¯æ¬¡å¼•èµ·çš„åŸå› åˆä¸å¤ªä¸€æ ·ï¼Œç»å¤§éƒ¨åˆ†æ˜¯å› ä¸º <code>php-fpm</code> å¯åŠ¨ä¸äº†æˆ–è€…æ˜¯å…¶ç«¯å£é”™è¯¯å¯¼è‡´çš„ã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œå»ºè®®å»çœ‹ <code>/usr/local/etc/nginx/logs/error.log</code> æ—¥å¿—æ–‡ä»¶ã€‚</p>
<p>ä¾‹å¦‚ä¸‹é¢çš„é”™è¯¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[error] </div><div class="line">61016#0: *1 kevent() reported that connect() failed (61: Connection refused) while connecting to upstream, </div><div class="line">client: 127.0.0.1, </div><div class="line">server: localhost, </div><div class="line">request: &quot;GET /3.php HTTP/1.1&quot;, </div><div class="line">upstream: &quot;fastcgi://127.0.0.1:9000&quot;, </div><div class="line">host: &quot;localhost:8080&quot;</div></pre></td></tr></table></figure>
<p>æœ€ç»ˆï¼Œæˆ‘ä¿®æ”¹äº† <code>/private/etc/php-fpm.d/www.conf</code> ä¸­ç«¯å£ä¸º <code>9000</code>ï¼ˆæˆ‘ä¹‹å‰å°†è¯¥ç«¯å£ä¿®æ”¹äº†å…¶ä»–çš„ï¼‰ï¼Œé‡å¯ <code>php-fpm</code> è§£å†³é—®é¢˜ã€‚ </p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> PHP MySql nginx php-fpm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®€å•é…ç½® Apache]]></title>
      <url>/2018/07/14/%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE-Apache/</url>
      <content type="html"><![CDATA[<h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>æœ‰æ—¶å€™, æˆ‘ä»¬å¸Œæœ›åœ¨è‡ªå·±æœ¬æœº(PC)æ­å»ºä¸€ä¸ª WebServer, ç„¶åè‡ªå·±å¯ä»¥åœ¨æµè§ˆå™¨æˆ–è€…æ‰‹æœºä¸Šé¢å¯ä»¥è®¿é—®å¯¹åº”çš„åœ°å€ç›´æ¥æŸ¥çœ‹æ•ˆæœ, å†æˆ–è€…å¸Œæœ›æµ‹è¯•ä¸‹è½½åŠŸèƒ½ç­‰, å…¶å® MacOS è‡ªå¸¦çš„æœ‰ Apache æœåŠ¡å™¨.</p>
<p>ä¸‹é¢ç®€å•åˆ†äº«ä¸€ä¸‹, åœ¨ MacOS ä¸­å¦‚ä½•ç®€å•çš„ä½¿ç”¨ Apache æœåŠ¡å™¨.</p>
<h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><p>å¸¸ç”¨çš„å‘½ä»¤æœ‰å¼€å¯/é‡å¯/åœæ­¢ç­‰.</p>
<p>1.å¼€å¯: <code>sudo apachectl start</code><br>2.é‡å¯: <code>sudo apachectl restart</code><br>3.å…³é—­: <code>sudo apachectl stop</code><br>4.æŸ¥çœ‹ç‰ˆæœ¬å·: <code>httpd -v</code></p>
<p><strong>1.æŸ¥çœ‹ Apache ç‰ˆæœ¬å·</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">httpd -v</div></pre></td></tr></table></figure>
<p>æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apachectl -v</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç»“æœå¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Server version: Apache/2.4.28 (Unix)</div><div class="line">Server built:   Oct  9 2017 19:54:20</div></pre></td></tr></table></figure>
<p><strong>2.å¯åŠ¨ Apache</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apachectl start</div></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨æ‰“å¼€: <a href="http://localhost" target="_blank" rel="noopener">http://localhost</a></p>
<p>ä¼šæ˜¾ç¤º:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">It works</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2018/07/14/1.jpg" alt=""></p>
<p><strong>3.åœæ­¢ Apache</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apachectl stop</div></pre></td></tr></table></figure>
<p>å¦‚æœæ²¡æœ‰å¼€å¯ Apache æœåŠ¡, æ‰§è¡Œä¸Šé¢å‘½ä»¤çš„è¯, ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/System/Library/LaunchDaemons/org.apache.httpd.plist: </div><div class="line">Could not find specified service</div></pre></td></tr></table></figure>
<p><strong>4.é‡æ–°å¯åŠ¨ Apache</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apachectl restart</div></pre></td></tr></table></figure>
<p>å¦‚æœä¿®æ”¹äº† Apache çš„é…ç½®æ–‡ä»¶, éœ€è¦é‡æ–°å¯åŠ¨ Apache æœåŠ¡, æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤å³å¯.</p>
<h2 id="é…ç½®-Sites"><a href="#é…ç½®-Sites" class="headerlink" title="é…ç½® Sites"></a>é…ç½® Sites</h2><p>åœ¨è‡ªå·±çš„ç”¨æˆ·ç›®å½•, æ–°å»ºä¸€ä¸ª <code>Sites</code> ç›®å½•, ä¾‹å¦‚æˆ‘çš„ç”¨æˆ·ç›®å½•æ˜¯ <code>/Users/mark</code>, å¯ä»¥åœ¨ç»ˆç«¯åˆ†åˆ«æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /Users/mark</div><div class="line"></div><div class="line">mkdir Sites</div></pre></td></tr></table></figure>
<p>æ‰§è¡ŒæˆåŠŸå, å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç›®å½•:</p>
<p><img src="/upload/images/2018/07/14/2.jpg" alt=""></p>
<p>æ¥ä¸‹æ¥ä¿®æ”¹ Apache ä¸­çš„é…ç½®æ–‡ä»¶, æ‰§è¡Œä¸‹é¢å‘½ä»¤å¼€å§‹ç¼–è¾‘ <code>httpd.conf</code> æ–‡ä»¶.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/apache2/httpd.conf</div></pre></td></tr></table></figure>
<p>æ‰“å¼€ httpd.conf æ–‡ä»¶ï¼ŒæŸ¥æ‰¾ <code>userdir</code> å…³é”®å­—.</p>
<p>æ‰¾åˆ°å¦‚ä¸‹ä¸¤è¡Œè¢«æ³¨é‡Šæ‰çš„å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#Include /private/etc/apache2/extra/httpd-userdir.conf</div><div class="line"></div><div class="line">#LoadModule userdir_module libexec/apache2/mod_userdir.so</div></pre></td></tr></table></figure>
<p>å°†å…¶å‰é¢çš„ <code>#</code>(æ³¨é‡Š) å»æ‰, ç´§æ¥ç€ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶, å¢åŠ å¦‚ä¸‹å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;Directory /Users/mark/Sites&gt;</div><div class="line">  Require all granted</div><div class="line">&lt;/Directory&gt;</div></pre></td></tr></table></figure>
<p>å°†ä¸Šé¢çš„è¿™äº›ä»£ç æ”¾åˆ°å¦‚ä¸‹ä»£ç ä¸‹é¢å³å¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;Directory &quot;/Library/WebServer/CGI-Executables&quot;&gt;</div><div class="line">    AllowOverride None</div><div class="line">    Options All</div><div class="line">    Require all granted</div><div class="line">&lt;/Directory&gt;</div></pre></td></tr></table></figure>
<p>ä¿å­˜è¯¥æ–‡ä»¶å¹¶é€€å‡º vim.</p>
<p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ä¿®æ”¹ <code>httpd-userdir.conf</code> æ–‡ä»¶:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /private/etc/apache2/extra/httpd-userdir.conf</div></pre></td></tr></table></figure>
<p>å¢åŠ å¦‚ä¸‹å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">UserDir Sites</div><div class="line"></div><div class="line">&lt;IfModule bonjour_module&gt;</div><div class="line">   RegisterUserSite customized-users</div><div class="line">&lt;/IfModule&gt;</div></pre></td></tr></table></figure>
<p><strong>æ³¨æ„:</strong> å¦‚æœåœ¨ <code>/private/etc/apache2/extra/</code> ç›®å½•ä¸‹æ²¡æœ‰è¯¥æ–‡ä»¶, æ–°å»ºä¸€ä¸ªå³å¯.</p>
<p>ä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºå³å¯.</p>
<p>æˆ‘ä»¬å¯ä»¥å°†è‡ªå·±éœ€è¦è¿è¡Œçš„ html ç­‰æ–‡ä»¶æ”¾åˆ°è¯¥ç›®å½•, å¦‚æˆ‘å°† <code>index.html</code> æ”¾åˆ°è¯¥ç›®å½•.</p>
<p>é‡æ–°å¯åŠ¨ Apache æœåŠ¡, åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>http://localhost/~mark/</code>, å¯ä»¥çœ‹åˆ° <code>index.html</code> é‡Œé¢çš„å†…å®¹.</p>
<h2 id="WebServer-ç›®å½•"><a href="#WebServer-ç›®å½•" class="headerlink" title="WebServer ç›®å½•"></a>WebServer ç›®å½•</h2><p>ä¸Šé¢æˆ‘ä»¬æåˆ°, å¯åŠ¨ Apache æœåŠ¡ä¹‹å, åœ¨æµè§ˆå™¨å¯ä»¥çœ‹åˆ° <code>It Works</code> çš„å­—æ ·, é‚£ä¹ˆè¿™ä¸ªæ˜¯å“ªä¸ªæ–‡ä»¶è¾“å‡ºçš„å‘¢?</p>
<p>è¿™ä¸ªæ–‡ä»¶æ˜¯ <code>sudo mvim index.html.en~orig</code>, åœ¨å¦‚ä¸‹ç›®å½•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/Library/WebServer/Documents</div></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨ vim ç¼–è¾‘è¯¥æ–‡ä»¶, ç„¶åå†åˆ·æ–°æµè§ˆå™¨å°±å¯ä»¥çœ‹åˆ°å…¶å˜åŒ–.</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠè‡ªå·±çš„ html æ–‡ä»¶æ”¾åˆ°è¿™é‡Œ, å¦‚ <code>mark.html</code>, å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;h1&gt;Hi, mark, Apache server works!&lt;/h1&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>http://localhost/mark.html</code>, å¯ä»¥çœ‹åˆ°å¯¹åº”çš„è¾“å‡º.</p>
<p>å¦‚æœå«Œé…ç½® <code>Sites</code> ç›®å½•éº»çƒ¦, å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼, ç›´æ¥æ‹·è´å¯¹åº”çš„æ–‡ä»¶æˆ–è€…ç›®å½•æ”¾åˆ° <code>/Library/WebServer/Documents</code> ä¸­, åªä¸è¿‡éœ€è¦ root æƒé™ç½¢äº†.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Apache WebServer MacOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RunLoop: ç§»é™¤å¸¸é©»çº¿ç¨‹]]></title>
      <url>/2018/07/01/RunLoop-%E7%A7%BB%E9%99%A4%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>ä¸‹é¢ä¸¤ç¯‡æ–‡ç« :</p>
<ul>
<li><p><a href="http://www.veryitman.com/2018/04/21/%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BB%80%E4%B9%88%E4%BD%93%E9%AA%8C/" target="_blank" rel="noopener">å¸¸é©»çº¿ç¨‹æ˜¯ä¸€ç§ä»€ä¹ˆä½“éªŒ</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/05/06/RunLoop-NSTimer-%E5%AE%9E%E7%8E%B0%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E7%9A%84%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">NSTimer å®ç°å¸¸é©»çº¿ç¨‹çš„é—®é¢˜</a></p>
</li>
</ul>
<p>éƒ½æ˜¯åœ¨ iOS å¹³å°ä¸Šå¦‚ä½•åˆ©ç”¨ <code>RunLoop</code> çš„ç‰¹æ€§å®ç°å¸¸é©»çº¿ç¨‹.</p>
<p>å¯èƒ½ä½ çœ‹åˆ°æœ¬ç¯‡æ–‡ç« çš„æ ‡é¢˜ <code>ç§»é™¤å¸¸é©»çº¿ç¨‹</code>, æœ‰ç‚¹ä¸ç†è§£ç”šè‡³è§‰å¾—ä½œè€…æ˜¯ä¸æ˜¯æœ‰ç‚¹ç¥ç»ç—…, éƒ½å·²ç»éœ€è¦å¸¸é©»çº¿ç¨‹äº†, ä¸ºä»€ä¹ˆè¿˜è¦å»é€€å‡ºå‘¢?</p>
<p>å®é™…åº”ç”¨åœºæ™¯ä¸­çš„ç¡®å‡ ä¹é‡ä¸åˆ°è¿™ç§æƒ…å†µ, æ‰€ä»¥, æœ¬ç¯‡åªæ˜¯ä»æŠ€æœ¯çš„è§’åº¦ç»™å¤§å®¶åˆ†äº« <code>RunLoop</code> å…¶ä»–çš„ä¸€äº›çŸ¥è¯†ç‚¹.</p>
<p>ä¸”è€ä½æ€§å­å¾€ä¸‹çœ‹â€¦</p>
<p>ä¸ºäº†ä¸è®©å¤§å®¶è¯¯è§£, ç»Ÿä¸€ä¸€ä¸‹ç›¸å…³çš„è¯æ±‡å’Œè¯­å¢ƒ.</p>
<ul>
<li>è¾“å…¥æº, åŒ…æ‹¬ source å’Œ timer.</li>
<li>é€€å‡º RunLoop æŒ‡çš„æ˜¯åœ¨å¸¸é©»çº¿ç¨‹çš„æ–¹æ³•ä¸­ç«‹å³è¿”å›.</li>
<li>è¿™é‡Œçš„ RunLoop æŒ‡çš„æ˜¯å­çº¿ç¨‹ä¸­çš„ RunLoop ä¸æ˜¯ä¸»çº¿ç¨‹ä¸­çš„.</li>
<li>ç»“åˆä¹‹å‰ä»‹ç»å¸¸é©»çº¿ç¨‹çš„æ–‡ç« æ¥çœ‹ç°åœ¨çš„æ–‡ç« , ä¸ç„¶ä¸å¥½ç†è§£.</li>
</ul>
<h2 id="è¿è¡Œ-RunLoop-çš„æ–¹æ³•"><a href="#è¿è¡Œ-RunLoop-çš„æ–¹æ³•" class="headerlink" title="è¿è¡Œ RunLoop çš„æ–¹æ³•"></a>è¿è¡Œ RunLoop çš„æ–¹æ³•</h2><p>è¿™é‡Œæœ‰ä¸‰ç§æ–¹å¼å¼€å¯è¿è¡Œ RunLoop, åˆ†åˆ«å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- (void)run;</div><div class="line"></div><div class="line">- (void)runUntilDate:(NSDate *)limitDate;</div><div class="line"></div><div class="line">- (void)runMode:(NSString *)mode beforeDate:(NSDate *)limitDate;</div></pre></td></tr></table></figure>
<ul>
<li><strong>run æ–¹æ³•</strong></li>
</ul>
<p>çœ‹ä¸€ä¸‹ API æ–‡æ¡£å¦‚ä½•è§£é‡Š <code>run</code> æ–¹æ³•çš„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Puts the receiver into a permanent loop, </div><div class="line">during which time it processes data from all attached input sources.</div><div class="line">If no input sources or timers are attached to the run loop, this method exits immediately; </div><div class="line">otherwise, it runs the receiver in the NSDefaultRunLoopMode by repeatedly invoking runMode:beforeDate:. </div><div class="line">In other words, this method effectively begins an infinite loop that processes data from the run loopâ€™s input sources and timers.</div></pre></td></tr></table></figure>
<p>å¤§è‡´æ„æ€è®²çš„æ˜¯, åœ¨æ²¡æœ‰ä»»ä½•è¾“å…¥æºçš„æƒ…å†µä¸‹, <code>run</code> æ–¹æ³•ä¼šç«‹å³æ‰§è¡Œåé€€å‡º, ä¸ä¼šä¿æŒçº¿ç¨‹çš„æŒä¹…æ€§, æ¢å¥è¯è¯´, åœ¨æœ‰è¾“å…¥æºçš„æƒ…å†µä¸‹, è¯¥æ–¹æ³•ä¼šè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯å½“ä¸­. æœ¬è´¨ä¸Š, åœ¨ <code>NSDefaultRunLoopMode</code> æ¨¡å¼ä¸‹, è¯¥æ–¹æ³•æ˜¯åå¤è°ƒç”¨ <code>runMode:beforeDate:</code> æ–¹æ³•çš„.</p>
<p>åœ¨ä¹‹å‰æ–‡ç« å®ç°å¸¸é©»çº¿ç¨‹çš„ä»£ç ä¸­, æˆ‘ä»¬ä½¿ç”¨äº† <code>run</code> æ–¹æ³•æ¥å¼€å¯è¿è¡Œ RunLoop.</p>
<p>å¯ä»¥çœ‹å‡º, æˆ‘ä»¬ä¹‹å‰å®ç°çš„å¸¸é©»çº¿ç¨‹ä½¿ç”¨ <code>run</code> æ–¹æ³•æ˜¯æ— æ³•é€€å‡ºå¸¸é©»çº¿ç¨‹çš„.</p>
<ul>
<li><strong>runUntilDate:(NSDate *)limitDate æ–¹æ³•</strong></li>
</ul>
<p>è¯¥æ–¹æ³• API é‡Šä¹‰:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Runs the loop until the specified date, </div><div class="line">during which time it processes data from all attached input sources.</div></pre></td></tr></table></figure>
<p>ä¿è¯æœ‰è¾“å…¥æºçš„æƒ…å†µä¸‹è¯¥æ–¹æ³•å¯åŠ¨çš„ RunLoop å¯ä»¥åœ¨æŒ‡å®šçš„æ—¥æœŸå†…ä¸€ç›´è¿è¡Œä¸ä¼šè¿”å›. æ¢å¥è¯è¯´, æ—¥æœŸåªè¦å·²åˆ°è¯¥æ–¹æ³•å°±ä¼šç«‹å³é€€å‡º RunLoop.</p>
<p>ç¤ºä¾‹ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//ç­‰åŒäº run, å¯ä¿è¯ä¸€ç›´è¿è¡Œ</div><div class="line">[runLoop runUntilDate:[NSDate distantFuture]];</div><div class="line"></div><div class="line">//ç«‹å³è¿”å›, é€€å‡º RunLoop</div><div class="line">[runLoop runUntilDate:[NSDate date]];</div><div class="line"></div><div class="line">//ç„¶åè¿‡12ç§’åè¿”å›</div><div class="line">[runLoop runUntilDate:[NSDate dateWithTimeIntervalSinceNow:12.0f]];</div></pre></td></tr></table></figure>
<ul>
<li><strong>runMode:(NSString <em>)mode beforeDate:(NSDate </em>)limitDate æ–¹æ³•</strong></li>
</ul>
<p>è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•° <code>mode</code> å’Œ <code>limitDate</code>, <code>mode</code> å°±æ˜¯ RunLoop çš„è¿è¡Œæ¨¡å¼, <code>limitDate</code> å°±æ˜¯ä¸Šé¢æ–¹æ³•ä¸€æ ·çš„é‡Šä¹‰å³åœ¨æŒ‡å®šçš„æ—¥æœŸå†….</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Runs the loop once, blocking for input in the specified mode until a given date.</div></pre></td></tr></table></figure>
<p>å¯ä»¥è¿™ä¹ˆç†è§£, è¯¥æ–¹æ³•å¼€å¯çš„ RunLoop å¤„ç†å®Œä¹‹åä¼šç«‹å³è¿”å›(once), å¦‚æœåœ¨æŒ‡å®šæ—¥æœŸå†…äº‹ä»¶è¿˜æ²¡å¤„ç†, åœ¨è¯¥æ—¥æœŸåä¼šç«‹å³è¿”å›.<br>æ¢å¥è¯è¯´, å¦‚æœæŒ‡å®šçš„æ—¥æœŸæ˜¯å½“å‰çš„, è¯¥æ–¹æ³•æ‰§è¡Œå RunLoop ä¼šç«‹å³é€€å‡º.</p>
<p>ç¤ºä¾‹ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//ç«‹å³è¿”å›</div><div class="line">[runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate date]];</div><div class="line">        </div><div class="line">//æœ‰äº‹ä»¶åˆ°è¾¾å¤„ç†åå°±è¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿‡12ç§’è¿”å›</div><div class="line">[runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate dateWithTimeIntervalSinceNow:12.0]];</div></pre></td></tr></table></figure>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•, æ€»ç»“ä¸€ä¸‹å¤§æ¦‚å¦‚ä¸‹:</p>
<ul>
<li>è¿™ä¸‰ä¸ªæ–¹æ³•åœ¨æ²¡æœ‰ä»»ä½•è¾“å…¥æºæƒ…å†µä¸‹ä¼šéƒ½ç«‹å³è¿”å›(é€€å‡º RunLoop), ä¸ä¼šç­‰å¾….</li>
<li><code>run</code> å¯ä¿è¯ RunLoop åœ¨æœ‰è¾“å…¥æºçš„æƒ…å†µä¸‹ä¸€ç›´è¿è¡Œ.</li>
<li><code>runUntilDate</code> å¯ä»¥é€šè¿‡è®¾ç½®è¶…æ—¶æ—¶é—´æ¥é€€å‡º RunLoop. è¶…æ—¶æ—¶é—´ä¸€è¿‡å°±ä¼šç«‹å³é€€å‡º RunLoop.</li>
<li>ä½¿ç”¨ <code>runMode</code> æ–¹å¼å¯åŠ¨çš„ RunLoop ä¼šåœ¨å¤„ç†å®Œäº‹ä»¶åæˆ–è€…è¶…æ—¶å, ç«‹å³è¿”å›. å³å¯ä»¥é€šè¿‡è®¾ç½®è¶…æ—¶æ—¶é—´æˆ–è€…ä½¿ç”¨ <code>CFRunLoopStop</code> æ–¹æ³•æ¥é€€å‡º RunLoop.</li>
</ul>
<h2 id="ç§»é™¤å¸¸é©»çº¿ç¨‹"><a href="#ç§»é™¤å¸¸é©»çº¿ç¨‹" class="headerlink" title="ç§»é™¤å¸¸é©»çº¿ç¨‹"></a>ç§»é™¤å¸¸é©»çº¿ç¨‹</h2><p>å…ˆçœ‹ä¸€ä¸‹, åœ¨å­çº¿ç¨‹æ‰§è¡Œçš„æ–¹æ³•ä¸­å¦‚ä½•å®ç°çš„. ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">- (void)asyncRun &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">        </div><div class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</div><div class="line">        _threadRunLoop = runLoop;</div><div class="line">        </div><div class="line">        // ä¿æŒå¸¸é©»çº¿ç¨‹çš„æ–¹å¼1: source</div><div class="line">        NSPort *port = [NSMachPort port];</div><div class="line">        _threadPort = port;</div><div class="line">        [runLoop addPort:port forMode:NSRunLoopCommonModes];</div><div class="line"></div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</div><div class="line">        </div><div class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</div><div class="line">        //...</div><div class="line">        </div><div class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</div><div class="line">        // [runLoop run];</div><div class="line">        </div><div class="line">        while (!self.stopLoopRunning &amp;&amp; [runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantPast]]) &#123;</div><div class="line">            </div><div class="line">            // è¿™é‡Œæ˜¯ä¸ºäº†éªŒè¯å¸¸é©»çº¿ç¨‹æ˜¯å¦å·²ç»é€€å‡º</div><div class="line">            NSLog(@&quot;--- asyncRun ----&quot;);</div><div class="line">            </div><div class="line">            // å®é™…ä¸šåŠ¡ä¸­, å»ºè®®ä½¿ç”¨ç©ºè¯­å¥å®ç°</div><div class="line">            ; //å®ç°ä¸ºç©ºè¯­å¥</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç»“åˆä¸Šé¢è®²è§£çš„åŸç†, è¿™é‡Œé€‰æ‹©ä½¿ç”¨ <code>runMode</code> æ–¹æ³•æ¥å¼€å¯è¿è¡Œ RunLoop. å¤§å®¶ä¹Ÿå¯ä»¥è‡ªç”±å‘æŒ¥ä½¿ç”¨å…¶ä»–çš„æ–¹æ³•.</p>
<p><strong>æ³¨æ„: <code>stopLoopRunning</code> æ˜¯å®šä¹‰çš„ä¸€ä¸ªå±æ€§.</strong></p>
<p>ç§»é™¤çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidDisappear:(BOOL)animated &#123;</div><div class="line">    </div><div class="line">    [super viewDidDisappear:animated];</div><div class="line">    </div><div class="line">    // å–æ¶ˆçº¿ç¨‹</div><div class="line">    // å®é™…ä¸šåŠ¡åœºæ™¯ä¸­è‡ªè¡Œå†³å®š canCancel çš„è®¾ç½®, è¿™é‡Œåªæ˜¯ç¤ºä¾‹</div><div class="line">    BOOL canCancel = YES;</div><div class="line">    if (canCancel) &#123;</div><div class="line">        [[self permanentThread] cancel];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    /// åœæ­¢å¸¸é©»çº¿ç¨‹</div><div class="line">    &#123;</div><div class="line">        self.stopLoopRunning = YES;</div><div class="line">        </div><div class="line">        // ç§»é™¤ port</div><div class="line">        // å¦‚æœæ˜¯ç”¨ timer çš„æ–¹å¼çš„å¸¸é©»çº¿ç¨‹, å¯ä»¥ invalid å¯¹åº”çš„ timer</div><div class="line">        [self.threadRunLoop removePort:self.threadPort forMode:NSRunLoopCommonModes];</div><div class="line">        </div><div class="line">        // åœæ­¢ RunLoop</div><div class="line">        if (nil != self.threadRunLoop) &#123;</div><div class="line">            CFRunLoopStop([self.threadRunLoop getCFRunLoop]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¦»å¼€é¡µé¢å, å¯ä»¥å‘ç° <code>NSLog(@&quot;--- asyncRun ----&quot;);</code> åœæ­¢äº†æ‰“å°, å¹¶ä¸”å½“å‰çš„ Controller ä¹Ÿ dealloc äº†.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> RunLoop å¸¸é©»çº¿ç¨‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS é€†å‘: dumpdecrypted ç ¸å£³è®°]]></title>
      <url>/2018/06/07/iOS-%E9%80%86%E5%90%91-dumpdecrypted-%E7%A0%B8%E5%A3%B3%E8%AE%B0/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„æ—¥å­, é«˜è€ƒçš„ç¬¬ä¸€å¤©, ç¥å„ä½è˜è˜å­¦å­é‡‘æ¦œé¢˜å.</p>
<hr>
<p><a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/" target="_blank" rel="noopener">iOS é€†å‘: ç ¸å£³</a> ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨å·¥å…· <code>Clutch</code> å¯¹ iOS çš„åº”ç”¨è¿›è¡Œç ¸å£³æ“ä½œ, ä»Šå¤©ç»§ç»­ç»™å¤§å®¶åˆ†äº«ä½¿ç”¨å¦å¤–ä¸€ä¸ªå·¥å…· <code>dumpdecrypted</code> å¯¹ APP è¿›è¡Œç ¸å£³.</p>
<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>æœ‰äº›æœ‹å‹å°±ä¼šé—®äº†, æ—¢ç„¶ <code>Clutch</code> å·²ç»å¾ˆç‰›Bäº†, ä¸ºä»€ä¹ˆè¿˜éœ€è¦ <code>dumpdecrypted</code> è¿™ä¸ªå·¥å…·å‘¢? </p>
<p>åˆšå¼€å§‹çš„æ—¶å€™, æˆ‘ä¹Ÿå¾ˆæ’æ–¥ä½¿ç”¨ <code>dumpdecrypted</code> è¿™ä¸ªå·¥å…·çš„, ä½¿ç”¨èµ·æ¥æ¯”è¾ƒå¤æ‚, å¹¶ä¸”å¥—è·¯ä¸ç†Ÿçš„æƒ…å†µä¸‹è¿˜å¾ˆå®¹æ˜“å‡ºé”™. </p>
<p>ä¹‹å‰è¯´è¿‡ <code>Clutch</code> å¹¶ä¸æ˜¯ä¸‡èƒ½çš„, ä» App Store ä¸‹è½½çš„ App(æ¯”å¦‚ WeChat)æœ‰äº›å¹¶ä¸èƒ½ä½¿ç”¨ <code>Clutch</code> æ¥è¿›è¡Œç ¸å£³, æ¢å¥è¯è¯´, ä½¿ç”¨ <code>Clutch</code> å·¥å…·æ¥è¿›è¡Œç ¸å£³ä¼šå¤±è´¥, é‚£ä¹ˆ, <code>dumpdecrypted</code> å°±ç™»åœºäº†.</p>
<p>æœ¬æ¬¡ç ¸å£³çš„ç³»ç»Ÿä¾ç„¶æ˜¯ <code>iOS10.3.x</code>, å·¥å…·ä½¿ç”¨ <code>dumpdecrypted</code>, ç ¸å£³çš„å¯¹è±¡æ˜¯ WeChat è¿™ä¸ª App.</p>
<h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><ul>
<li>MacOS PC</li>
<li>è¶Šç‹±æ‰‹æœºä¸€å°(æˆ‘ç”¨çš„æ˜¯iPhone6SPlus 10.3.1)</li>
<li>dumpdecrypted</li>
<li>class-dump</li>
<li>åœ¨ Cydia ä¸­å®‰è£… cycript, å¯ä»¥å…ˆä¸ç”¨ç®¡ cycript æ˜¯ä»€ä¹ˆ, ä¸‹è½½å®‰è£…å³å¯.</li>
<li>iFunBox æˆ–è€…å…¶ä»–åŠ©æ‰‹å·¥å…·</li>
</ul>
<h2 id="ç¼–è¯‘-dumpdecrypted"><a href="#ç¼–è¯‘-dumpdecrypted" class="headerlink" title="ç¼–è¯‘ dumpdecrypted"></a>ç¼–è¯‘ dumpdecrypted</h2><p>å» <a href="https://github.com/stefanesser/dumpdecrypted" target="_blank" rel="noopener">Github</a> ä¸‹è½½ <code>dumpdecrypted</code> æºç , æºç å°±ä¸€ä¸ª C æºæ–‡ä»¶.</p>
<p>ä¸‹è½½ zip åŒ…ä¹‹å, è§£å‹, å¦‚å›¾:<br><img src="/upload/images/2018/06/07/1.jpg" alt=""></p>
<p>åœ¨å½“å‰ç›®å½•, æ‰§è¡Œ <code>make</code> å³å¯å®Œæˆç¼–è¯‘, å¦‚å›¾æ‰€ç¤º:<br><img src="/upload/images/2018/06/07/2.jpg" alt=""></p>
<p>ç¼–è¯‘æˆåŠŸåç”Ÿæˆ <code>dumpdecrypted.dylib</code> æ–‡ä»¶.</p>
<p>è¿™é‡Œæœ‰ä¸ªå°æ’æ›², ç¼–è¯‘ <code>dumpdecrypted</code> çš„æ—¶å€™æŠ¥é”™äº†, é”™è¯¯ä¿¡æ¯å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">xcrun: error: SDK &quot;iphoneos&quot; cannot be located</div><div class="line">xcrun: error: unable to lookup item &apos;Path&apos; in SDK &apos;iphoneos&apos;</div><div class="line">clang: warning: no such sysroot directory: &apos;-F/System/Library/Frameworks&apos; [-Wmissing-sysroot]</div><div class="line">dumpdecrypted.c:27:10: fatal error: &apos;stdio.h&apos; file not found</div></pre></td></tr></table></figure>
<p>æ— æ³•æ‰¾åˆ°å¯¹åº”çš„ <code>SDK</code> å’Œ <code>stdio.h</code> æ–‡ä»¶, è¿™ç§é—®é¢˜å¤§å¤šæ•°æ˜¯ Xcode è·¯å¾„é€ æˆçš„.</p>
<p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤çœ‹ä¸€ä¸‹ç³»ç»ŸæŒ‡å‘çš„ Xcode è·¯å¾„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xcode-select -p</div></pre></td></tr></table></figure>
<p>æ§åˆ¶å°è¾“å‡º:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/Library/Developer/CommandLineTools</div></pre></td></tr></table></figure>
<p>æ˜¾ç„¶ä¸æ˜¯ Xcode çš„è·¯å¾„, é‚£åªèƒ½é‡æ–°åˆ‡æ¢ä¸€ä¸‹å…¶è·¯å¾„å³æŒ‡å‘æ­£ç¡®çš„<code>Xcode</code> è·¯å¾„å³å¯.</p>
<p>å‘½ä»¤å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo xcode-select --switch /Applications/Xcode.app</div></pre></td></tr></table></figure>
<p>å†æ¬¡ç¼–è¯‘ <code>dumpdecrypted</code> å³å¯æˆåŠŸå®Œæˆ.</p>
<h2 id="å¯¹-dumpecrypted-dylib-ç­¾å"><a href="#å¯¹-dumpecrypted-dylib-ç­¾å" class="headerlink" title="å¯¹ dumpecrypted.dylib ç­¾å"></a>å¯¹ dumpecrypted.dylib ç­¾å</h2><blockquote>
<p>å¦‚æœä¸å¯¹è¯¥æ–‡ä»¶è¿›è¡Œç­¾å, åç»­ç ¸å£³çš„æ“ä½œä¼šå¤±è´¥.</p>
</blockquote>
<p>å…ˆæ‰¾åˆ°å·²ç»åœ¨ç”µè„‘ä¸Šé¢å®‰è£…çš„è‹¹æœå¼€å‘è€…è¯ä¹¦, æ“ä½œå¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## åˆ—å‡ºå¯ç­¾åè¯ä¹¦, æ‰¾åˆ° mac ä¸Šé¢å·²ç»å®‰è£…çš„è¯ä¹¦</div><div class="line">security find-identity -v -p codesigning</div></pre></td></tr></table></figure>
<p>ä¸º dumpecrypted.dylib ç­¾å, å‘½ä»¤å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">codesign --force --verify --verbose --sign &quot;iPhone Developer: xxx xxxx (xxxxxxxxxx)&quot; dumpdecrypted.dylib</div></pre></td></tr></table></figure>
<p>å…¶ä¸­, <code>&quot;iPhone Developer: xxx xxxx (xxxxxxxxxx)&quot;</code> ä¸ºä½ è‡ªå·±æœ¬æœºå®‰è£…çš„å¼€å‘è€…è¯ä¹¦åç§°.</p>
<h2 id="SSH-è¿æ¥æ‰‹æœº"><a href="#SSH-è¿æ¥æ‰‹æœº" class="headerlink" title="SSH è¿æ¥æ‰‹æœº"></a>SSH è¿æ¥æ‰‹æœº</h2><p>ä½¿ç”¨ OpenSSH è®© Mac å’Œæ‰‹æœºè¿æ¥èµ·æ¥ è¿™æ ·å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ Mac ç»ˆç«¯ä½¿ç”¨ shell å‘½ä»¤æ¥æ“ä½œæ‰‹æœºçš„ç›®å½•äº†.</p>
<p>å…³äº OpenSSH çš„ä½¿ç”¨è¯·å‚è€ƒæˆ‘ä¹‹å‰çš„åšæ–‡ <a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/" target="_blank" rel="noopener">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a>.</p>
<h2 id="æŸ¥æ‰¾ç›®æ ‡-App-æ‰€åœ¨è¿›ç¨‹"><a href="#æŸ¥æ‰¾ç›®æ ‡-App-æ‰€åœ¨è¿›ç¨‹" class="headerlink" title="æŸ¥æ‰¾ç›®æ ‡ App æ‰€åœ¨è¿›ç¨‹"></a>æŸ¥æ‰¾ç›®æ ‡ App æ‰€åœ¨è¿›ç¨‹</h2><ul>
<li>åŒå‡» Home æŒ‰é”®å, æ‰‹åŠ¨æ€æ‰ iPhone ä¸Šé¢æ‰€æœ‰åœ¨åå°çš„ App.</li>
<li>Home åˆ°æ‰‹æœºæ¡Œé¢.</li>
<li>æ‰“å¼€ç›®æ ‡ App å³WeChat, è¿™é‡Œç§°ä¹‹ä¸º TargetApp.</li>
<li>Home åˆ°æ‰‹æœºæ¡Œé¢.</li>
<li>æŸ¥çœ‹å½“å‰è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹, å‘½ä»¤å¦‚ä¸‹:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps -e</div></pre></td></tr></table></figure>
<p>çœ‹åˆ°è¿™ä¸ªè´§:<br><img src="/upload/images/2018/06/07/3.jpg" alt=""></p>
<p>åœ¨å¦‚ä¸‹ç›®å½•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/var/containers/Bundle/Application/2837EC87-7C28-45C5-9309-24FACD3A97C9/WeChat.app/WeChat</div></pre></td></tr></table></figure>
<p><code>WeChat.app</code> å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ TargetApp.</p>
<p>è¿æ¥ SSH æˆåŠŸå, åœ¨ MacOS ç»ˆç«¯ <code>ls</code> ä¸€ä¸‹è¯¥ç›®å½•, å¯ä»¥å‘ç° <code>WeChat.app</code> èººåœ¨é‚£é‡Œ.<br><img src="/upload/images/2018/06/07/4.jpg" alt=""></p>
<h2 id="ç ¸å£³"><a href="#ç ¸å£³" class="headerlink" title="ç ¸å£³"></a>ç ¸å£³</h2><p><strong>1. æŸ¥æ‰¾ Documents ç›®å½•</strong></p>
<p><code>WeChat</code> ä¸ºå½“å‰çš„è¿›ç¨‹ç›®æ ‡æ‰§è¡Œæ–‡ä»¶åç§°, ä»ä¸Šé¢çš„å›¾å¯ä»¥çœ‹å‡º, å…¶å¯¹åº”çš„è¿›ç¨‹ id æ˜¯ <code>18983</code>.</p>
<p>åœ¨å‘½ä»¤è¡Œä¸­é€šè¿‡ cycript æ‰§è¡Œå¦‚ä¸‹æ“ä½œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cycript -p 18983</div></pre></td></tr></table></figure>
<p>å†æ‰§è¡Œ OC çš„æ–¹æ³•, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask][0]</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å¯¹åº”çš„è¾“å‡º, å¦‚ä¸‹å›¾æ‰€ç¤º, è¿™å°±æ˜¯å¯¹åº”çš„ Documents ç›®å½•.<br><img src="/upload/images/2018/06/07/5.jpg" alt=""></p>
<blockquote>
<p>æ³¨æ„: æ‰§è¡Œè¿‡ç¨‹ä¸­, åœ¨ iPhone ä¸Šé¢æ‰“å¼€è¿è¡Œä¸€ä¸‹ App, ä¸ç„¶ä¸Šé¢çš„æ‰§è¡Œä¸€ç›´å¡åœ¨é‚£é‡Œä¸åŠ¨.</p>
</blockquote>
<p>æ‰¾åˆ°ç›®å½•å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/var/mobile/Containers/Data/Application/2EFA08B6-DD7B-41A6-92C9-C6115CA6DDA1/Documents/</div></pre></td></tr></table></figure>
<p>åŒç†, ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ iFunBox æŸ¥çœ‹è¯¥ç›®å½•.</p>
<p><strong>2. æ‹·è´ dumpdecrypted.dylib</strong>.</p>
<p>æ‹·è´ <code>dumpdecrypted.dylib</code> è¿™ä¸ªä¹‹å‰ç¼–è¯‘ç­¾åå¥½çš„æ–‡ä»¶åˆ°iPhone ä¸Šé¢è¯¥ APP çš„ Documents ç›®å½•æœ‰ä¸¤ç§æ–¹æ³•.</p>
<p>ç¬¬ä¸€ç§æ–¹æ³•, ç›´æ¥åœ¨ mac ä¸Šé¢æ‹–æ‹½ <code>dumpdecrypted.dylib</code> åˆ° iFunBox æ˜¾ç¤ºçš„è¿™ä¸ªç›®å½•ä¸­, è¿™ç§æ–¹æ³•æ¯”è¾ƒç®€å•ä¸”å¿«.</p>
<p>ç¬¬äºŒç§æ–¹æ³•, ä½¿ç”¨ <code>scp</code> å‘½ä»¤è¿›è¡Œæ“ä½œ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp ~/dumpdecrypted.dylib root@192.168.99.231:/var/mobile/Containers/Data/Application/2EFA08B6-DD7B-41A6-92C9-C6115CA6DDA1/Documents/</div></pre></td></tr></table></figure>
<p><code>192.168.99.231</code> æ˜¯ iPhone è®¾å¤‡çš„ ip åœ°å€.</p>
<p><strong>3. é€€å‡º cycript, å›åˆ°å‘½ä»¤è¡Œæ¨¡å¼</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ctrl + d</div></pre></td></tr></table></figure>
<p><strong>4. cd åˆ° Documents ç›®å½•</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd /var/mobile/Containers/Data/Application/2EFA08B6-DD7B-41A6-92C9-C6115CA6DDA1/Documents/</div></pre></td></tr></table></figure>
<p><strong>5. ç ¸å£³</strong></p>
<p>ç»ˆç«¯åœ¨ Documents ç›®å½•ä¸‹é¢, æ‰§è¡Œä¸‹é¢å‘½ä»¤å³å¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DYLD_INSERT_LIBRARIES=dumpdecrypted.dylib /var/containers/Bundle/Application/2837EC87-7C28-45C5-9309-24FACD3A97C9/WeChat.app/WeChat</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œè¿‡ç¨‹æ˜¾ç¤ºå¦‚ä¸‹:<br><img src="/upload/images/2018/06/07/6.jpg" alt=""></p>
<p>æœ€åç”Ÿæˆäº† <code>WeChat.decrypted</code> æ–‡ä»¶, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">-rw-r--r--  1 root   mobile 74513728 Jun  7 15:20 WeChat.decrypted</div><div class="line">drwxr-xr-x 14 mobile mobile      448 Jun  7 15:20 .</div><div class="line">-rw-r--r--  1 root   mobile   207760 Jun  7 15:15 dumpdecrypted.dylib</div><div class="line">-rw-r--r--  1 mobile mobile        8 Jun  7 13:22 db.globalconfig</div><div class="line">-rw-r--r--  1 mobile mobile       15 Jun  7 11:35 SafeMode.dat</div><div class="line">drwxr-xr-x 26 mobile mobile      832 Jun  7 11:35 MMappedKV</div><div class="line">drwxr-xr-x  3 mobile mobile       96 Jun  7 11:35 CrashReport</div><div class="line">-rw-r--r--  1 mobile mobile     1011 Jun  7 11:35 LocalInfo.lst</div><div class="line">drwxr-xr-x  5 mobile mobile      160 Jun  7 11:35 MemoryStat</div><div class="line">drwxr-xr-x  6 mobile mobile      192 Jun  7 11:35 00000000000000000000000000000000</div><div class="line">drwxr-xr-x 15 mobile mobile      480 Jun  5 13:43 MMResourceMgr</div><div class="line">-rw-r--r--  1 mobile mobile      592 Jun  5 13:43 heavy_user_id_mapping.dat</div><div class="line">drwxr-xr-x  2 mobile mobile       64 Jun  5 10:07 OpenImResource</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>iFunBox</code> æˆ–è€… <code>scp</code> å‘½ä»¤å°† <code>WeChat.decrypted</code> æ–‡ä»¶å¯¼å‡ºåˆ° mac çš„ä»»æ„ç›®å½•å³å¯.</p>
<p>åç»­ä¼šè·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•ä½¿ç”¨ç ¸å£³åçš„æ–‡ä»¶, æ•¬è¯·æœŸå¾….</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jailbreak </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS é€†å‘: ç ¸å£³]]></title>
      <url>/2018/05/13/iOS-%E9%80%86%E5%90%91-%E7%A0%B8%E5%A3%B3/</url>
      <content type="html"><![CDATA[<p>æ‰€è°“çš„ç ¸å£³, æŒ‡çš„æ˜¯å°†ä» App Store ä¸Šé¢ä¸‹è½½çš„ App è¿›è¡Œç ´è§£çš„è¿‡ç¨‹. ä» App Store ä¸Šä¸‹è½½çš„ ipa ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ç»è¿‡åŠ å¯†(åŠ å£³)çš„ï¼Œéœ€è¦é€šè¿‡ç ´è§£æ‰èƒ½è®©æˆ‘ä»¬å¯¹å…¶ <code>ä¸ºæ‰€æ¬²ä¸º</code>, è¿™é‡Œçš„ç ´è§£å°±æ˜¯é€šå¸¸æ‰€è¯´çš„ç ¸å£³.</p>
<p>ç±»ä¼¼çš„, Android åº”ç”¨(apk æ–‡ä»¶)ä¹Ÿæœ‰åŠ å£³æ“ä½œ, å¦‚æœæƒ³ç ´è§£åˆ«äººçš„ apk, é¦–å…ˆè¦è¿›è¡Œç ¸å£³æ“ä½œ.</p>
<h2 id="å‡†å¤‡å·¥å…·"><a href="#å‡†å¤‡å·¥å…·" class="headerlink" title="å‡†å¤‡å·¥å…·"></a>å‡†å¤‡å·¥å…·</h2><p>[1]. Clutch<br>[2]. iFunBox æˆ–è€… <code>pp åŠ©æ‰‹</code><br>[3]. è¶Šç‹±æ‰‹æœºä¸€å°(æœ¬äººiPhone6sPlus iOS10.3.x ç³»ç»Ÿ).<br>[4]. å¯ä»¥æ­£å¸¸ä½¿ç”¨ SSH åŠŸèƒ½.</p>
<p>å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…ä¸Šé¢æåˆ°çš„é™¤ <code>Clutch</code> ä¹‹å¤–çš„å·¥å…·, è¯·å…ˆé˜…è¯» <a href="http://www.veryitman.com/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/" target="_blank" rel="noopener">iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„</a> è¿™ç¯‡æ–‡ç« , å¹¶å®‰è£…å¯¹åº”çš„å·¥å…·.</p>
<h2 id="å®‰è£…-Clutch"><a href="#å®‰è£…-Clutch" class="headerlink" title="å®‰è£… Clutch"></a>å®‰è£… Clutch</h2><p>å¯ä»¥åœ¨ Github è·å– <a href="https://github.com/KJCracks/Clutch" target="_blank" rel="noopener">Clutch æºç </a>, ç„¶åè‡ªå·±åœ¨ MacOS ä¸Šé¢ç¼–è¯‘å¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶.</p>
<p>ä¹Ÿå¯ä»¥å»ç›´æ¥ä¸‹è½½å·²ç»ç¼–è¯‘å¥½çš„ <a href="https://github.com/KJCracks/Clutch/releases" target="_blank" rel="noopener">äºŒè¿›åˆ¶åŒ…</a>, ç›´æ¥ä½¿ç”¨, æˆ‘æ˜¯ç›´æ¥ä¸‹è½½äº†å·²ç»ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶åŒ…çš„, æˆªæ­¢åˆ°å†™è¿™ç¯‡æ–‡ç« ä¸ºæ­¢, <code>Clutch</code> ç‰ˆæœ¬ä¸º <code>2.0.4</code>.</p>
<p>ä¸‹è½½å®Œæˆå, æˆ‘å°†å…¶æ”¾åˆ° <code>~/Downloads</code> ç›®å½•ä¸‹é¢äº†.</p>
<p>å‡†å¤‡å¥½è¶Šç‹±è®¾å¤‡, ä¿è¯å¯ä»¥æ­£å¸¸è¿æ¥ wifi, ä½¿ç”¨ scp å‘½ä»¤å°† <code>Clutch</code> äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ°è®¾å¤‡çš„ç³»ç»Ÿç›®å½•ä¸­, å‘½ä»¤å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp ~/Downloads/Clutch root@192.168.91.126:/usr/bin</div></pre></td></tr></table></figure>
<p>å…¶ä¸­, <code>192.168.91.126</code> æ˜¯æˆ‘è®¾å¤‡è¿æ¥ wifi åçš„ IP åœ°å€.</p>
<p>å¤åˆ¶æˆåŠŸå, ä½¿ç”¨ iFunBox å¯ä»¥çœ‹åˆ° <code>Clutch</code> é™é™åœ°èººåœ¨é‚£é‡Œ.</p>
<p><img src="/upload/images/2018/05/13/6.jpg" alt=""></p>
<p>ä½ å¯ä»¥ä½¿ç”¨ iFunBox æˆ–è€… <code>pp åŠ©æ‰‹</code>, ç›´æ¥å°† <code>~/Downloads/Clutch</code> æ‹–æ‹½åˆ° <code>/usr/bin</code> ç›®å½•.</p>
<h2 id="Clutch-çš„åŸºæœ¬ä½¿ç”¨"><a href="#Clutch-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Clutch çš„åŸºæœ¬ä½¿ç”¨"></a>Clutch çš„åŸºæœ¬ä½¿ç”¨</h2><p>SSH è¿æ¥è¶Šç‹±è®¾å¤‡, å¼€å§‹ä½¿ç”¨ <code>Clutch</code>. å…³äºä½¿ç”¨ SSH, å¯ä»¥é˜…è¯»ä¸€ä¸‹ <a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/" target="_blank" rel="noopener">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a> è¿™ç¯‡æ–‡ç« .</p>
<p>å¦‚æœä½ å‘ç°ç›´æ¥æ‰§è¡Œ <code>Clutch</code> è¯´æ²¡æœ‰æƒé™ä¹‹ç±»çš„æç¤º, å¯ä»¥å…ˆå°†å…¶æˆäºˆå¯æ‰§è¡Œçš„æƒé™.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod +x /usr/bin/Clutch</div></pre></td></tr></table></figure>
<p>Clutch å‘½ä»¤é€‰é¡¹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-b --binary-dump     Only dump binary files from specified bundleID</div><div class="line">-d --dump            Dump specified bundleID into .ipa file</div><div class="line">-i --print-installed Print installed application</div><div class="line">--clean              Clean /var/tmp/clutch directory</div><div class="line">--version            Display version and exit</div><div class="line">-? --help            Display this help and exit</div></pre></td></tr></table></figure>
<p><code>-b</code> é€‰é¡¹è¡¨ç¤ºäº§å‡ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶, <code>-d</code> é€‰é¡¹è¡¨ç¤ºäº§å‡ºä¸€ä¸ª ipa æ–‡ä»¶, <code>-i</code> è¡¨ç¤ºåˆ—å‡ºæ‰‹æœºä¸Šé¢å·²ç»å®‰è£…çš„ APP.</p>
<p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æ‰‹æœºä¸Šå·²ç»å®‰è£…çš„ App, å‘½ä»¤å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Clutch -i</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2018/05/13/7.jpg" alt=""></p>
<p>è¿™äº› APP å‰é¢çš„æ•°å­—è¡¨ç¤ºæŒ‡å®šçš„ id. <code>-d</code> å’Œ <code>-b</code> é€‰é¡¹éƒ½éœ€è¦æŒ‡å®šè¿™äº› id.</p>
<h2 id="ç ¸å§-éªšå¹´"><a href="#ç ¸å§-éªšå¹´" class="headerlink" title="ç ¸å§, éªšå¹´"></a>ç ¸å§, éªšå¹´</h2><p>æˆ‘ä»¬ç°åœ¨å¼€å§‹ä½¿ç”¨ <code>Clutch</code> æ¥å¯¹ APP è¿›è¡Œç ¸å£³æ“ä½œ, è¿™é‡Œä»¥å·²ç»å®‰è£…çš„ App åºå·ä¸º 8 çš„ä¸ºä¾‹å­.</p>
<p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¼€å§‹ç ¸å£³:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Clutch -d 8</div></pre></td></tr></table></figure>
<p>æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2018/05/13/8.jpg" alt=""></p>
<p>ç ¸å£³æˆåŠŸåä¼šåœ¨ <code>/private/var/mobile/Documents/Dumped</code>  è¿™ä¸ªç›®å½•ç”Ÿæˆå¯¹åº”çš„ <code>*.ipa</code> æ–‡ä»¶.</p>
<p>ç ¸å£³åçš„ ipa æ–‡ä»¶, å¯ä»¥ä» iFunBox ä¸­å¤åˆ¶åˆ° MacOS çš„ç›®å½•ä¸­, ç„¶åä½ å°±å¯ä»¥å¯¹è¯¥ ipa è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œäº†, æ¯”å¦‚è·å–å›¾ç‰‡/éŸ³é¢‘/è§†é¢‘ç­‰èµ„æºå’Œå¯¹åº”çš„å¤´æ–‡ä»¶. å…³äºè¿™äº›åç»­çš„è¶Šç‹±å·¥ä½œ, æˆ‘ä¼šåœ¨ä¸‹å‡ ç¯‡åšå®¢ä¸­åˆ†äº«ç»™å¤§å®¶.</p>
<p>ä¹Ÿè®¸æœ‰äººä¼šè¯´äº†, æˆ‘è‡ªå·±ä» <code>pp åŠ©æ‰‹</code> ä¸­å¤‡ä»½æŒ‡å®šçš„ App å°±å¯ä»¥è·å–èµ„æºäº†, ä¸éœ€è¦ä½¿ç”¨ <code>Clutch</code> è¿™ä¹ˆéº»çƒ¦äº†. é«˜ç³»ç»Ÿç‰ˆæœ¬, <code>pp åŠ©æ‰‹</code> æ˜¯æ— æ³•ç›´æ¥è·å– ipa æ–‡ä»¶çš„, å†µä¸”æˆ‘ä»¬ä¹Ÿä¸ä»…ä»…æ˜¯æƒ³è·å–åˆ«äºº APP çš„èµ„æºæ–‡ä»¶.</p>
<p>å½“ç„¶äº†, ä½ å¯ä»¥ä»è¶Šç‹± APP å¸‚åœºç›´æ¥ä¸‹è½½å·²ç»è¢«ç ¸å£³çš„ App è¿›è¡Œç©è€, ä¸éœ€è¦è‡ªå·±åƒè¾›ä¸‡è‹¦çš„å»ç ¸å£³äº†.</p>
<h2 id="Clutch-å¹¶ä¸æ˜¯ä¸‡èƒ½çš„"><a href="#Clutch-å¹¶ä¸æ˜¯ä¸‡èƒ½çš„" class="headerlink" title="Clutch å¹¶ä¸æ˜¯ä¸‡èƒ½çš„"></a>Clutch å¹¶ä¸æ˜¯ä¸‡èƒ½çš„</h2><p>ä¸Šé¢å¤§å®¶å¯ä»¥çœ‹å‡º, <code>Clutch</code> æ˜¯å¯ä»¥è¿›è¡Œç ¸å£³çš„å¹¶ä¸”ä¹ŸæŒºæ–¹ä¾¿, ä½† <code>Clutch</code> å¹¶ä¸æ˜¯ä¸‡èƒ½çš„, ä¹Ÿå°±æ˜¯è¯´, <code>Clutch</code> ä¸èƒ½å°†ä»»æ„ä¸€ä¸ª App Store ä¸‹è½½ APP è¿›è¡Œç ¸å£³.</p>
<p>æ‹¿ä¸Šé¢åºå·ä¸º4 çš„å¾®ä¿¡æ¥è¯´, æ‰§è¡Œä¸‹é¢å‘½ä»¤æŠ¥é”™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Clutch -d 4</div></pre></td></tr></table></figure>
<p>ç ¸å£³æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Writing new checksum</div><div class="line">...</div><div class="line">FAILED: &lt;WeChat bundleID: com.tencent.xin&gt;</div><div class="line">Finished dumping com.tencent.xin in 28.7 seconds</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€äº› APP, å†è¢«ç ¸å£³çš„æ—¶å€™ä¼šæŠ¥å¦‚ä¸‹çš„é”™è¯¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">could not obtain mach port either the process is dead</div></pre></td></tr></table></figure>
<p>è™½ç„¶æœ€æ–°ç‰ˆæœ¬(2.0.4)è¯´è§£å†³äº†è¯¥é—®é¢˜, ä½†æ˜¯å®é™…æ“ä½œè¿‡ç¨‹ä¸­, è¿˜æ˜¯ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜, æ— æ³•è¿›è¡Œç ¸å£³.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jailbreak </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS é€†å‘: æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶ç›®å½•å’Œç»“æ„]]></title>
      <url>/2018/05/13/iOS-%E9%80%86%E5%90%91-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%92%8C%E7%BB%93%E6%9E%84/</url>
      <content type="html"><![CDATA[<p>åœ¨ <a href="http://www.veryitman.com/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/" target="_blank" rel="noopener">iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH</a> ä¸­ç»™å¤§å®¶åˆ†äº«äº†å¦‚ä½•ä½¿ç”¨å·¥å…·å¯¹ iOS10.3 çš„ç³»ç»Ÿè¿›è¡Œè¶Šç‹±å’Œé…ç½®ä½¿ç”¨ SSH çš„å†…å®¹, ä»Šå¤©ç»§ç»­æ¢é€†å‘çš„çŸ¥è¯†.</p>
<p>æ‰‹æœºè¢«è¶Šç‹±ä¹‹å, æˆ‘ä»¬é¦–å…ˆè¦ææ¸…æ¥šæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸çš„è®¿é—®æ‰‹æœºé‡Œé¢çš„æ–‡ä»¶å’Œç›®å½•ç»“æ„, è¿™äº›æ–‡ä»¶å’Œç›®å½•ç»“æ„ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ ·çš„, è™½ç„¶è¿™äº›çŸ¥è¯†å¾ˆåŸºç¡€, ä½†æ˜¯è¿˜æ˜¯å¾ˆæœ‰å¿…è¦å»äº†è§£å’Œå­¦ä¹ çš„, å°±ç®—æ˜¯ä¸ºåæœŸé€†å‘ APP åšç‚¹å‡†å¤‡å§. </p>
<h2 id="å®‰è£…-iFunBox"><a href="#å®‰è£…-iFunBox" class="headerlink" title="å®‰è£… iFunBox"></a>å®‰è£… iFunBox</h2><p><code>iFunBox</code> æ˜¯ä¸€ä¸ªå¯ä»¥æµè§ˆ iPhone æ–‡ä»¶ç›®å½•çš„æ–‡ä»¶ç®¡ç†å·¥å…·, æ”¯æŒ MacOS å’Œ Windows ä¸¤ä¸ªå¹³å°.</p>
<p>ç‚¹å‡» <a href="http://www.i-funbox.com/" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a> å¯ä»¥å»ä¸‹è½½ MacOS ç‰ˆæœ¬çš„ iFunBox. å…³äº <code>iFunBox</code> çš„ä»‹ç»å’Œç‰¹æ€§å¯ä»¥å» <a href="http://www.i-funbox.com/en_about.html" target="_blank" rel="noopener">è¿™é‡Œ</a> æŸ¥é˜….</p>
<p>æœ€æ–°ç‰ˆæœ¬æ˜¯ <code>1.8</code>, å¦‚å›¾:</p>
<p><img src="/upload/images/2018/05/13/1.jpg" alt=""></p>
<p>æ‰‹æœºæ’ä¸Š USB è¿æ¥ä¸Š Mac ç”µè„‘, iFunBox å°±å¯ä»¥è¯†åˆ«ä½ çš„æ‰‹æœºäº†, å¦‚å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2018/05/13/2.jpg" alt=""></p>
<p>è¿™ä¸ªæ—¶å€™, ä½ ç‚¹å‡» <code>Raw File System</code> å…¶å®æ˜¯çœ‹ä¸åˆ° iPhone çš„ç³»ç»Ÿç›®å½•çš„, æ¥ä¸‹æ¥åœ¨ iPhone ä¸­å®‰è£…å¦å¤–ä¸€ä¸ªè½¯ä»¶å°±å¯ä»¥äº†.</p>
<h2 id="å®‰è£…-Apple-File-Conduitâ€2â€"><a href="#å®‰è£…-Apple-File-Conduitâ€2â€" class="headerlink" title="å®‰è£… Apple File Conduitâ€2â€"></a>å®‰è£… Apple File Conduitâ€2â€</h2><p>åœ¨ Cydia ä¸­æœç´¢ Apple File Conduit, å¦‚ä¸‹å›¾æ‰€ç¤º.</p>
<p><img src="/upload/images/2018/05/13/3.jpg" alt=""></p>
<p>ç‚¹å‡»æ›´æ”¹/å®‰è£…å³å¯.</p>
<p>å¦‚æœä½ æ²¡æœ‰æœç´¢åˆ°, é‚£ä¹ˆå°±éœ€è¦è‡ªå·±æ·»åŠ å¯¹åº”çš„è½¯ä»¶æºåœ°å€.</p>
<p>ç‚¹å‡»ã€è½¯ä»¶æºã€‘â€“ç¼–è¾‘/æ·»åŠ  â€“è¾“å…¥æºåœ°å€ <code>apt.25pp.com</code> â€“ æ·»åŠ æº, ç„¶åå†å»æœç´¢ <code>Apple File Conduit</code> å®‰è£….</p>
<p>å®‰è£…å¥½ä¹‹å, å†ç”¨ <code>iFunBox</code>, å°±å¯ä»¥æ­£å¸¸æŸ¥çœ‹ iPhone çš„ç³»ç»Ÿç›®å½•äº†, å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2018/05/13/4.jpg" alt=""></p>
<p>çœ‹åˆ°è¿™äº›ç›®å½•, æ˜¯ä¸æ˜¯è·Ÿ linux æˆ–è€… MacOS çš„ç›®å½•æœ‰å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹, å“ˆå“ˆ.</p>
<h2 id="å®‰è£…-pp-åŠ©æ‰‹"><a href="#å®‰è£…-pp-åŠ©æ‰‹" class="headerlink" title="å®‰è£… pp åŠ©æ‰‹"></a>å®‰è£… pp åŠ©æ‰‹</h2><p>æ—¢ç„¶å·²ç»å®‰è£…äº† <code>iFunBox</code> å·¥å…·, é‚£ä¸ºä»€ä¹ˆè¿˜éœ€è¦å®‰è£… <code>pp åŠ©æ‰‹</code> ä¹‹ç±»çš„å·¥å…·å‘¢? å…¶å®, è¿™ä¸ªçœ‹ä¸ªäººçš„éœ€è¦å§, åœ¨æŸç§ç¨‹åº¦ä¸Š, <code>pp åŠ©æ‰‹</code> çš„ç•Œé¢å’Œä¾¿æ·æ€§è¦æ¯” <code>iFunBox</code> å¥½ä¸€ç‚¹.</p>
<p>å®‰è£…å¥½ <code>pp åŠ©æ‰‹</code> å, ç‚¹å‡» Tools/File Manager æ˜¾ç¤ºçš„ç›®å½•å¯¼èˆª, å¦‚å›¾:</p>
<p><img src="/upload/images/2018/05/13/5.jpg" alt=""></p>
<p>å¯ä»¥çœ‹å‡º, ç›¸æ¯” <code>iFunBox</code> çš„ç•Œé¢æ˜¾ç¤º, <code>pp åŠ©æ‰‹</code> å·¥å…·æ˜¾å¾—æ›´åŠ å‹å¥½ä¸€äº›. </p>
<p>è‡³äºä½¿ç”¨å“ªä¸ªå·¥å…·, è¦çœ‹ä¸ªäººçˆ±å¥½å’Œè‡ªå·±çš„å·¥ä½œéœ€è¦, æ¯•ç«Ÿå·¥å…·éƒ½æ˜¯ä¸ºäº†æé«˜æˆ‘ä»¬å­¦ä¹ å’Œå·¥ä½œæ•ˆç‡çš„, æ²¡æœ‰ä»€ä¹ˆç»å¯¹çš„å¥½ä¸å, è‡ªå·±è§‰å¾—åˆé€‚é¡ºæ‰‹å°±å¥½äº†, æœ€ä¸»è¦çš„æ˜¯èƒ½å¤Ÿå¸®åˆ°è‡ªå·±. æˆ‘ä¸€èˆ¬æ˜¯å°†ä¸¤è€…ç»“åˆä½¿ç”¨çš„, å½“ç„¶ä½ å¦‚æœä½ æœ‰æ›´å¥½çš„å·¥å…·ä¹Ÿå¯ä»¥æ¨èç»™æˆ‘.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jailbreak </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS é€†å‘: è¶Šç‹±ä½¿ç”¨ SSH]]></title>
      <url>/2018/05/12/iOS-%E9%80%86%E5%90%91-%E8%B6%8A%E7%8B%B1%E4%BD%BF%E7%94%A8-SSH/</url>
      <content type="html"><![CDATA[<h2 id="è¶Šç‹±"><a href="#è¶Šç‹±" class="headerlink" title="è¶Šç‹±"></a>è¶Šç‹±</h2><p>ä½¿ç”¨è‹¹æœè®¾å¤‡æˆ–è€…åš iOS å¼€å‘çš„æœ‹å‹ä»¬, å‡ ä¹éƒ½åº”è¯¥å¬è¯´è¿‡è¶Šç‹±è¿™ä¸ªè¯. é‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯è¶Šç‹±å‘¢?</p>
<blockquote>
<p>iOSè¶Šç‹±ï¼ˆè‹±è¯­ï¼šiOS Jailbreakingï¼‰æ˜¯è·å– iOS è®¾å¤‡çš„ Root æƒé™çš„æŠ€æœ¯æ‰‹æ®µã€‚iOS è®¾å¤‡çš„ Root æƒé™ä¸€èˆ¬æ˜¯ä¸å¼€æ”¾çš„ã€‚ç”±äºè·å¾—äº†Root æƒé™ï¼Œåœ¨è¶Šç‹±ä¹‹å‰æ— æ³•æŸ¥çœ‹çš„ iOS çš„æ–‡ä»¶ç³»ç»Ÿä¹Ÿå¯æŸ¥çœ‹.</p>
</blockquote>
<p>ä¸Šé¢æ˜¯ç»´åŸºç™¾ç§‘çš„è§£é‡Š, å…·ä½“å¯ä»¥å» <a href="https://zh.wikipedia.org/wiki/%E8%B6%8A%E7%8D%84_(iOS" target="_blank" rel="noopener">iOS è¶Šç‹±</a>) äº†è§£ä¸€ä¸‹. iOS çš„è¶Šç‹±å°±ç±»ä¼¼ Android è·å– root æƒé™ä¸€æ ·çš„é“ç†.</p>
<p>æ‰‹å¤´ä¸Šé¢ä¹‹å‰é—²ç½®äº†ä¸€å° iPhone4s, é—²æ¥æ— äº‹å°±æŠŠä»–è¶Šç‹±äº†, åé¢ä¸çŸ¥é“æ€ä¹ˆæ“ä½œçš„, æ‰‹æœºå˜æˆäº†ç™½è‹¹æœ(å¼€æœºå°±ç™½å±, æ— æ³•è¿›å…¥ç³»ç»Ÿ), æœ€åæ²¡åŠæ³•, åªèƒ½å‡çº§ç³»ç»Ÿ, è¿™å°æ‰‹æœºä¹Ÿç®—æ˜¯åºŸäº†. </p>
<p>å½“æ—¶ä½¿ç”¨çš„å·¥å…·æ˜¯ <a href="http://www.pangu.io/" target="_blank" rel="noopener">ç›˜å¤è¶Šç‹±</a>, è¶Šç‹±çš„ iOS ç³»ç»Ÿæ˜¯ 7.x. ç°åœ¨ iOS å·²ç»å‡çº§åˆ° 11.x äº†, å¾ˆå¤š APP å’Œæ¸¸æˆå·²ç»ä¸å†æ”¯æŒ iOS8 ä»¥ä¸‹çš„ç³»ç»Ÿäº†, ç³»ç»Ÿçš„å®‰å…¨æ€§ä¹Ÿè¶Šæ¥è¶Šå¥½äº†, è¶Šç‹±ç ´è§£çš„éš¾åº¦ä¹Ÿéšä¹‹æé«˜äº†, ç›®å‰å¸‚é¢ä¸Šèƒ½è¶Šç‹±çš„æœ€é«˜ç‰ˆæœ¬åº”è¯¥æ˜¯ 10.3.x çš„ç³»ç»Ÿ(æˆªæ­¢åˆ°è¯¥ç¯‡æ–‡ç« å†™çš„æ—¶å€™). </p>
<p>ä¸ºäº†èƒ½å¤Ÿåˆ†æå’Œå­¦ä¹ ä¸€äº›ä¼˜ç§€ App çš„è®¾è®¡, æˆ‘ç´¢æ€§ä¹°äº†å°iPhone6sPlus æ‹¿æ¥è¶Šç‹±, æ‰€ä»¥æ¥ä¸‹æ¥çš„åˆ†äº«éƒ½æ˜¯åŸºäºè¿™å°æ‰‹æœºçš„.</p>
<p><strong>è¶Šç‹±å·¥å…·å’Œè®¾å¤‡</strong></p>
<p>[1]. è®¾å¤‡ iPhone6s Plus, ç³»ç»Ÿ iOS10.3.2<br>[2]. è¶Šç‹±å·¥å…·: çˆ±æ€åŠ©æ‰‹å’Œ doubleH3lix.ipa</p>
<p>å®‰è£…å¹¶æ‰“å¼€ pc ä¸Šé¢çš„ <code>çˆ±æ€åŠ©æ‰‹</code> ç›´æ¥å¼€å§‹è¶Šç‹±, çˆ±æ€åŠ©æ‰‹ä¼šå¸®æ‚¨åœ¨è®¾å¤‡ä¸Šå®‰è£… <code>doubleH3lix</code>. è¿è¡Œ <code>doubleH3lix</code> åº”ç”¨ï¼Œç‚¹å‡» <code>jailbreak</code> æŒ‰é’®ï¼Œç­‰å¾…è®¾å¤‡è‡ªè¡Œé‡å¯.</p>
<p>æ‰‹æœºé‡å¯å, ä½ ä¼šçœ‹åˆ° <code>Cydia</code> é™é™çš„å‘†åœ¨é‚£é‡Œäº†, è¿™ç§æ–¹å¼çš„è¶Šç‹±å±äºéå®Œç¾è¶Šç‹±, æ¢å¥è¯è¯´å°±æ˜¯æ²¡æœ‰çœŸæ­£çš„ç ´è§£ iOS ç³»ç»Ÿ.</p>
<p>å¦‚æœå‘ç°æ‰‹æœºæ–­ç”µå…³æœºæˆ–è€…é‡å¯å <code>Cydia</code> ä¸€æ‰“å¼€å°±é—ªé€€, å°±ä½¿ç”¨ <code>doubleH3lix</code> é‡æ–°è¶Šç‹±å°±å¯ä»¥äº†, å¦‚æœè¿˜æ˜¯ä¸è¡Œå°±éœ€è¦é‡æ–°ä½¿ç”¨ <code>çˆ±æ€åŠ©æ‰‹</code> äº†.</p>
<p>å‚è€ƒè¶Šç‹±æ•™ç¨‹ <a href="https://weibo.com/ttarticle/p/show?id=2309404217487167220184" target="_blank" rel="noopener">64ä½è®¾å¤‡iOS 10-10.3.3çˆ±æ€åŠ©æ‰‹ä¸€é”®è¶Šç‹±æ•™ç¨‹</a>.</p>
<h2 id="å®‰è£…-iOS-ç»ˆç«¯"><a href="#å®‰è£…-iOS-ç»ˆç«¯" class="headerlink" title="å®‰è£… iOS ç»ˆç«¯"></a>å®‰è£… iOS ç»ˆç«¯</h2><p>å®‰è£…ç»ˆç«¯, åœ¨ Cydia ä¸­æœç´¢ MTerminal, å®‰è£…å³å¯.</p>
<p><img src="/upload/images/2018/05/12/1.jpg" alt=""></p>
<p>å®‰è£…å¥½ç»ˆç«¯å·¥å…·å, æ‰“å¼€ç»ˆç«¯, è¾“å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">su</div></pre></td></tr></table></figure>
<p>ç´§æ¥ç€è®©ä½ è¾“å…¥å¯†ç , é»˜è®¤çš„ root ç”¨æˆ·å¯†ç æ˜¯ <code>alpine</code>. è¾“å…¥æ”¹å¯†ç å›è½¦å³å¯.</p>
<p>ä¸ºäº†å®‰å…¨èµ·è§, ä¿®æ”¹é»˜è®¤å¯†ç  <code>alpine</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">passwd</div></pre></td></tr></table></figure>
<p>è¿ç»­è¾“å…¥ç›¸åŒçš„å¯†ç å³ä¸ºå‘¢ä¿®æ”¹åçš„æ–°å¯†ç .</p>
<h2 id="é…ç½®-SSH"><a href="#é…ç½®-SSH" class="headerlink" title="é…ç½® SSH"></a>é…ç½® SSH</h2><p>é…ç½®å’Œä½¿ç”¨ SSH åŠŸèƒ½æ˜¯åç»­è¶Šç‹±å·¥ä½œçš„åŸºç¡€, è¿™æ ·å°±å¯ä»¥åœ¨ MacOS çš„ç»ˆç«¯ä¸­è®¿é—® iOS ç³»ç»Ÿäº†, å„ç§ shell å‘½ä»¤è®©ä½ å€æ„Ÿäº²åˆ‡, æ‰€ä»¥å¤§å®¶å°½é‡è¦å®Œæˆè¯¥æ­¥éª¤. è¯•æƒ³ä¸€ä¸‹, æœ¬æ¥æ‰‹æœºä¸Šé¢æ–‡å­—è¾“å…¥çš„ä½“éªŒå°±ä¸å¥½, è¿˜éœ€è¦åœ¨ iPhone è®¾å¤‡ä¸Šé¢çš„ç»ˆç«¯ä¸­æ•²ç€å‘½ä»¤â€¦æ²¡æ³•å¿!</p>
<p>iOS 10 è¶Šç‹±ä»¥åè‡ªå¸¦äº† SSH, æ‰€ä»¥ä¸éœ€è¦å•ç‹¬å» Cydia ä¸‹è½½å’Œå®‰è£… <code>OpenSSH</code>.</p>
<p>å¾ˆå¤šäººè¶Šç‹±å, å‘ç°ä¹Ÿå®‰è£…äº† OpenSSH, ä½†æ˜¯ä¸€æ—¦è¿æ¥ iPhone è®¾å¤‡å°±æ— æ³•è¿æ¥ç”šè‡³æŠ¥é”™. å¦‚æœä½ å·²ç»å®‰è£…äº† OpenSSH å¹¶ä¸”æ— æ³•ä½¿ç”¨ SSH æ¥æ“ä½œä½ çš„ iPhone è®¾å¤‡, è¯·ç»§ç»­å¾€ä¸‹çœ‹.</p>
<p>[1]. æ‰“å¼€ Cydia, åˆ†åˆ«æœç´¢ OpenSSL å’Œ Openssh, ç„¶ååˆ†åˆ«å¸è½½ OpenSSL å’Œ Openssh.</p>
<p>[2]. æ‰“å¼€ Cydia, æ·»åŠ æºï¼š<code>http://cydia.ichitaso.com/test</code></p>
<p><img src="/upload/images/2018/05/12/2.jpg" alt=""></p>
<p>ç‚¹å‡»å·¦ä¸Šè§’çš„ <code>æ·»åŠ </code>, åœ¨å¼¹æ¡†ä¸­è¾“å…¥å¯¹åº”çš„æºåœ°å€å³å¯.</p>
<p>[3]. åœ¨ Cydia ä¸­æœç´¢ <code>dropbear</code> å¹¶å®‰è£….</p>
<p><img src="/upload/images/2018/05/12/3.jpg" alt=""></p>
<p>å®‰è£…å³å¯.</p>
<p>å®‰è£…æˆåŠŸå, ä¸€èˆ¬å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ SSH åŠŸèƒ½äº†.</p>
<p>æ‰“å¼€ MacOS ç»ˆç«¯, å¼€å§‹ä½¿ç”¨ SSH è¿æ¥ä½ çš„ iPhone è®¾å¤‡.</p>
<p>[1]. æŸ¥çœ‹ iPhone è®¾å¤‡çš„(wifi) IP åœ°å€. å¦‚æˆ‘çš„æ˜¯ <code>192.168.1.105</code>.<br>[2]. ä½¿ç”¨ MacOS ç»ˆç«¯, è¾“å…¥:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh root@192.168.1.105</div></pre></td></tr></table></figure>
<p>æˆåŠŸçš„è¯, å®ƒå…ˆä¼šè­¦å‘Šä½ æ˜¯å¦ç»§ç»­æ“ä½œ, è¾“å…¥ <code>yes</code> å³å¯, ç„¶ååˆæç¤ºä½ è¾“å…¥ root å¯†ç , å¯†ç å°±æ˜¯å‰é¢è¯´çš„ä¿®æ”¹åçš„å¯†ç . å¦‚æœä½ æ²¡æœ‰ä¿®æ”¹å¯†ç , é‚£å°±æ˜¯ <code>alpine</code>. æ“ä½œæµç¨‹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">The authenticity of host &apos;192.168.1.105 (192.168.1.105)&apos; can&apos;t be established.</div><div class="line">ECDSA key fingerprint is SHA256:ANF7Cvc1yM/ZdaHyz9V1EHjG115cylIcHWyOzCL+kzs.</div><div class="line">Are you sure you want to continue connecting (yes/no)? yes</div><div class="line">Warning: Permanently added &apos;192.168.1.105&apos; (ECDSA) to the list of known hosts.</div><div class="line">root@192.168.1.105&apos;s password:</div></pre></td></tr></table></figure>
<p>ä¹‹å‰åœ¨ iOS 10.2.x è¶Šç‹±ä¿®æ”¹å¯¹åº”çš„é…ç½®æ–‡ä»¶, å°±å¯ä»¥ä½¿ç”¨ SSH åŠŸèƒ½äº†, ä½†æ˜¯åœ¨ iOS10.3.x æ— æµäºäº‹, å¦‚æœä½ æ˜¯iOS 10.2.x çš„è¶Šç‹±æ‰‹æœº, å¯ä»¥å‚è€ƒæœ¬æ–‡æœ«é™„å½•é…ç½® SSH, ä¹Ÿæ˜¯æˆ‘ä¹‹å‰å®è·µçš„ç»“æœ.</p>
<h2 id="usbmuxd"><a href="#usbmuxd" class="headerlink" title="usbmuxd"></a>usbmuxd</h2><p>ä¸Šé¢æ˜¯é€šè¿‡ wifi æ¥è¿æ¥ iPhone è®¾å¤‡çš„, å…¶å®è¿˜æœ‰ä¸€ç§æ–¹å¼, å°±æ˜¯å€ŸåŠ©äº <code>usbmuxd</code> è¿™ä¸ªå·¥å…·é€šè¿‡ USB è¿æ¥(æ‰‹æœºæ•°æ®çº¿è¿æ¥ç”µè„‘)ä¸éœ€è¦ wifi, USBè¿æ¥æ¯” wifi å“åº”é€Ÿåº¦å¿«ï¼Œä¸”æ— ç½‘ç»œç¯å¢ƒçš„é™åˆ¶.</p>
<p>ä½¿ç”¨ usbmuxd çš„å‰ææ˜¯ä½ çš„æ‰‹æœºå¯ä»¥æ­£å¸¸çš„ä½¿ç”¨ SSH åŠŸèƒ½, å¦åˆ™ usbmuxd ä¹Ÿæ— æ³•æ•‘ä½ .</p>
<p>[1].MacOS å®‰è£… <code>usbmuxd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install usbmuxd</div></pre></td></tr></table></figure>
<p>[2]. ä½¿ç”¨ <code>usbmuxd</code> è‡ªå¸¦å·¥å…· <code>iproxy</code>.</p>
<p><code>iproxy</code> å¯ä»¥å¿«æ·çš„æ“ä½œè¿æ¥ iPhone ç­‰æ“ä½œ.</p>
<p>MacOS ä¸Šåªæ”¯æŒ 4 ä½çš„ç«¯å£å·ï¼Œéœ€è¦æŠŠ iPhone çš„é»˜è®¤ç«¯å£ 22 æ˜ å°„åˆ° Mac ä¸Šé¢ä¸€ä¸ª 4 ä½ç«¯å£å·çš„ç«¯å£ä¸Šé¢ï¼Œç›¸å½“äºå»ºç«‹ä¸€ä¸ª Mac å’Œ iPhone ä¹‹é—´çš„é€šé“. <code>iproxy</code> å…·ä½“ä½¿ç”¨, åé¢å†è®². å¤§å®¶å…ˆå®‰è£…ä¸€ä¸‹å³å¯.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iproxy 5678 22</div><div class="line">waiting for connection</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå‘½ä»¤å°±æ˜¯æŠŠå½“å‰è¿æ¥è®¾å¤‡çš„ <code>22</code> ç«¯å£(SSHç«¯å£)æ˜ å°„åˆ°ç”µè„‘çš„ <code>5678</code> ç«¯å£ï¼Œé‚£ä¹ˆæƒ³å’Œè®¾å¤‡ <code>22</code> ç«¯å£é€šä¿¡ï¼Œç›´æ¥å’Œæœ¬åœ°çš„ <code>5678</code> ç«¯å£é€šä¿¡å°±å¯ä»¥äº†.</p>
<p>ç»ˆç«¯æç¤º <code>waiting for connection</code>, è¡¨ç¤ºè¿™ä¸¤ä¸ªç«¯å£ä¹‹é—´å·²ç»å¯ä»¥é€šä¿¡äº†ï¼Œä¿ç•™å½“å‰ç»ˆç«¯çª—å£(å¦‚æœå…³é—­å°±åœæ­¢ç«¯å£ä¹‹é—´çš„é€šä¿¡äº†)ï¼Œæ–°å»ºå¦ä¸€ä¸ªç»ˆç«¯è¾“å…¥ï¼Œé»˜è®¤å¯†ç  root å¯†ç .</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh -p 5678 root@127.0.0.1</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹, ç±»ä¼¼ä¸Šé¢é€šè¿‡ wifi æ“ä½œçš„æ–¹å¼.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">The authenticity of host &apos;[127.0.0.1]:5678 ([127.0.0.1]:5678)&apos; can&apos;t be established.</div><div class="line">ECDSA key fingerprint is SHA256:ANF7Cvc1yM/ZdaHyz9V1EHjG115cylIcHWyOzCL+kzs.</div><div class="line">Are you sure you want to continue connecting (yes/no)? yes</div><div class="line">Warning: Permanently added &apos;[127.0.0.1]:5678&apos; (ECDSA) to the list of known hosts.</div><div class="line">root@127.0.0.1&apos;s password:</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥, ä½ å°±å¯ä»¥åœ¨ MacOS ç»ˆç«¯ä¸Šé¢æ“ä½œä½ çš„ iPhone è®¾å¤‡äº†, å°½æƒ…çš„äº«å— shell å‘½ä»¤å§. ä¸ä½¿ç”¨çš„æ—¶å€™, è¾“å…¥ <code>exit</code> å³å¯é€€å‡º SSH.</p>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p><strong>[1]. iOS 10.2.x è¶Šç‹±ä½¿ç”¨ SSH åŠŸèƒ½.</strong></p>
<p>é¦–å…ˆä¿®æ”¹ root å¯†ç .</p>
<p>iOS 10.2 (è¶Šç‹±å)è‡ªå¸¦ OpenSSHï¼Œä¸éœ€è¦è‡ªå·±é‡æ–°å®‰è£… OpenSSH, ä½†æ˜¯éœ€è¦ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æ‰èƒ½ä½¿ç”¨.</p>
<p>åœ¨æ‰‹æœºä¸Šå®‰è£… MTERMINALï¼Œè¿è¡Œ suï¼Œè¾“å…¥ root å¯†ç ï¼Œæ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps aux|grep dropbear</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ çœ‹åˆ°çš„è¿›ç¨‹æ²¡æœ‰ dropbear, æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/bin/dropbear -F -R -p 22</div></pre></td></tr></table></figure>
<p>ç„¶åå°±å¯ä»¥è¿æ¥äº†ï¼Œé‡å¯ä¾ç„¶æœ‰æ•ˆ.</p>
<p>å¦‚æœä½ çœ‹åˆ°è¿›ç¨‹æ˜¯è¿™æ ·çš„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/bin/dropbear -F -R -p 127.0.0.1:22</div></pre></td></tr></table></figure>
<p>æ„æ€æ˜¯åªèƒ½æ•°æ®çº¿é‡å®šå‘è¿æ¥ SSHï¼Œå¦‚æœä½ æƒ³æ”¹æˆ WIFI å¯ä»¥è®¿é—®, éœ€è¦ä¿®æ”¹ <code>/private/var/containers/Bundle/Application/D9185B6D-EA9E-4678-B59C-BF43DEFE67BF/yalu102.app/dropbear.plist</code><br>æŠŠé‡Œé¢æœ‰ä¸ªå‚æ•° <code>127.0.0.1:22</code> æ”¹æˆ<code>22</code> ä¿å­˜ï¼Œé‡å¯æ‰‹æœºå³å¯.</p>
<p><strong>[2]. ä½¿ç”¨ <code>usbmuxd</code> æ— æ³•ä½¿ç”¨ SSH</strong></p>
<p>æ‰§è¡Œ <code>ssh -p 5678 root@127.0.0.1</code> åæŠ¥é”™, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh_exchange_identification: read: Connection reset by peer</div></pre></td></tr></table></figure>
<p>è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯æ²¡æœ‰æ­£ç¡®çš„ä½¿ç”¨æ•°æ®çº¿è¿æ¥ Mac ç”µè„‘, ä½¿ç”¨æ•°æ®çº¿æ­£å¸¸è¿æ¥ Mac ç”µè„‘å³å¯è§£å†³é—®é¢˜.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jailbreak </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RunLoop: NSTimer å®ç°å¸¸é©»çº¿ç¨‹çš„é—®é¢˜]]></title>
      <url>/2018/05/06/RunLoop-NSTimer-%E5%AE%9E%E7%8E%B0%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<h2 id="å¯è¡Œæ€§"><a href="#å¯è¡Œæ€§" class="headerlink" title="å¯è¡Œæ€§"></a>å¯è¡Œæ€§</h2><p>åœ¨ <a href="http://www.veryitman.com/2018/04/21/%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BB%80%E4%B9%88%E4%BD%93%E9%AA%8C/" target="_blank" rel="noopener">å¸¸é©»çº¿ç¨‹æ˜¯ä¸€ç§ä»€ä¹ˆä½“éªŒ</a> è¿™ç¯‡æ–‡ç« ä¸­ç»™å¤§å®¶åˆ†äº«äº†å¦‚ä½•åˆ©ç”¨ RunLoop çš„ç‰¹æ€§, ç»“åˆ <code>NSMachPort</code> å®ç°ä¸€ä¸ª <code>å¸¸é©»çº¿ç¨‹</code> çš„ä¸»é¢˜å†…å®¹.</p>
<p>ä»Šå¤©æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹ä½¿ç”¨ <code>NSTimer</code> å¦‚ä½•å®ç° <code>å¸¸é©»çº¿ç¨‹</code> ä»¥åŠæ³¨æ„äº‹é¡¹.</p>
<p>ä» RunLoop çš„ç‰¹æ€§æ¥çœ‹, åªè¦æœ‰ Source æˆ–è€… Timer éƒ½ä¼šä½¿å…¶èƒ½è‡ªå¾ªç¯ä½¿ç”¨, ä¸ä¼šç«‹å³ç»ˆæ­¢å½“å‰çº¿ç¨‹çš„æ‰§è¡Œ, æ‰€ä»¥ä»ç†è®ºä¸Šæ¥çœ‹ <code>NSTimer</code> æ˜¯å¯ä»¥è¾¾åˆ°åˆ›å»º <code>å¸¸é©»çº¿ç¨‹</code> çš„ç›®çš„çš„.</p>
<h2 id="å¼€å§‹å®è·µ"><a href="#å¼€å§‹å®è·µ" class="headerlink" title="å¼€å§‹å®è·µ"></a>å¼€å§‹å®è·µ</h2><p>å®Œæ•´çš„ä¾‹å­ä»£ç , å¯ä»¥ä»æ–‡ç« çš„é™„å½•è·å–å’ŒæŸ¥çœ‹, è¿™é‡Œåªç»™å‡ºæ ¸å¿ƒä»£ç .</p>
<p><strong><em>åˆ›å»ºçº¿ç¨‹</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (NSThread *)permanentThread &#123;</div><div class="line">    </div><div class="line">    static NSThread *thread = nil;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        </div><div class="line">        thread = [[NSThread alloc] initWithTarget:self selector:@selector(asyncRun) object:nil];</div><div class="line">        [thread setName:@&quot;veryitman-thread&quot;];</div><div class="line">        </div><div class="line">        // åŒä¸€ä¸ªçº¿ç¨‹è¿ç»­å¤šæ¬¡ start ä¼šå¯¼è‡´ crash</div><div class="line">        [thread start];</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    return thread;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong><em>çº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">- (void)asyncRun &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">        </div><div class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</div><div class="line">        </div><div class="line">        // ä¿æŒå¸¸é©»çº¿ç¨‹: ä½¿ç”¨ NSTimer</div><div class="line">        [self _attachTimerToRunLoop];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</div><div class="line">        </div><div class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</div><div class="line">        //...</div><div class="line">        </div><div class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</div><div class="line">        [runLoop run];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong><em>åˆ›å»ºå®šæ—¶å™¨</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (void)_attachTimerToRunLoop &#123;</div><div class="line">    </div><div class="line">    if (nil == self.timer) &#123;</div><div class="line">        </div><div class="line">        // scheduledTimerWithTimeInterval è¿™ç§æ–¹å¼</div><div class="line">        // åˆ›å»ºçš„ Timer ä¼šé»˜è®¤åŠ å…¥åˆ°å½“å‰çš„ RunLoop çš„ NSDefaultRunLoopMode ä¸­</div><div class="line">        _timer = [NSTimer scheduledTimerWithTimeInterval:2</div><div class="line">                                                  target:self</div><div class="line">                                                selector:@selector(runTimer)</div><div class="line">                                                userInfo:nil</div><div class="line">                                                 repeats:YES];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡º, <code>_attachTimerToRunLoop</code> ä¸­æ˜¯å°† timer åŠ å…¥åˆ°å½“å‰çš„ RunLoop å½“ä¸­äº†. è¿™é‡Œæ³¨æ„, repeats å€¼è¢«è®¾ç½®ä¸º <code>YES</code> äº†.</p>
<p>è·Ÿä¹‹å‰ä¸€æ ·, å¯ä»¥ä½¿ç”¨ç‚¹å‡»äº‹ä»¶æ¥æ¨¡æ‹Ÿå’ŒéªŒè¯å¸¸é©»çº¿ç¨‹çš„æœ‰æ•ˆæ€§.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</div><div class="line">    </div><div class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</div><div class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</div><div class="line">    </div><div class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¯ç‚¹å‡»ä¸€æ¬¡å±å¹•, éƒ½ä¼šå¯¹åº”æ‰§è¡Œ <code>runAnyTime</code> é‡Œé¢çš„å†…å®¹.</p>
<h2 id="å¯¹-repeat-çš„æ€è€ƒ"><a href="#å¯¹-repeat-çš„æ€è€ƒ" class="headerlink" title="å¯¹ repeat çš„æ€è€ƒ"></a>å¯¹ repeat çš„æ€è€ƒ</h2><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­, æˆ‘å°† <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>YES</code>, è¯•æƒ³ä¸€ä¸‹å¦‚æœæŠŠ <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>NO</code>, ä¼šä¸ä¼šé€ æˆå¸¸é©»çº¿ç¨‹å¤±æ•ˆå‘¢?</p>
<p>åŠ¨æ‰‹è¯•è¯•â€¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (void)_attachTimerToRunLoop &#123;</div><div class="line">    </div><div class="line">    if (nil == self.timer) &#123;</div><div class="line">        </div><div class="line">        // scheduledTimerWithTimeInterval è¿™ç§æ–¹å¼</div><div class="line">        // åˆ›å»ºçš„ Timer ä¼šé»˜è®¤åŠ å…¥åˆ°å½“å‰çš„ RunLoop çš„ NSDefaultRunLoopMode ä¸­</div><div class="line">        _timer = [NSTimer scheduledTimerWithTimeInterval:2</div><div class="line">                                                  target:self</div><div class="line">                                                selector:@selector(runTimer)</div><div class="line">                                                userInfo:nil</div><div class="line">                                                 repeats:NO];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†æ¬¡ç‚¹å‡»å±å¹•è‹¥å¹²æ¬¡, åŒæ ·ä¼šæ‰§è¡Œå¯¹åº”å‡½æ•°é‡Œé¢çš„å†…å®¹. è¿™å°±è¯´æ˜äº†å³ä½¿å°† <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>NO</code>, ä¹Ÿä¸ä¼šå½±å“å¸¸é©»çº¿ç¨‹.</p>
<p>é‚£æˆ‘ä»¬å†æ¥ç‚¹å…·æœ‰æŒ‘æˆ˜çš„æ´»åŠ¨â€¦</p>
<p>å°†å½“å‰é¡µé¢åŠ å…¥ <code>UIScrollview</code> è¿™ä¸ªè§†å›¾, è¿˜æ˜¯ä¿æŒ <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>NO</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    self.view.backgroundColor = [UIColor lightGrayColor];</div><div class="line">    self.navigationItem.title = @&quot;NSTimer åˆ›å»ºå¸¸é©»çº¿ç¨‹&quot;;</div><div class="line">    </div><div class="line">    // åŠ å…¥æ»šåŠ¨è§†å›¾</div><div class="line">    _scrollView = [[UIScrollView alloc] initWithFrame:self.view.bounds];</div><div class="line">    [self.view addSubview:self.scrollView];</div><div class="line">    self.scrollView.contentSize = CGSizeMake(1000, 1000);</div><div class="line">    self.scrollView.delegate = self;</div><div class="line">    </div><div class="line">    // å¯åŠ¨çº¿ç¨‹</div><div class="line">    [self permanentThread];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› ä¸ºåŠ å…¥äº†æ»šåŠ¨è§†å›¾, æˆ‘ä»¬æ¢ä¸€ç§æ–¹å¼æ¥æ¨¡å¼å’ŒéªŒè¯å¸¸é©»çº¿ç¨‹.</p>
<p>åœ¨ <code>UIScrollview</code> ä»£ç†ä¸­æ¥æ¨¡æ‹Ÿ, ç¤ºä¾‹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView &#123;</div><div class="line">    </div><div class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</div><div class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</div><div class="line">    </div><div class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿è¡Œåè¿›å…¥è¯¥é¡µé¢, å¯ä»¥å‘ç°å¸¸é©»çº¿ç¨‹è¢«ç»ˆæ­¢äº†.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">veryitman--timerRun.</div><div class="line">veryitman--asyncRun. End Run.</div></pre></td></tr></table></figure>
<p>å½“é™¤æˆ‘ä»¥ä¸ºæ›´æ¢ä¸€ä¸‹æ¨¡å¼å³ä½¿ å°† <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>NO</code>, ä¹Ÿä¸ä¼šå‡ºç°å¸¸é©»çº¿ç¨‹è¢«ç»ˆæ­¢çš„é—®é¢˜. å¦‚ä¸‹é¢çš„ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_timer = [NSTimer timerWithTimeInterval:2 target:self selector:@selector(runTimer) userInfo:nil repeats:NO];</div><div class="line">[[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes];</div></pre></td></tr></table></figure>
<p>è¿™æ ·æ›´æ¢æ¨¡å¼ä¸º <code>NSRunLoopCommonModes</code> ä¹Ÿä¸è¡Œ.</p>
<p>åœ¨è¿™ç§æƒ…å†µ(æœ‰æ»šåŠ¨è§†å›¾çš„)ä¸‹, å°† <code>repeat</code> å‚æ•°è®¾ç½®ä¸º <code>YES</code> å°±ä¸ä¼šå¯¼è‡´å¸¸é©»çº¿ç¨‹è¢«ç»ˆæ­¢äº†, æ— è®ºå“ªç§æ–¹å¼åˆ›å»ºçš„ Timer.</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>1.å­çº¿ç¨‹åˆ›å»ºä¸­çš„ RunLoop çš„æ¨¡å¼ä¸ä¼šä¸ä¸»çº¿ç¨‹ä¸­ RunLoop çš„æ¨¡å¼å†²çª, å„è‡ªè¿è¡Œåœ¨å„è‡ªçš„ mode å½“ä¸­. </p>
<p>2.ä½¿ç”¨ <code>NSTimer</code> æ¥åˆ›å»ºå¸¸é©»çº¿ç¨‹, åœ¨æœ‰ <code>UIScrollview</code> æˆ–è€…å…¶å­ç±»çš„æƒ…å†µä¸‹, éœ€è¦å°† <code>repeats</code> è®¾ç½®ä¸º <code>YES</code>, å¦åˆ™ä¸ä¼šåˆ›å»ºå¸¸é©»çº¿ç¨‹. æ²¡æœ‰æ»šåŠ¨è§†å›¾çš„æƒ…å†µä¸‹, <code>repeats</code> è®¾ç½®ä¸º <code>NO</code> ä¹Ÿæ²¡æœ‰å…³ç³».</p>
<p>3.åˆ›å»º NSTimer</p>
<p>ä¸‹é¢ä¸¤ç§åˆ›å»º Timer çš„æ•ˆæœæ˜¯ä¸€è‡´çš„.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[NSTimer scheduledTimerWithTimeInterval:2</div><div class="line">                  target:self</div><div class="line">                selector:@selector(runTimer)</div><div class="line">                userInfo:nil</div><div class="line">                 repeats:YES];</div></pre></td></tr></table></figure>
<p><code>scheduledTimerWithTimeInterval</code> é»˜è®¤ä¼šå°† Timer åŠ å…¥åˆ°å½“å‰çš„ RunLoop ä¸­.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[NSTimer timerWithTimeInterval:2 target:self selector:@selector(runTimer) userInfo:nil repeats:NO];</div><div class="line">[[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSDefaultRunLoopMode];</div></pre></td></tr></table></figure>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>å®Œæ•´ç¤ºä¾‹ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div></pre></td><td class="code"><pre><div class="line">#import &quot;MZTimerPermanentThreadController.h&quot;</div><div class="line"></div><div class="line">@interface MZTimerPermanentThreadController () &lt;UIScrollViewDelegate&gt;</div><div class="line"></div><div class="line">@property (nonatomic, strong) NSTimer *timer;</div><div class="line"></div><div class="line">@property (nonatomic, strong) UIScrollView *scrollView;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">@implementation MZTimerPermanentThreadController</div><div class="line"></div><div class="line">- (void)dealloc &#123;</div><div class="line">    </div><div class="line">    NSLog(@&quot;veryitman---MZTimerPermanentThreadController dealloc.&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    self.view.backgroundColor = [UIColor lightGrayColor];</div><div class="line">    self.navigationItem.title = @&quot;NSTimer åˆ›å»ºå¸¸é©»çº¿ç¨‹&quot;;</div><div class="line">    </div><div class="line">    // åŠ å…¥æ»šåŠ¨è§†å›¾</div><div class="line">    _scrollView = [[UIScrollView alloc] initWithFrame:self.view.bounds];</div><div class="line">    [self.view addSubview:self.scrollView];</div><div class="line">    self.scrollView.contentSize = CGSizeMake(1000, 1000);</div><div class="line">    self.scrollView.delegate = self;</div><div class="line">    </div><div class="line">    // å¯åŠ¨çº¿ç¨‹</div><div class="line">    [self permanentThread];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidDisappear:(BOOL)animated &#123;</div><div class="line">    </div><div class="line">    [super viewDidDisappear:animated];</div><div class="line">    </div><div class="line">    // å–æ¶ˆçº¿ç¨‹</div><div class="line">    // å®é™…ä¸šåŠ¡åœºæ™¯ä¸­è‡ªè¡Œå†³å®š canCancel çš„è®¾ç½®, è¿™é‡Œåªæ˜¯ç¤ºä¾‹</div><div class="line">    BOOL canCancel = YES;</div><div class="line">    if (canCancel) &#123;</div><div class="line">        </div><div class="line">        [self.timer invalidate];</div><div class="line">        _timer = nil;</div><div class="line">        </div><div class="line">        [[self permanentThread] cancel];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView &#123;</div><div class="line">    </div><div class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</div><div class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</div><div class="line">    </div><div class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</div><div class="line">    </div><div class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</div><div class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</div><div class="line">    </div><div class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (NSThread *)permanentThread &#123;</div><div class="line">    </div><div class="line">    static NSThread *thread = nil;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        </div><div class="line">        thread = [[NSThread alloc] initWithTarget:self selector:@selector(asyncRun) object:nil];</div><div class="line">        [thread setName:@&quot;veryitman-thread&quot;];</div><div class="line">        </div><div class="line">        // åŒä¸€ä¸ªçº¿ç¨‹è¿ç»­å¤šæ¬¡ start ä¼šå¯¼è‡´ crash</div><div class="line">        [thread start];</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    return thread;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)asyncRun &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">        </div><div class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</div><div class="line">        </div><div class="line">        // ä¿æŒå¸¸é©»çº¿ç¨‹: ä½¿ç”¨ NSTimer</div><div class="line">        [self _attachTimerToRunLoop];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</div><div class="line">        </div><div class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</div><div class="line">        //...</div><div class="line">        </div><div class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</div><div class="line">        [runLoop run];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)runAnyTime &#123;</div><div class="line">    </div><div class="line">    NSLog(@&quot;veryitman--runAnyTime. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)_attachTimerToRunLoop &#123;</div><div class="line">    </div><div class="line">    if (nil == self.timer) &#123;</div><div class="line">        </div><div class="line">        // scheduledTimerWithTimeInterval è¿™ç§æ–¹å¼</div><div class="line">        // åˆ›å»ºçš„ Timer ä¼šé»˜è®¤åŠ å…¥åˆ°å½“å‰çš„ RunLoop çš„ NSDefaultRunLoopMode ä¸­</div><div class="line">        _timer = [NSTimer scheduledTimerWithTimeInterval:2</div><div class="line">                                                  target:self</div><div class="line">                                                selector:@selector(runTimer)</div><div class="line">                                                userInfo:nil</div><div class="line">                                                 repeats:YES];</div><div class="line">        </div><div class="line">#if 0</div><div class="line">        _timer = [NSTimer timerWithTimeInterval:2 target:self selector:@selector(runTimer) userInfo:nil repeats:NO];</div><div class="line">        [[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes];</div><div class="line">#endif</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)runTimer &#123;</div><div class="line">    </div><div class="line">    NSLog(@&quot;--veryitman--timerRun.&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> RunLoop å¸¸é©»çº¿ç¨‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å¸¸é©»çº¿ç¨‹æ˜¯ä¸€ç§ä»€ä¹ˆä½“éªŒ]]></title>
      <url>/2018/04/21/%E5%B8%B8%E9%A9%BB%E7%BA%BF%E7%A8%8B%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BB%80%E4%B9%88%E4%BD%93%E9%AA%8C/</url>
      <content type="html"><![CDATA[<h2 id="ç®€è¯´-RunLoop"><a href="#ç®€è¯´-RunLoop" class="headerlink" title="ç®€è¯´ RunLoop"></a>ç®€è¯´ RunLoop</h2><p>å…³äº iOS RunLoop ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æœ‰ä»‹ç»è¿‡, å¾ˆå¤šæŠ€æœ¯é¢è¯•å®˜ä¹Ÿä¼šé—®å…³äº RunLoop çš„ç›¸å…³çŸ¥è¯†. æˆ‘æŠŠè‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜å’Œæ€»ç»“çš„ç»éªŒåˆ†äº«å‡ºæ¥(ä¼šåšæˆä¸€ç³»åˆ—çš„æ–‡ç« ), ä¹Ÿç®—æ˜¯å¯¹è‡ªå·±çš„ä¸€ä¸ªæ€»ç»“å’Œæ²‰æ·€, æ¬¢è¿å¤§å®¶äº¤æµ.</p>
<p>ç½‘ä¸Šçš„æ–‡ç« åŸºæœ¬éƒ½æ˜¯é’ˆå¯¹äº <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html" target="_blank" rel="noopener">Apple Developer Doc - Run Loops</a> è¿™ç¯‡æ¥å±•å¼€çš„, æ‰€ä»¥å»ºè®®å¤§å®¶è®¤çœŸçš„å»é€šè¯»è¿™ç¯‡æ–‡ç« , å¹¶å†™ä»£ç éªŒè¯, å®è·µ.</p>
<p>å¯ä»¥ç®€å•ç²—æš´çš„è¿™ä¹ˆç†è§£ä¸€ä¸‹ RunLoop, åŸºäºäº‹ä»¶é©±åŠ¨çš„æ­»å¾ªç¯(ç”±å†…æ ¸æ¥è°ƒåº¦å’Œç®¡ç†çš„), åœ¨éœ€è¦å¤„ç†äº‹æƒ…çš„æ—¶å€™å°±å‡ºæ¥å¹²ç‚¹äº‹, å¦åˆ™ä¼‘çœ å¾…å‘½.<br>RunLoop çš„æ ¸å¿ƒæ˜¯åŸºäº <code>machport</code> çš„ï¼Œå…¶è¿›å…¥ä¼‘çœ æ—¶è°ƒç”¨çš„å‡½æ•°æ˜¯ mach_msg().</p>
<p>ç±»ä¼¼ä¸‹é¢çš„ä»£ç æ¥è¯´æ˜ä¸€ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">BOOL stopRunning = NO;</div><div class="line"></div><div class="line">do &#123;</div><div class="line">   </div><div class="line">   // å¤„ç† App ä¸­å„ç§æ“ä½œå„ç§äº‹ä»¶</div><div class="line">   // ç‚¹å‡»å±å¹•, è§¦æ‘¸åˆ°ç¡¬ä»¶ä¹Ÿä¼šå”¤é†’ RunLoop</div><div class="line">   </div><div class="line">  &#125; while(!stopRunning);</div></pre></td></tr></table></figure>
<p>è¯´åˆ°è¿™é‡Œ, éšä¾¿æåŠä¸€ä¸‹, å­¦ä¹ è¿‡ Android å¼€å‘çš„åŒäº‹åº”è¯¥å’Œå¥½ç†è§£ RunLoop äº†,  iOS çš„ RunLoop è·Ÿ Android çš„ Looper æœºåˆ¶å‡ ä¹ä¸€æ ·, åªæ˜¯ä¸åŒçš„ç³»ç»Ÿä¹‹é—´å®ç°æœ‰å·®å¼‚ç½¢äº†!</p>
<p>æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹ä¸€ä¸‹æˆ‘ä¹‹å‰å†™çš„æ–‡ç«  <a href="https://blog.csdn.net/veryitman/article/details/6384641" target="_blank" rel="noopener">Handler: æ›´æ–°UIçš„æ–¹æ³•</a>.</p>
<hr>
<p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•åœ¨ iOS ä¸­ç»“åˆ RunLoop å’Œ machport å®ç°å¸¸é©»çº¿ç¨‹, å…ˆè·Ÿç€å®ä¾‹èµ°, åç»­å†å»æ€»ç»“ RunLoop çš„å„ç§ç»†èŠ‚ç‚¹.</p>
<h2 id="ç¥å¥‡çš„-main"><a href="#ç¥å¥‡çš„-main" class="headerlink" title="ç¥å¥‡çš„ main"></a>ç¥å¥‡çš„ main</h2><p>å¼€å‘è¿‡ iOS åº”ç”¨ä¸­çš„æœ‹å‹, å¯¹ <code>main.m</code> å†ä¹Ÿç†Ÿæ‚‰ä¸è¿‡äº†, <code>main</code> å‡½æ•°æ­£æ˜¯åº”ç”¨çš„å…¥å£å‡½æ•°.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">int main(int argc, char * argv[]) &#123;</div><div class="line">    @autoreleasepool &#123;</div><div class="line">        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°† <code>return</code> ä»£ç åˆ†å¼€å†™, çœ‹çœ‹æœ‰ä»€ä¹ˆè››ä¸é©¬è¿¹å¯å¯».</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">int main(int argc, char * argv[]) &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        </div><div class="line">        int ret = UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--- UIApplicationMain end.&quot;);</div><div class="line">        </div><div class="line">        return ret;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ— è®ºå¦‚ä½•ä½ ä¹Ÿçœ‹ä¸åˆ°æ—¥å¿— <code>veryitman--- UIApplicationMain end.</code> çš„æ‰“å°, è¿™è¯´æ˜ <code>UIApplicationMain</code> ä¸€ç›´åœ¨å‘µæŠ¤ç€ APP çš„è¿è¡Œ, å“ˆå“ˆ.</p>
<p>æˆ‘ä»¬ä¸å¦¨å†æ”¹ä¸€æ¬¡, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">int main(int argc, char * argv[]) &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        return 0;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†å»è¿è¡Œ APP, ä½ ä¼šå‘ç°æ ¹æœ¬æ²¡æœ‰è®© APP è¿è¡Œèµ·æ¥, å†æ¬¡è¯´æ˜æ²¡æœ‰äº† <code>UIApplicationMain</code> çš„å‘µæŠ¤, APP æ— æ³•èµ·æ­»å›ç”Ÿ.</p>
<p>çŒœæµ‹åœ¨ <code>UIApplicationMain</code> å‡½æ•°ä¸­ï¼Œå¼€å¯äº†å’Œä¸»çº¿ç¨‹ç›¸å…³çš„ RunLoopï¼Œä½¿ <code>UIApplicationMain</code> ä¸ä¼šè¿”å›ä¸€ç›´åœ¨è¿è¡Œä¸­ï¼Œä»è€Œä¿è¯äº†ç¨‹åºçš„æŒç»­è¿è¡Œ, æœ€å¤§çš„åŠŸè‡£å°±æ˜¯  RunLoop.</p>
<h2 id="æ™®é€šçº¿ç¨‹"><a href="#æ™®é€šçº¿ç¨‹" class="headerlink" title="æ™®é€šçº¿ç¨‹"></a>æ™®é€šçº¿ç¨‹</h2><p>ä¸€èˆ¬æˆ‘ä»¬å¼€å¯çš„çº¿ç¨‹åœ¨æ‰§è¡Œå®Œä»»åŠ¡å, å°±ä¼šç»“æŸè¯¥çº¿ç¨‹. é™¤éä½ å†™äº†ç±»ä¼¼ä¸‹é¢çš„ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">while(1) &#123;</div><div class="line">    // ä¸šåŠ¡å¤„ç†</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">while (æ¡ä»¶æ»¡è¶³) &#123;</div><div class="line">    // ä¸šåŠ¡å¤„ç†</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¼€å¯ä¸€ä¸ªçº¿ç¨‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (NSThread *)permanentThread &#123;</div><div class="line">    </div><div class="line">    static NSThread *thread = nil;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line"></div><div class="line">        thread = [[NSThread alloc] initWithTarget:self selector:@selector(asyncRun) object:nil];</div><div class="line">        [thread setName:@&quot;veryitman-thread&quot;];</div><div class="line">        </div><div class="line">        // åŒä¸€ä¸ªçº¿ç¨‹è¿ç»­å¤šæ¬¡ start ä¼šå¯¼è‡´ crash</div><div class="line">        [thread start];</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    return thread;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œå¯¹åº”çš„ <code>asyncRun</code> å‡½æ•°, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (void)asyncRun &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">        </div><div class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</div><div class="line">        //...</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç° <code>asyncRun</code> å¾ˆå¿«å°±å¯ä»¥æ‰§è¡Œå®Œæˆ (End Run).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">veryitman--asyncRun. Current Thread: &lt;NSThread: 0x60000066c400&gt;&#123;number = 3, name = veryitman-thread&#125;</div><div class="line">veryitman--asyncRun. End Run.</div></pre></td></tr></table></figure>
<h2 id="å­çº¿ç¨‹å¼€å¯-RunLoop"><a href="#å­çº¿ç¨‹å¼€å¯-RunLoop" class="headerlink" title="å­çº¿ç¨‹å¼€å¯ RunLoop"></a>å­çº¿ç¨‹å¼€å¯ RunLoop</h2><p>ä¸»çº¿ç¨‹æ˜¯é»˜è®¤å¼€å¯ RunLoop çš„å³ mainRunLoop æ˜¯ç³»ç»Ÿé»˜è®¤å¼€å¯çš„, ä½†æ˜¯å­çº¿ç¨‹ä¸­çš„ RunLoop éœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨å¼€å¯.</p>
<blockquote>
<p>å…³äºä¸ºä»€ä¹ˆå­çº¿ç¨‹ä¸­éœ€è¦æ‰‹åŠ¨å¼€å¯, åç»­æ–‡ç« ç»“åˆæºç ç»™å¤§å®¶åˆ†æ, è¿™é‡Œæš‚æ—¶å¯ä»¥ç†è§£ä¸ºè·å– RunLoop å¯¹è±¡æ˜¯ä¸€ç§æ‡’åŠ è½½æ¨¡å¼. åªä¸è¿‡ä¸»çº¿ç¨‹ä¸­, ç³»ç»Ÿå¸®æˆ‘ä»¬å¼€å¯äº†, ç„¶è€Œå­çº¿ç¨‹ä¸­éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¼€å¯è€Œå·².</p>
</blockquote>
<p>ç±»ä¼¼è¿™æ ·:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (void)asyncRun &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">        </div><div class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</div><div class="line">        </div><div class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</div><div class="line">        //...</div><div class="line">        </div><div class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</div><div class="line">        [runLoop run];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ°è¾“å‡º:</p>
<p><img src="/upload/images/2018/04/21/1.jpg" alt="1"></p>
<p>RunLoop æ²¡æœ‰ä»»ä½•è¾“å…¥æº(input source) å’Œå®šæ—¶å™¨(timer), è¿™æ—¶å³ä½¿å¼€å¯äº† RunLoop ä¹Ÿä¸ä¼šè®©å…¶ç­‰å¾…æ‰§è¡Œ, æ¢å¥è¯è¯´ä¼šç«‹å³ç»“æŸå½“å‰çš„ RunLoop.</p>
<p>æ—¢ç„¶è¿™æ ·æˆ‘ä»¬ç»™å­çº¿ç¨‹çš„ RunLoop æ·»åŠ æºæˆ–è€…å®šæ—¶å™¨å³å¯. è¿™é‡Œä»¥æ·»åŠ  NSPort ä¸ºä¾‹.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">- (void)asyncRun &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">        </div><div class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</div><div class="line">        </div><div class="line">        // æ·»åŠ  source</div><div class="line">        NSPort *port = [NSMachPort port];</div><div class="line">        [runLoop addPort:port forMode:NSRunLoopCommonModes];</div><div class="line">               </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</div><div class="line">        </div><div class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</div><div class="line">        //...</div><div class="line">        </div><div class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</div><div class="line">        [runLoop run];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†æ¬¡è¿è¡Œ, ä½ ä¼šå‘ç° <code>End Run</code> è¿™ä¸ª Log æ˜¯ä¸ä¼šæ‰“å°å‡ºæ¥çš„. å¯¹åº”å½“å‰çš„ RunLoop ä¹Ÿæœ‰äº†æºå’Œå®šæ—¶å™¨, å¦‚å›¾æ‰€ç¤º:<br><img src="/upload/images/2018/04/21/2.jpg" alt="1"></p>
<p>å…³äºå®šæ—¶å™¨å’Œ RunLoop çš„ç»“åˆ, ä¸‹ç¯‡å†åˆ†äº«. </p>
<p>ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚, éœ€è¦åœ¨æŒ‡å®šçš„çº¿ç¨‹ä¸­æ‰§è¡ŒæŸé¡¹ä»»åŠ¡, æ˜¾ç„¶ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥æ»¡è¶³éœ€æ±‚, ä¸‹é¢è¿›å…¥ä»Šå¤©çš„æ­£é¢˜.</p>
<h2 id="éªŒè¯å¸¸é©»çº¿ç¨‹"><a href="#éªŒè¯å¸¸é©»çº¿ç¨‹" class="headerlink" title="éªŒè¯å¸¸é©»çº¿ç¨‹"></a>éªŒè¯å¸¸é©»çº¿ç¨‹</h2><p>ä¸€å®šåˆ° <code>å¸¸é©»</code> è¿™ä¸ªè¯, å°±çŸ¥é“æ˜¯èƒ½å¤Ÿè®©è¯¥çº¿ç¨‹éšæ—¶å¾…å‘½, ä¿è¯å…¶ä¸æŒ‚æ‰.</p>
<p>iOS ä¸­é»˜è®¤å°±æœ‰ä¸ªä¸»çº¿ç¨‹å³ <code>main çº¿ç¨‹</code>, æˆ‘ä»¬çš„ UI çº¿ç¨‹æŒ‡çš„å°±æ˜¯ä¸»çº¿ç¨‹, ä¸€èˆ¬éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ“ä½œ UI, ä»æŸä¸ªè§’åº¦æ¥è¯´, ä¸»çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªå¸¸é©»çº¿ç¨‹.</p>
<p>æˆ‘ä»¬å¼€å¯å…¶ä»–çº¿ç¨‹, ç›®çš„æ˜¯ä¸ºäº†å¼‚æ­¥å®Œæˆä¸€äº›ä»»åŠ¡, è¿™äº›ä»»åŠ¡ä¸€èˆ¬éƒ½æ¯”è¾ƒè€—æ—¶, å¦‚æœæ”¾åœ¨ä¸»çº¿ç¨‹å½“ä¸­å®Œæˆè¿™äº›ä»»åŠ¡å°±ä¼šå¯¼è‡´ä¸»çº¿ç¨‹çš„å¡é¡¿, ç”¨æˆ·ä½“éªŒæå…¶å·®. </p>
<p>è¯´äº†è¿™ä¹ˆå¤š, ä¹Ÿè®¸ä½ ä¼šé—®, ä¸ºä»€ä¹ˆè¦å¸¸é©»çº¿ç¨‹å‘¢?</p>
<p>é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ï¼Œä¼šé€ æˆèµ„æº(ä¸»è¦æ˜¯å†…å­˜)çš„æµªè´¹, æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸è®©é¢‘ç¹ä½¿ç”¨çš„å­çº¿ç¨‹å¸¸é©»åœ¨å†…å­˜ä¸­, æƒ³ç”¨çš„æ—¶å€™å°±ç”¨, ä¸ç”¨çš„æ—¶å€™è®©ä»–ä¼‘çœ å‘¢?! </p>
<p>ä¸Šé¢å·²ç»ä½¿ç”¨ RunLoop æ¥å®ç°äº†è®©çº¿ç¨‹é•¿æ—¶é—´å­˜æ´»è€Œä¸è¢«é”€æ¯äº†.</p>
<p>ç”¨ <code>touchesBegan</code> æ¥æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸­å†æ¬¡æ‰§è¡Œä»»åŠ¡(runAnyTime)çš„æ–¹æ³•.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</div><div class="line">    </div><div class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</div><div class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</div><div class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)runAnyTime &#123;</div><div class="line">    </div><div class="line">    NSLog(@&quot;veryitman--runAnyTime. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯¹åº”ä¸Šé¢çš„ <code>asyncRun</code> å®ç°å³å¯, ä½ ä¼šå‘ç°åœ¨å½“å‰é¡µé¢æ¯æ¬¡ç‚¹å‡»å±å¹•éƒ½ä¼šæ‰§è¡Œ <code>runAnyTime</code>.</p>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ä»£ç çš„å®Œæ•´å®ç°</p>
<blockquote>
<p>å¸¸é©»çº¿ç¨‹, å¯ä»¥å‚è€ƒå…·ä½“çš„æ³¨é‡Š.</p>
</blockquote>
<p><strong>MZCreatePermanentThreadController.m</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line">@implementation MZCreatePermanentThreadController</div><div class="line"></div><div class="line">- (void)dealloc &#123;</div><div class="line">    </div><div class="line">    NSLog(@&quot;veryitman---MZCreatePermanentThreadController dealloc.&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    self.view.backgroundColor = [UIColor lightGrayColor];</div><div class="line">    self.navigationItem.title = @&quot;åˆ›å»ºå¸¸é©»çº¿ç¨‹&quot;;</div><div class="line">    </div><div class="line">    // å¯åŠ¨çº¿ç¨‹</div><div class="line">    [self permanentThread];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidDisappear:(BOOL)animated &#123;</div><div class="line">    </div><div class="line">    [super viewDidDisappear:animated];</div><div class="line">    </div><div class="line">    // å–æ¶ˆçº¿ç¨‹</div><div class="line">    // å®é™…ä¸šåŠ¡åœºæ™¯ä¸­è‡ªè¡Œå†³å®š canCancel çš„è®¾ç½®, è¿™é‡Œåªæ˜¯ç¤ºä¾‹</div><div class="line">    BOOL canCancel = YES;</div><div class="line">    if (canCancel) &#123;</div><div class="line">        [[self permanentThread] cancel];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</div><div class="line">    </div><div class="line">    // æ¨¡æ‹Ÿåœ¨æŒ‡å®šçº¿ç¨‹ä¸Šé¢å†æ¬¡æ‰§è¡Œæ–¹æ³•</div><div class="line">    SEL seltor = NSSelectorFromString(@&quot;runAnyTime&quot;);</div><div class="line">    </div><div class="line">    [self performSelector:seltor onThread:[self permanentThread] withObject:nil waitUntilDone:NO];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (NSThread *)permanentThread &#123;</div><div class="line">    </div><div class="line">    static NSThread *thread = nil;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line"></div><div class="line">        thread = [[NSThread alloc] initWithTarget:self selector:@selector(asyncRun) object:nil];</div><div class="line">        [thread setName:@&quot;veryitman-thread&quot;];</div><div class="line">        </div><div class="line">        // åŒä¸€ä¸ªçº¿ç¨‹è¿ç»­å¤šæ¬¡ start ä¼šå¯¼è‡´ crash</div><div class="line">        [thread start];</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    return thread;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)asyncRun &#123;</div><div class="line">    </div><div class="line">    @autoreleasepool &#123;</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">        </div><div class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</div><div class="line">        </div><div class="line">        // æ·»åŠ  source</div><div class="line">        NSPort *port = [NSMachPort port];</div><div class="line">        [runLoop addPort:port forMode:NSRunLoopCommonModes];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. Current RunLoop: %@&quot;, runLoop);</div><div class="line">        </div><div class="line">        // æ‰§è¡Œå…¶ä»–é€»è¾‘</div><div class="line">        //...</div><div class="line">        </div><div class="line">        // æ‰‹åŠ¨å¼€å¯ RunLoop</div><div class="line">        [runLoop run];</div><div class="line">        </div><div class="line">        NSLog(@&quot;veryitman--asyncRun. End Run.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)runAnyTime &#123;</div><div class="line">    </div><div class="line">    NSLog(@&quot;veryitman--runAnyTime. Current Thread: %@&quot;, [NSThread currentThread]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://developer.apple.com/library/content/documentation/General/Conceptual/CocoaEncyclopedia/Toll-FreeBridgin/Toll-FreeBridgin.html" target="_blank" rel="noopener">Toll-Free Bridging</a></p>
<p><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html" target="_blank" rel="noopener">Run Loops</a></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> RunLoop å¸¸é©»çº¿ç¨‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å‘äººå‘˜éœ€å…·å¤‡ä¸€ç‚¹äº§å“èƒ½åŠ›]]></title>
      <url>/2018/04/17/%E5%8F%91%E4%BA%BA%E5%91%98%E9%9C%80%E5%85%B7%E5%A4%87%E4%B8%80%E7%82%B9%E4%BA%A7%E5%93%81%E8%83%BD%E5%8A%9B/</url>
      <content type="html"><![CDATA[<p><img src="/upload/images/2018/04/17/12332.jpg" alt=""></p>
<p>ä¸ºäº†å¼€å§‹ä»Šå¤©çš„è¯é¢˜, æˆ‘å…ˆæ¥å€ŸåŠ©å‡ ä¸ªè§’è‰², æ¨¡æ‹Ÿä¸€ä¸‹å·¥ä½œä¸­çš„æŸäº›åœºæ™¯.</p>
<h2 id="è®¾ç«‹äººç‰©"><a href="#è®¾ç«‹äººç‰©" class="headerlink" title="è®¾ç«‹äººç‰©"></a>è®¾ç«‹äººç‰©</h2><p>å° A æ˜¯ååˆšå…¥é—¨çš„æŠ€æœ¯äººå‘˜, æ¯”è¾ƒå¬è¯.<br>å° B æ˜¯æœ‰å·¥ä½œç»éªŒçš„ä¸€åæŠ€æœ¯äººå‘˜, å¹³æ—¶å–œæ¬¢çœ‹çœ‹äº§å“ç›¸å…³çš„ä¹¦ç±, å–œæ¬¢å’Œäº§å“ç»ç†æ’•é€¼.<br>å° C å°±å‰å®³äº†, ä¸ä»…æŠ€æœ¯å‰å®³, ä¹Ÿå…·æœ‰äº§å“æ€ç»´, é™¤äº†é˜…è¯»äº§å“ç±»çš„ä¹¦ç±, è¿˜å†™äº§å“ä½“éªŒæŠ¥å‘Šå’Œä½“éªŒç«å“(å’Œå½“å‰è‡ªå·±äº§å“ç›¸å…³çš„äº§å“).<br>å° D å°±æ˜¯ä¸€åäº§å“ç»ç†, å…·æœ‰ä¸€å®šçš„äº§å“èƒ½åŠ›, æ•°æ®åˆ†æèƒ½åŠ›å’Œç®¡ç†èƒ½åŠ›.</p>
<p>äººç‰©å·²ç»è®¾ç«‹å¥½äº†, ç°åœ¨è®©ä»–ä»¬ç™»åœº.</p>
<h2 id="æƒ…æ™¯å†ç°-éœ€æ±‚è¯„å®¡"><a href="#æƒ…æ™¯å†ç°-éœ€æ±‚è¯„å®¡" class="headerlink" title="æƒ…æ™¯å†ç°: éœ€æ±‚è¯„å®¡"></a>æƒ…æ™¯å†ç°: éœ€æ±‚è¯„å®¡</h2><p>è¿™å¤©é£å’Œæ—¥ä¸½, å° D(äº§å“ç»ç†) é€šçŸ¥é¡¹ç›®ç»„çš„æ‰€æœ‰æˆå‘˜, åŒ…æ‹¬è®¾è®¡/å¼€å‘/è¿è¥/æµ‹è¯•ç­‰äººå‘˜æŒ‰æ—¶å‚åŠ äº§å“éœ€æ±‚è¯„å®¡ä¼šè®®.</p>
<p>ä¸ºäº†ç¼“è§£å¤§å®¶çš„æƒ…ç»ª, å° D ä¹°äº†å¾ˆå¤šé›¶é£Ÿå’Œæ°´æœ, ä¹Ÿç®—æ˜¯çŠ’åŠ³ä¸€ä¸‹å¤§å®¶. å° D å¼€å§‹ç»™å¤§å®¶è®²éœ€æ±‚äº†, åƒå¾€å¸¸ä¸€æ ·, æ‹¿å‡ºç²¾æ¹›çš„åŸå‹, å£æ²«ç›´é£çš„å‘å¤§å®¶å±•ç¤ºå…¶ç»µç»µä¸ç»çš„å£æ‰å’Œäº§å“æ€ç»´. å° A ä¸€ç›´åœ¨ç‚¹å¤´, ä¹Ÿä¸çŸ¥é“åˆ°åº•æœ‰æ²¡æœ‰å¬æ‡‚å° D åœ¨è¯´ä»€ä¹ˆ, åæ­£æˆ‘çœ‹åˆ°æœ‰éƒ¨åˆ†è®¾è®¡äººå‘˜å·²ç»å¼€å§‹æ‰“çŒç¡äº†.</p>
<p>çªç„¶, å° C ä¸­æ–­äº†æ­£åœ¨å£è¿°çš„å° D, å° D ä¸æ…Œä¸å¿™çš„åœæ­¢äº†æ‰‹ä¸­çš„ä¸€åˆ‡åŠ¨ä½œ, èšç²¾ä¼šç¥çš„å¬å° C çš„æ„è§å’Œå»ºè®®. å° C ä¹Ÿæœ‰æ¡ä¸ç´Šçš„å°†åˆšæ‰çš„æŸé¡¹éœ€æ±‚å£è¿°äº†ä¸€é, æŒ‰ç…§å° C çš„é€»è¾‘, ç›®å‰çš„éœ€æ±‚è¿˜æ˜¯å­˜åœ¨ä¸€äº›æ¼æ´çš„, è¿™ä¸ªæ—¶å€™, å° D å¼€å§‹è®¤çœŸçš„è·Ÿå° C å¼€å§‹äº¤æµ, ä½†æ˜¯æ²¡æœ‰é©¬ä¸Šè‚¯å®šå° C, åªæ˜¯è¯´æˆ‘æš‚æ—¶è®°ä¸‹è¿™ä¸ªç‚¹, å›å¤´åœ¨æ€è€ƒä¸€ç•ª. äº§å“å° D ç¨³å¦‚è€ç‹—, ç»§ç»­è‡ªå·±çš„è¡¨æ¼”.</p>
<p>äº§å“éœ€æ±‚åŸºæœ¬å·²ç»è®²å®Œäº†, ç°åœ¨æ˜¯å¤§å®¶æé—®é¢˜å’Œäº¤æµçš„æ—¶é—´, æˆ‘çœ‹åˆ°æœ‰äº›åŒäº‹æ‰äº†æ‰çœ¼ç›, åƒæ˜¯å¦‚æ¢¦åˆé†’èˆ¬çš„çœ‹ç€äº§å“å° D, ä¸æ˜¯æ—è¾¹çš„åŒäº‹æ‹‰ä½ Ta, ä¼°è®¡éƒ½èƒ½å†²å‡ºä¼šè®®å®¤. å° B ä¹Ÿä¸æ·¡å®šäº†, æå‡ºäº†ä¸å°‘é—®é¢˜, å¹¶ä»æŠ€æœ¯çš„è§’åº¦è¯´æ˜äº†å®ç°çš„éš¾åº¦. äº§å“ç»ç†å¬çš„ä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼, å¿ƒç†æƒ³: â€œä½ å®ç°æ˜¯å¦æœ‰å›°éš¾ç®¡æˆ‘é¸Ÿäº‹?â€.</p>
<p>å° B åœ¨äº§å“å° D é‚£é‡Œå¹¶æ²¡æœ‰å¾—åˆ°åº”æœ‰çš„è¡¨æ‰¬å’Œé¼“åŠ±, åé­åˆ°åŒäº‹å° C çš„é„™è§†, å° C è¯´, ä½ å…ˆä¸è¦å‘Šè¯‰ä»–å®ç°æ–¹æ¡ˆ, å…ˆè®¨è®ºè¿™ä¸ªéœ€æ±‚çš„åœºæ™¯å’ŒçœŸä¼ªåº¦. å° D é»˜é»˜çš„å¯¹å° C æŠ•è¿‡èµèµçš„ç›®å…‰. ç´§æ¥ç€æµ‹è¯•å’Œå…¶ä»–äººå‘˜æå‡ºäº†å‡ ä¸ªä¸ç—›ä¸ç—’çš„é—®é¢˜, éƒ½è¢«è€ç»ƒçš„å° D ä¸€ä¸€ç ´è§£, é‚£æ°”åŠ¿, å•§å•§! åŠ¿å¦‚ç ´ç«¹!</p>
<p>éœ€æ±‚è¯„å®¡ä¼šè®®å°±è¿™æ ·ç»“æŸäº†.</p>
<h2 id="æƒ…æ™¯å†ç°-éœ€æ±‚å˜æ›´"><a href="#æƒ…æ™¯å†ç°-éœ€æ±‚å˜æ›´" class="headerlink" title="æƒ…æ™¯å†ç°: éœ€æ±‚å˜æ›´"></a>æƒ…æ™¯å†ç°: éœ€æ±‚å˜æ›´</h2><p>åœ¨äº§å“è¿›å…¥å¼€å‘å’Œè®¾è®¡é˜¶æ®µ, æŒ‰ç†è¯´éœ€æ±‚å˜æ›´ä¹Ÿç®—æ˜¯æ¯”è¾ƒæ­£å¸¸çš„ä¸€ä»¶äº‹æƒ….</p>
<p>è¿™å¹´å¤´, å”¯ä¸€ä¸å˜çš„å°±æ˜¯å˜åŒ–.</p>
<p>å° B æ­£åœ¨èšç²¾ä¼šç¥çš„å†™ä»£ç , çªç„¶å° D è·Ÿä»–è¯´, è¿™ä¸ªåœ°æ–¹çš„éœ€æ±‚éœ€è¦ä¿®æ”¹ä¸€ä¸‹, ä½ çœ‹æ”¹åŠ¨æœ‰å¤šå¤§?</p>
<p>å° B é„™è§†çš„çœ‹ç€äº§å“ç»ç†å° D, å¿ƒç†åœ¨è¯´æ”¹åŠ¨æœ‰å¤šå¤§ä½ å¿ƒé‡Œè¿˜æ²¡æœ‰ç‚¹ Bæ•°å˜›. å° B è¿˜æ˜¯æ§åˆ¶äº†è‡ªå·±çš„æƒ…ç»ª, æ¥ç€è¯´é“, ä½ å½“åˆåº”è¯¥å¥½å¥½æ€è€ƒçš„, ä½ çœ‹æˆ‘éƒ½å¿«åšå®Œäº†, ä½ æ‰å‘Šè¯‰æˆ‘éœ€è¦æ”¹åŠ¨.</p>
<p>å™¼é‡Œå•ªå•¦çš„è¯´å®Œ, ä¼°è®¡å° B å¿ƒç†ä¹Ÿæš—çˆ½äº†ä¸å°‘, æœ€ç»ˆè¿˜æ˜¯æ¥å—äº†è¿™æ¬¡çš„å˜åŠ¨.</p>
<p>å° A è´Ÿè´£çš„æ¨¡å—, ä¹Ÿè¢«äº§å“ç»ç†ä¿®æ”¹è¿‡, Ta å’Œäº§å“ç»ç†å° D çš„äº¤æµåŸºæœ¬æ˜¯, å“¦, æ©, å¥½, å¯ä»¥!</p>
<p>å½“å° C æ‰¾åˆ°å° D çš„æ—¶å€™, å¹¶æ²¡æœ‰ç›´æ¥å‘Šè¯‰å° D éœ€è¦æ”¹ä¸œæ”¹è¥¿, è€Œæ˜¯é—®é—®å° D, ä½ çœ‹è¿™æ ·ä¼šä¸ä¼šæ›´å¥½ä¸€äº›?</p>
<p>å° C å½“ç„¶æ˜ç™½å° D çš„ç›®çš„äº†, äºæ˜¯æ‹¿å‡ºè‡ªå·±çœ‹è¿‡çš„ç«å“, å¹¶è¯´å‡ºäº†è‡ªå·±çš„æ„è§, æ„‰å¿«çš„å’Œå° D äº¤æµå, å±…ç„¶ TMD çš„ç äº†ä¸€ä¸ªéœ€æ±‚. è¿™è®©æ—è¾¹çš„å° A å’Œå° B ç¾¡æ…•ä¸å·².</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸Šé¢çš„ä¸¤ç§æƒ…æ™¯, æˆ‘ç›¸ä¿¡åšè¿‡å¼€å‘çš„åŒäº‹åº”è¯¥éƒ½æ·±æœ‰ä½“ä¼š, ä½†æ˜¯åƒä¸‡ä¸è¦å¯¹å·å…¥åº§, æˆ‘åªæ˜¯æ‰“ä¸ªæ¯”æ–¹.</p>
<p>ä»ä¸Šé¢çœ‹å‡º, å° C æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„è§’è‰², æ— è®ºæ˜¯æ€ç»´è¿˜æ˜¯æ²Ÿé€šèƒ½åŠ›éƒ½æœ‰åˆ«ä¸ä»–äºº, æœ€é‡è¦çš„æ˜¯ä»–æ²¡æœ‰ä»…ä»…æŠŠè‡ªå·±å½“åšä¸€åå¼€å‘äººå‘˜, è€Œæ˜¯ç«™åœ¨äº§å“çš„è§’åº¦å»æ€è€ƒé—®é¢˜å’Œè§£å†³é—®é¢˜.</p>
<p>éœ€æ±‚å˜æ›´æ˜¯å¸¸æ€, ä½œä¸ºå¼€å‘äººå‘˜, è¦æœ€å¤§é™åº¦çš„ç»™äº§å“ä»¥æ”¯æŒ. äº§å“ç»ç†ä¹Ÿæ˜¯äºº, å½“ç„¶æœ‰è€ƒè™‘ä¸å‘¨çš„åœ°æ–¹, å¦‚æœä½ ä¸èƒ½æƒ³å‡ºæ›´å¥½æ›´å®Œç¾çš„è§£å†³æ–¹æ¡ˆ, è¯·æ”¯æŒä»–çš„å†³å®š.</p>
<p>å¤šç«™åœ¨åˆ«äººçš„è§’åº¦å»æ€è€ƒé—®é¢˜, æ¢ä½æ€è€ƒ, æ‰èƒ½ä¿è¯æœ‰æ•ˆçš„æ²Ÿé€š. ä½œä¸ºä¸€åæŠ€æœ¯äººå‘˜, å°¤å…¶æ˜¯åœ¨äº’è”ç½‘è¡Œä¸š, å¤šå¤šå°‘å°‘éƒ½åº”è¯¥éœ€è¦å…·å¤‡ä¸€å®šçš„äº§å“æ€ç»´.</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æŠ€æœ¯ ç”Ÿæ´» </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸è®© SIGPIPE signal å¤ªåš£å¼ ]]></title>
      <url>/2018/04/15/%E4%B8%8D%E8%AE%A9-SIGPIPE-signal-%E5%A4%AA%E5%9A%A3%E5%BC%A0/</url>
      <content type="html"><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>ç”±äºé¡¹ç›®è¿­ä»£æ¯”è¾ƒå¿«, å¤§å®¶è¿˜æ²¡æœ‰æ¥å¾—åŠåšè‡ªæˆ‘è°ƒæ•´å’Œæ€»ç»“, å°±éœ€è¦æŠ•å…¥åˆ°æ–°ç‰ˆæœ¬å½“ä¸­å¼€å‘æ–°åŠŸèƒ½äº†.</p>
<p>åœ¨æœ€è¿‘çš„ä¸€æ¬¡ç‰ˆæœ¬æµ‹è¯•å’Œä½“éªŒè¿‡ç¨‹ä¸­, å¾ˆå¤šå†…æµ‹ç”¨æˆ·åé¦ˆè¿›å…¥æˆ–è€…é€€å‡º App çš„èŠå¤©å®¤, ä¼šè«åå…¶å¦™çš„å´©æºƒæ‰(Crash).<br>å¯¹äº Crash çš„é—®é¢˜, æˆ‘ä»¬å¼€å‘åŒäº‹ç»å¯¹æ˜¯é›¶å®¹å¿, äºæ˜¯å°±å¼€å§‹è·Ÿè¸ªé—®é¢˜.</p>
<p>è·Ÿè¸ªäº†å¾ˆä¹…, å‘ç°è¿™ä¸ª Crash å¹¶ä¸æ˜¯é‚£ä¹ˆçš„ â€˜ä¹–å·§â€™, å¾ˆéš¾å¤ç°!<br>æ—¢ç„¶ç”¨æˆ·å·²ç»åé¦ˆäº†å¹¶ä¸”åå°ä¹Ÿæœ‰ Crash ä¸ŠæŠ¥, è¿™ä¸ªé—®é¢˜è‚¯å®šå­˜åœ¨, æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æ”¾å¼ƒ.</p>
<p>å¥½å§, ç»§ç»­åŠ ç­æâ€¦è‹¦é€¼ä¸­â€¦</p>
<p>æœ€ç»ˆ, æˆ‘ä»¬å‘ç°ä¸€ä¸ªè§„å¾‹, åœ¨æ—¥å¿—åå°, çœ‹åˆ°å¾ˆå¤šç±»ä¼¼ä¸‹é¢çš„æ—¥å¿—:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Signal <span class="number">13</span> was raised. SIGPIPE (_mh_execute_header + <span class="number">420728</span>)</div></pre></td></tr></table></figure>
<p>å¾ˆé—æ†¾çš„æ˜¯, å †æ ˆä¿¡æ¯ä¸­æ²¡æœ‰æä¾›ç»™æˆ‘ä»¬æ›´æœ‰åŠ›çš„è¯æ®, æ‰€ä»¥å½“æ—¶å®šä½åœ¨ <code>Signal 13</code> è¿™ä¸ªç‚¹ä¸Šé¢.</p>
<p>ä¹Ÿç®—æ˜¯æœ‰äº†çªç ´â€¦è¿™ç­æ²¡æœ‰ç™½åŠ â€¦</p>
<h2 id="æ’æŸ¥é—®é¢˜"><a href="#æ’æŸ¥é—®é¢˜" class="headerlink" title="æ’æŸ¥é—®é¢˜"></a>æ’æŸ¥é—®é¢˜</h2><p>æ—¢ç„¶æ‰€æœ‰çš„ç½ªè¯éƒ½æŒ‡å‘äº† <code>Signal 13</code>, æˆ‘ä»¬å°±éœ€è¦å»è·Ÿè¸ªå®ƒ, å»è°ƒæŸ¥å®ƒ, å»ç ”ç©¶å®ƒ.</p>
<p>åœ¨ <code>signal.h</code> æ–‡ä»¶ä¸­, å¯ä»¥å‘ç°å…¶å®šä¹‰å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* write on a pipe with no one to read it */</span></div><div class="line"><span class="meta">#define	SIGPIPE	13</span></div></pre></td></tr></table></figure>
<p>ç”¨é€šä¿—çš„è¯æ¥è®², å°±æ˜¯ç®¡é“ç ´è£‚.</p>
<blockquote>
<p>ç®¡é“ç ´è£‚ï¼Œè¿™ä¸ªä¿¡å·é€šå¸¸åœ¨è¿›ç¨‹é—´é€šä¿¡äº§ç”Ÿï¼Œæ¯”å¦‚é‡‡ç”¨ FIFO(ç®¡é“)é€šä¿¡çš„ä¸¤ä¸ªè¿›ç¨‹ï¼Œè¯»ç®¡é“æ²¡æ‰“å¼€æˆ–è€…æ„å¤–ç»ˆæ­¢å°±å¾€ç®¡é“å†™ï¼Œå†™è¿›ç¨‹ä¼šæ”¶åˆ° SIGPIPE ä¿¡å·.<br>æ­¤å¤–ç”¨ Socket é€šä¿¡çš„ä¸¤ä¸ªè¿›ç¨‹ï¼Œå†™è¿›ç¨‹åœ¨å†™ Socket çš„æ—¶å€™ï¼Œè¯»è¿›ç¨‹å·²ç»ç»ˆæ­¢.<br>å¦å¤–, åœ¨ send/write æ—¶ä¼šå¼•èµ·ç®¡é“ç ´è£‚ï¼Œå…³é—­ Socket, ç®¡é“æ—¶ä¹Ÿä¼šå‡ºç°ç®¡é“ç ´è£‚.<br>ä½¿ç”¨ Socket ä¸€èˆ¬éƒ½ä¼šæ”¶åˆ°è¿™ä¸ª SIGPIPE ä¿¡å·.</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´, è¯¥ä¿¡å·æ˜¯è·Ÿ Socket çš„è¿æ¥ä»¥åŠæ•°æ®çš„è¯»å†™ç›¸å…³è”çš„.</p>
<p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±çŸ¥é“ä¸ºä»€ä¹ˆè¿›é€€æˆ¿é—´å¯¼è‡´ Crash äº†ï¼Œæˆ‘ä»¬çš„è¿›é€€æˆ¿é—´éƒ½å’Œ Socket æœ‰å…³è”ï¼Œè¿™ç§ Crash å¤§éƒ½æ•°æ˜¯åœ¨ç”¨æˆ·ç½‘ç»œä¸å¥½çš„æƒ…å†µä¸‹å‘ç”Ÿçš„.</p>
<h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>ç±»ä¼¼ <code>signal 13</code> è¿™ç§é”™è¯¯æ˜¯ç³»ç»Ÿå‘å‡ºæ¥çš„, å’Œå†…å­˜ä½¿ç”¨å¼‚å¸¸å’Œé‡æŒ‡é’ˆä¸€æ ·ï¼Œç”±äºæ˜¯ç³»ç»Ÿçº§åˆ«å´©æºƒï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@try</span> &#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="keyword">@catch</span>(<span class="built_in">NSException</span> *exception) &#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ•è·åˆ°è¿™ç±»å¼‚å¸¸.</p>
<p>å› æ­¤, <code>try catch</code> æ˜¯æ— æ³•è§£å†³é—®é¢˜çš„.</p>
<p>ç›®å‰æœ‰ä¸¤ä¸ªæ–¹æ¡ˆå¯ç”¨:</p>
<blockquote>
<p>æ–¹æ¡ˆ1. å¿½ç•¥è¿™ç±»ä¿¡å·.</p>
<p>æ–¹æ¡ˆ2. ä¿®æ”¹æºç , åœ¨ IM ä»£ç é‡Œé¢ä¿®æ”¹.</p>
</blockquote>
<p>å› ä¸º, IMSDK æˆ‘ä»¬æ˜¯ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„, æ‰€ä»¥æ— æ³•æ›´æ”¹å…¶æºç , æ‰€ä»¥é‡‡å–äº†æ–¹æ¡ˆ1: å¿½ç•¥è¿™ç±»ä¿¡å·.</p>
<p>å¿½ç•¥çš„æ–¹æ¡ˆå¾ˆç®€å•, åœ¨ä½ è¿æ¥æˆ–è€…åˆå§‹åŒ– IMSDK ä¹‹å‰, åªéœ€è¦ä¸€è¡Œä»£ç :</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">signal(SIGPIPE, SIG_IGN);</div></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä»£ç :</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions </div><div class="line">&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">    </div><div class="line">    signal(SIGPIPE, SIG_IGN);</div><div class="line">    </div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯¹äº <code>æ–¹æ¡ˆ2</code>, æˆ‘æŸ¥é˜…äº†ä¸€ä¸‹ <code>CocoaAsyncSocket</code> çš„æºç :</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Prevent SIGPIPE signals</span></div><div class="line">    </div><div class="line"><span class="keyword">int</span> nosigpipe = <span class="number">1</span>;</div><div class="line">setsockopt(socketFD, SOL_SOCKET, SO_NOSIGPIPE, &amp;nosigpipe, <span class="keyword">sizeof</span>(nosigpipe));</div></pre></td></tr></table></figure>
<p>æ‰€ä»¥å¯¹äº <code>æ–¹æ¡ˆ2</code>, å°±æ˜¯å¢åŠ ä¸Šé¢çš„ä»£ç å³å¯, å³è®¾ç½® Socket ä¸å‘é€ SIGPIPE ä¿¡å·.</p>
<p>å¯¹äºä¸Šé¢çš„ä¸¤ç§æ–¹æ¡ˆ, è‹¹æœå¼€å‘è€…æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/CommonPitfalls/CommonPitfalls.html" target="_blank" rel="noopener">Avoiding Common Networking Mistakes</a> éƒ½æœ‰æåŠ.</p>
<p><img src="/upload/images/2018/04/15/1.jpg" alt="-w380"></p>
<h2 id="é—®é¢˜å¤ç°"><a href="#é—®é¢˜å¤ç°" class="headerlink" title="é—®é¢˜å¤ç°"></a>é—®é¢˜å¤ç°</h2><p>æ—¢ç„¶è¿™ä¸ªé—®é¢˜å¾ˆéš¾å¤ç°, æˆ‘ä»¬å°±æƒ³åŠæ³•è®©ä»–å¾ˆå®¹æ˜“å¤ç°.</p>
<p>å¯ä»¥é‡‡ç”¨æ‰‹åŠ¨å‘é€ signal çš„æ–¹å¼, æ¥å¤ç°è¿™ä¸ªé—®é¢˜.</p>
<p>å…ˆçœ‹ä¸€ä¸‹ <a href="https://linux.die.net/man/3/kill" target="_blank" rel="noopener">kill(3) - Linux man page</a> å‡½æ•°:</p>
<blockquote>
<p>The kill() function shall send a signal to a process or a group of processes specified by pid. The signal to be sent is specified by sig and is either one from the list given in <signal.h> or 0. If sig is 0 (the null signal), error checking is performed but no signal is actually sent. The null signal can be used to check the validity of pid.</signal.h></p>
</blockquote>
<p>kill å‡½æ•°æ˜¯å¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ POSIX(Portable Operating System Interface of UNIX) å®šä¹‰çš„, å¯ä»¥å‚è€ƒ <a href="https://zh.wikipedia.org/wiki/POSIX" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a>.</p>
<p>ç¤ºä¾‹ä»£ç :</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    <span class="comment">//è·å–è¿›ç¨‹ id</span></div><div class="line">    pid_t cur_pid = getpid();</div><div class="line">    printf(<span class="string">"current process's id: %i\n"</span>, cur_pid);</div><div class="line">    </div><div class="line">    <span class="comment">//å»¶æ—¶10s ä¸ºäº†è®© Bugtags æœ‰æ—¶é—´ä¸ŠæŠ¥æ—¥å¿—.</span></div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">10</span> * <span class="built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^&#123;</div><div class="line">        </div><div class="line">        wpcSendSignal(cur_pid);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">///æ‰‹åŠ¨å‘é€ä¿¡å·</span></div><div class="line"><span class="keyword">int</span> wpcSendSignal(<span class="keyword">int</span> pid)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> ret = kill(pid, SIGPIPE);</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°† <code>signal(SIGPIPE, SIG_IGN)</code> ä»£ç å…ˆæ³¨é‡Š.</p>
<p>è¿è¡Œ APP åˆ°æ‰‹æœº, ç„¶åé€€å‡º Xcode çš„è¿æ¥.</p>
<blockquote>
<p>æ³¨æ„: è¿™é‡Œå¦‚æœè¿æ¥ Xcode, ä¸ä¼šç›´æ¥ Crash, æ‰€ä»¥éœ€è¦æ–­å¼€æ‰‹æœºä¸ Xcode çš„è¿æ¥.</p>
</blockquote>
<p>åœ¨åå°å¯ä»¥çœ‹åˆ°ç±»ä¼¼çš„ Crash æ—¥å¿—:</p>
<p><img src="/upload/images/2018/04/15/2.jpg" alt="-w500"></p>
<p>é™¤äº†ä¸Šé¢ä½¿ç”¨ <code>kill</code> å‡½æ•°å¤–, æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ <code>raise</code> å‡½æ•°æ¥å‘é€ signal.</p>
<p>å…³äº raise å‡½æ•°, å¯ä»¥æŸ¥é˜… <a href="https://linux.die.net/man/3/raise" target="_blank" rel="noopener">æ‰‹å†Œ</a>.</p>
<p>æˆ–è€…ç›´æ¥é—®ç”·äºº(man):</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">man raise</div></pre></td></tr></table></figure>
<h2 id="é—®é¢˜å†æ¬¡æ¥ä¸´-ä¸-Bugtags-çš„ç»“åˆ"><a href="#é—®é¢˜å†æ¬¡æ¥ä¸´-ä¸-Bugtags-çš„ç»“åˆ" class="headerlink" title="é—®é¢˜å†æ¬¡æ¥ä¸´: ä¸ Bugtags çš„ç»“åˆ"></a>é—®é¢˜å†æ¬¡æ¥ä¸´: ä¸ Bugtags çš„ç»“åˆ</h2><p>æœ¬ä»¥ä¸ºé‡‡ç”¨ä¸Šè¿°æ–¹æ¡ˆå°±ä¸‡äº‹å¤§å‰äº†, åœ¨ç¬¬äºŒæ¬¡ææµ‹å, è¿˜æ˜¯æœ‰è¿™ç§ Crash çš„é—®é¢˜åœ¨åå°ä¸ŠæŠ¥.</p>
<p>æ’æŸ¥äº†å¾ˆä¹…åæ‰å‘ç°ï¼Œé—®é¢˜çš„åŸå› æ˜¯ BugTags ä¹Ÿä¼šæ§åˆ¶è¿™ä¸ªå¼€å¤´ï¼Œé»˜è®¤æ˜¯ä¸å¿½ç•¥ï¼Œè¿™æ ·ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * æ˜¯å¦å¿½ç•¥ PIPE Signal (SIGPIPE) é—ªé€€ï¼Œé»˜è®¤ NO</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> ignorePIPESignalCrash;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªé»˜è®¤è®¾ç½®ä¸º NO, å³å¯ä»¥ä¸ŠæŠ¥ PIPE Signal Crash çš„é—®é¢˜.</p>
<p>è¿™é‡Œä¹Ÿè¯´æ˜ä¸€ä¸ªé—®é¢˜, å³ä½¿æˆ‘ä»¬é‡‡ç”¨ <code>æ–¹æ¡ˆ1</code> è§£å†³ Crash çš„é—®é¢˜äº†, Bugtags è¿˜æ˜¯ä¼šå°†è¿™ç§ Crash ä¸ŠæŠ¥åˆ°åå°.</p>
<p>ç¤ºä¾‹ä»£ç :</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">bugtag.option.ignorePIPESignalCrash = <span class="literal">YES</span>;</div><div class="line"></div><div class="line"><span class="comment">// ...</span></div><div class="line"></div><div class="line">signal(SIGPIPE, SIG_IGN);</div></pre></td></tr></table></figure>
<p>å¯¹æ¯”ä¸€ä¸‹æµ‹è¯•çš„ä¸¤å¼ å›¾, ç¬¬ä¸€å¼ å›¾åˆ°ç¬¬äºŒå¼ å›¾æ˜¯å¢åŠ äº†ä¸¤æ¬¡å´©æºƒæ¬¡æ•°, åŸå› æ˜¯æ•…æ„è®¾ç½®äº† <code>bugtag.option.ignorePIPESignalCrash = NO</code>, ä¹Ÿæ­£å¥½éªŒè¯äº†æˆ‘ä»¬çš„æƒ³æ³•.</p>
<p><img src="/upload/images/2018/04/15/3.jpg" alt="-w600"><br><img src="/upload/images/2018/04/15/4.jpg" alt="-w600"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li><p>Xcode è¿æ¥çœŸæœºæˆ–è€…æ¨¡æ‹Ÿå™¨, è¿è¡Œå‡ºç°å¼‚å¸¸æ–­ç‚¹, å¯èƒ½å°±æ˜¯éšæ‚£ç‚¹.</p>
</li>
<li><p>å­¦ä¼šä½¿ç”¨åå°æ—¥å¿—æ‰¾åˆ°è§„å¾‹, ç»§è€Œå»æ€è€ƒå¹¶è§£å†³é—®é¢˜.</p>
</li>
<li><p>å¯¹ Crash è¿›è¡Œæ›´æ·±å…¥çš„åˆ†æå’Œæ€»ç»“, ä¸è¦è½»æ˜“æ”¾å¼ƒ.</p>
</li>
</ol>
<h2 id="åç»­ç ”ç©¶"><a href="#åç»­ç ”ç©¶" class="headerlink" title="åç»­ç ”ç©¶"></a>åç»­ç ”ç©¶</h2><ol>
<li><p>æ˜¯å¦å¯ä»¥å¿½ç•¥å…¶ä»–çš„ signal, æ¥é¿å…ä¸å¿…è¦çš„ Crash?</p>
</li>
<li><p>è‡ªå®šä¹‰ä¸€å¥—å…³äº signal æ•è·çš„è·¨å¹³å°åº“, åœ¨å¼€å‘é˜¶æ®µå¯ä»¥ç›´æ¥çœ‹åˆ°å®Œæ•´çš„æ—¥å¿—.</p>
</li>
</ol>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><ol>
<li><p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/CommonPitfalls/CommonPitfalls.html" target="_blank" rel="noopener">Avoiding Common Networking Mistakes</a></p>
</li>
<li><p><a href="https://linux.die.net/" target="_blank" rel="noopener">linux die</a></p>
</li>
<li><p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/NetworkingTopics/Articles/UsingSocketsandSocketStreams.html#//apple_ref/doc/uid/CH73-SW1" target="_blank" rel="noopener">Using Sockets and Socket Streams</a></p>
</li>
</ol>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Crash linux signal SIGPIPE </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è¿™æ ·å­¦ä¹ ä½ æ„¿æ„å—?]]></title>
      <url>/2018/04/07/%E8%BF%99%E6%A0%B7%E5%AD%A6%E4%B9%A0%E4%BD%A0%E6%84%BF%E6%84%8F%E5%90%97/</url>
      <content type="html"><![CDATA[<p><img src="/upload/images/2018/04/07/1.jpg" alt=""></p>
<p>ä¸å¾—ä¸æ‰¿è®¤, å­¦ä¹ ç¡®å®æ˜¯ä¸ªã€Œè‹¦å·®äº‹ã€, è¿™é‡Œè¯´çš„å­¦ä¹ ä¸ä»…ä»…æŒ‡ä¼æ¡ˆå­¦ä¹ , ä¹‹ä¹è€…ä¹Ÿç­‰, è€Œæ˜¯ä¸€ç§å¹¿æ³›çš„å­¦ä¹ .</p>
<p>å¦‚ä½•å­¦ä¹ æ˜¯å§‹ç»ˆè¦å»æ¢è®¨çš„ä¸€ä¸ªè¯é¢˜, æ—¶ä»£åœ¨å˜, ç¯å¢ƒåœ¨å˜, å­¦ä¹ å½“ç„¶ä¹Ÿä¸èƒ½ä¸€æˆä¸å˜. åšæŒå­¦ä¹ æ˜¯ä¸€è¾ˆå­çš„äº‹, æ´»åˆ°è€å­¦åˆ°è€.</p>
<p>æ—¢ç„¶å­¦ä¹ æ˜¯ä¸€ä¸ªæ¼«é•¿çš„é©¬æ‹‰æ¾, é‚£æˆ‘ä»¬åªæœ‰æŒä¹‹ä»¥æ’çš„â€™è·‘â€™ä¸‹å», æ‰èƒ½ä¿æŒä¸æ‰é˜Ÿ. è¿™æ ·ä¸€æ¥, å­¦ä¹ æ–¹æ³•å’Œå­¦ä¹ æŠ€å·§å°±æ˜¯å–èƒœçš„å…³é”®äº†.</p>
<p>ä¸–ä¸Šæ²¡æœ‰ç»å¯¹çš„å­¦ä¹ å¦™æ‹›å’Œå­¦ä¹ å®å…¸, æ‰¾åˆ°é€‚åˆè‡ªå·±çš„å°±æ˜¯æœ€å¥½çš„. ä¸‹é¢æˆ‘ç»“åˆè‡ªå·±çš„ä¸€äº›ç»å†ç»™å¤§å®¶åˆ†äº«åœ¨å­¦ä¹ çš„é“è·¯ä¸Šé‡åˆ°çš„é‚£äº›äº‹.</p>
<blockquote>
<p>ä¸ç®¡æ€æ ·, å­¦ä¹ ä¸€å®šè¦å¸¦ç€ç›®æ ‡, ç»“åˆç†è®ºå†å»å®è·µ, äº‹åŠåŠŸå€.</p>
</blockquote>
<hr>
<p>æ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºäº¤æµ, ä¸å–œå‹¿å–·~ </p>
<h2 id="å›å¿†å½“å¤©äº‹"><a href="#å›å¿†å½“å¤©äº‹" class="headerlink" title="å›å¿†å½“å¤©äº‹"></a>å›å¿†å½“å¤©äº‹</h2><p>æ¯æ™šèººåœ¨åºŠä¸Šæˆ–è€…æ²™å‘ä¸Š, å‘å‘å‘†, æŠŠå½“å¤©åšè¿‡çš„äº‹æƒ…, åœ¨è„‘æµ·ä¸­ç»Ÿç»Ÿçš„è¿‡ä¸€é, åƒæ”¾ç”µå½±ä¸€æ ·, èƒ½æœ‰å¤šè¯¦ç»†å°±å¤šè¯¦ç»†, ä¹Ÿå°±æ˜¯è¯´å°½é‡çš„å›å¿†ç»†èŠ‚.</p>
<p>è¿™ç§åšæ³•çœ‹ä¼¼å¾ˆç®€å•, å…¶å®å¾ˆéš¾åšæŒä¸‹å». ç‰¹åˆ«æ˜¯ä¸­é—´å‡ å¤©, å¾ˆå¤šäººéƒ½ä¼šæ”¾å¼ƒ, å†åŠ ä¸Šç°åœ¨æ‰‹æœºäº’è”ç½‘çš„ â€œæ¯’å®³â€, ç•™ç»™è‡ªå·±å»çœŸæ­£å­¦ä¹ çš„æ—¶é—´æ›´å°‘äº†. ä½†æ˜¯åªè¦ä½ å’¬å’¬ç‰™åšæŒä¸€ä¸‹, æŠŠè¿™ä¸ªä¹ æƒ¯å…»æˆ, å°±ä¼šç»ˆç”Ÿå—ç”¨.</p>
<p>æˆ‘åœ¨åˆä¸­æ—¶æœŸå·²ç»å…»æˆäº†è¿™ä¸ªä¹ æƒ¯, ç›´åˆ°å¤§å­¦éƒ½æ²¡æœ‰æ”¾å¼ƒ. å¤§å­¦é‡Œé¢æ¯æ¬¡æœŸæœ«è€ƒè¯•, çœ‹åˆ°å¾ˆå¤šäººå¿™çš„ä¸å¯å¼€äº¤, æˆ‘éƒ½æ˜¯ä¸æ…Œä¸å¿™çš„, æ‚ é—²è‡ªå¾—, å®¤å‹é—®æˆ‘æ€ä¹ˆåšåˆ°æ¸¸åˆƒæœ‰ä½™, æˆ‘è¯´ä½ ç™½å¤©å°‘ç¡ç‚¹è§‰, å¹³æ—¶æ³¨æ„å¬è®², æ™šä¸Šå›å¿†ä¸€ä¸‹å°±å¯ä»¥äº†, ä»ä»–è¿·èŒ«çš„çœ¼ç¥ä¸­å¯ä»¥çœ‹å‡º, ä»–å½“æ—¶å¹¶ä¸å®Œå…¨ç›¸ä¿¡æˆ‘è¯´çš„!</p>
<p>æ¯æ¬¡å›å¿†ç»“æŸ, æœ‰äº›ä¸œè¥¿è¿˜æ˜¯æ¯”è¾ƒæ¨¡ç³Šç”šè‡³ä¸€çŸ¥åŠè§£, æ²¡äº‹, ä½ ç¬¬äºŒå¤©å»ç¿»é˜…ç›¸å…³çŸ¥è¯†å†å»æ•´ç†å’Œç†è§£ä¸€ä¸‹å°±å¥½äº†, è¿™ç§è‡ªæˆ‘æ¿€åŠ±æ¯”ä»»ä½•é­ç­–éƒ½æœ‰ç”¨.</p>
<blockquote>
<p>æœ‰äº›å›°éš¾åªæ˜¯æš‚æ—¶çš„, æƒ³åŠæ³• â€˜æŒºâ€™ è¿‡å», ä½ å°±èµ¢äº†. å¾ˆå¤šæ—¶å€™ä¸æ˜¯å›°éš¾å“åˆ°äº†æˆ‘ä»¬, è€Œæ˜¯æˆ‘ä»¬æ”¾å¼ƒäº†è‡ªå·±.</p>
</blockquote>
<h2 id="å¤šæƒ³å¤šé—®"><a href="#å¤šæƒ³å¤šé—®" class="headerlink" title="å¤šæƒ³å¤šé—®"></a>å¤šæƒ³å¤šé—®</h2><p>å’Œä½ èº«è¾¹å…´è¶£ç›¸æŠ•æˆ–è€…æ¯”ä½ æœ‰èƒ½åŠ›çš„äººå¤šäº¤æµ, äº¤æµçš„è¿‡ç¨‹ä¹Ÿæ˜¯ä½ ç»ƒä¹ è‡ªæˆ‘è¡¨è¾¾èƒ½åŠ›çš„è¿‡ç¨‹, æŠŠè‡ªå·±çš„é—®é¢˜èƒ½å¤Ÿæ¸…æ¥šçš„æè¿°ç»™åˆ«äººå¬, ä¹Ÿæ˜¯ä¸€ç§èƒ½åŠ›.</p>
<p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰è¿™æ ·ä¸€ç§æ„Ÿè§‰, åœ¨è·Ÿåˆ«äººäº¤æµçš„è¿‡ç¨‹ä¸­, è™½ç„¶åˆ«äººæ²¡æœ‰ç›´æ¥å¸®ä½ è§£å†³é—®é¢˜, ä½†æ˜¯ä½ çªç„¶æœ‰äº†è§£å†³é—®é¢˜çš„åŠæ³•. ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢? å¾ˆç®€å•, å› ä¸ºè¿™ä¸ªé—®é¢˜ä½ ä¹‹å‰æ€è€ƒè¿‡, åªæ˜¯åœ¨äº¤æµçš„è¿‡ç¨‹ä¸­, ä½ çš„å¤§è„‘ä¸“æ³¨åœ¨æ­¤, èšç²¾ä¼šç¥çš„åœ¨æƒ³è¿™ä»¶äº‹æƒ….</p>
<p>é—®é—®é¢˜æœ‰ä¸€å¥—é—¨é“. åœ¨è¯·æ•™åˆ«äººé—®é¢˜ä¹‹å‰, æœ€å¥½è‡ªå·±å…ˆå°½åŠ›æƒ³ä¸€æƒ³, ä¸è¦é‡åˆ°ä¸€ç‚¹é—®é¢˜å°±å»é—®ä¸œé—®è¥¿, å³ä½¿åˆ«äººç»™ä½ è®²äº†, ä½ ä¹Ÿåªæ˜¯å½“æ—¶æ˜ç™½äº†, ä¸‹æ¬¡å†é‡åˆ°æ­¤ç±»é—®é¢˜, ä½ ä¾ç„¶æ‡µé€¼. è¿˜æœ‰å°±æ˜¯ä¼šè®©ä½ å½¢æˆä¸€ç§ä¾èµ–å¿ƒç†, åæ­£æœ‰äººèƒ½è§£å†³, æˆ‘é—®å°±å¯ä»¥äº†, å¹²å˜›è¿˜æœ‰è´¹æ—¶è´¹åŠ›çš„å»æƒ³?! ä¹…è€Œä¹…ä¹‹, å°±ç ´ç½å­ç ´æ‘”äº†.</p>
<p>å¦å¤–ä¸€ä¸ªè¦è¯´çš„å°±æ˜¯åœ¨è¯·æ•™æˆ–è€…äº¤æµé—®é¢˜çš„æ—¶å€™, è¦å¯¹å¯¹æ–¹è°¦è™š.</p>
<p>æˆ‘å¾ˆæ„Ÿæ¿€é«˜ä¸­æ—¶ä»£, ç­ä¸»ä»»å¾ˆä¿¡ä»»æˆ‘, è®©æˆ‘å½“äº†ä¸‰å¹´ç­é•¿, é‚£ä¸‰å¹´è®©æˆ‘å­¦åˆ°äº†å¾ˆå¤šä¹¦æœ¬ä¹‹å¤–çš„ä¸œè¥¿, å…¶ä¸­æ²Ÿé€šå’Œç®¡ç†è®©æˆ‘åœ¨ä»Šåçš„å·¥ä½œä¸­å—ç›ŠåŒªæµ…. </p>
<h2 id="é˜…è¯»å’Œå†™ä½œ"><a href="#é˜…è¯»å’Œå†™ä½œ" class="headerlink" title="é˜…è¯»å’Œå†™ä½œ"></a>é˜…è¯»å’Œå†™ä½œ</h2><blockquote>
<p>è¿™é‡Œè¯´çš„å†™ä½œä¸æ˜¯æŒ‡ä¸“ä¸šçš„ä½œå®¶çº§çš„å†™ä½œ, æ³›æŒ‡ä»»ä½•æ–‡å­—çš„è®°å½•, æ—¥è®°ä¹Ÿç®—.</p>
</blockquote>
<p>æ¯å¤©æœ€å¹¸ç¦çš„æ—¶åˆ»å°±æ˜¯åœ¨ 23:00 ç‚¹ä¹‹å‰ååœ¨ç”µè„‘å‰, å¯ä»¥å†™è‡ªå·±å¿ƒä¸­è¦è¡¨è¾¾çš„å†…å®¹, ä»»æ€ç»ªé£˜æ‘‡.</p>
<p>åªè¦æœ‰é—²æš‡çš„æ—¶é—´, æˆ‘å°±ä¼šæ•´ç†å’Œæ€»ç»“è¿™æ®µæ—¶é—´å‘ç”Ÿçš„äº‹æƒ…, æ—¢æœ‰å·¥ä½œä¸Šçš„ä¹Ÿæœ‰ç”Ÿæ´»ä¸Šçš„.</p>
<p>å°çš„æ—¶å€™, å®¶é‡Œæ¯”è¾ƒç©·, äº¤å­¦è´¹éƒ½æ˜¯é—®é¢˜, æ›´åˆ«è¯´æ˜¯ä¹°ä¹¦äº†. æˆ‘è®°å¾—åˆä¸­ä¸€å¹´çº§, æˆ‘å¾ˆæƒ³è¦ä¸€æœ¬è‹±è¯­ä¹¦ç±, é‚£ç§æ¸´æœ›è‡³ä»Šéš¾å¿˜! åæ¥, æˆ‘æ¯å¤©ä»è‡ªå·±çš„ç”Ÿæ´»è´¹é‡ŒæŠ å‡ºä¸€ç‚¹é’±(ç”Ÿæ´»è´¹æœ¬æ¥å°±å°‘), å°±è¿™æ ·ç§¯æ”’äº†å‡ ä¸ªæ˜ŸæœŸ, å»æ–°åä¹¦åº—ä¹°äº†ä¸€æœ¬è‹±è¯­ä¹¦ç±. é«˜ä¸­æ—¶æœŸ, æœ‰åŒå­¦ä¸è¦çš„æˆ–è€…å·²ç»ä¸è¯»çš„ä¹¦ç±, æˆ‘éƒ½ä¼šå€Ÿè¿‡æ¥çœ‹, æ²‰æµ¸åœ¨è‡ªå·±çš„å¹¸ç¦å½“ä¸­.</p>
<p>å‚åŠ å·¥ä½œä¹‹å, æˆ‘ä¹Ÿæœ‰å†™åšå®¢çš„ä¹ æƒ¯, æŠŠè‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜ä»¥åŠè§£å†³é—®é¢˜çš„æ€è·¯å’Œæ–¹å¼å†™å‡ºæ¥, åˆ†äº«ç»™å…¶ä»–äºº, å¿«ä¹æ— æ¯”. ç‰¹åˆ«æ˜¯æ”¶åˆ°æ–‡ç« çš„è¯„è®ºå, å¿ƒç†ç¾æ»‹æ»‹çš„. åœ¨äº’è”ç½‘çš„æµ·æ´‹é‡Œ, å¤§å®¶ç´ ä¸ç›¸è¯†, é€šè¿‡é”®ç›˜ä¸Šæ•²å‡»çš„æ–‡å­—äº’ç›¸äº¤æµçŸ¥è¯†å’Œæƒ³æ³•, å½¼æ­¤æˆé•¿ç€, ä¹Ÿåˆ«å…·ä¸€ç•ªä¹è¶£.</p>
<p>é˜…è¯»å’Œå†™ä½œå¯ä»¥åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›, è¿™ä¹ˆå¥½çš„ä¹ æƒ¯ä½ åƒä¸‡ä¸è¦æ‹’ç». å†™ä½œå¯ä»¥å€’é€¼ç€ä½ å»é˜…è¯», å»å…³å¿ƒç”Ÿæ´»é‡Œé¢çš„ç‚¹æ»´, é˜…è¯»å’Œç”Ÿæ´»ä¸­çš„ä½“éªŒåˆå¯ä»¥æ¿€å‘ä½ å†™ä½œçš„æ¬²æœ›, ä¸¤è€…ç›¸è¾…ç›¸æˆ.</p>
<p>æ¨èç»™å¤§å®¶ä¸€æœ¬ä¹¦: <strong>Google å·¥ä½œæ•´ç†æœ¯</strong></p>
<p><img src="/upload/images/2018/04/07/2.png" alt="-w200"></p>
<blockquote>
<p>è°·æ­Œå‰CIOï¼ˆé¦–å¸­ä¿¡æ¯å®˜ï¼‰åˆ†äº«é£é¡è°·æ­Œçš„ä¿¡æ¯æ•´ç†æœ¯ï¼Œå¸®åŠ©ç°ä»£äººå½»åº•å‘Šåˆ«æ— åºå·¥ä½œï¼Œå­¦ä¼šåˆ©ç”¨æ•°å­—å·¥å…·ä¸ºå¤§è„‘å‡å‹ï¼ä¿¡æ¯å¤ªå¤šã€æ—¶é—´å¤ªå°‘ï¼Œæ•´ç†ä¿¡æ¯å·²æˆä¸ºç°ä»£äººæ€¥éœ€æŒæ¡çš„å¿…å¤‡æŠ€èƒ½ã€‚è°·æ­Œä½œä¸ºå¼•é¢†å…¨çƒçš„ä¿¡æ¯æœç´¢ä¸æ•´åˆå·¨å¤´ï¼Œæ‹¥æœ‰èƒ½å¤Ÿæœ‰åºæ•´ç†ä¿¡æ¯çš„ç‹¬ç‰¹æ–¹å¼ï¼Œè€Œè°·æ­Œé¦–å¸­ä¿¡æ¯å®˜ä¾¿æ˜¯ä¸»å¯¼è¿™ä¸€â€œä¿¡æ¯å·¥å‚â€çš„æ€»å·¥ç¨‹å¸ˆã€‚å¦‚ä»Šï¼Œæ›¾æ‹…ä»»â€œæ€»å·¥ç¨‹å¸ˆâ€çš„é“æ ¼æ‹‰æ–¯æ¢…é‡Œå°”äº²è‡ªå°†é£é¡è°·æ­Œçš„ä¿¡æ¯æ•´ç†æ–¹å¼åˆ†äº«ç»™å¤§ä¼—è¯»è€…ï¼Œå¸®åŠ©ç°ä»£äººå…‹æœæ— åºå·¥ä½œçš„é€šç—…ã€‚ã€ŠGoogleå·¥ä½œæ•´ç†æœ¯ã€‹å‘Šè¯‰ä½ ï¼šä¸è¦èŠ±å¤ªå¤šæ—¶é—´ç»™ä¿¡æ¯å½’æ¡£ï¼Œç”¨çš„æ—¶å€™å­¦ä¼šå»æœç´¢ï¼›åœ¨æ•°å­—ä¿¡æ¯æ–‡æ¡£ä¸­åŠ ä¸Šå…³é”®è¯ï¼Œæ–¹ä¾¿æ—¥åæ£€ç´¢ï¼›ä»å‰ï¼ŒçŸ¥è¯†å°±æ˜¯åŠ›é‡,ç°åœ¨ï¼Œå…±äº«çŸ¥è¯†æ‰æ˜¯åŠ›é‡ï¼›æŠŠå·¥ä½œå’Œç”Ÿæ´»èä¸ºä¸€ä½“ï¼Œè€Œä¸æ˜¯åŠ›å›¾åœ¨äºŒè€…ä¹‹é—´æ±‚å¹³è¡¡ã€‚è¿™äº›å®ç”¨ Tips éƒ½æ­ç¤ºäº†ï¼šä¿¡æ¯æ•´ç†æ‰æ˜¯é«˜æ•ˆå·¥ä½œçš„å…³é”®ï¼Œä¿¡æ¯æ•´ç†å·²æ˜¯ç°ä»£äººçš„å·¥ä½œå¿…å¤‡æŠ€èƒ½ï¼</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç”Ÿæ´» æ„Ÿæ‚Ÿ å­¦ä¹  é˜…è¯» </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OC-RunTime: æ€»ç»“æ¶ˆæ¯è½¬å‘ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹]]></title>
      <url>/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹å®ä¾‹è®²è§£</a></p>
<p><a href="http://www.veryitman.com/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p>
<p>åœ¨ä¸Šé¢çš„å‡ ç¯‡æ–‡ç« ä¸­æˆ‘åˆ†äº«äº†å…³äºæ¶ˆæ¯è½¬å‘ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œé‡Œé¢æœ‰å¾ˆå¤šç»†èŠ‚æ²¡æœ‰é˜è¿°ã€‚</p>
<p>è‹¥åœ¨ä¸Šé¢çš„æ–‡ç« ä¸­åŠ å…¥å¾ˆå¤šç»†èŠ‚ç‚¹çš„è¯ï¼Œä¸€æ˜¯æ‹‰é•¿äº†æ–‡ç« çš„å†…å®¹, äºŒæ˜¯å¯¹äºåˆšæ¥è§¦ Runtime çš„æœ‹å‹æ¥è¯´ä¸ä¸€å®šèƒ½æ¥å—, äºæ˜¯å°±æœ‰äº†è¿™ç¯‡æ–‡ç« çš„è¯ç”Ÿ.</p>
<h2 id="RunTime-çš„å®šä¹‰åŠä½¿ç”¨åœºæ™¯"><a href="#RunTime-çš„å®šä¹‰åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="RunTime çš„å®šä¹‰åŠä½¿ç”¨åœºæ™¯"></a>RunTime çš„å®šä¹‰åŠä½¿ç”¨åœºæ™¯</h2><p>è‹¹æœ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Introduction/Introduction.html" target="_blank" rel="noopener">å¼€å‘æ–‡æ¡£</a> çš„è¿™æ ·è§£é‡Š runtime çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">The Objective-C language defers as many decisions as it can from compile time and link time to runtime. Whenever possible, it does things dynamically. This means that the language requires not just a compiler, but also a runtime system to execute the compiled code. The runtime system acts as a kind of operating system for the Objective-C language; itâ€™s what makes the language work</div></pre></td></tr></table></figure>
<p>å°½é‡å°†å†³å®šæ”¾åˆ°è¿è¡Œçš„æ—¶å€™ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘å’Œé“¾æ¥è¿‡ç¨‹ä¸­.</p>
<p>RunTime çš„åº”ç”¨åœºæ™¯:</p>
<blockquote>
<p>1.é¢å‘åˆ‡é¢ç¼–ç¨‹ AOP.<br>2.æ–¹æ³•è°ƒé… method swizzling. æœ‰äº›åœ°æ–¹ç§°ä¹‹ä¸ºâ€é»‘é­”æ³•â€.<br>3.æ¶ˆæ¯è½¬å‘.<br>4.ç»™åˆ†ç±»æ·»åŠ å±æ€§(å…³è”å¯¹è±¡).<br>5.åŠ¨æ€è·å– class å’Œ slector.<br>6.KVO/KVC, ä¿®æ”¹ç§æœ‰å±æ€§çš„å€¼.</p>
</blockquote>
<p>å»ºè®®å»é˜…è¯»ä¸‹é¢æ¡†æ¶çš„æºç ï¼Œæ•æˆ‘æ²¡æœ‰åŠ å…¥é“¾æ¥:</p>
<blockquote>
<p>Aspectsï¼ˆAOPå¿…å¤‡ï¼Œâ€œå–ç¼”â€ baseVCï¼Œæ— ä¾µå…¥åŸ‹ç‚¹ï¼‰</p>
<p>MJExtensionï¼ˆJSON è½¬ modelï¼Œä¸€è¡Œä»£ç å®ç° NSCoding åè®®çš„è‡ªåŠ¨å½’æ¡£å’Œè§£æ¡£ï¼‰</p>
<p>JSPatchï¼ˆåŠ¨æ€ä¸‹å‘ JS è¿›è¡Œçƒ­ä¿®å¤ï¼‰</p>
<p>NullSafeï¼ˆé˜²æ­¢å› å‘ unrecognised messages ç»™ NSNull å¯¼è‡´çš„å´©æºƒï¼‰</p>
<p>UITableView-FDTemplateLayoutCellï¼ˆè‡ªåŠ¨è®¡ç®—å¹¶ç¼“å­˜ table view çš„ cell é«˜åº¦ï¼‰</p>
<p>UINavigationController+FDFullscreenPopGestureï¼ˆå…¨å±æ»‘åŠ¨è¿”å›ï¼‰</p>
</blockquote>
<h2 id="æ€è€ƒé—®é¢˜"><a href="#æ€è€ƒé—®é¢˜" class="headerlink" title="æ€è€ƒé—®é¢˜"></a>æ€è€ƒé—®é¢˜</h2><p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œå¾ˆå¤šæ¬¡çœ‹åˆ° IMPã€SELã€selector ä»¥åŠ Method ç­‰å…³é”®å­—ï¼Œç›¸ä¿¡å¤§å®¶éšç€å¯¹ RunTime çš„é€æ­¥äº†è§£ï¼Œæ…¢æ…¢ä¼šé€æ¸ç†Ÿæ‚‰å®ƒä»¬çš„ï¼Œåªæ˜¯æ—¶é—´é—®é¢˜ã€‚å¾ˆå¤šæ¦‚å¿µä¸Šé¢çš„ä¸œè¥¿ç†è§£èµ·æ¥æ²¡é‚£ä¹ˆç®€å•ï¼Œéœ€è¦åŠ¨æ‰‹å»å†™å†™ä»£ç ã€‚</p>
<p>åœ¨çœ‹ä¸‹é¢å†…å®¹ä¹‹å‰, å…ˆæŠ›å‡ºä¸€ä¸ªé—®é¢˜:</p>
<blockquote>
<p>runtime å¦‚ä½•é€šè¿‡ selector æ‰¾åˆ°å¯¹åº”çš„ IMP åœ°å€?</p>
</blockquote>
<p>æ¥ä¸‹æ¥åˆ†åˆ«è¯´ä¸€ä¸‹ IMPã€SELã€selector ä»¥åŠ Method.</p>
<h2 id="IMP"><a href="#IMP" class="headerlink" title="IMP"></a>IMP</h2><p>IMP ä¿å­˜çš„æ˜¯ Method çš„åœ°å€ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œç”±ç¼–è¯‘å™¨ç”Ÿæˆã€‚</p>
<p>IMP åœ¨ <code>objc.h</code> ä¸­çš„å®šä¹‰ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// A pointer to the function of a method implementation. </span></div><div class="line"><span class="meta">#if !OBJC_OLD_DISPATCH_PROTOTYPES</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">void</span> (*IMP)(<span class="keyword">void</span> <span class="comment">/* id, SEL, ... */</span> ); </div><div class="line"><span class="meta">#else</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">id</span> (*IMP)(<span class="keyword">id</span>, SEL, ...); </div><div class="line"><span class="meta">#endif</span></div></pre></td></tr></table></figure>
<p>å‘å¯¹è±¡å‘é€æ¶ˆæ¯ä¹‹åï¼Œæ˜¯ç”±è¿™ä¸ªå‡½æ•°æŒ‡é’ˆ IMP æŒ‡å®šçš„, å³ IMP å‡½æ•°æŒ‡é’ˆå°±æŒ‡å‘äº†æ–¹æ³•çš„å®ç°.</p>
<p>IMP å‡½æ•°æŒ‡é’ˆæœ€å°‘åŒ…å« id å’Œ SEL ç±»å‹çš„ä¸¤ä¸ªå‚æ•°ï¼Œåé¢å…¶ä»–çš„å‚æ•°æ˜¯å¯¹åº”æ–¹æ³•éœ€è¦çš„å‚æ•°ã€‚å…¶ä¸­ id ä»£è¡¨æ‰§è¡Œè¯¥æ–¹æ³•çš„ target(å¯¹è±¡), SEL å°±æ˜¯å¯¹åº”çš„æ–¹æ³•, é€šè¿‡ id å’Œ SEL å‚æ•°å°±èƒ½ç¡®å®šå”¯ä¸€çš„æ–¹æ³•å®ç°åœ°å€.</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è·å–æ–¹æ³•çš„ IMP å‘¢ï¼Ÿå¾ˆç®€å•.</p>
<p>NSObject æä¾›äº†å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- (IMP)methodForSelector:(SEL)aSelector;</div><div class="line">+ (IMP)instanceMethodForSelector:(SEL)aSelector;</div></pre></td></tr></table></figure>
<p>å¯¹åº”çš„å®ç°(æºç  NSObject.mm), å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">+ (IMP)instanceMethodForSelector:(SEL)sel &#123;</div><div class="line">    <span class="keyword">if</span> (!sel) [<span class="keyword">self</span> doesNotRecognizeSelector:sel];</div><div class="line">    <span class="keyword">return</span> class_getMethodImplementation(<span class="keyword">self</span>, sel);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (IMP)methodForSelector:(SEL)sel &#123;</div><div class="line">    <span class="keyword">if</span> (!sel) [<span class="keyword">self</span> doesNotRecognizeSelector:sel];</div><div class="line">    <span class="keyword">return</span> object_getMethodImplementation((<span class="keyword">id</span>)<span class="keyword">self</span>, sel);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (IMP)methodForSelector:(SEL)sel &#123;</div><div class="line">    <span class="keyword">if</span> (!sel) [<span class="keyword">self</span> doesNotRecognizeSelector:sel];</div><div class="line">    <span class="keyword">return</span> object_getMethodImplementation(<span class="keyword">self</span>, sel);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¯¹åº”çš„ <code>methodForSelector</code> æ—¢æœ‰å®ä¾‹æ–¹æ³•åˆæœ‰ç±»æ–¹æ³•ï¼Œè€Œ <code>instanceMethodForSelector</code> åªæœ‰ç±»æ–¹æ³•ã€‚</p>
<p>åœ¨ä½¿ç”¨ <code>methodForSelector</code> æ–¹æ³•æ—¶ï¼Œå‘ç±»å‘é€æ¶ˆæ¯ï¼Œåˆ™ SEL åº”è¯¥æ˜¯ç±»æ–¹æ³•, è‹¥å‘å®ä¾‹å¯¹è±¡å‘é€æ¶ˆæ¯ï¼Œåˆ™ SEL åº”è¯¥ä¸ºå®ä¾‹å¯¹è±¡æ–¹æ³•.</p>
<p>è€Œ <code>instanceMethodForSelector</code> ä»…ä»…å…è®¸ç±»å‘é€è¯¥æ¶ˆæ¯, ä»è€Œè·å–å®ä¾‹æ–¹æ³•çš„ IMP. è¯¥æ–¹æ³•æ— æ³•è·å–ç±»æ–¹æ³•çš„ IMP, å¦‚æœæƒ³è·å–ç±»æ–¹æ³•çš„ IMP å¯ä»¥ä½¿ç”¨ <code>methodForSelector</code> æ¥è·å–ã€‚</p>
<p>å‡½æ•°æ–‡æ¡£åŸæ–‡è§£é‡Šå¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Use this method to ask the class object for the implementation of instance methods only. </div><div class="line">To ask the class for the implementation of a class method, send the methodForSelector: instance method to the class instead.</div></pre></td></tr></table></figure>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ–è®¸æ›´å¥½ç†è§£ã€‚</p>
<p>ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•, ä¸€ä¸ªæ˜¯ç±»æ–¹æ³•(testClassMethod), å¦ä¸€ä¸ªæ˜¯å®ä¾‹æ–¹æ³•(testInstanceMethod).</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)testClassMethod &#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)testInstanceMethod &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åˆ†åˆ«ä½¿ç”¨ä¸Šé¢æåˆ°çš„æ–¹æ³•æ¥è·å– IMP çš„å‡ ä¸ªæ–¹æ³•.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">IMP imp = [[<span class="keyword">self</span> <span class="keyword">class</span>] instanceMethodForSelector:<span class="keyword">@selector</span>(testClassMethod)];</div><div class="line">IMP imp2 = [[<span class="keyword">self</span> <span class="keyword">class</span>] instanceMethodForSelector:<span class="keyword">@selector</span>(testInstanceMethod)];</div><div class="line"></div><div class="line"><span class="comment">// ä¹Ÿå¯ä»¥æ”¹æˆ NSObject è°ƒç”¨çš„æ–¹å¼, ç»“æœä¸€æ ·.</span></div><div class="line"><span class="comment">// IMP imp = [NSObject instanceMethodForSelector:@selector(testClassMethod)];</span></div><div class="line"><span class="comment">// IMP imp2 = [NSObject instanceMethodForSelector:@selector(testInstanceMethod)];</span></div><div class="line">    </div><div class="line">IMP imp3 = [[<span class="keyword">self</span> <span class="keyword">class</span>] methodForSelector:<span class="keyword">@selector</span>(testClassMethod)];</div><div class="line">IMP imp4 = [<span class="keyword">self</span> methodForSelector:<span class="keyword">@selector</span>(testInstanceMethod)];</div></pre></td></tr></table></figure>
<p>è°ƒè¯•å™¨å¯ä»¥çœ‹å‡º, å¦‚ä¸‹æ—¥å¿—:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Printing description of imp:</div><div class="line">(IMP) imp = <span class="number">0x000000010d8455c0</span> (libobjc.A.dylib`_objc_msgForward)</div><div class="line"></div><div class="line">Printing description of imp2:</div><div class="line">(IMP) imp2 = <span class="number">0x000000010cf19b90</span> (-[ViewController testInstanceMethod] at ViewController.m:<span class="number">94</span>)</div><div class="line"></div><div class="line">Printing description of imp3:</div><div class="line">(IMP) imp3 = <span class="number">0x000000010cf19b60</span> (+[ViewController testClassMethod] at ViewController.m:<span class="number">89</span>)</div><div class="line"></div><div class="line">Printing description of imp4:</div><div class="line">(IMP) imp4 = <span class="number">0x000000010cf19b90</span> (-[ViewController testInstanceMethod] at ViewController.m:<span class="number">94</span>)</div><div class="line">(lldb)</div></pre></td></tr></table></figure>
<p>imp2ã€imp3ã€imp4 éƒ½æ˜¯æ­£å¸¸çš„ï¼Œå”¯ç‹¬ imp ä¸æ­£å¸¸ï¼Œä¹Ÿå……åˆ†è¯´æ˜äº† <code>instanceMethodForSelector</code> æ— æ³•è·å–ç±»æ–¹æ³•çš„ IMP.</p>
<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p>åœ¨æºç  <code>runtime.h</code> ä¸­, å®šä¹‰ method, å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªç»“æ„ä½“.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> objc_method &#123;</div><div class="line">    SEL method_name     OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">char</span> *method_types  OBJC2_UNAVAILABLE;</div><div class="line">    IMP method_imp      OBJC2_UNAVAILABLE;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ–¹æ³•å <code>method_name</code> ç±»å‹ä¸º SEL.</p>
<p><code>method_types</code> æ–¹æ³•ç±»å‹, æ˜¯ä¸€ä¸ª char æŒ‡é’ˆï¼Œå­˜å‚¨ç€æ–¹æ³•çš„å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹ã€‚</p>
<p>æ–¹æ³•å®ç° <code>method_imp</code> çš„ç±»å‹ä¸º IMP.</p>
<p>å¯ä»¥çœ‹å‡º, æœ‰ SEL å’Œ IMP, method_types æ˜¯å¯¹åº”çš„æ–¹æ³•è¿”å›å€¼å’Œå‚æ•°ç±»å‹, å¦‚ <code>v@:</code>ï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p><code>runtime.h</code> ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æ ¹æ® SEL ç›´æ¥è·å–å®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•çš„ Methodï¼Œå¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Method class_getInstanceMethod(Class cls, SEL name);</div><div class="line"></div><div class="line">Method class_getClassMethod(Class cls, SEL name);</div></pre></td></tr></table></figure>
<h2 id="SEL"><a href="#SEL" class="headerlink" title="SEL"></a>SEL</h2><p><code>selector</code>, ç§°ä¹‹ä¸ºæ–¹æ³•é€‰æ‹©å™¨ï¼ŒSEL æ˜¯ <code>selector</code> çš„è¡¨ç¤ºç±»å‹ï¼Œä¹Ÿæ˜¯æ–¹æ³•çš„ç¼–å·ï¼Œæ˜¯ç±»æˆå‘˜æ–¹æ³•çš„æŒ‡é’ˆã€‚</p>
<p>SEL å®šä¹‰åœ¨æºç  <code>objc.h</code> ä¸­, æ˜¯ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆ, å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// An opaque type that represents a method selector.</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_selector *SEL;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯æºç ä¸­æŸ¥ä¸åˆ° <code>objc_selector</code> å…·ä½“çš„å®šä¹‰å’Œå®ç°.</p>
<p>è·å– SEL æœ‰ä¸‰ä¸ªæ–¹æ³•:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SEL sel = <span class="keyword">@selector</span>(play:);</div><div class="line">SEL sel = sel_registerName(<span class="string">"play:"</span>); </div><div class="line">SEL sel = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"play"</span>);</div></pre></td></tr></table></figure>
<p>SEL è¡¨ç¤ºä¸€ä¸ª selector çš„æŒ‡é’ˆï¼Œæ— è®ºä»€ä¹ˆç±»é‡Œï¼Œåªè¦æ–¹æ³•åç›¸åŒï¼ŒSEL å°±ç›¸åŒï¼ŒSEL å®é™…æ˜¯æ ¹æ®æ–¹æ³•å hash åŒ–äº†çš„å­—ç¬¦ä¸²ã€‚è€Œå¯¹äºå­—ç¬¦ä¸²çš„æ¯”è¾ƒä»…ä»…éœ€è¦æ¯”è¾ƒä»–ä»¬çš„åœ°å€å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥é€Ÿåº¦ä¸Šéå¸¸å¿«ï¼ŒSEL çš„å­˜åœ¨åŠ å¿«äº†æŸ¥è¯¢æ–¹æ³•çš„é€Ÿåº¦ã€‚</p>
<blockquote>
<p>æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆåœ¨åŒä¸€ä¸ª OC ç±»ä¸­ï¼Œä¸èƒ½å­˜åœ¨åŒåçš„å‡½æ•°ï¼Œå³ä½¿å‚æ•°ç±»å‹ä¸åŒä¹Ÿä¸è¡Œï¼Œæ¢å¥è¯è¯´ OCä¸ºä»€ä¹ˆæ²¡æœ‰é‡è½½ï¼Ÿ</p>
<p>ç­”æ¡ˆå·²ç»åœ¨ä¸Šé¢è¯´äº†ï¼ŒSEL è¡¨ç¤ºä¸€ä¸ª selector çš„æŒ‡é’ˆï¼Œæ— è®ºä»€ä¹ˆç±»é‡Œï¼Œåªè¦æ–¹æ³•åç›¸åŒï¼ŒSEL å°±ç›¸åŒï¼Œç›¸åŒçš„å‡½æ•°åï¼Œç¼–è¯‘å™¨æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚</p>
</blockquote>
<p><code>dispatch table</code> å­˜æ”¾ SEL å’Œ IMP çš„å¯¹åº”å…³ç³»ï¼ŒSEL æœ€ç»ˆä¼šé€šè¿‡ <code>dispatch table</code> å¯»æ‰¾åˆ°å¯¹åº”çš„IMPã€‚</p>
<p>æ€»ä¹‹ï¼ŒSelectorã€Method å’Œ IMP ä¸‰è€…ä¹‹é—´çš„å…³ç³»å¯ä»¥è¿™ä¹ˆè§£é‡Šï¼Œåœ¨ç±»çš„(å®ä¾‹å’Œç±»æ–¹æ³•)è°ƒåº¦è¡¨(dispatch table)ä¸­çš„æ¯ä¸€ä¸ªå®ä½“ä»£è¡¨ä¸€ä¸ªæ–¹æ³• Methodï¼Œå…¶åå­—å«åšé€‰æ‹©å™¨ SELï¼Œå¹¶å¯¹åº”ç€ä¸€ç§æ–¹æ³•å®ç°ç§°ä¹‹ä¸º IMPï¼Œæœ‰äº† Method å°±å¯ä»¥ä½¿ç”¨ SEL æ‰¾åˆ°å¯¹åº”çš„ IMPï¼ŒSEL å°±æ˜¯ä¸ºäº†æŸ¥æ‰¾æ–¹æ³•çš„æœ€ç»ˆå®ç° IMPã€‚</p>
<h2 id="class-addMethod"><a href="#class-addMethod" class="headerlink" title="class_addMethod"></a>class_addMethod</h2><p>æŸ¥çœ‹æºç  <code>objc-runtime-new.mm</code> ä¸­è¯¥å‡½æ•°å®ç°å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">BOOL</span> class_addMethod(Class cls, SEL name, IMP imp, <span class="keyword">const</span> <span class="keyword">char</span> *types)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (!cls) <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line"></div><div class="line">    rwlock_writer_t lock(runtimeLock);</div><div class="line">    <span class="keyword">return</span> ! addMethod(cls, name, imp, types ?: <span class="string">""</span>, <span class="literal">NO</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¼€å‘æ–‡æ¡£ä¸­è¿™æ ·æè¿°è¯¥å‡½æ•°:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Adds a new method to a <span class="keyword">class</span> with a given name and implementation.</div><div class="line">class_addMethod will add an override of a superclass's implementation, </div><div class="line">but will not replace an existing implementation <span class="keyword">in</span> <span class="keyword">this</span> <span class="keyword">class</span>. </div><div class="line">To change an existing implementation, use method_setImplementation.</div></pre></td></tr></table></figure>
<p>è§£é‡Šä¸€ä¸‹ï¼Œå¯ä»¥ä¸ºç±»æ ¹æ® SEL å’Œ IMP åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ–°æ–¹æ³•ã€‚<code>class_addMethod</code> ä»…å¯ä»¥åŠ¨æ€æ·»åŠ æ–¹æ³•ï¼Œä¸ä¼šæ›¿æ¢ã€‚å¦‚æœæƒ³è¾¾åˆ°æ–¹æ³•æ›¿æ¢çš„æ•ˆæœå¯ä½¿ç”¨ <code>method_setImplementation</code> å‡½æ•°ã€‚</p>
<p>å…³äº <code>method_setImplementation</code> å’Œ <code>method_exchangeImplementations</code> åé¢æ–‡ç« å†åšåˆ†æ.</p>
<p>å…¶å®, <code>method_exchangeImplementations</code> çš„å†…éƒ¨å®ç°ç›¸å½“äºè°ƒç”¨äº† 2 æ¬¡ <code>method_setImplementation</code> æ–¹æ³•ã€‚</p>
<p><code>class_addMethod</code> ä¸ä»…å¯ä»¥åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•, ä¹Ÿå¯ä»¥æ·»åŠ å®ä¾‹æ–¹æ³•ã€‚</p>
<p>å‚æ•°åŠè¿”å›å€¼è§£é‡Š:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">è¿”å›å€¼: è¿”å› <span class="literal">YES</span> è¡¨ç¤ºæ–¹æ³•æ·»åŠ æˆåŠŸ, å¦åˆ™æ·»åŠ å¤±è´¥ã€‚</div><div class="line"></div><div class="line">å‚æ•° Class cls: å°†è¦ç»™æ·»åŠ æ–¹æ³•çš„ç±», å³ï¼»ç±»å <span class="keyword">class</span>ï¼½</div><div class="line"></div><div class="line">å‚æ•° SEL name: å°†è¦æ·»åŠ çš„æ–¹æ³• SEL, å³ <span class="keyword">@selector</span>(æ–¹æ³•å)ï¼Œå¦‚æœå·²ç»å­˜åœ¨ï¼Œè¯¥æ–¹æ³•è¿”å›å¤±è´¥ï¼Œä¸å­˜åœ¨å°±æ·»åŠ æˆåŠŸã€‚</div><div class="line"></div><div class="line">å‚æ•° IMP impï¼šå®ç°è¿™ä¸ªæ–¹æ³•çš„å‡½æ•°. æœ‰ä¸¤ç§å†™æ³•å³ C å’Œ OC çš„å†™æ³•. ä¸€ä¸ª IMP æœ€å°‘åŒ…æ‹¬ä¸¤ä¸ªå‚æ•°, ä¸Šé¢å·²ç»è¯´è¿‡ã€‚</div><div class="line"></div><div class="line">å‚æ•° <span class="keyword">const</span> <span class="keyword">char</span> *types: å®ç°æ–¹æ³•çš„å‡½æ•°çš„è¿”å›å’Œå‚æ•°ç¼–ç ç±»å‹. å¦‚ <span class="string">"v@:"</span> è¡¨ç¤ºè¿”å›å€¼ä¸º <span class="keyword">void</span>, æ²¡æœ‰å‚æ•°çš„ä¸€ä¸ªå‡½æ•°, å…¶ä¸­ @å’Œ:åˆ†åˆ«ä»£è¡¨ IMP çš„é»˜è®¤ä¸¤ä¸ªå‚æ•°å³ <span class="keyword">id</span> å’Œ sel.</div></pre></td></tr></table></figure>
<p>å…³äº typesï¼Œå¯ä»¥ä½¿ç”¨ <code>method_getTypeEncoding</code> æ¥è·å–ã€‚</p>
<p>æ›´å¤šå…³äº types çš„å†…å®¹å¯ä»¥å‚è€ƒå¼€å‘è€…æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtTypeEncodings.html#//apple_ref/doc/uid/TP40008048-CH100-SW1" target="_blank" rel="noopener">Type Encodings</a>.</p>
<h2 id="è§£ç­”é—®é¢˜"><a href="#è§£ç­”é—®é¢˜" class="headerlink" title="è§£ç­”é—®é¢˜"></a>è§£ç­”é—®é¢˜</h2><p>è¯»åˆ°è¿™é‡Œ, å¤§å®¶å¯¹ IMP, SEL ä»¥åŠ Method åº”è¯¥æœ‰åˆæ­¥çš„äº†è§£äº†, é‚£ä¹ˆæ¥è§£ç­”ä¸€ä¸‹åˆšæ‰æå‡ºçš„é—®é¢˜:</p>
<blockquote>
<p>runtime å¦‚ä½•é€šè¿‡ selector æ‰¾åˆ°å¯¹åº”çš„ IMP åœ°å€?</p>
</blockquote>
<p>å›ç­”è¿™ä¸ªé—®é¢˜çš„å…³é”®æ˜¯è¦çŸ¥é“æ¶ˆæ¯è°ƒåº¦è¡¨(dispatch table)ï¼Œå¦å¤–ä¸€ä¸ªè¦å›ç­”çš„è¦ç‚¹æ˜¯ IMP çš„å®ç°å’Œè·å–ä»¥åŠå’Œ Method ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>ç±»å¯¹è±¡ä¸­æœ‰ç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„åˆ†å‘è¡¨ï¼Œè¡¨ä¸­è®°å½•ç€æ–¹æ³•çš„åå­—ã€å‚æ•°å’Œå®ç°ï¼Œselector æœ¬è´¨å°±æ˜¯æ–¹æ³•åç§°ï¼Œruntime é€šè¿‡è¿™ä¸ªæ–¹æ³•åç§°å°±å¯ä»¥åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°è¯¥æ–¹æ³•å¯¹åº”çš„å®ç°.</p>
<p>ç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›äº†è·å– IMP æŒ‡é’ˆçš„å‡½æ•°ï¼Œæ— è®ºæ˜¯ç±»æ–¹æ³•è¿˜æ˜¯å®ä¾‹æ–¹æ³•æˆ‘ä»¬éƒ½å¯ä»¥è·å–å¯¹åº”çš„ IMP.</p>
<p>è€Œ Method å°† Selector å’Œ IMP è”ç³»èµ·æ¥ï¼Œå¯ä»æºç ä¸­çœ‹å‡º:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> objc_method &#123;</div><div class="line">    SEL method_name     OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">char</span> *method_types  OBJC2_UNAVAILABLE;</div><div class="line">    IMP method_imp      OBJC2_UNAVAILABLE;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>IMP æ˜¯å‡½æ•°çš„æŒ‡é’ˆï¼Œå®ƒæ˜¯ç”±ç¼–è¯‘å™¨ç¼–è¯‘ç”Ÿæˆçš„ã€‚å½“å‘ä¸€ä¸ªæ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šæ‰¾åˆ°é‚£æ®µä»£ç æ‰§è¡Œï¼ŒIMP æŒ‡å‘äº†è¿™ä¸ªæ–¹æ³•çš„å…·ä½“çš„å®ç°ï¼Œå¾—åˆ°è¿™ä¸ªå‡½æ•°çš„æŒ‡é’ˆå¯ä»¥ç›´æ¥æ‰§è¡Œã€‚</p>
<p>IMP æŒ‡å‘çš„æ–¹æ³•ä¸ <code>objc_msgSend</code> å‡½æ•°ç±»å‹ç›¸åŒï¼Œå‚æ•°éƒ½åŒ…å« id å’Œ SEL ç±»å‹ã€‚æ¯ä¸ªæ–¹æ³•åéƒ½å¯¹åº”ä¸€ä¸ª SEL ç±»å‹çš„æ–¹æ³•é€‰æ‹©å™¨ï¼Œè€Œæ¯ä¸ªå®ä¾‹å¯¹è±¡ä¸­çš„ SEL å¯¹åº”çš„æ–¹æ³•å®ç°è‚¯å®šæ˜¯å”¯ä¸€çš„ï¼Œé€šè¿‡ä¸€ç»„ id å’Œ SEL å‚æ•°å°±èƒ½ç¡®å®šå”¯ä¸€çš„æ–¹æ³•å®ç°åœ°å€ï¼Œåä¹‹äº¦ç„¶ã€‚å½“å‘é€æ¶ˆæ¯ç»™ä¸€ä¸ªå¯¹è±¡æ—¶ï¼ŒrunTime ä¼šåœ¨å¯¹è±¡çš„ç±»å¯¹è±¡æ–¹æ³•åˆ—è¡¨é‡ŒæŸ¥æ‰¾ï¼Œå½“æˆ‘ä»¬å‘é€ä¸€ä¸ªæ¶ˆæ¯ç»™ä¸€ä¸ªç±»æ—¶ï¼Œè¿™æ¡æ¶ˆæ¯ä¼šåœ¨ç±»çš„ <code>Meta Class</code> å¯¹è±¡çš„æ–¹æ³•åˆ—è¡¨é‡ŒæŸ¥æ‰¾ï¼Œç›´åˆ°è¶…æ‰¾åˆ° NSObject ä¸­ä¸ºæ­¢ã€‚</p>
<p><strong>æ¶ˆæ¯ä¼ é€’çš„è¿‡ç¨‹</strong></p>
<p><strong>1.</strong> å½“æ¶ˆæ¯è¢«å‘é€ç»™ä¸€ä¸ªå¯¹è±¡ï¼Œmessaging function è·Ÿéšå¯¹è±¡çš„ isa æŒ‡é’ˆæ‰¾åˆ°å®ƒçš„ class structureï¼Œåœ¨ dispatch table ä¸­å¯»æ‰¾ method selector.</p>
<p><strong>2.</strong> å¦‚æœæ²¡æœ‰æ‰¾åˆ° selectorï¼Œobjc_msgsend è·Ÿéšè¯¥ç±»å®ä¾‹çš„ isa æ‰¾åˆ°çˆ¶ç±»ï¼Œå°è¯•åœ¨çˆ¶ç±»çš„ dispatch table ä¸­å¯»æ‰¾ selector.</p>
<p><strong>3.</strong> é‡å¤æ­¥éª¤ <strong>2</strong>ï¼Œç›´åˆ° isa æŒ‡å‘ NSObject Class ä¸ºæ­¢ã€‚</p>
<p>å…³äºåˆ†å‘è¡¨å’Œæ¶ˆæ¯ç›¸å…³çš„çŸ¥è¯†å¯ä»¥å‚è€ƒå¼€å‘æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtHowMessagingWorks.html" target="_blank" rel="noopener">Messaging</a>ï¼Œè®²å¾—å¾ˆæ¸…æ¥šã€‚</p>
<h2 id="å®é™…ä¾‹å­"><a href="#å®é™…ä¾‹å­" class="headerlink" title="å®é™…ä¾‹å­"></a>å®é™…ä¾‹å­</h2><p>è¯´äº†è¿™ä¹ˆå¤šç†è®ºçŸ¥è¯†ï¼Œæ˜¯æ—¶å€™ä¸¾æ —å­äº†ï¼Œæ–¹ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£ä¸Šé¢çš„å†…å®¹ã€‚</p>
<h3 id="1-åŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•"><a href="#1-åŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•" class="headerlink" title="1. åŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•"></a>1. åŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•</h3><p><strong>Student.m</strong></p>
<p>é™¤ <code>init</code> å¤–ï¼ŒStudent åªæœ‰ä¸€ä¸ªå®ä¾‹æ–¹æ³• <code>studentWalkImp</code>.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">instancetype</span>)init</div><div class="line">&#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</div><div class="line">        </div><div class="line">        SEL proxySelector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"studentWalkImp"</span>);</div><div class="line">        IMP impletor = class_getMethodImplementation([<span class="keyword">self</span> <span class="keyword">class</span>], proxySelector);</div><div class="line">        </div><div class="line">        <span class="comment">// è·å–å®ä¾‹æ–¹æ³•</span></div><div class="line">        Method method = class_getInstanceMethod([<span class="keyword">self</span> <span class="keyword">class</span>], proxySelector);</div><div class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</div><div class="line">        </div><div class="line">        SEL origSel = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"walk"</span>);</div><div class="line">        class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], origSel, impletor, types);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)studentWalkImp</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- Student studentWalkImp"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>è°ƒç”¨æµ‹è¯•ä¸€ä¸‹.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    Student *stud = [[Student alloc] init];</div><div class="line">    [stud performSelector:<span class="built_in">NSSelectorFromString</span>(<span class="string">@"walk"</span>) withObject:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œ Student å¹¶æ²¡æœ‰ <code>walk</code> æ–¹æ³•ï¼Œæ•…æ„ä¸ºä¹‹ï¼Œè¿è¡Œåæ§åˆ¶å°ä¼šæ‰“å°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">---veryitman--- Student studentWalkImp</div></pre></td></tr></table></figure>
<p>æˆåŠŸçš„ä¸º Student æ·»åŠ äº†ä¸€ä¸ªå®ä¾‹æ–¹æ³• <code>walk</code> çš„å®ç° <code>studentWalkImp</code>.</p>
<p>ä¸Šé¢çš„ä¾‹å­æ˜¯ä½¿ç”¨ OC çš„ IMP æ–¹å¼æ¥å®ç°çš„ï¼Œå¯ä»¥æ”¹ä¸º C å®ç°ç‰ˆæœ¬çš„.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">instancetype</span>)init</div><div class="line">&#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</div><div class="line">        SEL origSel = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"walk"</span>);</div><div class="line">        class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], origSel, (IMP)studentWalkImp, <span class="string">"v:@"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> studentWalkImp()</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- Student studentWalkImp"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•"><a href="#2-åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•" class="headerlink" title="2. åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•"></a>2. åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•</h3><p>åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•ï¼Œå’ŒåŠ¨æ€æ·»åŠ å®ä¾‹æ–¹æ³•ç¨å¾®æœ‰ç‚¹ä¸åŒã€‚ä¸‹é¢æ˜¯æ”¹é€ åçš„ <code>Student.m</code>.</p>
<p><strong>Student.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">instancetype</span>)init</div><div class="line">&#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// è·å– MetaClass, ç±»æ–¹æ³•ä¸å¯ä»¥ä½¿ç”¨ [self class]</span></div><div class="line">        Class metaCls = objc_getMetaClass([<span class="built_in">NSStringFromClass</span>([<span class="keyword">self</span> <span class="keyword">class</span>]) UTF8String]);</div><div class="line">        </div><div class="line">        SEL proxySelector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"clsImp"</span>);</div><div class="line">        IMP impletor = class_getMethodImplementation(metaCls, proxySelector);</div><div class="line">        </div><div class="line">        <span class="comment">// è·å–ç±»æ–¹æ³•</span></div><div class="line">        Method method = class_getClassMethod([<span class="keyword">self</span> <span class="keyword">class</span>], proxySelector);</div><div class="line">        </div><div class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</div><div class="line">        SEL origSel = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"walk"</span>);</div><div class="line">        </div><div class="line">        class_addMethod(metaCls, origSel, impletor, types);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)clsImp</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- Student clsImp"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šè¿™é‡Œè·å– Class ç¨å¾®ä¸åŒçš„æ˜¯ä½¿ç”¨äº† <code>objc_getMetaClass</code>ï¼Œè¿™é‡Œå…³ç³»åˆ° Objective-C ä¸­çš„ç±»ã€Classã€æ ¹ç±»å’Œå…ƒç±»çš„åŒºåˆ«ï¼Œåç»­åšæ–‡å†åšåˆ†äº«ã€‚</p>
<p>è°ƒç”¨æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    Student *stud = [[Student alloc] init];</div><div class="line">    </div><div class="line">    [[stud <span class="keyword">class</span>] performSelector:<span class="built_in">NSSelectorFromString</span>(<span class="string">@"walk"</span>) withObject:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ§åˆ¶å°æ‰“å°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">---veryitman--- Student clsImp</div></pre></td></tr></table></figure>
<p>æˆåŠŸåœ°ä¸ºç±»åŠ¨æ€çš„æ·»åŠ äº†ä¸€ä¸ªç±»æ–¹æ³• <code>clsImp</code>.</p>
<h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><strong>1. <a href="http://blog.devtang.com/2013/10/15/objective-c-object-model/" target="_blank" rel="noopener">Objective-C å¯¹è±¡æ¨¡å‹åŠåº”ç”¨</a></strong></p>
<p><strong>2. <a href="https://opensource.apple.com/tarballs/objc4/" target="_blank" rel="noopener">Apple RunTime æºç  objc4-723.tar.gz</a></strong></p>
<p><strong>3. <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtHowMessagingWorks.html" target="_blank" rel="noopener">Messaging</a></strong></p>
<p><strong>4. <a href="https://junyixie.github.io/2017/05/01/Objective-C-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B8%AD%E7%9A%84%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6%E5%92%8C%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8/" target="_blank" rel="noopener">Objective-C æ·±å…¥ç†è§£ä¸­çš„æ¶ˆæ¯æœºåˆ¶å’Œæ–¹æ³•è°ƒç”¨</a></strong></p>
<h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p>ç‚¹å‡»ä¸‹è½½æ–‡ä¸­å®Œæ•´çš„ <a href="https://github.com/veryitman/iOSDemo/tree/master/MZRuntimeMsgForward" target="_blank" rel="noopener">Demo</a>.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS RunTime MessageForward </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹]]></title>
      <url>/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡æ˜¯ã€Œæ¶ˆæ¯è½¬å‘ã€ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡, åœ¨ <a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a> å’Œ <a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹[å®ä¾‹è®²è§£]</a> ä¸­åˆ†äº«äº†å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹.</p>
<p>ä»Šå¤©åˆ†äº«å¦‚ä½•å¯¹ç±»æ–¹æ³•è¿›è¡Œæ¶ˆæ¯çš„è½¬å‘.</p>
<h2 id="resolveClassMethod"><a href="#resolveClassMethod" class="headerlink" title="resolveClassMethod"></a>resolveClassMethod</h2><p>NSObject æä¾›äº† <code>resolveClassMethod</code> æ¥è®©å¼€å‘è€…åœ¨é‡Œé¢åŠ¨æ€æ·»åŠ ä¸€ä¸ªç±»æ–¹æ³•.</p>
<p>ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹å’Œå®ä¾‹æ–¹æ³•è½¬å‘çš„æµç¨‹å¤§è‡´ä¸€æ ·, å”¯ç‹¬ä¸åŒçš„æ˜¯éœ€è¦é‡å†™çš„æ–¹æ³•(NSObjectä¸­)çš„ä¸ä¸€æ ·.</p>
<p>å½“æ—¶æˆ‘åœ¨å†™ Demo, ä»¥ä¸ºåªéœ€è¦å°† <code>resolveInstanceMethod</code> æ”¹ä¸º <code>resolveClassMethod</code> å°±ä¸‡äº‹å¤§å‰äº†å³é‡å†™ä¸‹é¢å‡ ä¸ªæ–¹æ³•å°±å¯ä»¥è§£å†³é—®é¢˜, äº‹å®è¯æ˜è¿™æ ·æ˜¯ä¸è¡Œçš„.</p>
<blockquote>
<ol>
<li>+resolveClassMethod</li>
<li>-forwardingTargetForSelector</li>
<li>-methodSignatureForSelector</li>
<li>-forwardInvocation</li>
<li>-doesNotRecognizeSelector:</li>
</ol>
</blockquote>
<p>ç½‘ä¸Šå¾ˆå¤šåšæ–‡å¹¶æ²¡æœ‰æ·±å…¥çš„æ¢è®¨å…³äºç±»æ–¹æ³•è½¬å‘çš„æµç¨‹, åªæ˜¯åœ¨ä»‹ç»å®ä¾‹æ–¹æ³•è½¬å‘çš„æµç¨‹çš„åŒæ—¶, ä¸€ç¬”å¸¦è¿‡ç±»æ–¹æ³•è½¬å‘æœºåˆ¶å’Œæµç¨‹.</p>
<p>é€šè¿‡å¯¹ <code>NSObject.mm</code> æºç çš„æŸ¥çœ‹, å¯ä»¥çœ‹åˆ°å¯¹åº”ä¸Šé¢çš„å‡ ä¸ªæ–¹æ³•éƒ½æœ‰ç±»æ–¹æ³•. å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span> +resolveClassMethod</div><div class="line"><span class="number">2.</span> +forwardingTargetForSelector</div><div class="line"><span class="number">3.</span> +methodSignatureForSelector</div><div class="line"><span class="number">4.</span> +forwardInvocation</div><div class="line"><span class="number">5.</span> +doesNotRecognizeSelector:</div></pre></td></tr></table></figure>
<p>é‡æ–°è¿™å‡ ä¸ªæ–¹æ³•æ‰æ˜¯è§£å†³é—®é¢˜çš„å…³é”®.</p>
<p>ç°åœ¨æˆ‘ä»¬é‡å†™ <code>resolveClassMethod</code>, å¦‚ä¸‹.</p>
<hr>
<p><strong>ViewController.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> sPerformClassMethodName = <span class="string">@"veryClassMethod"</span>;</div><div class="line"></div><div class="line">+ (<span class="built_in">BOOL</span>)resolveClassMethod:(SEL)sel</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 1--- +resolveClassMethod"</span>);</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *methodName = <span class="built_in">NSStringFromSelector</span>(sel);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([sPerformClassMethodName isEqualToString:methodName]) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// è·å– MetaClass</span></div><div class="line">        Class predicateMetaClass = objc_getMetaClass([<span class="built_in">NSStringFromClass</span>(<span class="keyword">self</span>) UTF8String]);</div><div class="line">        <span class="comment">// æ ¹æ® metaClass è·å–æ–¹æ³•çš„å®ç°</span></div><div class="line">        IMP impletor = class_getMethodImplementation(predicateMetaClass, <span class="keyword">@selector</span>(proxyMethod));</div><div class="line">        <span class="comment">// è·å–ç±»æ–¹æ³•</span></div><div class="line">        Method predicateMethod = class_getClassMethod(predicateMetaClass, <span class="keyword">@selector</span>(proxyMethod));</div><div class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *encoding = method_getTypeEncoding(predicateMethod);</div><div class="line">        </div><div class="line">        <span class="comment">// åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•</span></div><div class="line">        class_addMethod(predicateMetaClass, sel, impletor, encoding);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveClassMethod:sel];</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)proxyMethod</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- +proxyMethod of class's method for OC."</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¨¡æ‹Ÿè°ƒç”¨</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    <span class="comment">// è¿è¡Œç±»æ–¹æ³•</span></div><div class="line">    SEL selector = <span class="built_in">NSSelectorFromString</span>(sPerformClassMethodName);</div><div class="line">    SuppressPerformSelectorLeakWarning(</div><div class="line">        [[<span class="keyword">self</span> <span class="keyword">class</span>] performSelector:selector withObject:<span class="literal">nil</span>];</div><div class="line">    );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…³äº <code>SuppressPerformSelectorLeakWarning</code> å¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹[å®ä¾‹è®²è§£]</a>.</p>
<p>å°†åŠ¨æ€æ·»åŠ çš„æ–¹æ³•è®© <code>proxyMethod</code> æ¥æ‰§è¡Œ, æ˜¾ç¤ºç»“æœè¾¾åˆ°é¢„æœŸ.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">---veryitman--- <span class="number">1</span>--- +resolveClassMethod</div><div class="line">---veryitman--- +proxyMethod of class's method for OC.</div></pre></td></tr></table></figure>
<h2 id="åˆ›å»ºè¢«è½¬å‘è€…"><a href="#åˆ›å»ºè¢«è½¬å‘è€…" class="headerlink" title="åˆ›å»ºè¢«è½¬å‘è€…"></a>åˆ›å»ºè¢«è½¬å‘è€…</h2><p><strong>MZTempObj.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MZTempObj</span></span></div><div class="line"></div><div class="line"><span class="comment">/// ç±»æ–¹æ³•</span></div><div class="line">+ (<span class="keyword">void</span>)veryClassMethod</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- veryClassMethod"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ç±»æ–¹æ³•çš„ä¸€ä¸ªå®ç° <code>veryClassMethod</code>.</p>
<h2 id="é‡å†™è½¬å‘æ¶ˆæ¯çš„å‡½æ•°"><a href="#é‡å†™è½¬å‘æ¶ˆæ¯çš„å‡½æ•°" class="headerlink" title="é‡å†™è½¬å‘æ¶ˆæ¯çš„å‡½æ•°"></a>é‡å†™è½¬å‘æ¶ˆæ¯çš„å‡½æ•°</h2><p>åŒç†å°† <code>resolveClassMethod</code> ä¿®æ”¹ä¸€ä¸‹, ä¸ºäº†ä¿è¯æµç¨‹ç»§ç»­.</p>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line">+ (<span class="built_in">BOOL</span>)resolveClassMethod:(SEL)sel</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 1--- +resolveClassMethod. selector: %@"</span>, <span class="built_in">NSStringFromSelector</span>(sel));</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *methodName = <span class="built_in">NSStringFromSelector</span>(sel);</div><div class="line">    </div><div class="line">    <span class="comment">// è¿™é‡Œæ•…æ„å°† sPerformClassMethodName æ”¹ä¸º @"", ä¸ºäº†æµç¨‹å¾€ä¸‹èµ°</span></div><div class="line">    <span class="keyword">if</span> ([<span class="string">@""</span> isEqualToString:methodName]) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// è·å– MetaClass</span></div><div class="line">        Class predicateMetaClass = objc_getMetaClass([<span class="built_in">NSStringFromClass</span>(<span class="keyword">self</span>) UTF8String]);</div><div class="line">        <span class="comment">// æ ¹æ® metaClass è·å–æ–¹æ³•çš„å®ç°</span></div><div class="line">        IMP impletor = class_getMethodImplementation(predicateMetaClass, <span class="keyword">@selector</span>(proxyMethod));</div><div class="line">        <span class="comment">// è·å–ç±»æ–¹æ³•</span></div><div class="line">        Method predicateMethod = class_getClassMethod(predicateMetaClass, <span class="keyword">@selector</span>(proxyMethod));</div><div class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *encoding = method_getTypeEncoding(predicateMethod);</div><div class="line">        </div><div class="line">        <span class="comment">// åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•</span></div><div class="line">        class_addMethod(predicateMetaClass, sel, impletor, encoding);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveClassMethod:sel];</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 2--- +forwardingTargetForSelector"</span>);</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *selectorName = <span class="built_in">NSStringFromSelector</span>(aSelector);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([sPerformClassMethodName isEqualToString:selectorName]) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// æ³¨æ„1: ä¹Ÿå¯åœ¨æ­¤è½¬å‘å®ä¾‹æ–¹æ³•</span></div><div class="line"><span class="meta">#if 0</span></div><div class="line">        <span class="comment">// è®© MZTempObj å»æ‰§è¡Œ aSelector, å®ç°æ¶ˆæ¯çš„è½¬å‘</span></div><div class="line">        MZTempObj *myobject = [[MZTempObj alloc] init];</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> myobject;</div><div class="line"><span class="meta">#endif</span></div><div class="line">        </div><div class="line">        <span class="comment">// è½¬å‘ç±»æ–¹æ³•å¯¹åº”è¿”å›ç±»å¯¹è±¡</span></div><div class="line">        <span class="keyword">return</span> [MZTempObj <span class="keyword">class</span>];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">id</span> obj = [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> obj;</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="built_in">NSMethodSignature</span> *)methodSignatureForSelector:(SEL)aSelector</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 3--- +methodSignatureForSelector"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// æ‰¾å‡ºå¯¹åº”çš„ aSelector ç­¾å</span></div><div class="line">    <span class="built_in">NSMethodSignature</span> *signature = [<span class="keyword">super</span> methodSignatureForSelector:aSelector];</div><div class="line">    </div><div class="line">    <span class="comment">// æ³¨æ„2: ä¹Ÿå¯ä»¥åœ¨æ­¤è·å–å®ä¾‹æ–¹æ³•çš„ç­¾å</span></div><div class="line"><span class="meta">#if 0</span></div><div class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == signature) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// æ˜¯å¦æœ‰ aSelector</span></div><div class="line">        <span class="keyword">if</span> ([MZTempObj instancesRespondToSelector:aSelector]) &#123;</div><div class="line">            signature = [MZTempObj instanceMethodSignatureForSelector:aSelector];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> signature;</div><div class="line"><span class="meta">#endif</span></div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == signature) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// æ˜¯å¦æœ‰ aSelector</span></div><div class="line">        <span class="keyword">if</span> ([MZTempObj respondsToSelector:aSelector]) &#123;</div><div class="line">            </div><div class="line">            <span class="comment">//methodSignatureForSelector å¯ä»¥è·å–ç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„ç­¾å</span></div><div class="line">            <span class="comment">//instanceMethodSignatureForSelectoråªèƒ½è·å–å®ä¾‹æ–¹æ³•çš„ç­¾å</span></div><div class="line">            signature = [MZTempObj methodSignatureForSelector:aSelector];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> signature;</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)forwardInvocation:(<span class="built_in">NSInvocation</span> *)anInvocation</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 4--- +forwardInvocation"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// æ³¨æ„3: ä¹Ÿå¯ä»¥è°ƒç”¨å®ä¾‹æ–¹æ³•</span></div><div class="line"><span class="meta">#if 0</span></div><div class="line">    <span class="keyword">if</span> ([MZTempObj instancesRespondToSelector:anInvocation.selector]) &#123;</div><div class="line">        [anInvocation invokeWithTarget:[[MZTempObj alloc] init]];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        [<span class="keyword">super</span> forwardInvocation:anInvocation];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span>;</div><div class="line"><span class="meta">#endif</span></div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([MZTempObj respondsToSelector:anInvocation.selector]) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// è¿™é‡Œè½¬å‘çš„æ˜¯ MZTempObj Class, ä¸æ˜¯å¯¹è±¡</span></div><div class="line">        [anInvocation invokeWithTarget:[MZTempObj <span class="keyword">class</span>]];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        [<span class="keyword">super</span> forwardInvocation:anInvocation];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)doesNotRecognizeSelector:(SEL)aSelector</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 5--- +doesNotRecognizeSelector: %@"</span>, <span class="built_in">NSStringFromSelector</span>(aSelector));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œå, æ§åˆ¶å°è¾“å‡ºæ—¥å¿—:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">---veryitman--- <span class="number">1</span>--- +resolveClassMethod. selector: veryClassMethod</div><div class="line">---veryitman--- <span class="number">2</span>--- +forwardingTargetForSelector</div><div class="line">---veryitman--- veryClassMethod</div></pre></td></tr></table></figure>
<p><strong>è¿™é‡Œæ³¨æ„ä¸€ä¸‹</strong></p>
<blockquote>
<p>å°†ä»£ç ä¸­ <code>æ³¨æ„1</code> <code>æ³¨æ„2</code> ç­‰éƒ¨åˆ†å¯ä»¥è‡ªè¡Œæ‰“å¼€æµ‹è¯•ä¸€ä¸‹, ç„¶åå°† <code>MZTempObj.m</code> ä¸­çš„ç±»æ–¹æ³•(+veryClassMethod)æ”¹ä¸ºå®ä¾‹æ–¹æ³•(-veryClassMethod), ä¹Ÿæ˜¯å¯ä»¥çš„, è¿™æ ·å°±è¾¾åˆ°äº†å°†ç±»æ–¹æ³•è½¬å‘ç»™å®ä¾‹æ–¹æ³•çš„æ•ˆæœ.</p>
</blockquote>
<p>ä¿®æ”¹ä¸€ä¸‹ <code>forwardingTargetForSelector</code> ä¸­çš„å®ç°, å¯ä»¥çœ‹åˆ° 4, 5ä¹Ÿä¼šæ‰§è¡Œ.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 2--- +forwardingTargetForSelector"</span>);</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *selectorName = <span class="built_in">NSStringFromSelector</span>(aSelector);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([<span class="string">@""</span> isEqualToString:selectorName]) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// æ³¨æ„1: ä¹Ÿå¯åœ¨æ­¤è½¬å‘å®ä¾‹æ–¹æ³•</span></div><div class="line"><span class="meta">#if 0</span></div><div class="line">        <span class="comment">// è®© MZTempObj å»æ‰§è¡Œ aSelector, å®ç°æ¶ˆæ¯çš„è½¬å‘</span></div><div class="line">        MZTempObj *myobject = [[MZTempObj alloc] init];</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> myobject;</div><div class="line"><span class="meta">#endif</span></div><div class="line">        </div><div class="line">        <span class="comment">// è½¬å‘ç±»æ–¹æ³•å¯¹åº”è¿”å›ç±»å¯¹è±¡</span></div><div class="line">        <span class="keyword">return</span> [MZTempObj <span class="keyword">class</span>];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">id</span> obj = [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> obj;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">---veryitman--- <span class="number">1</span>--- +resolveClassMethod. selector: veryClassMethod</div><div class="line">---veryitman--- <span class="number">2</span>--- +forwardingTargetForSelector</div><div class="line">---veryitman--- <span class="number">3</span>--- +methodSignatureForSelector</div><div class="line">---veryitman--- <span class="number">1</span>--- +resolveClassMethod. selector: _forwardStackInvocation:</div><div class="line">---veryitman--- <span class="number">4</span>--- +forwardInvocation</div><div class="line">---veryitman--- veryClassMethod</div></pre></td></tr></table></figure>
<p>åŒç†æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç±»æ–¹æ³•çš„æ¶ˆæ¯è½¬å‘æµç¨‹å›¾, å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2018/04/03/1.jpg" alt="1"></p>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹å®ä¾‹è®²è§£</a></p>
<p><a href="http://www.veryitman.com/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/" target="_blank" rel="noopener">OC-RunTime: æ€»ç»“æ¶ˆæ¯è½¬å‘ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹</a></p>
<p>ç‚¹å‡»ä¸‹è½½æ–‡ä¸­å®Œæ•´çš„ <a href="https://github.com/veryitman/iOSDemo/tree/master/MZRuntimeMsgForward" target="_blank" rel="noopener">Demo</a>.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS RunTime MessageForward </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹[å®ä¾‹è®²è§£]]]></title>
      <url>/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p><a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a> åˆ†äº«äº†æ¶ˆæ¯è½¬å‘çš„æµç¨‹, æœ¬æ¬¡ç»“åˆå®é™…ä¾‹å­ç»§ç»­åˆ†æä¸€ä¸‹æ¶ˆæ¯è½¬å‘æµç¨‹.</p>
<h2 id="å‘é€ä¸å­˜åœ¨çš„æ¶ˆæ¯"><a href="#å‘é€ä¸å­˜åœ¨çš„æ¶ˆæ¯" class="headerlink" title="å‘é€ä¸å­˜åœ¨çš„æ¶ˆæ¯"></a>å‘é€ä¸å­˜åœ¨çš„æ¶ˆæ¯</h2><p>åœ¨ ViewController çš„ viewDidLoad ä¸­è¿è¡Œ <code>veryTestMethod</code> æ–¹æ³•.</p>
<p><strong>ViewController.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> sPerformInstanceMethodName = <span class="string">@"veryTestMethod"</span>;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    <span class="comment">// è¿è¡Œå®ä¾‹æ–¹æ³•</span></div><div class="line">    SEL selector = <span class="built_in">NSSelectorFromString</span>(sPerformInstanceMethodName);</div><div class="line">    </div><div class="line">    SuppressPerformSelectorLeakWarning(</div><div class="line">        [<span class="keyword">self</span> performSelector:selector withObject:<span class="literal">nil</span>];</div><div class="line">    );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­, <code>SuppressPerformSelectorLeakWarning</code> æ˜¯å®šä¹‰çš„ä¸€ä¸ªå®.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define SuppressPerformSelectorLeakWarning(Stuff) \</span></div><div class="line"><span class="keyword">do</span> &#123; \</div><div class="line">    _Pragma(<span class="string">"clang diagnostic push"</span>) \</div><div class="line">    _Pragma(<span class="string">"clang diagnostic ignored \"-Warc-performSelector-leaks\""</span>) \</div><div class="line">    Stuff; \</div><div class="line">    _Pragma(<span class="string">"clang diagnostic pop"</span>) \</div><div class="line">&#125; <span class="keyword">while</span> (<span class="number">0</span>)</div></pre></td></tr></table></figure>
<p>åœ¨ ViewController ä¸­æˆ‘å¹¶æ²¡æœ‰å†™ <code>veryTestMethod</code> è¿™ä¸ªå‡½æ•°, åªæ˜¯å€ŸåŠ© <code>performSelector</code> åŠ¨æ€æ‰§è¡Œ, å¦‚æœç¼–è¯‘è¿è¡Œç›´æ¥ä¼š crash.</p>
<p>å¯ä»¥æŸ¥çœ‹ <code>NSObject.mm</code> æºç , é‡Œé¢å…³äºæ¶ˆæ¯è½¬å‘çš„å‡ ä¸ªé‡è¦å‡½æ•°éƒ½å†™ç€ <code>_objc_fatal</code>, å¯è°“æ˜¯æ‹›æ‹›æ¯™å‘½.</p>
<p>ç´§æ¥ç€, æˆ‘ä»¬å¯ä»¥å€ŸåŠ© <code>resolveInstanceMethod</code> æ¥å®Œæˆæ¶ˆæ¯è½¬å‘ç»™ ViewController.</p>
<h2 id="resolveInstanceMethod-è½¬å‘"><a href="#resolveInstanceMethod-è½¬å‘" class="headerlink" title="resolveInstanceMethod è½¬å‘"></a>resolveInstanceMethod è½¬å‘</h2><p>é‡å†™ NSObject ä¸­çš„ <code>resolveInstanceMethod</code> å‡½æ•°.</p>
<blockquote>
<p>+resolveInstanceMethod</p>
</blockquote>
<p><strong>ViewController.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è®°å¾—å¯¼å…¥ RunTime å¤´æ–‡ä»¶</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line">+ (<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 1--- +resolveInstanceMethod"</span>);</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *methodName = <span class="built_in">NSStringFromSelector</span>(sel);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([sPerformInstanceMethodName isEqualToString:methodName]) &#123;</div><div class="line">        </div><div class="line">        SEL proxySelector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"proxyMethod"</span>);</div><div class="line">        IMP impletor = class_getMethodImplementation(<span class="keyword">self</span>, proxySelector);</div><div class="line">        </div><div class="line">        <span class="comment">// è·å–å®ä¾‹æ–¹æ³•</span></div><div class="line">        Method method = class_getInstanceMethod(<span class="keyword">self</span>, proxySelector);</div><div class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</div><div class="line">        </div><div class="line">        <span class="comment">// æ·»åŠ  OC çš„å‡½æ•°</span></div><div class="line">        class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], sel, impletor, types);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveInstanceMethod:sel];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ViewController ä¸­å®ç°çš„ <code>proxyMethod</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// OC å®ç°</span></div><div class="line">- (<span class="keyword">void</span>)proxyMethod</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- -proxyMethod of instance's method for OC."</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ <code>resolveInstanceMethod</code> ä¸­åŠ¨æ€æ·»åŠ äº† <code>veryTestMethod</code> æ–¹æ³•, å¹¶è®© <code>proxyMethod</code> å‡½æ•°æ¥å®ç°(IMP).</p>
<p>è¿è¡Œå¯ä»¥çœ‹åˆ°, ç¨‹åºå¹¶æ²¡æœ‰ crash, æˆåŠŸçš„æ‰§è¡Œäº† <code>proxyMethod</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">---veryitman--- 1--- +resolveInstanceMethod</div><div class="line">---veryitman--- -proxyMethod of instance&apos;s method for OC.</div></pre></td></tr></table></figure>
<p>åˆ°æ­¤ä¸ºæ­¢, æˆ‘ä»¬å·²ç»çœ‹åˆ°åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ–¹æ³•çš„å®ç°å¹¶æˆåŠŸè¿è¡Œçš„å®Œæ•´ä¾‹å­.</p>
<p>æ¥ä¸‹æ¥, æˆ‘ä»¬å°†è½¬å‘ç»™å…¶ä»–å¯¹è±¡ <code>MZTempObj</code> æ¥æ‰§è¡Œ.</p>
<h2 id="è‡ªå®šä¹‰è¢«è½¬å‘çš„å¯¹è±¡"><a href="#è‡ªå®šä¹‰è¢«è½¬å‘çš„å¯¹è±¡" class="headerlink" title="è‡ªå®šä¹‰è¢«è½¬å‘çš„å¯¹è±¡"></a>è‡ªå®šä¹‰è¢«è½¬å‘çš„å¯¹è±¡</h2><p><strong>MZTempObj.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MZTempObj</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)veryTestMethod</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- veryTestMethod"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>veryTestMethod</code> å°±æ˜¯æˆ‘ä»¬è¦è½¬å‘å¯¹åº”çš„æ¶ˆæ¯.</p>
<h2 id="æ¶ˆæ¯è½¬å‘å®è·µ"><a href="#æ¶ˆæ¯è½¬å‘å®è·µ" class="headerlink" title="æ¶ˆæ¯è½¬å‘å®è·µ"></a>æ¶ˆæ¯è½¬å‘å®è·µ</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠå‘ ViewController å‘é€ <code>veryTestMethod</code> çš„æ¶ˆæ¯è½¬å‘ç»™ <code>MZTempObj</code> çš„  <code>veryTestMethod</code> æ–¹æ³•.</p>
<p>ç»§ç»­é‡å†™ä¸‹é¢å‡½æ•°, ä¸è¿‡ <code>resolveInstanceMethod</code> è¦ç¨å¾®æ”¹é€ ä¸€ä¸‹, æ‰èƒ½è¾¾åˆ°æˆ‘ä»¬å®è·µçš„ç›®çš„.</p>
<blockquote>
<ol>
<li>+resolveInstanceMethod</li>
<li>-forwardingTargetForSelector</li>
<li>-methodSignatureForSelector</li>
<li>-forwardInvocation</li>
<li>-doesNotRecognizeSelector:</li>
</ol>
</blockquote>
<p><strong>ViewController.m</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è®°å¾—å¯¼å…¥ RunTime å¤´æ–‡ä»¶</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line">+ (<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 1--- +resolveInstanceMethod: %@"</span>, <span class="built_in">NSStringFromSelector</span>(sel));</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *methodName = <span class="built_in">NSStringFromSelector</span>(sel);</div><div class="line">    </div><div class="line">    <span class="comment">// è¿™é‡Œæ•…æ„ä¸ºä¹‹, è®©æµç¨‹å¾€ä¸‹èµ°</span></div><div class="line">    <span class="keyword">if</span> ([<span class="string">@""</span> isEqualToString:methodName]) &#123;</div><div class="line">        </div><div class="line">        SEL proxySelector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"proxyMethod"</span>);</div><div class="line">        IMP impletor = class_getMethodImplementation(<span class="keyword">self</span>, proxySelector);</div><div class="line">        </div><div class="line">        <span class="comment">// è·å–å®ä¾‹æ–¹æ³•</span></div><div class="line">        Method method = class_getInstanceMethod(<span class="keyword">self</span>, proxySelector);</div><div class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</div><div class="line">        </div><div class="line">        <span class="comment">// æ·»åŠ  OC çš„å‡½æ•°</span></div><div class="line">        class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], sel, impletor, types);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveInstanceMethod:sel];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/// è½¬å‘ç»™å¯¹åº”çš„æŸä¸ªå¯¹è±¡æ¥æ‰§è¡Œ aSelector</span></div><div class="line">- (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 2--- -forwardingTargetForSelector"</span>);</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *selectorName = <span class="built_in">NSStringFromSelector</span>(aSelector);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([sPerformInstanceMethodName isEqualToString:selectorName]) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// è®© MZTempObj å»æ‰§è¡Œ aSelector, å®ç°æ¶ˆæ¯çš„è½¬å‘</span></div><div class="line">        MZTempObj *myobject = [[MZTempObj alloc] init];</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> myobject;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">id</span> obj = [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> obj;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSMethodSignature</span> *)methodSignatureForSelector:(SEL)aSelector</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 3--- -methodSignatureForSelector"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// æ‰¾å‡ºå¯¹åº”çš„ aSelector ç­¾å</span></div><div class="line">    <span class="built_in">NSMethodSignature</span> *signature = [<span class="keyword">super</span> methodSignatureForSelector:aSelector];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == signature) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// æ˜¯å¦æœ‰ aSelector</span></div><div class="line">        <span class="keyword">if</span> ([MZTempObj instancesRespondToSelector:aSelector]) &#123;</div><div class="line">            signature = [MZTempObj instanceMethodSignatureForSelector:aSelector];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    <span class="keyword">return</span> signature;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)forwardInvocation:(<span class="built_in">NSInvocation</span> *)anInvocation</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 4--- -forwardInvocation"</span>);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([MZTempObj instancesRespondToSelector:anInvocation.selector]) &#123;</div><div class="line">        [anInvocation invokeWithTarget:[[MZTempObj alloc] init]];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        [<span class="keyword">super</span> forwardInvocation:anInvocation];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)doesNotRecognizeSelector:(SEL)aSelector</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 5--- -doesNotRecognizeSelector: %@"</span>, <span class="built_in">NSStringFromSelector</span>(aSelector));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿è¡Œç¨‹åº, æ§åˆ¶å°æ‰“å°ç»“æœå¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">---veryitman--- 1--- +resolveInstanceMethod</div><div class="line">---veryitman--- 2--- -forwardingTargetForSelector</div><div class="line">---veryitman--- veryTestMethod</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¯¹ç…§ä¹‹å‰çš„æµç¨‹å›¾æ˜¯å®Œå…¨ç¬¦åˆçš„, é‚£ä¹ˆæ€ä¹ˆè®©å…¶æ‰§è¡Œ 3 å’Œ 4 å‘¢? å¾ˆç®€å•, ä¿®æ”¹ä¸€ä¸‹ <code>forwardingTargetForSelector</code> é‡Œé¢çš„å®ç°å³å¯.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"---veryitman--- 2--- -forwardingTargetForSelector"</span>);</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *selectorName = <span class="built_in">NSStringFromSelector</span>(aSelector);</div><div class="line">    </div><div class="line">    <span class="comment">// æ•…æ„ä¸ºä¹‹</span></div><div class="line">    <span class="keyword">if</span> ([<span class="string">@""</span> isEqualToString:selectorName]) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// è®© MZTempObj å»æ‰§è¡Œ aSelector, å®ç°æ¶ˆæ¯çš„è½¬å‘</span></div><div class="line">        MZTempObj *myobject = [[MZTempObj alloc] init];</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> myobject;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">id</span> obj = [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> obj;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†æ¬¡æ‰§è¡Œçœ‹ç»“æœ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">---veryitman--- 1--- +resolveInstanceMethod veryTestMethod</div><div class="line">---veryitman--- 2--- -forwardingTargetForSelector</div><div class="line">---veryitman--- 3--- -methodSignatureForSelector</div><div class="line">---veryitman--- 1--- +resolveInstanceMethod: _forwardStackInvocation:</div><div class="line">---veryitman--- 4--- -forwardInvocation</div><div class="line">---veryitman--- veryTestMethod</div></pre></td></tr></table></figure>
<p><strong>æ³¨æ„:</strong> è¿™é‡Œåœ¨ 3åé¢ä¼šå¤šäº†ä¸€ä¸ª <code>1--- resolveInstanceMethod</code> çš„æ‰“å°, æ˜¯ç³»ç»Ÿè°ƒç”¨çš„, æ­¤æ—¶å¯¹åº”çš„ sel æ˜¯ <code>_forwardStackInvocation</code>.</p>
<p>å¦‚æœä¸å»é‡å†™ <code>methodSignatureForSelector</code> æ‰“å°ç»“æœå¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">---veryitman--- 1--- +resolveInstanceMethod</div><div class="line">---veryitman--- 2--- -forwardingTargetForSelector</div><div class="line">---veryitman--- 5--- -doesNotRecognizeSelector: veryTestMethod</div></pre></td></tr></table></figure>
<h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p>1.Apple RunTime æºç  <a href="https://opensource.apple.com/tarballs/objc4/" target="_blank" rel="noopener">objc4-723.tar.gz</a></p>
<p>2.<a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html#//apple_ref/doc/uid/TP40008048-CH105-SW1" target="_blank" rel="noopener">Message Forwarding</a></p>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="http://www.veryitman.com/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/" target="_blank" rel="noopener">OC-RunTime: æ€»ç»“æ¶ˆæ¯è½¬å‘ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹</a></p>
<p>ç‚¹å‡»ä¸‹è½½æ–‡ä¸­å®Œæ•´çš„ <a href="https://github.com/veryitman/iOSDemo/tree/master/MZRuntimeMsgForward" target="_blank" rel="noopener">Demo</a>.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS RunTime MessageForward </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹]]></title>
      <url>/2018/03/31/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡åªæ˜¯ä»ç³»ç»Ÿå‡½æ•°çš„å®ç°ä¸Š, æ¥åˆ†ææ¶ˆæ¯è½¬å‘çš„æµç¨‹. </p>
<p>ä¸‹ä¸€ç¯‡ç»“åˆæœ¬ç¯‡çš„ç†è®ºå’Œå®é™…çš„ä¾‹å­æ¥åˆ†æä¸€ä¸‹æ¶ˆæ¯è½¬å‘.</p>
<h2 id="éœ€è¦æ˜ç¡®çš„å‡ ä¸ªé—®é¢˜"><a href="#éœ€è¦æ˜ç¡®çš„å‡ ä¸ªé—®é¢˜" class="headerlink" title="éœ€è¦æ˜ç¡®çš„å‡ ä¸ªé—®é¢˜"></a>éœ€è¦æ˜ç¡®çš„å‡ ä¸ªé—®é¢˜</h2><p>åœ¨å¾€ä¸‹çœ‹è¿™ç¯‡åšæ–‡ä¹‹å‰, æœ‰å‡ ä¸ªé—®é¢˜éœ€è¦å¤§å®¶è¾¾æˆå…±è¯†.</p>
<p><strong>1.Objective-C çš„ç‰¹ç‚¹</strong><br>æŒ‰ç…§æ˜¯å¦éœ€è¦ç¼–è¯‘çš„åŸç†æ¥è¯´, ç¼–ç¨‹è¯­è¨€ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºé™æ€ç¼–è¯‘ç±»å‹å’ŒåŠ¨æ€è§£é‡Šç±»å‹.</p>
<p>å¦‚ Java/C/C++ æ˜¯å±äºç¼–è¯‘ç±»å‹çš„è¯­è¨€, Php/Python/Ruby å±äºè§£é‡Šç±»å‹çš„è¯­è¨€.</p>
<p>Objective-C æ˜¯åŸºäº C å¹¶å…·æœ‰è‡ªèº«ç‰¹ç‚¹çš„ç¼–è¯‘å‹è¯­è¨€, å†åŠ ä¸Šå…¶ RunTime æœºåˆ¶, Objective-C æ—¢æ˜¯ç¼–è¯‘å‹åˆæ˜¯åŠ¨æ€çš„ä¸€é—¨ç¼–ç¨‹è¯­è¨€. æ‰€è°“çš„åŠ¨æ€æŒ‡çš„æ˜¯åœ¨ç¨‹åºç¼–è¯‘åè¿è¡Œä¸­å¯ä»¥æ”¹å˜å…¶ç»“æ„.</p>
<p><strong>2.å‡½æ•°è°ƒç”¨</strong><br>åœ¨ Objective-C ä¸­è°ƒç”¨å‡½æ•°, è¢«è§£é‡Šä¸ºå‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯, è¯¥å¯¹è±¡å¯ä»¥æ˜¯ç±»å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡.</p>
<p>ä¾‹å¦‚:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[person play];</div></pre></td></tr></table></figure>
<p>æ„æ€æ˜¯å‘å®ä¾‹å¯¹è±¡ person å‘é€ä¸€ä¸ª play çš„æ¶ˆæ¯. </p>
<p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯, å‘ä¸€ä¸ªç©ºå¯¹è±¡(nil) å‘é€æ¶ˆæ¯ä¸ä¼š crash, å¦‚æœåœ¨ Java ä¸­è¿™ä¸ªæ˜¯ä¸è¡Œçš„.ä¾‹å¦‚:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">person = <span class="literal">nil</span>;</div><div class="line">[person play];</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ, åªæ˜¯è°ƒç”¨ <code>play</code> å‡½æ•°æ²¡æœ‰ä»»ä½•ååº”ç½¢äº†!</p>
<p><strong>3.self</strong><br>åœ¨ C++/Java è¯­è¨€ä¸­, æœ‰ this æŒ‡é’ˆçš„æ¦‚å¿µ, åœ¨ Objective-C ä¸­, ä¹Ÿæœ‰ç±»ä¼¼çš„ this æŒ‡é’ˆå³ self. self æ—¢å¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯ç±»å¯¹è±¡.</p>
<p>è¿™é‡Œä¸¾ä¸ªä¾‹å­, ä¸‹é¢ä¸¤ä¸ªåŒåå‡½æ•°, ä¸€ä¸ªæ˜¯ç±»æ–¹æ³•(+)ä¸€ä¸ªæ˜¯å®ä¾‹æ–¹æ³•(-).<br>è·Ÿ Java ä¸­çš„ç±»ä¼¼, å®ä¾‹æ–¹æ³•å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»æ–¹æ³•, ä½†æ˜¯ç±»æ–¹æ³•ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨å®ä¾‹æ–¹æ³•.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)testClassMethod</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span> sendMsg];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)testInstanceMethod</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span> sendMsg];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç±»æ–¹æ³•</span></div><div class="line">+ (<span class="keyword">void</span>)sendMsg</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"+ sendMsg. self: %@"</span>, <span class="keyword">self</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å®ä¾‹æ–¹æ³•</span></div><div class="line">- (<span class="keyword">void</span>)sendMsg</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"- sendMsg. self: %@"</span>, <span class="keyword">self</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ ViewController ä¸­åˆ†åˆ«è°ƒç”¨ä¸¤ä¸ª test æ–¹æ³•, è¾“å‡ºå†…å®¹, å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">+ sendMsg. <span class="keyword">self</span>: ViewController</div><div class="line"></div><div class="line">- sendMsg. <span class="keyword">self</span>: &lt;ViewController: <span class="number">0x7fc64740a5e0</span>&gt;</div></pre></td></tr></table></figure>
<p>ä»ç»“æœå¯ä»¥çœ‹å‡ºç±»æ–¹æ³•ä¸­çš„ <code>self</code> ä»£è¡¨çš„æ˜¯è¯¥ç±», å®ä¾‹æ–¹æ³•ä¸­çš„ <code>self</code> æŒ‡çš„æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹å³å¯¹è±¡.</p>
<p>æ›´å¤š <code>self</code> çš„çŸ¥è¯†ç‚¹ï¼Œå¯ä»¥å‚è€ƒ <a href="http://www.veryitman.com/2018/12/23/OC-self/" target="_blank" rel="noopener">OC: self</a> è¿™ç¯‡æ–‡ç« ã€‚</p>
<h2 id="å…³äº-Message-Forwarding"><a href="#å…³äº-Message-Forwarding" class="headerlink" title="å…³äº Message Forwarding"></a>å…³äº Message Forwarding</h2><p>Message Forwarding å³æ¶ˆæ¯è½¬å‘. </p>
<p>å…³äºæ¶ˆæ¯è½¬å‘, å®˜æ–¹æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html#//apple_ref/doc/uid/TP40008048-CH105-SW1" target="_blank" rel="noopener">Message Forwarding</a> æ˜¯è¿™ä¹ˆè§£é‡Šçš„:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Sending a message to an object that does not handle that message is an error. However, </div><div class="line">before announcing the error, </div><div class="line">the runtime system gives the receiving object a second chance to handle the message.</div></pre></td></tr></table></figure>
<p>å¤§æ¦‚æ„æ€æ˜¯è¿™æ ·çš„:</p>
<blockquote>
<p>å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯, è¯¥å¯¹è±¡å¦‚æœæ— æ³•å¤„ç†è¯¥æ¶ˆæ¯, ç³»ç»Ÿå°±ä¼šæŠ¥é”™, ä½†æ˜¯åœ¨æŠ¥é”™ä¹‹å‰, åˆ©ç”¨ Objective-C æä¾›çš„è¿è¡Œæ—¶æœºåˆ¶å¯ä»¥é˜²æ­¢æŠ¥é”™çš„å‘ç”Ÿ. åœ¨ iOS ä¸­ç±»ä¼¼è¿™æ ·çš„æŠ¥é”™ä¼šå¯¼è‡´ç¨‹åºç›´æ¥ crash.<br>è¿™é‡Œçš„å¯¹è±¡, å¯ä»¥æ˜¯å®ä¾‹å¯¹è±¡åˆå¯ä»¥æ˜¯ç±»å¯¹è±¡.</p>
</blockquote>
<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­, å¤§å®¶ä¸€èˆ¬éƒ½ä¼šé‡åˆ°ç±»ä¼¼çš„ crash:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> *** Terminating app due to uncaught exception  </div><div class="line">'NSInvalidArgumentException', </div><div class="line">reason: '-[Controller play]: unrecognized selector sent to instance 0x7ff779f322a0'</div><div class="line">*** First throw call stack:</div><div class="line">(</div><div class="line">CoreFoundation  <span class="number">0x000000010d89712b</span> __exceptionPreprocess + <span class="number">171</span></div><div class="line">libobjc.A.dylib <span class="number">0x000000010cf2bf41</span> objc_exception_throw + <span class="number">48</span></div><div class="line">CoreFoundation  <span class="number">0x000000010d918024</span> -[<span class="built_in">NSObject</span>(<span class="built_in">NSObject</span>) doesNotRecognizeSelector:] + <span class="number">132</span></div><div class="line"><span class="built_in">UIKit</span> 			<span class="number">0x000000010df48f51</span> -[<span class="built_in">UIResponder</span> doesNotRecognizeSelector:] + <span class="number">295</span></div><div class="line">CoreFoundation  <span class="number">0x000000010d819f78</span> ___forwarding___ + <span class="number">1432</span></div><div class="line">CoreFoundation  <span class="number">0x000000010d819958</span> _CF_forwarding_prep_0 + <span class="number">120</span></div><div class="line">)</div></pre></td></tr></table></figure>
<p>è¿™ä¸ª crash å¾ˆæ˜æ˜¾, <code>Controller</code> ä¸­è°ƒç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•° <code>play</code>.</p>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¢«è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•° <code>doesNotRecognizeSelector</code>, ä»Šå¤©æˆ‘ä»¬å‰–æä¸€ä¸‹æ¶ˆæ¯è½¬å‘çš„æµç¨‹.</p>
<h2 id="å®ä¾‹æ–¹æ³•-æ¶ˆæ¯-è½¬å‘çš„æµç¨‹"><a href="#å®ä¾‹æ–¹æ³•-æ¶ˆæ¯-è½¬å‘çš„æµç¨‹" class="headerlink" title="å®ä¾‹æ–¹æ³•(æ¶ˆæ¯)è½¬å‘çš„æµç¨‹"></a>å®ä¾‹æ–¹æ³•(æ¶ˆæ¯)è½¬å‘çš„æµç¨‹</h2><p>åœ¨ä¸Šé¢å·²ç»è¯´è¿‡, OC å¯ä»¥é€šè¿‡è¿è¡Œæ—¶æ¥é¿å…å› ä¸ºæ‰¾ä¸åˆ°æ–¹æ³•è€Œå¯¼è‡´é”™è¯¯.</p>
<p>å…¶å®, å«ä¹‰å°±æ˜¯ OC ç»™äº†æˆ‘ä»¬ç¬¬äºŒæ¬¡æœºä¼šæ¥é¿å…ç±»ä¼¼çš„é”™è¯¯.</p>
<p>æˆ‘ä»¬é‡å†™ NSObject ä¸­çš„ 5 ä¸ªæ–¹æ³•, åˆ†åˆ«æ˜¯:</p>
<blockquote>
<ol>
<li>+resolveInstanceMethod</li>
<li>-forwardingTargetForSelector</li>
<li>-methodSignatureForSelector</li>
<li>-forwardInvocation</li>
<li>-doesNotRecognizeSelector:</li>
</ol>
</blockquote>
<p>å½“æ— æ³•æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•æ—¶, è°ƒç”¨çš„æ–¹æ³•å’Œé¡ºåºå¤§è‡´å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">+resolveInstanceMethod</div><div class="line">-forwardingTargetForSelector</div><div class="line">-methodSignatureForSelector</div><div class="line">-doesNotRecognizeSelector:</div></pre></td></tr></table></figure>
<p>å½“æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•æ—¶, è°ƒç”¨æ–¹æ³•å’Œé¡ºåºå¤§è‡´å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">+resolveInstanceMethod</div><div class="line">-forwardingTargetForSelector</div><div class="line">-methodSignatureForSelector</div><div class="line">-forwardInvocation</div></pre></td></tr></table></figure>
<p>æ ¹æ®å®è·µç»“æœ, ç”»æµç¨‹å›¾å¦‚ä¸‹:<br><img src="/upload/images/2018/03/31/1.jpg" alt="1"></p>
<p>ä¸‹é¢åˆ†åˆ«è§£é‡Šä¸€ä¸‹è¿™å‡ ä¸ªæ–¹æ³•çš„ä½œç”¨å’Œæ„ä¹‰.</p>
<p><strong>+ (BOOL)resolveInstanceMethod:(SEL)sel</strong></p>
<p>è§£æå¯¹åº”çš„å®ä¾‹æ–¹æ³•. åœ¨è¯¥æ–¹æ³•ä¸­å…è®¸å¢åŠ ä¸€ä¸ªæ–¹æ³•çš„å®ç°, ä»è€Œå®ç°åŠ¨æ€æ·»åŠ æ–¹æ³•.</p>
<p>é»˜è®¤è¿”å› NO.</p>
<p>åœ¨ <code>NSObject.mm</code> ä¸­å¯ä»¥çœ‹åˆ°æ–¹æ³•çš„å®ç°:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">+ (<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>- (id)forwardingTargetForSelector:(SEL)aSelector</strong></p>
<p>å°†å¯¹åº”çš„ selector è½¬å‘ç»™æŒ‡å®šçš„å¯¹è±¡. æ¢å¥è¯è¯´å°±æ˜¯å°†ä¹‹å‰æ²¡æœ‰å®ç°çš„ selector è½¬äº¤ç»™å¦å¤–ä¸€ä¸ªå¯èƒ½å®ç°äº†è¯¥ selector çš„å¯¹è±¡å»å¤„ç†.</p>
<p>é»˜è®¤è¿”å› nil.</p>
<p><strong>- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector</strong></p>
<p>è¯¥æ–¹æ³•è¿”å›å¯¹ selector å®ç°çš„æ–¹æ³•ç­¾å.</p>
<p>é»˜è®¤å®ç°å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSMethodSignature</span> *)methodSignatureForSelector:(SEL)sel &#123;</div><div class="line">    _objc_fatal(<span class="string">"-[NSObject methodSignatureForSelector:] "</span></div><div class="line">                <span class="string">"not available without CoreFoundation"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>- (void)forwardInvocation:(NSInvocation *)anInvocation</strong></p>
<p>è¯¥æ–¹æ³•æ˜¯ä¾èµ–ç¬¬3ä¸ªæ–¹æ³•çš„, å¦‚æœç¬¬ä¸‰ä¸ªæ–¹æ³•æ‰¾åˆ°äº†å¯¹åº”çš„æ–¹æ³•ç­¾å, è¯¥æ–¹æ³•å°±å¯ä»¥å®ç°è½¬å‘è°ƒç”¨äº†.</p>
<p><strong>- (void)doesNotRecognizeSelector:(SEL)sel</strong></p>
<p>å¦‚æœå‰é¢å‡ ä¸ªæ–¹æ³•éƒ½æ²¡æœ‰å¤„ç†å¥½, ç³»ç»Ÿä¼šè°ƒç”¨è¯¥æ–¹æ³•, ç›´æ¥å¯¼è‡´ç¨‹åº crash, ä¹Ÿç§°ä¹‹ä¸ºç»ˆææ­»äº¡æ–¹æ³•.</p>
<p>æºç å®ç°å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)doesNotRecognizeSelector:(SEL)sel &#123;</div><div class="line">    _objc_fatal(<span class="string">"-[%s %s]: unrecognized selector sent to instance %p"</span>, </div><div class="line">                object_getClassName(<span class="keyword">self</span>), sel_getName(sel), <span class="keyword">self</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ€»ç»“, Objective-C ä¸­ç»™ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯ä¼šç»è¿‡å¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<p><strong>æ­¥éª¤1.</strong> åœ¨ç±»çš„è°ƒåº¦è¡¨(dispatch table) ä¸­æ‰¾è¦æ‰§è¡Œçš„å‡½æ•°(æ¶ˆæ¯), å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ°ç›¸åº”çš„å‡½æ•° IMP å»æ‰§è¡Œ.</p>
<blockquote>
<p>æ¯ä¸ªç±»çš„ç»“æ„ä½“åŒ…å«ç€ä¸¤ä¸ªå¿…å¤‡çš„å…ƒç´ :<br>[1]. æŒ‡å‘çˆ¶ç±»çš„æŒ‡é’ˆ<br>[2]. class dispatch table(è°ƒåº¦è¡¨). è°ƒåº¦è¡¨ä¸­åŒ…å«äº† method selectors å’Œç‰¹å®š class ç›¸åº”æ–¹æ³•å®ç°çš„åœ°å€.</p>
</blockquote>
<p><strong>æ­¥éª¤2.</strong> å¦‚æœæ²¡æ‰¾åˆ°ï¼Œè¿è¡Œæ—¶ä¼šè°ƒç”¨ +resolveInstanceMethod: æˆ–è€… +resolveClassMethod: å°è¯•è§£æè¿™ä¸ªæ¶ˆæ¯. åœ¨è¯¥æ–¹æ³•ä¸­, å…è®¸åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ–¹æ³•çš„å®ç°.</p>
<blockquote>
<p>å…³äº <code>resolveClassMethod</code> è¿™ä¸ªæ”¾åœ¨å¦ä¸€ç¯‡åšå®¢ä¸­è®²è§£.</p>
</blockquote>
<p><strong>æ­¥éª¤3.</strong> å¦‚æœ resolveXX è¿”å› YES, ç›´æ¥ç»“æŸåé¢çš„æµç¨‹, æ‰§è¡Œè§£æå¾—åˆ°çš„æ–¹æ³•. å¦‚æœ resolveXX è¿”å› NOï¼Œè¿è¡Œæ—¶å°±å‘é€ forwardingTargetForSelector æ¶ˆæ¯, å…è®¸è¿™ä¸ªæ¶ˆæ¯è½¬å‘ç»™å¦ä¸€ä¸ªå¯èƒ½å®ç°äº†å¯¹åº” selector çš„å¯¹è±¡.</p>
<p><strong>æ­¥éª¤4.</strong> å¦‚æœæ²¡æœ‰æ–°çš„ç›®æ ‡å¯¹è±¡è¿”å›, è¿è¡Œæ—¶å°±ä¼šå‘é€methodSignatureForSelector æ¶ˆæ¯, æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ç­¾å.<br>å¦‚æœæ‰¾åˆ°äº†, ä¼šæ¥ç€è°ƒç”¨ forwardInvocation, å¦‚æœæ²¡æœ‰æ‰¾åˆ°å³è¿”å› nil, é‚£ä¹ˆç›´æ¥è°ƒç”¨ doesNotRecognizeSelector.</p>
<p>ä¸‹ä¸€ç¯‡ç»“åˆå®é™…ä¾‹å­åˆ†æä¸€ä¸‹æ•´ä¸ªå®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹.</p>
<h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p>1.Apple å¼€å‘è€…æ–‡æ¡£ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html#//apple_ref/doc/uid/TP40008048-CH105-SW1" target="_blank" rel="noopener">Message Forwarding</a></p>
<p>2.Apple RunTime æºç  <a href="https://opensource.apple.com/tarballs/objc4/" target="_blank" rel="noopener">objc4-723.tar.gz</a></p>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="http://www.veryitman.com/2018/04/01/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B-%E5%AE%9E%E4%BE%8B%E8%AE%B2%E8%A7%A3/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹å®ä¾‹æ–¹æ³•çš„è½¬å‘æµç¨‹å®ä¾‹è®²è§£</a></p>
<p><a href="http://www.veryitman.com/2018/04/03/OC-RunTime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B9%8B%E7%B1%BB%E6%96%B9%E6%B3%95%E7%9A%84%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">OC-RunTime: æ¶ˆæ¯è½¬å‘ä¹‹ç±»æ–¹æ³•çš„è½¬å‘æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2018/04/05/OC-RunTime-%E6%80%BB%E7%BB%93%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/" target="_blank" rel="noopener">OC-RunTime: æ€»ç»“æ¶ˆæ¯è½¬å‘ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹</a></p>
<p>ç‚¹å‡»ä¸‹è½½æ–‡ä¸­å®Œæ•´çš„ <a href="https://github.com/veryitman/iOSDemo/tree/master/MZRuntimeMsgForward" target="_blank" rel="noopener">Demo</a>.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS RunTime MessageForward </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MacOS æ–‡ä»¶å¤§å°çš„å•ä½]]></title>
      <url>/2018/03/24/MacOS-%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E7%9A%84%E5%8D%95%E4%BD%8D/</url>
      <content type="html"><![CDATA[<h2 id="ç¼˜ç”±"><a href="#ç¼˜ç”±" class="headerlink" title="ç¼˜ç”±"></a>ç¼˜ç”±</h2><p>æˆ‘ä¸€ç›´ä»¥ä¸ºæ–‡ä»¶å¤§å°éƒ½æ˜¯æŒ‰ç…§ <code>1024</code> ä¸ºå•ä½æ¥è®¡ç®—çš„, ä½†æ˜¯åœ¨ MacOS ä¸Šé¢æ˜¯æŒ‰ç…§ <code>1000</code> ä¸ºå•ä½è®¡ç®—çš„, windows ä¸Šé¢æ˜¯æŒ‰ç…§ <code>1024</code> ä¸ºå•ä½æ¥è®¡ç®—çš„.</p>
<h2 id="å¶ç„¶çš„å‘ç°"><a href="#å¶ç„¶çš„å‘ç°" class="headerlink" title="å¶ç„¶çš„å‘ç°"></a>å¶ç„¶çš„å‘ç°</h2><p>ä¹‹å‰å†™ä»£ç , éœ€è¦ç”¨åˆ°è·å–æ–‡ä»¶å¤§å°çš„åŠŸèƒ½, ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">// è¯»å–æ–‡ä»¶å¤§å°</div><div class="line">long getFileSize(char *filename) &#123;</div><div class="line">    </div><div class="line">    FILE *fp = fopen(filename, &quot;r&quot;);</div><div class="line">    if (!fp) &#123;</div><div class="line">        return -1;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    fseek(fp, 0, SEEK_END);</div><div class="line">    </div><div class="line">    long size = ftell(fp);</div><div class="line">    fclose(fp);</div><div class="line">    </div><div class="line">    return size;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ–‡ä»¶åæ˜¯ <code>mm.aac</code>, ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶, è·å–åˆ°çš„æ–‡ä»¶å¤§å°æ˜¯ <code>76395</code> å­—èŠ‚.</p>
<p>æˆ‘æ— èŠè‡³æ, ä½¿ç”¨ <code>du</code> å‘½ä»¤æ¥è·å–è¯¥æ–‡ä»¶çš„å¤§å°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">du -sh mm.aac</div></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºæ–‡ä»¶å¤§å°æ˜¯ <code>76KB</code>.</p>
<p>MacOS ä¸Šé¢æŸ¥çœ‹æ–‡ä»¶å±æ€§, è·å–åˆ°çš„å¤§å°ä¹Ÿæ˜¯ <code>76KB</code></p>
<p><img src="/upload/images/2018/03/24/1.jpg" alt="1"></p>
<p>äºŒè€…è·å–çš„æ–‡ä»¶å¤§å°ä¸€è‡´, å¯ä»¥çœ‹å‡ºæ–‡ä»¶çš„å¤§å°æ˜¯æ­£ç¡®çš„.</p>
<p>äºæ˜¯æˆ‘æŸ¥äº†ä¸€ä¸‹åœ¨ windows ä¸Šé¢çš„è¯¥æ–‡ä»¶çš„å¤§å°, å¦‚ä¸‹æˆªå›¾:</p>
<p><img src="/upload/images/2018/03/24/2.png" alt="1"></p>
<p>å¯ä»¥çœ‹å‡º, MacOS ä¸Šé¢æ–‡ä»¶å¤§å°æ˜¯æŒ‰ç…§ 1000 å•ä½æ¥è®¡ç®—çš„, è€Œ windows ä¸Šé¢æ˜¯æŒ‰ç…§ 1024 å•ä½æ¥è®¡ç®—çš„.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">76395 / 1000 = 76.395</div><div class="line">76395 / 1024 = 74.604</div></pre></td></tr></table></figure>
<blockquote>
<p>æŒ‰ç…§ GNU çš„ä¹ æƒ¯ï¼Œå•çº¯çš„ <code>K</code> <code>M</code> <code>G</code> <code>T</code> åˆ†åˆ«æŒ‡ä»£ <code>KiB</code> <code>MiB</code> <code>GiB</code> <code>TiB</code> ä»¥ 1024 è¿›åˆ¶æ•°æ®é‡å•ä½ï¼Œç”¨ <code>KB</code> <code>MB</code> <code>GB</code> <code>TB</code> ä»¥ 1000 è¿›åˆ¶æ•°æ®é‡å•ä½. </p>
</blockquote>
<p>æ‰€ä»¥, åœ¨ windows ä¸Šé¢å‡†ç¡®è¡¨ç¤º <code>76395bytes</code> åº”è¯¥æ˜¯ <code>74.6KiB</code>.</p>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p>åœ¨çº¿è®¡ç®— <a href="http://www.justintools.com/unit-conversion/data-storage.php?" target="_blank" rel="noopener">å•ä½æ¢ç®—</a>.</p>
]]></content>
      
        <categories>
            
            <category> MacOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> MacOS C æ–‡ä»¶å¤§å°å•ä½ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GO: å†™ç¬¬ä¸€ä¸ª GOLang ç¨‹åº]]></title>
      <url>/2018/03/11/GO-%E5%86%99%E7%AC%AC%E4%B8%80%E4%B8%AA-GOLang-%E7%A8%8B%E5%BA%8F/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡åˆ†äº«åœ¨ MacOS ä¸Šé¢é€šè¿‡ pkg çš„æ–¹å¼å®‰è£… GO ç¼–ç¨‹ç¯å¢ƒ, ä»¥åŠç¼–è¯‘è¿è¡Œç¬¬ä¸€ä¸ªä½¿ç”¨ GOLang ç¼–å†™çš„ç¨‹åº.</p>
<p>å…¶ä»–å…³äº GO çš„å®‰è£…æ–¹å¼, å¦‚ä½¿ç”¨ Homebrew å®‰è£…æˆ–è€…ä½¿ç”¨æºç å®‰è£…çš„æ–¹å¼, è¯·è‡ªè¡Œå°è¯•.</p>
<h2 id="ä¸‹è½½å®‰è£…"><a href="#ä¸‹è½½å®‰è£…" class="headerlink" title="ä¸‹è½½å®‰è£…"></a>ä¸‹è½½å®‰è£…</h2><p>åœ¨ <a href="https://golang.org/doc/install" target="_blank" rel="noopener">è¿™é‡Œ</a> ä¸‹è½½ GO çš„ pkg å®‰è£…åŒ….</p>
<p>ä½†æ˜¯ä½ éœ€è¦ç§‘(fan)å­¦(qiang)æ‰èƒ½ä¸‹è½½.</p>
<p><img src="/upload/images/2018/03/11/1.jpg" alt="1"></p>
<p>ä½ ä¹Ÿå¯ä»¥ä¸‹è½½ Stable versions.</p>
<p>ä¸‹è½½å®Œæˆå, ç›´æ¥åŒå‡»å®‰è£…å³å¯.</p>
<h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p>å®‰è£…å®Œæˆå, GO å®‰è£…ç›®å½•åœ¨ <code>/usr/local</code> ä¸‹é¢.</p>
<p>å®‰è£…ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2018/03/11/2.jpg" alt="1"></p>
<p>éœ€è¦å°†å…¶è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­, æ‰èƒ½åœ¨ç»ˆç«¯ä½¿ç”¨å…¶ç›¸å…³çš„å‘½ä»¤.</p>
<p>ç¼–è¾‘ <code>~/.bash_profile</code>, å¢åŠ ä¸‹é¢å‡ è¡Œå³å¯.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># Golang</div><div class="line"></div><div class="line">export GOROOT=/usr/local/go</div><div class="line">export GOPATH=~/gowork</div><div class="line">export PATH=$GOROOT/bin:$GOPATH:$PATH</div></pre></td></tr></table></figure>
<blockquote>
<p>è®°ä½, GOROOT å’Œ GOPATH å¿…é¡»è®¾ç½®.<br><code>gowork</code> æ˜¯æˆ‘è‡ªå·±æ–°å»ºçš„ç›®å½•. GOPATH å¯ä»¥ç†è§£ä¸ºå·¥ä½œç›®å½•.</p>
</blockquote>
<p>å…³äº GOPATH å¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡æ¡£ <a href="https://github.com/golang/go/wiki/SettingGOPATH" target="_blank" rel="noopener">SettingGOPATH</a>.</p>
<p>æˆ‘åˆšå¼€å§‹æ²¡æœ‰é…ç½® GOROOT å˜é‡, æ‰§è¡Œ go å‘½ä»¤ä¼šæç¤ºè­¦å‘Š, è­¦å‘Šå†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">warning: GOPATH set to GOROOT (/usr/local/go) has no effect</div></pre></td></tr></table></figure>
<p>ç¼–è¾‘ä¿å­˜, ç„¶åä½¿å…¶ç«‹å³ç”Ÿæ•ˆ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source ~/.bash_profile</div></pre></td></tr></table></figure>
<p>æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">go version</div></pre></td></tr></table></figure>
<p>å¯¹åº”è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">go version go1.9.4 darwin/amd64</div></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>go env</code> æ¥æŸ¥çœ‹æ›´åŠ è¯¦ç»†çš„å†…å®¹.</p>
<h2 id="ç¼–è¯‘è¿è¡Œ-GOLang-ç¨‹åº"><a href="#ç¼–è¯‘è¿è¡Œ-GOLang-ç¨‹åº" class="headerlink" title="ç¼–è¯‘è¿è¡Œ GOLang ç¨‹åº"></a>ç¼–è¯‘è¿è¡Œ GOLang ç¨‹åº</h2><p><strong>1.ç¼–å†™ä»£ç </strong></p>
<p>ç¼–è¾‘ä¸€ä¸ª <code>Hello GOLang</code> çš„ç¨‹åº.</p>
<p>åœ¨ä»»æ„ä¸€ä¸ªæ–‡ä»¶å¤¹ä½ç½®, æ–°å»ºä¸€ä¸ª <code>go_hello.go</code> çš„æ–‡ä»¶.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">touch go_hello.go</div></pre></td></tr></table></figure>
<p>å†™å…¥å¦‚ä¸‹ç¨‹åº:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">package main</div><div class="line"></div><div class="line">import &quot;fmt&quot;</div><div class="line"></div><div class="line">func main() &#123;</div><div class="line">   fmt.Println(&quot;Hello, GOLang!&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>2.ç¼–è¯‘è¿è¡Œ</strong></p>
<p>ä½¿ç”¨ <code>go build</code> å‘½ä»¤ç¼–è¯‘.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">go build go_hello.go</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘æˆåŠŸå, ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ <code>go_hello</code>. æ‰§è¡Œå³å¯.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./go_hello</div></pre></td></tr></table></figure>
<p>æˆ–è€…ç›´æ¥è¿è¡Œ, æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">go run go_hello.go</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¸ä¼šç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶.</p>
<p>è‡³æ­¤, GO çš„ç¼–ç¨‹ç¯å¢ƒå·²ç»æ­å»ºå®Œæˆ, æ¯”è¾ƒç®€å•.</p>
<h2 id="å¸è½½-GO"><a href="#å¸è½½-GO" class="headerlink" title="å¸è½½ GO"></a>å¸è½½ GO</h2><p>å¦‚æœä½ æƒ³å¸è½½ GO ç¯å¢ƒ, åªéœ€è¦ä¸‰ä¸ªæ­¥éª¤.</p>
<p><strong>1.åˆ é™¤å®‰è£…ç›®å½•</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo rm -fr /usr/local/go</div></pre></td></tr></table></figure>
<p><strong>2.åˆ é™¤ go æ–‡ä»¶</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo rm -f /etc/paths.d/go</div></pre></td></tr></table></figure>
<p><strong>3.åˆ é™¤ç¯å¢ƒå˜é‡</strong></p>
<p>ç¼–è¾‘ etc, åˆ é™¤å¯¹åº”æ·»åŠ çš„ go ç¯å¢ƒå˜é‡å³å¯.</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://golang.org/doc/install" target="_blank" rel="noopener">GO: Getting Started</a></p>
<p><a href="https://golang.org/doc/" target="_blank" rel="noopener">GO: DOC</a></p>
<p><a href="https://github.com/golang/go/wiki/SettingGOPATH" target="_blank" rel="noopener">SettingGOPATH</a></p>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GOLanguage Google </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[C æŒ‡é’ˆä¸ OC å¯¹è±¡ä¹‹é—´çš„è½¬æ¢]]></title>
      <url>/2018/03/07/C-%E6%8C%87%E9%92%88%E4%B8%8E-OC-%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2/</url>
      <content type="html"><![CDATA[<h2 id="Core-Foundation-æ¡†æ¶"><a href="#Core-Foundation-æ¡†æ¶" class="headerlink" title="Core Foundation æ¡†æ¶"></a>Core Foundation æ¡†æ¶</h2><p>Core Foundation æ¡†æ¶ (CoreFoundation.framework) æ˜¯ä¸€ç»„ C è¯­è¨€æ¥å£ï¼Œ ç®€ç§° CF. </p>
<p>å®ƒä»¬ä¸º iOS åº”ç”¨ç¨‹åºæä¾›åŸºæœ¬æ•°æ®ç®¡ç†å’ŒæœåŠ¡åŠŸèƒ½.</p>
<p>å¦‚ Core Graphicsã€Core Textï¼Œå¹¶ä¸”æˆ‘ä»¬å¯èƒ½éœ€è¦å°† CF å¯¹è±¡å’ŒOC å¯¹è±¡è¿›è¡Œç›¸äº’è½¬åŒ–ï¼ŒARC ä¸‹ï¼Œç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨ç®¡ç† CF å¯¹è±¡çš„å†…å­˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç®¡ç†. </p>
<p>åˆ›å»ºä¸€ä¸ª CF å¯¹è±¡ä½¿ç”¨å, éœ€è¦ä½¿ç”¨ CFRelease å°†å…¶æ‰‹åŠ¨é‡Šæ”¾, æ¢å¥è¯è¯´, Core Foundation å¯¹è±¡ç±»å‹ä¸åœ¨ ARC ç®¡ç†èŒƒç•´å†….</p>
<p>å¦‚ä½•å°† CF å’Œ OC å¯¹è±¡æœ‰æ•ˆçš„ç»“åˆèµ·æ¥, åœ¨ ARC ç¯å¢ƒä¸‹, æä¾›äº† <code>æ¡¥æ¥</code> çš„æŠ€æœ¯, å³ ARC ä¸‹ OC å¯¹è±¡å’Œ Core Foundation å¯¹è±¡ä¹‹é—´çš„æ¡¥æ¢.</p>
<h2 id="ARC-æ¡¥æ¥"><a href="#ARC-æ¡¥æ¥" class="headerlink" title="ARC æ¡¥æ¥"></a>ARC æ¡¥æ¥</h2><p>ARC ä¸‹ C æŒ‡é’ˆä¸ OC æŒ‡é’ˆ(å¯¹è±¡)ä¹‹é—´è½¬æ¢, ä¸€èˆ¬ä¼šç”¨åˆ°ä¸‹é¢çš„æ–¹æ³•.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">__bridge_retained &lt;<span class="meta">#CF type#&gt;)<span class="meta-string">&lt;#expression#&gt;</span></span></div><div class="line"></div><div class="line">__bridge_transfer &lt;<span class="meta">#Objective-C type#&gt;)<span class="meta-string">&lt;#expression#&gt;</span></span></div><div class="line"></div><div class="line">__bridge &lt;<span class="meta">#type#&gt;)<span class="meta-string">&lt;#expression#&gt;</span></span></div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯æ‰€è°“çš„ <code>æ¡¥æ¥</code>, å®ƒæ˜¯ Object-C åœ¨ ARC ç¯å¢ƒä¸‹å¼€å‘å‡ºæ¥çš„ä¸€ç§ç”¨ä½œè½¬æ¢ C æŒ‡é’ˆè·Ÿ OC (ç±»)æŒ‡é’ˆçš„ä¸€ç§è½¬æ¢æŠ€æœ¯, æ‰€ä»¥æ˜¯ ARC ä¸‹çš„ç§°è°“, åœ¨ MRC ä¸‹æ²¡æœ‰ <code>æ¡¥æ¥</code>.</p>
<p>é’ˆå¯¹å†…å­˜ç®¡ç†é—®é¢˜ï¼ŒARC å¯ä»¥ç®¡ç† Objective-C å¯¹è±¡, ä½†ä¸æ”¯æŒ Core Foundation å¯¹è±¡çš„ç®¡ç†ï¼Œæ‰€ä»¥è½¬æ¢åè¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼šè°æ¥é‡Šæ”¾ä½¿ç”¨åçš„å¯¹è±¡.</p>
<p>ç»“åˆ ARC å’Œ å†…å­˜ç®¡ç†, ä¸‹é¢åˆ†åˆ«ä»‹ç»ä¸€ä¸‹.</p>
<p>Core Foundation å¯¹è±¡å¿…é¡»ä½¿ç”¨ CFRetain å’Œ CFRelease æ¥è¿›è¡Œå†…å­˜ç®¡ç†.<br>å½“ä½¿ç”¨ Objective-C å’Œ Core Foundation å¯¹è±¡ç›¸äº’è½¬æ¢çš„æ—¶å€™ï¼Œå¿…é¡»è®©ç¼–è¯‘å™¨çŸ¥é“ï¼Œåˆ°åº•ç”±è°æ¥è´Ÿè´£é‡Šæ”¾å¯¹è±¡ï¼Œæ˜¯å¦äº¤ç»™ ARC å¤„ç†, åªæœ‰æ­£ç¡®çš„å¤„ç†ï¼Œæ‰èƒ½é¿å…å†…å­˜æ³„æ¼å’Œ double free å¯¼è‡´ç¨‹åºå´©æºƒ.</p>
<h2 id="bridge-retained-lt-CF-type-gt-lt-expression-gt"><a href="#bridge-retained-lt-CF-type-gt-lt-expression-gt" class="headerlink" title="__bridge_retained &lt;#CF type#&gt;)&lt;#expression#&gt;"></a>__bridge_retained &lt;#CF type#&gt;)&lt;#expression#&gt;</h2><p><code>__bridge_retained</code> ç­‰åŒäº <code>CFBridgingRetain()</code>.</p>
<p>å°† Objective-C å¯¹è±¡è½¬æ¢ä¸º Core Foundation å¯¹è±¡ï¼ŒæŠŠå¯¹è±¡æ‰€æœ‰æƒæ¡¥æ¥ç»™ Core Foundation å¯¹è±¡ï¼ŒåŒæ—¶å‰¥å¤º ARC çš„ç®¡ç†æƒï¼Œåç»­éœ€è¦å¼€å‘è€…ä½¿ç”¨ CFRelease æˆ–è€…ç›¸å…³æ–¹æ³•æ‰‹åŠ¨æ¥é‡Šæ”¾ CF å¯¹è±¡.</p>
<p>ç¤ºä¾‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> *cPointer;</div><div class="line"><span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line"></div><div class="line"><span class="comment">//å°† OC å¯¹è±¡è½¬æ¢ä¸º C æŒ‡é’ˆ</span></div><div class="line">cPointer = (__bridge_retained <span class="keyword">void</span>*)objc;</div><div class="line"></div><div class="line"><span class="comment">//use cPointer ...</span></div><div class="line"></div><div class="line"><span class="comment">//éœ€è¦é‡Šæ”¾èµ„æº</span></div><div class="line"><span class="built_in">CFRelease</span>(cPointer);</div></pre></td></tr></table></figure>
<p>åœ¨ ARC ä¸‹, CFBridgingRetain å®ç°å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NS_INLINE</span> <span class="built_in">CF_RETURNS_RETAINED</span> <span class="built_in">CFTypeRef</span> _Nullable <span class="built_in">CFBridgingRetain</span>(<span class="keyword">id</span> _Nullable X) &#123;</div><div class="line">    <span class="keyword">return</span> (__bridge_retained <span class="built_in">CFTypeRef</span>)X;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…³äº CFTypeRef, å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">const</span> <span class="built_in">CF_BRIDGED_TYPE</span>(<span class="keyword">id</span>) <span class="keyword">void</span> * <span class="built_in">CFTypeRef</span>;</div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ CFBridgingRetain è¿”å›å€¼æ˜¯ <code>const void *</code> ç±»å‹çš„.</p>
<p>ä¸Šé¢çš„ç¤ºä¾‹å¯ä»¥æ”¹å†™ä¸º:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">void</span> *cPointer;</div><div class="line"><span class="keyword">const</span> <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line">cPointer = <span class="built_in">CFBridgingRetain</span>(objc);</div><div class="line">    </div><div class="line"><span class="comment">//use cPointer ...</span></div><div class="line">    </div><div class="line"><span class="built_in">CFRelease</span>(cPointer);</div></pre></td></tr></table></figure>
<h2 id="bridge-transfer-lt-Objective-C-type-gt-lt-expression-gt"><a href="#bridge-transfer-lt-Objective-C-type-gt-lt-expression-gt" class="headerlink" title="__bridge_transfer &lt;#Objective-C type#&gt;)&lt;#expression#&gt;"></a>__bridge_transfer &lt;#Objective-C type#&gt;)&lt;#expression#&gt;</h2><p><code>__bridge_transfer</code> ç­‰åŒäº <code>CFBridgingRelease()</code>.</p>
<p>å°†é OC å¯¹è±¡è½¬æ¢ä¸º OC å¯¹è±¡ï¼ŒåŒæ—¶å°†å¯¹è±¡çš„ç®¡ç†æƒäº¤ç»™ ARCï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨ç®¡ç†å†…å­˜.</p>
<p>ç¤ºä¾‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CFUUIDRef</span> uuid = <span class="built_in">CFUUIDCreate</span>(kCFAllocatorDefault);</div><div class="line"><span class="built_in">CFStringRef</span> strUUID = <span class="built_in">CFUUIDCreateString</span>(kCFAllocatorDefault, uuid);</div><div class="line"><span class="built_in">NSString</span> *str = (__bridge_transfer <span class="built_in">NSString</span> *)strUUID;</div><div class="line"></div><div class="line"><span class="comment">//æ— éœ€é‡Šæ”¾ strUUID</span></div><div class="line"><span class="comment">//CFRelease(strUUID);</span></div><div class="line"></div><div class="line"><span class="built_in">CFRelease</span>(uuid);</div></pre></td></tr></table></figure>
<p>CFBridgingRelease å®ç°å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NS_INLINE</span> <span class="keyword">id</span> _Nullable <span class="built_in">CFBridgingRelease</span>(<span class="built_in">CFTypeRef</span> <span class="built_in">CF_CONSUMED</span> _Nullable X) &#123;</div><div class="line">    <span class="keyword">return</span> (__bridge_transfer <span class="keyword">id</span>)X;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ç¤ºä¾‹å¯ä»¥æ”¹å†™ä¸º:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CFUUIDRef</span> uuid = <span class="built_in">CFUUIDCreate</span>(kCFAllocatorDefault);</div><div class="line"><span class="built_in">CFStringRef</span> strUUID = <span class="built_in">CFUUIDCreateString</span>(kCFAllocatorDefault, uuid);</div><div class="line"><span class="built_in">NSString</span> *str = <span class="built_in">CFBridgingRelease</span>(strUUID);</div><div class="line">    </div><div class="line"><span class="comment">//æ— éœ€é‡Šæ”¾ strUUID</span></div><div class="line"><span class="comment">//CFRelease(strUUID);</span></div><div class="line">    </div><div class="line"><span class="built_in">CFRelease</span>(uuid);</div></pre></td></tr></table></figure>
<h2 id="bridge"><a href="#bridge" class="headerlink" title="__bridge"></a>__bridge</h2><p><code>__bridge</code> ä¸æ”¹å˜å¯¹è±¡æ‰€æœ‰æƒ, éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ç®¡ç†å†…å­˜, å®ƒä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æ–¹æ³•, ä»æŸç§ç¨‹åº¦ä¸Šæ¥è¯´, å®ƒæ˜¯ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•çš„ç®€åŒ–ç‰ˆæœ¬.</p>
<p><code>__bridge</code> å¯ä»¥å°† OC å¯¹è±¡ ä¸ C æŒ‡é’ˆç›¸äº’è½¬æ¢, ç¤ºä¾‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//CFString -&gt; OC å¯¹è±¡</span></div><div class="line"><span class="built_in">CFStringRef</span> cfString = <span class="built_in">CFStringCreateWithCString</span>(kCFAllocatorDefault, <span class="string">"very"</span>, kCFStringEncodingUTF8);</div><div class="line"><span class="built_in">NSString</span> *nsString = (__bridge <span class="built_in">NSString</span> *)cfString;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"CFString -&gt; NSString: %@"</span>, nsString);</div><div class="line"><span class="built_in">CFRelease</span>(cfString);</div></pre></td></tr></table></figure>
<p>å¦‚æœå°† <code>CFRelease(cfString)</code> æ³¨é‡Šæ‰, Xcode çš„é™æ€æ£€æµ‹å™¨ä¼šå‘Šè¯‰ä½ æœ‰å†…å­˜æ³„éœ²çš„æƒ…å†µ, å¦‚å›¾:<br><img src="/upload/images/2018/03/07/2.png" alt="1"></p>
<p>å†æ¥å¦å¤–ä¸€ä¸ªä¾‹å­, å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//OC å¯¹è±¡ -&gt; CFString</span></div><div class="line"><span class="built_in">NSString</span> *nstr = <span class="string">@"itman"</span>;</div><div class="line"><span class="built_in">CFStringRef</span> cfStringRef = (__bridge <span class="built_in">CFStringRef</span>)nstr;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"NSString -&gt; CFString: %@"</span>, cfStringRef);</div><div class="line"><span class="built_in">CFRelease</span>(cfStringRef);</div></pre></td></tr></table></figure>
<p>æ— è®ºæ˜¯ä½¿ç”¨ <code>CFRelease(cfStringRef)</code>, è¿˜æ˜¯æ³¨é‡Šæ‰ <code>CFRelease(cfStringRef)</code>, é™æ€æ£€æµ‹å™¨éƒ½ä¸ä¼šæŠ¥é”™. è¯´æ˜è¿™ç§æƒ…å†µä¸‹, å½“å‰çš„å†…å­˜ç®¡ç†å·²ç»è¢« OC å¯¹è±¡ç®¡ç†.</p>
<h2 id="ç»å…¸ä¾‹å­"><a href="#ç»å…¸ä¾‹å­" class="headerlink" title="ç»å…¸ä¾‹å­"></a>ç»å…¸ä¾‹å­</h2><h3 id="NSString-ä¸-CFString-è½¬æ¢"><a href="#NSString-ä¸-CFString-è½¬æ¢" class="headerlink" title="NSString ä¸ CFString è½¬æ¢"></a>NSString ä¸ CFString è½¬æ¢</h3><p>1ã€NSString â†’ CFString</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="built_in">NSString</span> *string = <span class="string">@"veryitman.com"</span>;</div><div class="line">    <span class="comment">// æ–¹æ³•1: ä¸éœ€è¦é‡Šæ”¾</span></div><div class="line">    <span class="built_in">CFStringRef</span> cfStr = (__bridge <span class="built_in">CFStringRef</span>)string;</div><div class="line">    </div><div class="line">    <span class="comment">// æ–¹æ³•2: éœ€è¦é‡Šæ”¾, è¿™é‡Œ retain äº†</span></div><div class="line">    <span class="built_in">CFStringRef</span> cfStr2 = (__bridge_retained <span class="built_in">CFStringRef</span>)string;</div><div class="line">    <span class="built_in">CFRelease</span>(cfStr2);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2ã€CFString â†’ NSString</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CFStringRef</span> cfStr = <span class="built_in">CFStringCreateWithCString</span>(kCFAllocatorDefault, <span class="string">"veryitman"</span>, kCFStringEncodingUnicode);</div><div class="line">    </div><div class="line"><span class="comment">// æ–¹æ³•1: éœ€è¦é‡Šæ”¾</span></div><div class="line"><span class="built_in">NSString</span> *string = (__bridge <span class="built_in">NSString</span> *)cfStr;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"OC string: %@"</span>, string);</div><div class="line"><span class="built_in">CFRelease</span>(cfStr);</div><div class="line">    </div><div class="line"><span class="comment">// æ–¹æ³•2: ä¸éœ€è¦é‡Šæ”¾, __bridge_transfer è‡ªå¸¦ release</span></div><div class="line">string = (__bridge_transfer <span class="built_in">NSString</span> *)cfStr;</div></pre></td></tr></table></figure>
<h3 id="é‡æŒ‡é’ˆ"><a href="#é‡æŒ‡é’ˆ" class="headerlink" title="é‡æŒ‡é’ˆ"></a>é‡æŒ‡é’ˆ</h3><p>è¿è¡Œä¸‹é¢çš„ç¤ºä¾‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> *p;</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line">    p = (__bridge <span class="keyword">void</span>*)objc;</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"mark: %@"</span>, (__bridge <span class="built_in">NSObject</span>*)p);</div></pre></td></tr></table></figure>
<p>ä¼šç›´æ¥ crash, å¦‚å›¾:</p>
<p><img src="/upload/images/2018/03/07/1.jpg" alt="1"></p>
<p>å½“ <code>objc</code> è¿™ä¸ªå¯¹è±¡è¶…å‡ºä½œç”¨åŸŸèŒƒå›´ï¼Œå…¶å†…å­˜å°±ä¼šè¢«å›æ”¶ï¼Œæ¥ç€åœ¨ä½œç”¨åŸŸèŒƒå›´å¤–ç”¨ <code>void *p</code> å»è®¿é—® <code>objc</code> çš„å†…å­˜ï¼Œå°±é€ æˆäº†é‡æŒ‡é’ˆ.</p>
<p>ç»“åˆä¸Šé¢æ‰€è¯´çš„, æˆ‘ä»¬å¯ä»¥è®©æŒ‡é’ˆ p å¯¹ objc è¿›è¡Œå¼•ç”¨å³ retain æ“ä½œ, ä¿®æ”¹å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> *p;</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line">    <span class="comment">//p = (__bridge void*)objc;</span></div><div class="line">    p = (__bridge_retained <span class="keyword">void</span>*)objc;</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"mark: %@"</span>, (__bridge <span class="built_in">NSObject</span>*)p);</div><div class="line">    </div><div class="line"><span class="comment">// ä¸€å®šè¦é‡Šæ”¾</span></div><div class="line"><span class="built_in">CFRelease</span>(p);</div></pre></td></tr></table></figure>
<p>å¯ä»¥æ­£å¸¸çš„è¿è¡Œ. è¿˜å¯ä»¥ä¿®æ”¹ä¸ºå¦ä¸€ç§æ–¹å¼:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> *p;</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line">    <span class="comment">//p = (__bridge void*)objc;</span></div><div class="line">    <span class="comment">//p = (__bridge_retained void*)objc;</span></div><div class="line">    p = (<span class="keyword">void</span> *)<span class="built_in">CFBridgingRetain</span>(objc);</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"mark: %@"</span>, (__bridge <span class="built_in">NSObject</span>*)p);</div><div class="line">    </div><div class="line"><span class="comment">// ä¸€å®šè¦é‡Šæ”¾</span></div><div class="line"><span class="built_in">CFRelease</span>(p);</div></pre></td></tr></table></figure>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Objective-C ARC Foundation </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘ç¼–ç¨‹: iOS æ¨æµ]]></title>
      <url>/2018/02/26/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E6%8E%A8%E6%B5%81/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡åˆ†äº«æ˜¯åŸºäº <a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a> è¿™ç¯‡æ–‡ç« çš„, ä¹‹å‰æ˜¯ä½¿ç”¨ ffmpeg å‘½ä»¤è¿›è¡Œæ¨æµå¹¶ä¸”éƒ½æ˜¯åœ¨ macos ä¸Šé¢è¿›è¡Œçš„æ“ä½œ.</p>
<p>ç°åœ¨åœ¨ iOS å¹³å°ä¸Šä½¿ç”¨ <a href="https://github.com/LaiFengiOS/LFLiveKit" target="_blank" rel="noopener">LFLiveKit</a> è¿›è¡Œæ¨æµ, ç„¶åä½¿ç”¨ VLC æ’­æ”¾å™¨æ’­æ”¾æµè§†é¢‘.</p>
<p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p>
<ul>
<li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac/faad2</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/26/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E6%8E%A8%E6%B5%81/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS æ¨æµ</a> (æœ¬ç¯‡)</p>
</li>
</ul>
<h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>ä¸€èˆ¬ç›´æ’­è¿‡ç¨‹åŒ…æ‹¬å¯¹éŸ³è§†é¢‘çš„é‡‡é›†ã€å¤„ç†ã€ç¼–ç ã€å°åŒ…ã€æ¨æµã€ä¼ è¾“ã€è½¬ç ã€åˆ†å‘ã€è§£ç ã€æ’­æ”¾ç­‰. </p>
<p><strong>æ¨æµ</strong>, æŒ‡ä½¿ç”¨æ¨æµå·¥å…·æŠŠç›´æ’­å†…å®¹ä¼ è¾“åˆ°æœåŠ¡å™¨çš„è¿‡ç¨‹. æœ¬ç¯‡åˆ†äº«ä½¿ç”¨ LFLiveKit å·¥å…·å°† iPhone æ‘„åƒå¤´å’Œéº¦å…‹é£é‡‡é›†çš„æ•°æ®æ¨æµåˆ°æœ¬åœ°æµæœåŠ¡å™¨.</p>
<p><strong>æ‹‰æµ</strong>, æŒ‡å¯¹æœåŠ¡å™¨ç›´æ’­çš„å†…å®¹ï¼Œç”¨æŒ‡å®šåœ°å€è¿›è¡Œæ‹‰å–(æ’­æ”¾)çš„è¿‡ç¨‹, æœ¬ç¯‡åˆ†äº«ä½¿ç”¨ VLC å……å½“æ‹‰æµçš„è§’è‰².</p>
<h2 id="é›†æˆ-LFLiveKit"><a href="#é›†æˆ-LFLiveKit" class="headerlink" title="é›†æˆ LFLiveKit"></a>é›†æˆ LFLiveKit</h2><p>LFLiveKit æ˜¯ä¸€ä¸ªå¼€æºçš„æ¨æµ SDK, æ”¯æŒ H264 and AAC çš„ç¡¬ç¼–ç , æ”¯æŒç¾é¢œ(é›†æˆäº† GPUImage).</p>
<p>ä½¿ç”¨ LFLiveKit æ¯”è¾ƒç®€å•, æŒ‰ç…§å…¶ demo é›†æˆå³å¯.</p>
<p><strong>1.å·¥ç¨‹é…ç½®info.plist</strong></p>
<p>éœ€è¦è®¿é—®ç›¸æœºå’Œéº¦å…‹é£æƒé™.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Privacy - Camera Usage Description</div><div class="line"></div><div class="line">Privacy - Microphone Usage Description</div></pre></td></tr></table></figure>
<p><strong>2.è¯·æ±‚ç›¸æœºå’Œéº¦å…‹é£æƒé™.</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">- (void)requestAccessForVideo &#123;</div><div class="line">    </div><div class="line">    __weak typeof(self) _self = self;</div><div class="line">    AVAuthorizationStatus status = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeVideo];</div><div class="line">    </div><div class="line">    switch (status) &#123;</div><div class="line">            </div><div class="line">        case AVAuthorizationStatusNotDetermined: &#123;</div><div class="line">            </div><div class="line">            [AVCaptureDevice requestAccessForMediaType:AVMediaTypeVideo completionHandler:^(BOOL granted) &#123;</div><div class="line">                </div><div class="line">                if (granted) &#123;</div><div class="line">                    </div><div class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">                        [_self.session setRunning:YES];</div><div class="line">                    &#125;);</div><div class="line">                &#125;</div><div class="line">            &#125;];</div><div class="line">            </div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">            </div><div class="line">        case AVAuthorizationStatusAuthorized: &#123;</div><div class="line">            </div><div class="line">            dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">                [_self.session setRunning:YES];</div><div class="line">            &#125;);</div><div class="line">            </div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">            </div><div class="line">        case AVAuthorizationStatusDenied:</div><div class="line">        case AVAuthorizationStatusRestricted:</div><div class="line">            // ç”¨æˆ·æ˜ç¡®åœ°æ‹’ç»æˆæƒï¼Œæˆ–è€…ç›¸æœºè®¾å¤‡æ— æ³•è®¿é—®</div><div class="line">            break;</div><div class="line">            </div><div class="line">        default:</div><div class="line">            break;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)requestAccessForAudio &#123;</div><div class="line">    </div><div class="line">    AVAuthorizationStatus status = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeAudio];</div><div class="line">    </div><div class="line">    switch (status) &#123;</div><div class="line">            </div><div class="line">        case AVAuthorizationStatusNotDetermined: &#123;</div><div class="line">            [AVCaptureDevice requestAccessForMediaType:AVMediaTypeAudio completionHandler:^(BOOL granted) &#123;</div><div class="line">            &#125;];</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">            </div><div class="line">        case AVAuthorizationStatusAuthorized: &#123;</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">            </div><div class="line">        case AVAuthorizationStatusDenied:</div><div class="line">        case AVAuthorizationStatusRestricted:</div><div class="line">            break;</div><div class="line">        default:</div><div class="line">            break;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åŠ¡å¿…è¦è°ƒç”¨ LFLiveSession çš„ <code>setRunning</code> æ–¹æ³•.</p>
<p>å®Œæ•´çš„å·¥ç¨‹ä»£ç , åç»­æˆ‘ä¼šæ”¾åˆ° Github ä¸Šé¢. æ–¹ä¾¿æœ‰éœ€è¦çš„ä¸‹è½½.</p>
<h2 id="æ¨æµæ’­æ”¾"><a href="#æ¨æµæ’­æ”¾" class="headerlink" title="æ¨æµæ’­æ”¾"></a>æ¨æµæ’­æ”¾</h2><p>ä¸Šé¢çš„åŸºæœ¬é…ç½®å®Œæˆå, å¯ä»¥å¼€å§‹æ¨æµäº†.</p>
<p><strong>1.å¯åŠ¨ nginx</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nginx</div></pre></td></tr></table></figure>
<p><strong>2.å¯åŠ¨æ¨æµ</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (void)startLive &#123;</div><div class="line">    </div><div class="line">    LFLiveStreamInfo *streamInfo = [LFLiveStreamInfo new];</div><div class="line">    streamInfo.url = sRTMPUrl;</div><div class="line">    [self.session startLive:streamInfo];</div><div class="line">    self.session.beautyFace = YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ <code>sRTMPUrl</code> æ˜¯ä¸€ä¸ªå¸¸é‡å®šä¹‰:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">static NSString * const sRTMPUrl = @&quot;rtmp://192.168.1.102:1935/rtmplive/channel&quot;;</div></pre></td></tr></table></figure>
<p><code>192.168.1.102</code> æ˜¯æˆ‘çš„æœ¬æœº(mac) ip åœ°å€.</p>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸çš„è¯, ä½ åœ¨æ‰‹æœºä¸Šé¢å¯ä»¥çœ‹åˆ°è‡ªå·±çš„é¢„è§ˆç”»é¢.</p>
<p><strong>3.VLC æ’­æ”¾</strong></p>
<p>ä½¿ç”¨ VLC æ’­æ”¾ rtmp çš„æµ, æ‰“å¼€ VLC æ’­æ”¾å™¨, é€‰æ‹© File/Open Network, è¾“å…¥ <code>rtmp://192.168.1.102:1935/rtmplive/channel</code> è¿™ä¸ªåœ°å€å³å¯å®æ—¶æ’­æ”¾äº†.</p>
<p>è¿™é‡Œæ³¨æ„ä¸€å®šè¦ä½¿ç”¨æœ¬æœºçš„ ip åœ°å€, ä¸è¦ä½¿ç”¨ <code>localhost:1935</code> ç±»ä¼¼çš„åœ°å€, å¦åˆ™æ— æ³•æ’­æ”¾å’Œæ¨æµ.</p>
<p>åç»­åˆ†äº«å¦‚ä½•åœ¨ iOS ä¸Šé¢ä½¿ç”¨æ’­æ”¾å™¨æ¥æ’­æ”¾ç›´æ’­æµ.</p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éŸ³è§†é¢‘ rtmp nginx æ¨æµ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨]]></title>
      <url>/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      <content type="html"><![CDATA[<blockquote>
<p>æœ¬ç¯‡åˆ†äº«çš„ä¸»è¦å†…å®¹</p>
</blockquote>
<p>å¦‚ä½•åœ¨ macos ä¸­æ„å»ºæœ¬åœ°çš„æ¨æµæœåŠ¡å™¨(nginx + rtmp-nginx-module), å¹¶ä½¿ç”¨ ffmpeg å‘½ä»¤è¿›è¡Œè§†é¢‘æ¨æµ, ç„¶åä½¿ç”¨ VLC æ’­æ”¾å™¨æ’­æ”¾è§†é¢‘.</p>
<p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p>
<ul>
<li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac/faad2</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a> (æœ¬ç¯‡)</p>
</li>
</ul>
<h2 id="å®‰è£…-rtmp-nginx-module"><a href="#å®‰è£…-rtmp-nginx-module" class="headerlink" title="å®‰è£… rtmp-nginx-module"></a>å®‰è£… rtmp-nginx-module</h2><p>ä¹‹å‰åœ¨æµ‹è¯• php ç¨‹åºçš„æ—¶å€™, æˆ‘å·²ç»å®‰è£…è¿‡ nginx, ä½†æ˜¯å‘ç°è¿™æ ·åœ¨é…ç½® rtmp-nginx-module çš„æ—¶å€™, æ— æ³•æˆåŠŸ.</p>
<p>é…ç½®æ–‡ä»¶ä¿®æ”¹å®Œæˆä¹‹å, nginx æ€»æ˜¯æ— æ³•è¯†åˆ« <code>rtmp</code>, æŠ¥é”™å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[emerg] 30766#0: unknown directive &quot;rtmp&quot; in /usr/local/etc/nginx/nginx.conf:40</div></pre></td></tr></table></figure>
<p>ç°åœ¨éœ€è¦å¸è½½åŸæ¥å·²ç»å®‰è£…çš„ nginx, å‘½ä»¤å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew uninstall nginx</div></pre></td></tr></table></figure>
<p>å†æ¬¡å®‰è£…:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install nginx-full --with-rtmp-module</div></pre></td></tr></table></figure>
<p>è€å¿ƒç­‰å¾…ä¸€ä¼š ~~</p>
<p>nginx çš„ç‰ˆæœ¬(nginx -v):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nginx/1.12.2</div></pre></td></tr></table></figure>
<p>rtmp-nginx-module ç‰ˆæœ¬:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1.1.7.11-dev_2</div></pre></td></tr></table></figure>
<h2 id="é…ç½®-rtmp"><a href="#é…ç½®-rtmp" class="headerlink" title="é…ç½® rtmp"></a>é…ç½® rtmp</h2><p>ç¼–è¾‘ nginx çš„é…ç½®æ–‡ä»¶, æ–‡ä»¶ä½ç½®ä½äº:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/etc/nginx/nginx.conf</div></pre></td></tr></table></figure>
<p>åœ¨ <code>http {}</code> åé¢å†™å…¥å¦‚ä¸‹å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">rtmp &#123;</div><div class="line">   server &#123;</div><div class="line">        #rtmpåè®®çš„é»˜è®¤ç«¯å£å·æ˜¯ 1935</div><div class="line">        listen 1935;</div><div class="line">        #ç›´æ’­æµé…ç½®, è®¿é—® path æ˜¯ rtmplive</div><div class="line">        application rtmplive &#123;</div><div class="line">              #å¼€å¯å®æ—¶</div><div class="line">              live on;</div><div class="line">              #è®¾ç½® rtmp å¼•æ“çš„æœ€å¤§è¿æ¥æ•°. é»˜è®¤ä¸ºoff</div><div class="line">              max_connections 1024;</div><div class="line">              #ä¸è®°å½•æ•°æ®</div><div class="line">             record off;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„: <code>rtmplive</code> æ˜¯å›ºå®šçš„.</p>
<p>å…·ä½“çš„ nginx é…ç½®è¯¦è§åé¢çš„é™„å½•å†…å®¹.</p>
<h2 id="æ¨æµ"><a href="#æ¨æµ" class="headerlink" title="æ¨æµ"></a>æ¨æµ</h2><p><strong>1.å®‰è£… ffmpeg å³å¯. </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install ffmpeg</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹ä¹…, å¦‚æœä½ æ²¡æœ‰æ¢¯å­åŸºæœ¬å®‰è£…ä¸äº† [å¤§å“­]~</p>
<p><strong>2.å®‰è£… VLC</strong></p>
<p>ç›´æ¥å»å®˜ç½‘ä¸‹è½½ dmg åŒ…, å®‰è£…å³å¯.</p>
<p>æ‰“å¼€ VLC ç„¶åé€‰æ‹©ä» File/Open Network æ‰“å¼€æ–‡ä»¶, å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2018/02/25/1.jpg" alt="1"></p>
<p>åœ¨å¼¹å‡ºçš„æ¡†ä¸­, å†™å…¥æ¨æµåœ°å€ <code>rtmp://localhost:1935/rtmplive/channel</code>, å¦‚å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2018/02/25/2.jpg" alt="1"></p>
<p>ç›´æ¥ç‚¹å‡» Open.</p>
<blockquote>
<p>æ³¨æ„: å¦‚æœ localhost æ— æ³•æ’­æ”¾, è¯·æ›´æ¢ä¸ºä½ çš„æœ¬æœº ip, å¦‚æˆ‘çš„æœ¬æœº ip æ˜¯ <code>192.168.1.122</code>, å¯¹åº”çš„æ’­æ”¾åœ°å€ä¸º <code>rtmp://192.168.1.122:1935/rtmplive/channel</code>.<br>å¦‚æœè¿˜æ˜¯æ— æ³•æˆåŠŸ, è¯·å…³é—­ macos çš„é˜²ç«å¢™.</p>
</blockquote>
<p><strong>3.å¯åŠ¨ nginx</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nginx</div></pre></td></tr></table></figure>
<p>å¯ä»¥åœ¨æµè§ˆå™¨è®¿é—®å¦‚ä¸‹åœ°å€, çœ‹çœ‹ nginx æ˜¯å¦å¯åŠ¨æˆåŠŸ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:8080/index.html</div></pre></td></tr></table></figure>
<p><strong>4.ffmpeg æ¨æµ</strong></p>
<p>æ¨æµçš„å‘½ä»¤å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i ~/Desktop/launcher.mp4 -vcodec libx264 -acodec aac -strict -2 -f flv rtmp://localhost:1935/rtmplive/channel</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ <code>launcher.mp4</code> æ˜¯æˆ‘è‡ªå·±ä»ç½‘ç»œä¸Šé¢ä¸‹è½½çš„ä¸€ä¸ªè§†é¢‘æ–‡ä»¶, æ—¶é•¿å¤§çº¦æ˜¯ 5 åˆ†é’Ÿ.</p>
<p>åœ¨ VLC ä¸­, å°±å¯ä»¥çœ‹åˆ°æ¨æµæ’­æ”¾çš„è§†é¢‘äº†. [å¼€å¿ƒ]~~</p>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><h3 id="nginx-é…ç½®æ–‡ä»¶"><a href="#nginx-é…ç½®æ–‡ä»¶" class="headerlink" title="nginx é…ç½®æ–‡ä»¶"></a>nginx é…ç½®æ–‡ä»¶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">worker_processes  1;</div><div class="line"> </div><div class="line">error_log  /usr/local/etc/nginx/logs/error.log debug;</div><div class="line"></div><div class="line">pid        /usr/local/var/run/nginx.pid;</div><div class="line"> </div><div class="line">events &#123;</div><div class="line">    worker_connections  256;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">http &#123;</div><div class="line">    include             mime.types;</div><div class="line">    default_type        application/octet-stream;</div><div class="line"> </div><div class="line">    log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</div><div class="line">                      &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</div><div class="line">                      &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</div><div class="line"> </div><div class="line">    access_log  /usr/local/etc/nginx/logs/access.log  main;</div><div class="line"> </div><div class="line">    sendfile            on;</div><div class="line"> </div><div class="line">    keepalive_timeout   65;</div><div class="line"> </div><div class="line">    index index.html index.php;</div><div class="line"> </div><div class="line">    include /usr/local/etc/nginx/sites-enabled/*; </div><div class="line">    include /usr/local/etc/nginx/conf.d/*;</div><div class="line"></div><div class="line">     server &#123;</div><div class="line">        listen       8080;</div><div class="line">        server_name  localhost;</div><div class="line"></div><div class="line">        #charset koi8-r;</div><div class="line"></div><div class="line">        #access_log  logs/host.access.log  main;</div><div class="line"></div><div class="line">        location / &#123;</div><div class="line">            root   /Users/me/workspace/projs/phpwork/; #webçš„æ ¹ç›®å½•</div><div class="line">            index  index.php index.html index.htm; </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">rtmp &#123;</div><div class="line">   server &#123;</div><div class="line">        #rtmpåè®®çš„é»˜è®¤ç«¯å£å·æ˜¯1935</div><div class="line">        listen 1935;</div><div class="line">        #ç›´æ’­æµé…ç½®,è®¿é—®è·¯å¾„æ˜¯rtmplive</div><div class="line">        application rtmplive &#123;</div><div class="line">              #å¼€å¯å®æ—¶</div><div class="line">              live on;</div><div class="line">              #ä¸ºrtmpå¼•æ“è®¾ç½®æœ€å¤§è¿æ¥æ•°.é»˜è®¤ä¸ºoff</div><div class="line">              max_connections 1024;</div><div class="line">              #ä¸è®°å½•æ•°æ®</div><div class="line">             record off;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="è§†é¢‘æ–‡ä»¶"><a href="#è§†é¢‘æ–‡ä»¶" class="headerlink" title="è§†é¢‘æ–‡ä»¶"></a>è§†é¢‘æ–‡ä»¶</h2><p>ä½¿ç”¨ä¸‹è½½çš„ mp4 æ–‡ä»¶, æœ‰äº›æ— æ³•æ’­æ”¾, æš‚æ—¶ä¼°è®¡åº”è¯¥æ˜¯ç ç‡çš„é—®é¢˜, å¤§å®¶åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­, å‘ç°è§†é¢‘æ— æ³•æ’­æ”¾, æœ€åè¯•è¯•å…¶ä»–è§†é¢‘æ–‡ä»¶.</p>
<p>å¦å¤–, è§†é¢‘æ–‡ä»¶ä¸è¦å¤ªå°, å°½é‡èƒ½è®©å…¶æ’­æ”¾æ—¶é•¿åœ¨ 3-5 åˆ†é’Ÿ.</p>
<h2 id="brew-install-uninstall-æŠ¥é”™"><a href="#brew-install-uninstall-æŠ¥é”™" class="headerlink" title="brew install/uninstall æŠ¥é”™"></a>brew install/uninstall æŠ¥é”™</h2><p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Error: undefined method `patch&apos; for #&lt;Resource:0x000001040877a8&gt;</div><div class="line">/usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/gcc@4.9.rb:55:in `block in &lt;class:GccAT49&gt;&apos;</div><div class="line">/usr/local/Homebrew/Library/Homebrew/resource.rb:49:in `instance_eval&apos;</div><div class="line">/usr/local/Homebrew/Library/Homebrew/resource.rb:49:in `initialize&apos;</div><div class="line">/usr/local/Homebrew/Library/Homebrew/software_spec.rb:111:in `new&apos;</div><div class="line">/usr/local/Homebrew/Library/Homebrew/software_spec.rb:111:in `resource&apos;</div></pre></td></tr></table></figure>
<p>æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆæ˜¯é‡æ–°å®‰è£… Homebrew, å‘½ä»¤å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div></pre></td></tr></table></figure>
<h2 id="æ£€æŸ¥æœ¬æœºçš„-ip"><a href="#æ£€æŸ¥æœ¬æœºçš„-ip" class="headerlink" title="æ£€æŸ¥æœ¬æœºçš„ ip"></a>æ£€æŸ¥æœ¬æœºçš„ ip</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ifconfig | grep &quot;inet &quot; | grep -v 127.0.0.1</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éŸ³è§†é¢‘ rtmp nginx </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[NSLog æ ¼å¼åŒ–è¾“å‡º NSInteger/NSUInteger]]></title>
      <url>/2018/02/22/NSLog-%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA-NSInteger-NSUInteger/</url>
      <content type="html"><![CDATA[<p>åœ¨ Xcode ä¸­ ä½¿ç”¨ NSLog æ‰“å° NSInteger/NSUInteger æ•°æ®, ç»å¸¸ä¼šé‡åˆ°ç±»ä¼¼çš„è­¦å‘Š. </p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="/upload/images/2018/02/22/1.jpg" alt="1"></p>
<p>ä½†æ˜¯åœ¨ iphone 4s(32ä½)æœºå™¨ä¸Šå°±æ²¡æœ‰ä»»ä½•è­¦å‘Š, åªæ˜¯åœ¨64ä½çš„æœºå‹ä¸Šé¢æœ‰è¿™æ ·çš„è­¦å‘Š.</p>
<p>åœ¨ <code>NSObjCRuntime.h</code> é‡Œé¢å®šä¹‰ <code>NSInteger</code> å’Œ <code>NSUInteger</code> å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#if __LP64__ || (TARGET_OS_EMBEDDED &amp;&amp; !TARGET_OS_IPHONE) || TARGET_OS_WIN32 || NS_BUILD_32_LIKE_64</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="built_in">NSInteger</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="built_in">NSUInteger</span>;</div><div class="line"><span class="meta">#else</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> <span class="built_in">NSInteger</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="built_in">NSUInteger</span>;</div><div class="line"><span class="meta">#endif</span></div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ 64 ä½ä¸‹æ˜¯ long ç±»å‹ï¼Œ32 ä½ä¸‹æ˜¯ int ç±»å‹.</p>
<p>æ‰€ä»¥, ä¸Šé¢çš„ä»£ç åœ¨ 32 ä½æœºå‹ä¸Šé¢ä¸ä¼šæœ‰è­¦å‘Š.</p>
<p>æŒ‰ç…§ Xcode çš„æç¤º, Fix it: </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSUInteger</span> iun = <span class="number">3</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"iun: %lu"</span>, (<span class="keyword">unsigned</span> <span class="keyword">long</span>)iun);</div><div class="line">    </div><div class="line"><span class="built_in">NSInteger</span> nsi = <span class="number">6</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"nsi: %ld"</span>, (<span class="keyword">long</span>)nsi);</div></pre></td></tr></table></figure>
<p>è¿™æ ·æ— è®ºåœ¨ 32 ä½è¿˜æ˜¯åœ¨ 64 ä½æœºå‹ä¸Šé¢, éƒ½æ²¡æœ‰è­¦å‘Šäº†.</p>
<h2 id="Twitter-å¸–å­"><a href="#Twitter-å¸–å­" class="headerlink" title="Twitter å¸–å­"></a>Twitter å¸–å­</h2><p>åœ¨ <a href="https://twitter.com/gparker/status/377910611453046784" target="_blank" rel="noopener">twitter æœ‰ä¸ªå¸–å­</a> è¯´äº†å¦ä¸€ç§è§£å†³åŠæ³•, åŸæ–‡å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">%zd, %tu, %tx (<span class="keyword">signed</span>, <span class="keyword">unsigned</span>, hex) currently format <span class="built_in">NSInteger</span> and <span class="built_in">NSUInteger</span> with no warnings.</div></pre></td></tr></table></figure>
<blockquote>
<p>æ„æ€æ˜¯ä½¿ç”¨ zd å¯ä»¥æ ¼å¼åŒ–æœ‰ç¬¦å·çš„å¦‚ NSInteger, ä½¿ç”¨ tu æ ¼å¼åŒ–æ— ç¬¦å·çš„å¦‚ NSUInteger. è€Œ tx å¯ä»¥ç”¨æ¥æ ¼å¼åŒ–è¾“å‡º 16 è¿›åˆ¶æ•°æ®.</p>
</blockquote>
<p>æŒ‰ç…§è¿™ä¸ªè¯´æ³•, ä¿®æ”¹å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSUInteger</span> iun = <span class="number">3</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"iun: %zd"</span>, iun);</div><div class="line">    </div><div class="line"><span class="built_in">NSInteger</span> nsi = <span class="number">6</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"nsi: %td"</span>, nsi);</div></pre></td></tr></table></figure>
<p>æˆ–è€…è¿™æ ·ä¿®æ”¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">NSUInteger iun = 3;</div><div class="line">NSLog(@&quot;iun: %tu&quot;, iun);</div><div class="line">    </div><div class="line">NSInteger nsi = 6;</div><div class="line">NSLog(@&quot;nsi: %td&quot;, nsi);</div></pre></td></tr></table></figure>
<p>ç¡®å®æ²¡æœ‰äº†è­¦å‘Šçš„é—®é¢˜.</p>
<p>æˆ‘åœ¨å®è·µè¿‡ç¨‹ä¸­å‘ç°ä¸€ä¸ªé—®é¢˜: ä½¿ç”¨ <code>zu</code> æ¥æ ¼å¼åŒ–è¾“å‡º NSUInteger, åœ¨ 32 ä½æœºå™¨ä¸Šé¢, ä»æ—§ä¼šæŠ¥è­¦å‘Š.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSUInteger</span> iun = <span class="number">3</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"iun: %zu"</span>, iun);</div></pre></td></tr></table></figure>
<p>è¿™å°±è®©æˆ‘å¼€å§‹æ€€ç–‘ z å’Œ t çš„å¯é æ€§äº†.</p>
<p>ä¸‹é¢æ¥ç€äº†è§£ä¸€ä¸‹å®ƒä»¬.</p>
<h2 id="å…³äº-z-t"><a href="#å…³äº-z-t" class="headerlink" title="å…³äº z t"></a>å…³äº z t</h2><p>å…³äº <code>z</code> <code>t</code> çš„è¯´æ˜å¯ä»¥å‚è€ƒ <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html" target="_blank" rel="noopener">String Format Specifiers</a></p>
<p><img src="/upload/images/2018/02/22/2.jpg" alt="1"></p>
<p>å¯ä»¥è¯´æ˜:</p>
<blockquote>
<p>æ ¼å¼åŒ– z å¯ä»¥ç”¨æ¥ä»£è¡¨ size_t.<br>æ ¼å¼åŒ– t å¯ä»¥ç”¨æ¥ä»£è¡¨ ptrdiff_t.</p>
</blockquote>
<p>ptrdiff_t æ˜¯C/C++æ ‡å‡†åº“ä¸­å®šä¹‰çš„ä¸€ä¸ªä¸æœºå™¨ç›¸å…³çš„æ•°æ®ç±»å‹.<br>ptrdiff_t ç±»å‹å˜é‡é€šå¸¸ç”¨æ¥ä¿å­˜ä¸¤ä¸ªæŒ‡é’ˆå‡æ³•æ“ä½œçš„ç»“æœ, å…¶å®šä¹‰åœ¨ C99 æ ‡å‡†ä¸­.</p>
<p><strong>size_t ç±»å‹ç”¨äºæŒ‡æ˜æ•°ç»„é•¿åº¦, å®ƒå¿…é¡»æ˜¯ä¸€ä¸ªæ­£æ•°, è€Œ ptrdiff_t ç±»å‹åˆ™åº”ä¿è¯è¶³ä»¥å­˜æ”¾åŒä¸€æ•°ç»„ä¸­ä¸¤ä¸ªæŒ‡é’ˆä¹‹é—´çš„å·®è·, å®ƒæœ‰å¯èƒ½æ˜¯è´Ÿæ•°.</strong></p>
<p>å³: size_t æ˜¯ unsigned ç±»å‹, è€Œ ptrdiff_t åˆ™æ˜¯ signed æ•´å‹.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">printf(<span class="string">"size_t bytes = %d\n"</span> ,<span class="keyword">sizeof</span>(size_t));</div><div class="line">printf(<span class="string">"ptrdiff_t bytes = %d\n"</span> ,<span class="keyword">sizeof</span>(ptrdiff_t));</div></pre></td></tr></table></figure>
<p>åœ¨ 32 ä½æœºå‹ä¸­è¾“å‡ºç»“æœ:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">size_t bytes = <span class="number">4</span></div><div class="line">ptrdiff_t bytes = <span class="number">4</span></div></pre></td></tr></table></figure>
<p>åœ¨ 64 ä½æœºå‹ä¸­è¾“å‡ºç»“æœ:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">size_t bytes = <span class="number">8</span></div><div class="line">ptrdiff_t bytes = <span class="number">8</span></div></pre></td></tr></table></figure>
<p>è¿™è¯´æ˜, sizet_t å’Œ ptrdiff_t æ˜¯å’Œæœºå™¨ç±»å‹ç›¸å…³çš„è·¨å¹³å°çš„.</p>
<p>ç³»ç»Ÿå®šä¹‰:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> __SIZE_TYPE__ size_t;</div><div class="line"><span class="keyword">typedef</span> __PTRDIFF_TYPE__ ptrdiff_t;</div></pre></td></tr></table></figure>
<p>32 ä½æœºå‹å®šä¹‰:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define __SIZE_TYPE__ long unsigned int</span></div><div class="line"><span class="meta">#define __PTRDIFF_TYPE__ int</span></div></pre></td></tr></table></figure>
<p>64 ä½æœºå‹å®šä¹‰:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define __SIZE_TYPE__ long unsigned int</span></div><div class="line"><span class="meta">#define __PTRDIFF_TYPE__ long int</span></div></pre></td></tr></table></figure>
<h2 id="ç»ˆæè§£å†³æ–¹æ¡ˆ"><a href="#ç»ˆæè§£å†³æ–¹æ¡ˆ" class="headerlink" title="ç»ˆæè§£å†³æ–¹æ¡ˆ"></a>ç»ˆæè§£å†³æ–¹æ¡ˆ</h2><p>æ—¢ç„¶åœ¨ Xcode é‡Œé¢æç¤º Fix it å¯ä»¥ä½¿ç”¨, é‚£ä¹ˆä¸ºäº†æé«˜ä»£ç çš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§, å¯ä»¥å®šä¹‰å®å®šä¹‰æ¥è§£å†³.</p>
<p>å®å®šä¹‰å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#if __LP64__</span></div><div class="line"><span class="meta">#define MZNSI @<span class="meta-string">"ld"</span></span></div><div class="line"><span class="meta">#define MZNSU @<span class="meta-string">"lu"</span></span></div><div class="line"><span class="meta">#else</span></div><div class="line"><span class="meta">#define MZNSI @<span class="meta-string">"d"</span></span></div><div class="line"><span class="meta">#define MZNSU @<span class="meta-string">"u"</span></span></div><div class="line"><span class="meta">#endif //__LP64__</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ–¹æ³•, å¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSInteger</span> nsi = <span class="number">6</span>;</div><div class="line"><span class="built_in">NSUInteger</span> iun = <span class="number">3</span>;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"NSInteger nsi = %"</span>MZNSI, nsi);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"NSUInteger iun = %"</span>MZNSU, iun);</div></pre></td></tr></table></figure>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ç»™å‡ºå¸¸ç”¨çš„æ ¼å¼åŒ–æ‰“å°è¾“å‡ºå­—ç¬¦ä¸²ä¸­çš„æ ¼å¼ç¬¦, å¦‚ä¸‹æ‰€ç¤º:</p>
<p>1ï¼‰%cï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>int</code> ç±»å‹ï¼Œä½†å®é™…è¿è¡Œæ—¶ä¼šå°†è¯¥ <code>int</code>ç±»å‹å¯¹è±¡è½¬æ¢ä¸º <code>unsigned char</code> ç±»å‹.</p>
<p>2ï¼‰%d æˆ–è€… %iï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>int</code> ç±»å‹. åªä¸è¿‡, %d ä¸€èˆ¬ç”¨äºåè¿›åˆ¶, %i å¯ä»¥å¯¹åº”å„ç§è¿›åˆ¶çš„æ•°æ®.</p>
<blockquote>
<p>äºŒè€…åœ¨æ‰“å°è¾“å‡ºä¸Šé¢æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„å·®åˆ«. ä½†æ˜¯åœ¨æ¥æ”¶è¾“å…¥(scanf)ä¸Š, %d ç”¨äºåè¿›åˆ¶, %i å¯¹åº”å„ç§è¿›åˆ¶çš„æ•°æ®. å¯ä»¥å‚è€ƒ <a href="https://www.geeksforgeeks.org/difference-d-format-specifier-c-language/" target="_blank" rel="noopener">Difference between %d and %i format specifier in C language</a> è¿™ç¯‡æ–‡ç« .</p>
</blockquote>
<p>3ï¼‰%fï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>double</code> ç±»å‹.</p>
<p>4ï¼‰%ldï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>long int</code> ç±»å‹.</p>
<p>5ï¼‰%sï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>const char*</code> ç±»å‹ï¼Œè¡¨ç¤ºè¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸².</p>
<p>6ï¼‰%uï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>unsigned int</code> ç±»å‹.</p>
<p>7ï¼‰%zuï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>size_t</code> ç±»å‹.</p>
<p>8ï¼‰%tdï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>ptrdiff_t</code> ç±»å‹.</p>
<p>9ï¼‰%xï¼ˆæˆ– %Xï¼‰ï¼šå¯¹åº”å‚æ•°æ˜¯ä¸€ä¸ª <code>int</code> ç±»å‹ï¼Œä¸è¿‡ä¼šä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºï¼Œå…¶ä¸­å¤§äº 9 çš„æ•°å­—æ ¹æ®å­—æ¯ <code>x</code> å¤§å°å†™è¿›è¡Œè½¬æ¢ï¼Œå¦‚æœæ˜¯ <code>%x</code>ï¼Œåˆ™å¤§äº 9 çš„æ•°ç”¨ <code>aï½f</code> è¡¨ç¤ºï¼›å¦‚æœæ˜¯ <code>%X</code>ï¼Œåˆ™ç”¨ <code>Aï½F</code> è¡¨ç¤º.</p>
<p>10ï¼‰%%ï¼šè¾“å‡ºä¸€ä¸ª % ç¬¦å·.</p>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html" target="_blank" rel="noopener">Appleï¼šString Format Specifiers</a></p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼ŒæœŸå¾…ä¸ä½ çš„äº¤æµ~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> NSLog printf scanf </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2]]></title>
      <url>/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/</url>
      <content type="html"><![CDATA[<p>æœ¬æ¬¡åˆ†äº«ä½¿ç”¨ faad2 è§£ç  AAC éŸ³é¢‘æ–‡ä»¶, å°† AAC æ–‡ä»¶è½¬æ¢ä¸º WAV æ–‡ä»¶å¹¶ä½¿ç”¨ AVAudioPlayer è¿›è¡Œæ’­æ”¾.</p>
<p>åœ¨åšæ–‡ <a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a> ç»™å¤§å®¶ç®€å•çš„åˆ†æäº†ä¸€ä¸‹ WAV çš„æ•°æ®å¤´åè®®, å…¶å®ä¹Ÿæ˜¯ä¸ºäº†è¿™ç¯‡åšæ–‡æ¥æœåŠ¡çš„, æ‰€ä»¥é˜…è¯»æœ¬æ–‡ä¹‹å‰, å»ºè®®å…ˆçœ‹ä¸Šæ–‡.</p>
<p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p>
<ul>
<li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac/faad2</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> (æœ¬ç¯‡)</p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p>
</li>
</ul>
<h2 id="ä¾‹å­ç®€ä»‹"><a href="#ä¾‹å­ç®€ä»‹" class="headerlink" title="ä¾‹å­ç®€ä»‹"></a>ä¾‹å­ç®€ä»‹</h2><p>æœ¬æ–‡ä»¥ä¸€ä¸ªå®é™…çš„ä¾‹å­, ä½¿ç”¨ faad2çš„å„ä¸ªå‡½æ•°æ¥è§£ç  AAC æ•°æ®.</p>
<p>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤:</p>
<ul>
<li>è·å–è¾“å…¥æ–‡ä»¶</li>
<li>è·å– faad è§£ç å™¨å¥æŸ„</li>
<li>åˆå§‹åŒ– faad è§£ç å™¨</li>
<li>æ ¹æ®æ–‡ä»¶è§£ææ–‡ä»¶å¸§, å¹¶å†™å…¥è¾“å‡ºæ–‡ä»¶ä¸­</li>
<li>å†™å…¥æ–‡ä»¶å¤´å°†å…¶å°è£…ä¸º WAV æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶</li>
<li>å…³é—­ faad è§£ç å™¨å¥æŸ„</li>
</ul>
<h2 id="å·¥ç¨‹å®æˆ˜"><a href="#å·¥ç¨‹å®æˆ˜" class="headerlink" title="å·¥ç¨‹å®æˆ˜"></a>å·¥ç¨‹å®æˆ˜</h2><h3 id="å¼•å…¥-faad2"><a href="#å¼•å…¥-faad2" class="headerlink" title="å¼•å…¥ faad2"></a>å¼•å…¥ faad2</h3><p>å°†ç¼–è¯‘å¥½çš„ faad2 å¯¼å…¥å·¥ç¨‹å³å¯.</p>
<p><img src="/upload/images/2018/02/20/11.jpg" alt="1"><br>å…¶ä¸­å…³é”®çš„ API åœ¨ neaacdec.h ä¸­æœ‰æè¿°.</p>
<p>å·¥ç¨‹æ•ˆæœå›¾:<br><img src="/upload/images/2018/02/20/22.jpg" alt="1"></p>
<h3 id="ç¼–ç å®ç°"><a href="#ç¼–ç å®ç°" class="headerlink" title="ç¼–ç å®ç°"></a>ç¼–ç å®ç°</h3><p>åœ¨ <a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a> ä¸­å·²ç»å®šä¹‰äº† WAV çš„æ•°æ®å¤´.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">struct MZWavAudioFileHeader</div><div class="line">&#123;</div><div class="line">    char       riff[4];       // å­—ç¬¦ä¸² &quot;RIFF&quot;</div><div class="line">    uint32_t   totalLength; // æ–‡ä»¶æ€»å¤§å°, åŒ…æ‹¬PCM æ•°æ®å¤§å°å’Œè¯¥æ–‡ä»¶å¤´å¤§å°</div><div class="line">    char       wave[4];     // å­—ç¬¦ä¸² &quot;WAVE&quot;</div><div class="line">    char       fmt[4];      // å­—ç¬¦ä¸² &quot;fmt &quot;</div><div class="line">    uint32_t   format;      // WAV å¤´å¤§å°, å›ºå®šä¸ºå€¼ 16</div><div class="line">    uint16_t   pcm;         // PCM ç¼–ç æ–¹å¼, å›ºå®šå€¼ä¸º 1</div><div class="line">    uint16_t   channels;    // å£°é“æ•°é‡, ä¸º 2</div><div class="line">    uint32_t   frequency;   // é‡‡æ ·é¢‘ç‡</div><div class="line">    uint32_t   bytes_per_second; // æ¯ç§’å­—èŠ‚æ•°(ç ç‡), å…¶å€¼=é‡‡æ ·ç‡xé€šé“æ•°xä½æ·±åº¦/8</div><div class="line">    uint16_t   bytes_by_capture; // é‡‡æ ·å—å¤§å°</div><div class="line">    uint16_t   bits_per_sample; // é‡‡æ ·ç‚¹å¤§å°, è¿™é‡Œæ˜¯ 16 ä½</div><div class="line">    char       data[4];         // å­—ç¬¦ä¸² &quot;data&quot;</div><div class="line">    uint32_t   bytes_in_pcmdata;  // pcm æ•°æ®é•¿åº¦</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç°åœ¨å®ç°å†™å…¥æ•°æ®å¤´çš„æ–¹æ³• <code>mz_write_wav_header</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * å†™å…¥ wav å¤´æ•°æ®.</div><div class="line"> *</div><div class="line"> *  @param file  wav æ–‡ä»¶æŒ‡é’ˆ.</div><div class="line"> *  @param total_samples_per_channel æ¯ä¸ªå£°é“çš„é‡‡æ ·æ•°.</div><div class="line"> *  @param samplerate é‡‡æ ·ç‡.</div><div class="line"> *  @param channels å£°é“æ•°.</div><div class="line"> */</div><div class="line">void mz_write_wav_header(FILE *file, int total_samples_per_channel, int samplerate, int channels) &#123;</div><div class="line">    </div><div class="line">    if (NULL == file) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if (total_samples_per_channel &lt;= 0) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    printf(&quot;FAAD. total_samples_per_channel: %i, samplerate: %i, channels: %i\n&quot;,</div><div class="line">           total_samples_per_channel, samplerate, channels);</div><div class="line">    </div><div class="line">    struct MZWavAudioFileHeader wavHeader;</div><div class="line">    </div><div class="line">    // å†™å…¥ RIFF</div><div class="line">    strcpy(wavHeader.riff, &quot;RIFF&quot;);</div><div class="line">    </div><div class="line">    wavHeader.bits_per_sample = 16;</div><div class="line">    </div><div class="line">    wavHeader.totalLength = (total_samples_per_channel * channels * wavHeader.bits_per_sample/8) + sizeof(wavHeader) - 8;</div><div class="line">    </div><div class="line">    // å†™å…¥ WAVE å’Œ fmt</div><div class="line">    strcpy(wavHeader.wave, &quot;WAVE&quot;);</div><div class="line">    strcpy(wavHeader.fmt, &quot;fmt &quot;);</div><div class="line">    </div><div class="line">    wavHeader.format = 16;</div><div class="line">    wavHeader.pcm = 1;</div><div class="line">    wavHeader.channels = channels;</div><div class="line">    wavHeader.frequency = samplerate;</div><div class="line">    </div><div class="line">    // æ¯ç§’çš„å­—èŠ‚æ•°(ç ç‡)=é‡‡æ ·ç‡xé€šé“æ•°xä½æ·±åº¦/8</div><div class="line">    wavHeader.bytes_per_second = wavHeader.channels * wavHeader.frequency * wavHeader.bits_per_sample/8;</div><div class="line">    </div><div class="line">    wavHeader.bytes_by_capture = wavHeader.channels*wavHeader.bits_per_sample/8;</div><div class="line">    </div><div class="line">    wavHeader.bytes_in_pcmdata = total_samples_per_channel * wavHeader.channels * wavHeader.bits_per_sample/8;</div><div class="line">    </div><div class="line">    // å†™å…¥ data</div><div class="line">    strcpy(wavHeader.data, &quot;data&quot;);</div><div class="line">    </div><div class="line">    fwrite(&amp;wavHeader, 1, sizeof(wavHeader), file);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è§£ç ä¸»è¦ç”¨åˆ°äº† FAAD2 ä¸­çš„ <code>NeAACDecDecode</code> å‡½æ•°. å‡½æ•°åŸå‹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">void* NEAACDECAPI NeAACDecDecode(NeAACDecHandle hDecoder,</div><div class="line">                                 NeAACDecFrameInfo *hInfo,</div><div class="line">                                 unsigned char *buffer,</div><div class="line">                                 unsigned long buffer_size);</div></pre></td></tr></table></figure>
<p>å¯¹åº”å¸§å®šä¹‰çš„ç»“æ„ä½“: <code>NeAACDecFrameInfo</code>, å®šä¹‰å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">typedef struct NeAACDecFrameInfo</div><div class="line">&#123;</div><div class="line">    unsigned long bytesconsumed;</div><div class="line">    unsigned long samples;</div><div class="line">    unsigned char channels;</div><div class="line">    unsigned char error;</div><div class="line">    unsigned long samplerate;</div><div class="line"></div><div class="line">    /* SBR: 0: off, 1: on; upsample, 2: on; downsampled, 3: off; upsampled */</div><div class="line">    unsigned char sbr;</div><div class="line"></div><div class="line">    /* MPEG-4 ObjectType */</div><div class="line">    unsigned char object_type;</div><div class="line"></div><div class="line">    /* AAC header type; MP4 will be signalled as RAW also */</div><div class="line">    unsigned char header_type;</div><div class="line"></div><div class="line">    /* multichannel configuration */</div><div class="line">    unsigned char num_front_channels;</div><div class="line">    unsigned char num_side_channels;</div><div class="line">    unsigned char num_back_channels;</div><div class="line">    unsigned char num_lfe_channels;</div><div class="line">    unsigned char channel_position[64];</div><div class="line"></div><div class="line">    /* PS: 0: off, 1: on */</div><div class="line">    unsigned char ps;</div><div class="line">&#125; NeAACDecFrameInfo;</div></pre></td></tr></table></figure>
<p>å…·ä½“çš„è§£ç å®ç°, æˆ‘æ”¾åˆ°äº† Github ä¸Šé¢äº†, å¤§å®¶å¯ä»¥å» <a href="https://github.com/veryitman/faacfaad2" target="_blank" rel="noopener">è¿™é‡Œ</a> æŸ¥çœ‹.</p>
<h2 id="éº»çƒ¦"><a href="#éº»çƒ¦" class="headerlink" title="éº»çƒ¦"></a>éº»çƒ¦</h2><blockquote>
<p>è§£ç  aac, è§£å†³é‡‡æ ·é¢‘ç‡å’Œé€šé“æ•°ä¸å¯¹çš„é—®é¢˜</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//é˜²æ­¢é‡‡æ ·é¢‘ç‡åŠ å€</div><div class="line">NeAACDecConfigurationPtr conf = NeAACDecGetCurrentConfiguration(decoder);</div><div class="line">conf-&gt;dontUpSampleImplicitSBR = 1;</div><div class="line">NeAACDecSetConfiguration(decoder, conf);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//ä»åŒå£°é“çš„æ•°æ®ä¸­æå–å•é€šé“  </div><div class="line">for(i=0,j=0; i&lt;4096 &amp;&amp; j&lt;2048; i+=4, j+=2) &#123;</div><div class="line"></div><div class="line">    frame_mono[j]=pcm_data[i];</div><div class="line">    frame_mono[j+1]=pcm_data[i+1];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…·ä½“å¯ä»¥æŸ¥é˜… FAAD2 çš„æºç . æ„Ÿè°¢ <a href="http://blog.csdn.net/machh/article/details/47153111" target="_blank" rel="noopener">ä½¿ç”¨FAADåº“è§£ç AACå®ä¾‹åŠ åŠ faadè§£ç åçš„é€šé“æ•°ä¸æ­£ç¡®çš„é—®é¢˜</a> æä¾›.</p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éŸ³è§†é¢‘ wav pcm faad2 aac </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶]]></title>
      <url>/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>è¿™ç¯‡åˆ†äº«æ˜¯ä¸‹ç¯‡ <a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> çš„é¢„å¤‡çŸ¥è¯†, å¦‚æœè¦è§£ç  WAV æ–‡ä»¶, é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹ WAV éŸ³é¢‘æ–‡ä»¶çš„æ ¼å¼.</p>
<p>ä»Šå¤©è¯´çš„æ˜¯ <code>çº¿æ€§ PCM</code> å¯¹åº”çš„ WAV æ ¼å¼çš„æ•°æ®.</p>
<blockquote>
<p>PCM çš„ç§ç±»</p>
</blockquote>
<ul>
<li>çº¿æ€§åŒ– PCM</li>
<li>Aå¾‹é‡åŒ–çš„ PCM</li>
<li>Uå¾‹é‡åŒ–çš„ PCM</li>
<li>AD PCM</li>
<li>GSM</li>
</ul>
<p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p>
<ul>
<li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac/faad2</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a>(æœ¬ç¯‡)</p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p>
</li>
</ul>
<h2 id="WAV-ç®€ä»‹"><a href="#WAV-ç®€ä»‹" class="headerlink" title="WAV ç®€ä»‹"></a>WAV ç®€ä»‹</h2><p>WAV åªæ˜¯è¯¥éŸ³é¢‘æ–‡ä»¶çš„åç¼€å, å…¶å®Œæ•´åç§°ç¼©å†™æ˜¯ WAVE.</p>
<p>WAVE(Waveform Audio File Format), é‡‡ç”¨RIFFï¼ˆResource Interchange File Formatï¼‰æ–‡ä»¶æ ¼å¼ç»“æ„.</p>
<p>WAV æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶é€šå¸¸ç”¨æ¥ä¿å­˜ PCM æ ¼å¼çš„åŸå§‹éŸ³é¢‘æ•°æ®ï¼Œé€šå¸¸è¢«ç§°ä¹‹ä¸ºæ— æŸéŸ³é¢‘. </p>
<p>WAV éŸ³é¢‘æ–‡ä»¶, ç²—ç•¥æ¥è¯´æ˜¯ WAV æ•°æ®å¤´ + PCM æ•°æ®ç»„æˆçš„. è£¸æ•°æ® PCM å¤–é¢åŒ…äº†ä¸€å±‚æ–‡ä»¶å¤´ï¼ŒWAV å®è´¨ä¸ºä¸€ä¸ª <a href="http://www.cnblogs.com/wangguchangqing/p/5957531.html" target="_blank" rel="noopener">RIFF æ–‡ä»¶</a>.</p>
<h2 id="WAV-æ•°æ®å¤´"><a href="#WAV-æ•°æ®å¤´" class="headerlink" title="WAV æ•°æ®å¤´"></a>WAV æ•°æ®å¤´</h2><p>å…³äº WAV éŸ³é¢‘æ–‡ä»¶çš„æ•°æ®å¤´å®šä¹‰å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2018/02/20/1.jpg" alt="1"></p>
<p>æœ€å‰é¢çš„4ä¸ªå­—èŠ‚ç”¨æ¥æ ‡ç¤ºæ˜¯ RIFF å­—ç¬¦ä¸².</p>
<p>å¯ä»¥çœ‹å‡º, ä¸€èˆ¬çš„ WAV æ–‡ä»¶çš„æ•°æ®å¤´ä¸º 44 ä¸ªå­—èŠ‚, å…¶åé¢è·Ÿçš„æ˜¯ PCM æ•°æ®.</p>
<h2 id="åˆ†æ-WAV-æ•°æ®å¤´"><a href="#åˆ†æ-WAV-æ•°æ®å¤´" class="headerlink" title="åˆ†æ WAV æ•°æ®å¤´"></a>åˆ†æ WAV æ•°æ®å¤´</h2><p>ä½¿ç”¨ hexdump æ¥çœ‹ä¸€ä¸‹ WAV æ–‡ä»¶çš„æ•°æ®å¤´.</p>
<p>åœ¨å½“å‰è·¯å¾„ä¸‹, æœ‰ä¸ª wav æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ <code>m.wav</code>, ä½¿ç”¨ hexdump åˆ†æä¸€ä¸‹.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexdump -n 44 m.wav</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2018/02/20/2.jpg" alt="2"></p>
<p>å…¶ä¸­, <code>-n 44</code> è¡¨ç¤ºæŸ¥çœ‹å‰ 44 ä¸ªå­—èŠ‚.</p>
<p>æŒ‰å­—èŠ‚åˆ†ç»„çš„å›¾, å¦‚ä¸‹æ‰€ç¤º:<br><img src="/upload/images/2018/02/20/3.png" alt="2"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">52 49 46 46</div></pre></td></tr></table></figure>
<p>åˆ†åˆ«æ˜¯ RIFF çš„ ASCII ç .</p>
<p>è·Ÿåœ¨ RIFF åé¢çš„å››ä¸ªå­—èŠ‚æ˜¯æ–‡ä»¶çš„å¤§å°ä¿¡æ¯, æˆ‘ä»¬å…ˆä½¿ç”¨ <code>ls</code> å‘½ä»¤çœ‹ä¸€ä¸‹è¯¥æ–‡ä»¶çš„å¤§å°.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ls -al</div></pre></td></tr></table></figure>
<p>è¾“å‡ºæ–‡ä»¶å¤§å°ä¸º(å­—èŠ‚æ•°): 1080808</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">staff  1080808 Jan 25 15:44 m.wav</div></pre></td></tr></table></figure>
<p>RIFF åé¢çš„å››ä¸ªå­—èŠ‚åˆ†åˆ«æ˜¯: e0 7d 10 00, ç”±äºè¯¥å­˜å‚¨ä½¿ç”¨äº†å°ç«¯åº(Little-Endian å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹å…¶ä¸­çš„æ•°æ®ï¼Œä½ä½å­—èŠ‚åœ¨å‰ï¼Œé«˜ä½å­—èŠ‚åœ¨å), æ‰€ä»¥16è¿›åˆ¶è¡¨ç¤ºä¸º: 0x00107de0, å¯¹åº”çš„å­—èŠ‚å¤§å°æ˜¯ <code>1080808</code>.</p>
<p>ä¸Šé¢è¯´åˆ°, çº¿æ€§ PCM, å…¶å®åœ¨è¯¥æ–‡ä»¶å¤´ä¸­, ç¬¬17åˆ°ç¬¬ç¬¬22ä¸ªå­—èŠ‚(ä¸Šå›¾çº¢è‰²çš„5å’Œ6ç»„åˆ)æ ‡ç¤ºäº† PCM çš„ç±»å‹, å³:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">10 00 00 00 01 00</div></pre></td></tr></table></figure>
<p>å…¶ä»–ç±»å‹çš„ PCM ç±»å‹å®šä¹‰ä¸º:</p>
<blockquote>
<p>Aå¾‹é‡åŒ–çš„PCM: 12 00 00 0006 00<br>Uå¾‹é‡åŒ–çš„PCM: 12 00 00 00 07 00<br>AD PCM: 32 00 00 00 02 00<br>GSM: 14 00 00 00 31 00</p>
</blockquote>
<p>æœ€å4ä¸ªå­—èŠ‚è¡¨ç¤ºçœŸæ­£ PCM æ•°æ®çš„æ–‡ä»¶å¤§å°, å³: 0x00107dbc, å…¶10è¿›åˆ¶å¤§å°ä¸º: 1080764, ç”¨æ€»æ–‡ä»¶å¤§å°å‡å» 1080764, å°±æ˜¯æ–‡ä»¶å¤´çš„å¤§å°, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1080808 - 1080764 = 44</div></pre></td></tr></table></figure>
<p>å…¶ä»–å¯¹åº”çš„æ•°æ®, å¤§å®¶å¯ä»¥å¯¹ç…§è¡¨è‡ªè¡Œåˆ†æ.</p>
<h2 id="å®šä¹‰æ•°æ®å¤´"><a href="#å®šä¹‰æ•°æ®å¤´" class="headerlink" title="å®šä¹‰æ•°æ®å¤´"></a>å®šä¹‰æ•°æ®å¤´</h2><blockquote>
<p>æ•°æ®ç±»å‹</p>
</blockquote>
<ul>
<li>char å ç”¨ 1 ä¸ªå­—èŠ‚</li>
<li>uint32_t å ç”¨ 4 ä¸ªå­—èŠ‚</li>
<li>uint16_t å ç”¨ 2 ä¸ªå­—èŠ‚</li>
</ul>
<p>è¿™é‡Œä½¿ç”¨ç»“æ„ä½“å®šä¹‰ WAV æ–‡ä»¶å¤´, å…¶å®šä¹‰å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">struct MZWavAudioFileHeader</div><div class="line">&#123;</div><div class="line">    char       riff[4];       // å­—ç¬¦ä¸² &quot;RIFF&quot;</div><div class="line">    uint32_t   totalLength; // æ–‡ä»¶æ€»å¤§å°, åŒ…æ‹¬PCM æ•°æ®å¤§å°å’Œè¯¥æ–‡ä»¶å¤´å¤§å°</div><div class="line">    char       wave[4];     // å­—ç¬¦ä¸² &quot;WAVE&quot;</div><div class="line">    char       fmt[4];      // å­—ç¬¦ä¸² &quot;fmt &quot;</div><div class="line">    uint32_t   format;      // WAV å¤´å¤§å°, å›ºå®šä¸ºå€¼ 16</div><div class="line">    uint16_t   pcm;         // PCM ç¼–ç æ–¹å¼, å›ºå®šå€¼ä¸º 1</div><div class="line">    uint16_t   channels;    // å£°é“æ•°é‡, ä¸º 2</div><div class="line">    uint32_t   frequency;   // é‡‡æ ·é¢‘ç‡</div><div class="line">    uint32_t   bytes_per_second; // æ¯ç§’å­—èŠ‚æ•°(ç ç‡), å…¶å€¼=é‡‡æ ·ç‡xé€šé“æ•°xä½æ·±åº¦/8</div><div class="line">    uint16_t   bytes_by_capture; // é‡‡æ ·å—å¤§å°</div><div class="line">    uint16_t   bits_per_sample; // é‡‡æ ·ç‚¹å¤§å°, è¿™é‡Œæ˜¯ 16 ä½</div><div class="line">    char       data[4];         // å­—ç¬¦ä¸² &quot;data&quot;</div><div class="line">    uint32_t   bytes_in_pcmdata;  // pcm æ•°æ®é•¿åº¦</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨ä¸‹é¢ä»£ç æ¥è®¡ç®—è¯¥ç»“æ„ä½“æ‰€å çš„å­—èŠ‚æ•°(ç»“æœæ˜¯44):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">int wav_header_size = sizeof(struct MZWavAudioFileHeader);</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éŸ³è§†é¢‘ wav pcm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç ]]></title>
      <url>/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/</url>
      <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬æ–‡åˆ†äº«å¦‚ä½•å°† WAV æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶è½¬æ¢(ç¼–ç )ä¸º AAC æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶å¹¶ä½¿ç”¨ AVAudioPlayer æ’­æ”¾ç¼–ç åçš„æ–‡ä»¶. </p>
<p>è¿™é‡Œçš„ç¼–ç åŠŸèƒ½ä½¿ç”¨ faac è¿™ä¸ªåº“æ¥å®ç°.</p>
<p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p>
<ul>
<li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac/faad2</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a>(æœ¬ç¯‡)</p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p>
</li>
</ul>
<h2 id="å‡½æ•°ä»‹ç»"><a href="#å‡½æ•°ä»‹ç»" class="headerlink" title="å‡½æ•°ä»‹ç»"></a>å‡½æ•°ä»‹ç»</h2><blockquote>
<p>è·å– faac çš„ç‰ˆæœ¬</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">int FAACAPI faacEncGetVersion(char **faac_id_string, char **faac_copyright_string);</div></pre></td></tr></table></figure>
<p>ç¤ºä¾‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">char *version;</div><div class="line">char *copyright;</div><div class="line">faacEncGetVersion(&amp;version, &amp;copyright);</div><div class="line">printf(&quot;FAAC version: %s, copyright: %s&quot;, version, copyright);</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">FAAC version: 1.28, copyright: FAAC - Freeware Advanced Audio Coder (http://www.audiocoding.com/)</div><div class="line">Copyright (C) 1999,2000,2001  Menno Bakker</div><div class="line">Copyright (C) 2002,2003  Krzysztof Nikiel</div><div class="line">This software is based on the ISO MPEG-4 reference source code.</div></pre></td></tr></table></figure>
<blockquote>
<p>æ‰“å¼€å¹¶åˆå§‹åŒ– faac ç¼–ç å™¨</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// sampleRate: é‡‡æ ·ç‡</div><div class="line">// numChannels: é€šé“æ•°é‡ï¼Œ1-å•å£°é“ 2-ç«‹ä½“å£°</div><div class="line">// inputSamples: ç¼–ç åçš„æ•°æ®é•¿åº¦</div><div class="line">// maxOutputBytes: ç¼–ç åçš„ä¿¡æ¯æœ€å¤§é•¿åº¦</div><div class="line">faacEncHandle FAACAPI faacEncOpen(unsigned long sampleRate,</div><div class="line">                  unsigned int numChannels,</div><div class="line">                  unsigned long *inputSamples,</div><div class="line">                  unsigned long *maxOutputBytes);</div></pre></td></tr></table></figure>
<p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ª faac ç¼–ç å™¨å¥æŸ„. å…¶å¾ˆå¤šå‡½æ•°éƒ½éœ€è¦è¿™ä¸ªå¥æŸ„.</p>
<blockquote>
<p>å…³é—­ faac ç¼–ç å™¨</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">int FAACAPI faacEncClose(faacEncHandle hEncoder);</div></pre></td></tr></table></figure>
<p>å°†å¼€å¯ faac ç¼–ç å™¨è¿”å›çš„å¥æŸ„ä¼ å…¥å³å¯.</p>
<blockquote>
<p>è·å–é…ç½®å’Œè®¾ç½®é…ç½®</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">faacEncConfigurationPtr FAACAPI</div><div class="line">  faacEncGetCurrentConfiguration(faacEncHandle hEncoder);</div><div class="line"></div><div class="line"></div><div class="line">int FAACAPI faacEncSetConfiguration(faacEncHandle hEncoder,</div><div class="line">                    faacEncConfigurationPtr config);</div></pre></td></tr></table></figure>
<p>faac çš„é…ç½®è¢«å®šä¹‰ä¸ºäº†ä¸€ä¸ªç»“æ„ä½“ faacEncConfiguration, å¤§å®¶å¯ä»¥çœ‹æºç .</p>
<blockquote>
<p>ç¼–ç (ç¼–ç ä¸€å¸§éŸ³é¢‘æ•°æ®)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//	hEncoder: faacEncOpen è¿”å›çš„ç¼–ç å™¨å¥æŸ„</div><div class="line">//	inputBuffer: è¾“å…¥ä¿¡æ¯ç¼“å†²åŒº</div><div class="line">//	samplesInput: faacEncOpenç¼–ç åçš„æ•°æ®é•¿åº¦ï¼Œå³ç¼“å†²åŒºé•¿åº¦</div><div class="line">//	outputBuffer: ç¼–ç åè¾“å‡ºä¿¡æ¯ç¼“å†²åŒº</div><div class="line">//	bufferSize: è¾“å‡ºä¿¡æ¯é•¿åº¦</div><div class="line">int FAACAPI faacEncEncode(faacEncHandle hEncoder, int32_t * inputBuffer, unsigned int samplesInput,</div><div class="line">             unsigned char *outputBuffer,</div><div class="line">             unsigned int bufferSize);</div></pre></td></tr></table></figure>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>å¯ä»¥è‡ªå·±æ–°å»ºä¸€ä¸ª iOS å·¥ç¨‹.</p>
<p>å‡†å¤‡å¥½ä¸€ä¸ª <code>wav</code> æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶.</p>
<p>æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="/upload/images/2018/02/16/1.jpg" alt="1"></p>
<p>æ–°å»ºä¸€ä¸ª C++ æ–‡ä»¶, MZCodec.</p>
<blockquote>
<p>MZCodec.hpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#ifndef MZCodec_hpp</div><div class="line">#define MZCodec_hpp</div><div class="line"></div><div class="line">#include &lt;stdio.h&gt;</div><div class="line"></div><div class="line">int codeWAV(const char *srcFilePath,  const char *destPath);</div><div class="line"></div><div class="line">#endif /* MZCodec_hpp */</div></pre></td></tr></table></figure>
<blockquote>
<p>MZCodec.cpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div></pre></td><td class="code"><pre><div class="line">#include &quot;MZCodec.hpp&quot;</div><div class="line"></div><div class="line">#include &quot;faac.h&quot;</div><div class="line">#include &lt;stdio.h&gt;</div><div class="line"></div><div class="line">int codeWAV(const char *srcFilePath,  const char *destPath) &#123;</div><div class="line">    </div><div class="line">    unsigned long nSampleRate   = 44100;//é‡‡æ ·ç‡</div><div class="line">    unsigned int nChannels      = 2;//å£°é“æ•°</div><div class="line">    unsigned int nPCMBitSize    = 16;//å•æ ·æœ¬ä½æ•°</div><div class="line">    </div><div class="line">    unsigned long nInputSamples   = 0;</div><div class="line">    unsigned long nMaxOutputBytes = 0;</div><div class="line">    </div><div class="line">    int nRet;</div><div class="line">    faacEncHandle hEncoder;</div><div class="line">    faacEncConfigurationPtr pConfiguration;</div><div class="line">    </div><div class="line">    size_t nBytesRead;</div><div class="line">    unsigned long nPCMBufferSize;</div><div class="line">    unsigned char *pbPCMBuffer;</div><div class="line">    unsigned char *pbAACBuffer;</div><div class="line">    </div><div class="line">    FILE *fpIn; // WAV file for input</div><div class="line">    FILE *fpOut; // AAC file for output</div><div class="line">    </div><div class="line">    /// è·å– faac ç‰ˆæœ¬ä¿¡æ¯</div><div class="line">    &#123;</div><div class="line">        char *version;</div><div class="line">        char *copyright;</div><div class="line">        faacEncGetVersion(&amp;version, &amp;copyright);</div><div class="line">        printf(&quot;FAAC version: %s, copyright: %s&quot;, version, copyright);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    fpIn = fopen(srcFilePath, &quot;rb&quot;);</div><div class="line">    </div><div class="line">    if (NULL == fpIn) &#123;</div><div class="line">        return -2;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    fpOut = fopen(destPath, &quot;wb&quot;);</div><div class="line">    </div><div class="line">    /// 1. æ‰“å¼€ FAAC</div><div class="line">    hEncoder = faacEncOpen(nSampleRate, nChannels, &amp;nInputSamples, &amp;nMaxOutputBytes);</div><div class="line">    </div><div class="line">    if (NULL == hEncoder) &#123;</div><div class="line">        </div><div class="line">        printf(&quot;[ERROR] Failed to call faacEncOpen()\n&quot;);</div><div class="line">        return -1;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    nPCMBufferSize = nInputSamples * nPCMBitSize / 8;</div><div class="line">    pbPCMBuffer = new unsigned char[nPCMBufferSize];</div><div class="line">    pbAACBuffer = new unsigned char[nMaxOutputBytes];</div><div class="line">    </div><div class="line">    /// 2.1. è·å–å½“å‰çš„ç¼–ç å™¨é…ç½®</div><div class="line">    pConfiguration = faacEncGetCurrentConfiguration(hEncoder);</div><div class="line">    </div><div class="line">    pConfiguration-&gt;inputFormat = FAAC_INPUT_16BIT;</div><div class="line">    // å¯¹è±¡ç±»å‹åªæœ‰ä¸º LOW, iOS çš„ AVAudioPlayer æ‰èƒ½æ’­æ”¾</div><div class="line">    pConfiguration-&gt;aacObjectType = LOW;</div><div class="line">    // 0 = Raw; 1 = ADTS</div><div class="line">    pConfiguration-&gt;outputFormat = 1;</div><div class="line">    pConfiguration-&gt;mpegVersion = MPEG4;</div><div class="line">    pConfiguration-&gt;useTns = 1;</div><div class="line">    pConfiguration-&gt;bitRate = 30;</div><div class="line">    </div><div class="line">    /// 2.2. é…ç½®ç¼–ç å™¨</div><div class="line">    nRet = faacEncSetConfiguration(hEncoder, pConfiguration);</div><div class="line">    </div><div class="line">    //æ˜¯wavæ ¼å¼, å…ˆè¯»å–å‰é¢çš„</div><div class="line">    fseek(fpIn, 58, SEEK_SET);</div><div class="line">    </div><div class="line">    do &#123;</div><div class="line">        </div><div class="line">        //è¯»å…¥çš„å®é™…å­—èŠ‚æ•°ï¼Œæœ€å¤§ä¸ä¼šè¶…è¿‡ nPCMBufferSize</div><div class="line">        nBytesRead = fread(pbPCMBuffer, 1, nPCMBufferSize, fpIn);</div><div class="line">        </div><div class="line">        //è¾“å…¥æ ·æœ¬æ•°ï¼Œç”¨å®é™…è¯»å…¥å­—èŠ‚æ•°è®¡ç®—</div><div class="line">        //ä¸€èˆ¬åªæœ‰è¯»åˆ°æ–‡ä»¶å°¾æ—¶æ‰ä¸æ˜¯ nPCMBufferSize/(nPCMBitSize/8)</div><div class="line">        nInputSamples = nBytesRead / (nPCMBitSize / 8);</div><div class="line">        </div><div class="line">        /// 3. ç¼–ç </div><div class="line">        nRet = faacEncEncode(hEncoder,</div><div class="line">                             (int *)pbPCMBuffer,</div><div class="line">                             (unsigned int)nInputSamples,</div><div class="line">                             pbAACBuffer,</div><div class="line">                             (unsigned int)nMaxOutputBytes);</div><div class="line">        </div><div class="line">        fwrite(pbAACBuffer, 1, nRet, fpOut);</div><div class="line">        </div><div class="line">        printf(&quot;FaacEncEncode returns %d\n&quot;, nRet);</div><div class="line">    &#125; while (nBytesRead &gt; 0);</div><div class="line">    </div><div class="line">    /// 4. å…³é—­ FAAC</div><div class="line">    nRet = faacEncClose(hEncoder);</div><div class="line">    </div><div class="line">    delete[] pbPCMBuffer;</div><div class="line">    delete[] pbAACBuffer;</div><div class="line">    </div><div class="line">    fclose(fpIn);</div><div class="line">    fclose(fpOut);</div><div class="line">    </div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ MZCodec çš„ Controller éœ€è¦å‘½åä¸º <code>.mm</code> æ–‡ä»¶.</p>
<blockquote>
<p>ViewController.mm</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">NSBundle *bundle = [NSBundle mainBundle];</div><div class="line">NSString *resPath = [bundle pathForResource:@&quot;m&quot; ofType:@&quot;wav&quot;];</div><div class="line">NSLog(@&quot;The path of wav file: %@&quot;, resPath);</div><div class="line">    </div><div class="line">NSArray&lt;NSString *&gt; *docPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);</div><div class="line">NSString *destPath = [[docPath lastObject] stringByAppendingString:@&quot;/out.aac&quot;];</div><div class="line">NSLog(@&quot;The path of aac file: %@&quot;, destPath);</div><div class="line">    </div><div class="line">dispatch_async(dispatch_get_global_queue(0, 0), ^&#123;</div><div class="line">    </div><div class="line">    codeWAV([resPath UTF8String], [destPath UTF8String]);</div><div class="line">    </div><div class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">        //è½¬æ¢å®Œæˆ.</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ç¼–ç è¿‡ç¨‹éœ€è¦ç‚¹æ—¶é—´, å¦‚æœæ–‡ä»¶å¾ˆå¤§, æ—¶é—´è¶Šä¹…. æ‰€ä»¥, æ–°å¼€çº¿ç¨‹æ¥è¿›è¡Œç¼–ç .</p>
<p>ç¼–ç å®Œæˆå, å¯åœ¨å¯¹åº”çš„æ²™ç›’ç›®å½•æ‰¾åˆ° <code>out.aac</code> æ–‡ä»¶.</p>
<p>å…·ä½“ä»£ç åœ¨ <a href="https://github.com/veryitman/faacfaad2/tree/master/MZAudioCodec" target="_blank" rel="noopener">Github</a> ä¸Šé¢, æ„Ÿå…´è¶£çš„å¯ä»¥ç‚¹å‡» <a href="https://github.com/veryitman/faacfaad2/tree/master/MZAudioCodec" target="_blank" rel="noopener">å‰å¾€</a>.</p>
<h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>è¿™ä¸ª <code>aacObjectType</code> éœ€è¦æ³¨æ„, ä¹‹å‰æˆ‘åœ¨è¿™é‡ŒæŠ˜è…¾äº†å¾ˆä¹….</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pConfiguration-&gt;aacObjectType = LOW;</div></pre></td></tr></table></figure>
<p>å¦‚æœè®¾ç½®ä¸ºå…¶ä»–ä¸‰ç§, ç¼–ç åçš„ aac æ–‡ä»¶, AVAudioPlayer æ’­æ”¾ä¸äº†, åˆå§‹åŒ– AVAudioPlayer å°±ä¼šæŠ¥é”™, æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹:</p>
<p><img src="/upload/images/2018/02/16/2.jpg" alt="1"></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éŸ³è§†é¢‘ faac faad2 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac/faad2]]></title>
      <url>/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡åˆ†äº«å¦‚ä½•åœ¨ MacOS ä¸Šé¢ç¼–è¯‘ faac å’Œ faad2, ç¼–è¯‘åçš„åº“æ–‡ä»¶å¯ä»¥ç›´æ¥åœ¨ iOS ä¸Šé¢ä½¿ç”¨.</p>
<p>åç»­ä¼šåˆ†äº«å¦‚ä½•ç¼–è¯‘ç»™ Android ä½¿ç”¨çš„åº“æ–‡ä»¶çš„æ–¹æ³•ä»¥åŠå®æˆ˜.</p>
<p><strong>è¯¥ç³»åˆ—åšæ–‡:</strong></p>
<ul>
<li><p><a href="http://www.veryitman.com/2018/02/14/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%BC%96%E8%AF%91-faac-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç¼–è¯‘ faac/faad2</a>(æœ¬ç¯‡)</p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/16/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faac-%E7%BC%96%E7%A0%81/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faac ç¼–ç </a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90-WAV-%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: ç®€å•åˆ†æ WAV æ–‡ä»¶</a></p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/20/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-iOS-%E4%BD%BF%E7%94%A8-faad2/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: iOS ä½¿ç”¨ faad2</a> </p>
</li>
<li><p><a href="http://www.veryitman.com/2018/02/25/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%BC%96%E7%A8%8B-%E6%9E%84%E5%BB%BA-nginx-%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener">éŸ³è§†é¢‘ç¼–ç¨‹: æ„å»º nginx æ¨æµæœåŠ¡å™¨</a></p>
</li>
</ul>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>faad</code> æ˜¯ AAC æ ¼å¼æ–‡ä»¶çš„éŸ³é¢‘è§£ç åº“. ç›¸å¯¹äº FFmpeg æ¥è¯´æ¯”è¾ƒè½»é‡å’Œç®€å•. ç¼–è¯‘å‡ºæ¥å…¨å¹³å°é™æ€åº“æ–‡ä»¶è¾ƒå°, API ä¹Ÿæ¯”è¾ƒç®€å•, ç¼ºç‚¹æ˜¯åŠŸèƒ½å•ä¸€, åªèƒ½å¤„ç† AAC æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶.</p>
<p><code>faac</code> æ˜¯ä¸ä¹‹å¯¹åº”çš„ AAC éŸ³é¢‘ç¼–ç åº“. æ”¯æŒ MPEG-4 å’Œ MPEG-2 çš„AAC ç¼–ç ï¼Œå…¶ç‰¹æ€§åŒ…æ‹¬ï¼šå¯ç§»æ¤æ€§å¥½ï¼Œå¿«é€Ÿï¼Œæ”¯æŒLC/Main/LTPï¼Œé€šè¿‡ Dream æ”¯æŒ DRM.</p>
<p>è¿™ä¸¤ä¸ªåº“è™½ç„¶å¾ˆä¹…æ²¡æœ‰æ›´æ–°äº†, ä½†æ˜¯å…¶åŠŸèƒ½å·²ç»æ»¡è¶³å¾ˆå¤šä¸šåŠ¡åœºæ™¯äº†, å¹¶ä¸”å¾ˆå¥½ç”¨.</p>
<h2 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h2><p>ç‚¹å‡» <a href="http://www.audiocoding.com/downloads.html" target="_blank" rel="noopener">æºç é“¾æ¥</a> å³å¯ä¸‹è½½æºç .</p>
<p><img src="/upload/images/2018/02/14/1.jpg" alt="1"></p>
<h2 id="ç¼–è¯‘-faac"><a href="#ç¼–è¯‘-faac" class="headerlink" title="ç¼–è¯‘ faac"></a>ç¼–è¯‘ faac</h2><p>ä¸‹è½½å®Œæˆå, è§£å‹, å°† <code>faac-1.28</code> æ”¾åˆ°æ–°å»ºç›®å½•  <code>src</code> ä¸‹é¢å³å¯, ç›®å½•ç»“æ„å¦‚ä¸‹:<br><img src="/upload/images/2018/02/14/2.jpg" alt="1"></p>
<p>ä¿®æ”¹ <code>build_faac.sh</code> æƒé™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod +x build_faac.sh</div></pre></td></tr></table></figure>
<p>ç¼–è¾‘ <code>build_faac.sh</code> å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh  </div><div class="line">  </div><div class="line"># http://www.linuxfromscratch.org/blfs/view/svn/multimedia/faac.html  </div><div class="line"># ftp://mirror.ovh.net/gentoo-distfiles/distfiles/  </div><div class="line">  </div><div class="line">major=1  </div><div class="line">minor=28  </div><div class="line">micro=  </div><div class="line"></div><div class="line">XCD_ROOT=&quot;/Applications/Xcode.app/Contents/Developer&quot;  </div><div class="line">TOL_ROOT=&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain&quot;  </div><div class="line">#ä¿®æ”¹ä¸ºæœ€æ–°çš„ sdk ç‰ˆæœ¬</div><div class="line">SDK_ROOT=&quot;/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS11.2.sdk&quot;  </div><div class="line">SDK_SML_ROOT=&quot;/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator11.2.sdk&quot;  </div><div class="line"></div><div class="line">export PATH=$TOL_ROOT/usr/bin:$PATH  </div><div class="line">  </div><div class="line">work=`pwd`  </div><div class="line">srcs=$work/src  </div><div class="line">buid=$work/build  </div><div class="line">insl=$buid/install  </div><div class="line">name=faac-$&#123;major&#125;.$&#123;minor&#125;  </div><div class="line">pakt=$&#123;name&#125;.tar.gz  </div><div class="line">dest=$work/faac-iOS-$&#123;major&#125;.$&#123;minor&#125;.$&#123;micro&#125;.tgz  </div><div class="line">  </div><div class="line">rm -rf $srcs $buid $dest &amp;&amp; mkdir -p $srcs $buid  </div><div class="line"></div><div class="line"> </div><div class="line">archs=&quot;i386 x86_64 armv7 armv7s arm64&quot;  </div><div class="line">  </div><div class="line">for a in $archs; do  </div><div class="line">  case $a in  </div><div class="line">    arm*)  </div><div class="line">      sys_root=$&#123;SDK_ROOT&#125;  </div><div class="line">      host=arm-apple-darwin</div><div class="line">      ;;  </div><div class="line">    i386|x86_64)  </div><div class="line">      sys_root=$&#123;SDK_SML_ROOT&#125;  </div><div class="line">      host=$a-apple-darwin</div><div class="line">      ;;  </div><div class="line">  esac  </div><div class="line">  prefix=$insl/$a &amp;&amp; rm -rf $prefix &amp;&amp; mkdir -p $prefix  </div><div class="line">  rm -rf $srcs &amp;&amp; mkdir -p $srcs &amp;&amp; cd $work &amp;&amp; tar xvzf $pakt -C $srcs &amp;&amp; cd $srcs/$name  </div><div class="line"></div><div class="line">  </div><div class="line">  export CC=&quot;$TOL_ROOT/usr/bin/clang -arch $a -isysroot $sys_root&quot;</div><div class="line">  export CXX=&quot;$TOL_ROOT/usr/bin/clang++ -arch $a -isysroot $sys_root&quot;</div><div class="line">  export CXXFLAGS=&quot;-arch $a -isysroot $sys_root&quot;</div><div class="line">  export CFLAGS=&quot;-arch $a -isysroot $sys_root&quot;</div><div class="line">  export LDFLAGS=&quot;-isysroot $sys_root&quot;</div><div class="line">  export LIBS=&quot;-L$&#123;sys_root&#125;/usr/lib&quot;</div><div class="line"></div><div class="line">  chmod +x bootstrap  </div><div class="line">  ./bootstrap \</div><div class="line">    &amp;&amp;./configure \</div><div class="line">    --host=$host \</div><div class="line">    --with-sysroot=$sys_root \</div><div class="line">    --prefix=$prefix \</div><div class="line">    --disable-shared \</div><div class="line">    --enable-static \</div><div class="line">    --disable-faac \</div><div class="line">    --with-mp4v2 \</div><div class="line">    &amp;&amp;make &amp;&amp; make install</div><div class="line">  lipo_archs=&quot;$lipo_archs $prefix/lib/libfaac.a&quot;</div><div class="line"></div><div class="line">  echo &apos;continue any key pressed..&apos;</div><div class="line">  read -n 1</div><div class="line">done</div><div class="line">  </div><div class="line">univ=$insl/universal &amp;&amp; mkdir -p $univ/lib  </div><div class="line">cp -r $prefix/include $univ/  </div><div class="line">lipo $lipo_archs -create -output $univ/lib/libfaac.a  </div><div class="line">ranlib $univ/lib/libfaac.a  </div><div class="line">strip -S $univ/lib/libfaac.a  </div><div class="line">  </div><div class="line">cd $univ &amp;&amp; tar cvzf $dest *</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œ <code>./build_faac.sh</code>, å¼€å§‹ç¼–è¯‘.</p>
<p>ç¼–è¯‘æˆåŠŸå, ç”Ÿæˆ build ç›®å½•.<br><img src="/upload/images/2018/02/14/3.jpg" alt="1"></p>
<p>å…¶ä¸­, universal ç”Ÿæˆçš„åº“æ˜¯é€šç”¨åº“.</p>
<h2 id="ç¼–è¯‘-faad2"><a href="#ç¼–è¯‘-faad2" class="headerlink" title="ç¼–è¯‘ faad2"></a>ç¼–è¯‘ faad2</h2><p>è§£å‹å, å°† <code>faad2-2.7</code> æ”¹åä¸º <code>faad</code>.</p>
<p>ç¼–å†™ç¼–è¯‘çš„è„šæœ¬æ–‡ä»¶, è¿™é‡Œå–åä¸º <code>build_fadd2.sh</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">touch build_fadd2.sh</div></pre></td></tr></table></figure>
<p>ç¼–è¾‘ <code>build_fadd2.sh</code> æ–‡ä»¶.</p>
<p>å†™å…¥å¦‚ä¸‹å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line"></div><div class="line">CONFIGURE_FLAGS=&quot;--enable-static --with-pic&quot;</div><div class="line"></div><div class="line">ARCHS=&quot;arm64 armv7s armv7 x86_64 i386&quot;</div><div class="line"></div><div class="line"># directories</div><div class="line">SOURCE=&quot;faad&quot;</div><div class="line">FAT=&quot;fat-faad&quot;</div><div class="line"></div><div class="line">SCRATCH=&quot;scratch-faad&quot;</div><div class="line"># must be an absolute path</div><div class="line">THIN=`pwd`/&quot;thin-faad&quot;</div><div class="line"></div><div class="line">COMPILE=&quot;y&quot;</div><div class="line">LIPO=&quot;y&quot;</div><div class="line"></div><div class="line">if [ &quot;$*&quot; ]</div><div class="line">then</div><div class="line">if [ &quot;$*&quot; = &quot;lipo&quot; ]</div><div class="line">then</div><div class="line"># skip compile</div><div class="line">COMPILE=</div><div class="line">else</div><div class="line">ARCHS=&quot;$*&quot;</div><div class="line">if [ $# -eq 1 ]</div><div class="line">then</div><div class="line"># skip lipo</div><div class="line">LIPO=</div><div class="line">fi</div><div class="line">fi</div><div class="line">fi</div><div class="line"></div><div class="line">if [ &quot;$COMPILE&quot; ]</div><div class="line">then</div><div class="line">CWD=`pwd`</div><div class="line">for ARCH in $ARCHS</div><div class="line">do</div><div class="line">echo &quot;building $ARCH...&quot;</div><div class="line">mkdir -p &quot;$SCRATCH/$ARCH&quot;</div><div class="line">cd &quot;$SCRATCH/$ARCH&quot;</div><div class="line"></div><div class="line">if [ &quot;$ARCH&quot; = &quot;i386&quot; -o &quot;$ARCH&quot; = &quot;x86_64&quot; ]</div><div class="line">then</div><div class="line">PLATFORM=&quot;iPhoneSimulator&quot;</div><div class="line">CPU=</div><div class="line">if [ &quot;$ARCH&quot; = &quot;x86_64&quot; ]</div><div class="line">then</div><div class="line">SIMULATOR=&quot;-mios-simulator-version-min=7.0&quot;</div><div class="line">HOST=&quot;--host=x86_64-apple-darwin&quot;</div><div class="line">else</div><div class="line">SIMULATOR=&quot;-mios-simulator-version-min=5.0&quot;</div><div class="line">HOST=&quot;--host=i386-apple-darwin&quot;</div><div class="line">fi</div><div class="line">else</div><div class="line">PLATFORM=&quot;iPhoneOS&quot;</div><div class="line">if [ $ARCH = &quot;armv7s&quot; ]</div><div class="line">then</div><div class="line">CPU=&quot;--cpu=swift&quot;</div><div class="line">else</div><div class="line">CPU=</div><div class="line">fi</div><div class="line">SIMULATOR=</div><div class="line">HOST=&quot;--host=arm-apple-darwin&quot;</div><div class="line">fi</div><div class="line"></div><div class="line">XCRUN_SDK=`echo $PLATFORM | tr &apos;[:upper:]&apos; &apos;[:lower:]&apos;`</div><div class="line">CC=&quot;xcrun -sdk $XCRUN_SDK clang -Wno-error=unused-command-line-argument-hard-error-in-future&quot;</div><div class="line">AS=&quot;$CWD/$SOURCE/extras/gas-preprocessor.pl $CC&quot;</div><div class="line">CFLAGS=&quot;-arch $ARCH $SIMULATOR&quot;</div><div class="line">CXXFLAGS=&quot;$CFLAGS&quot;</div><div class="line">LDFLAGS=&quot;$CFLAGS&quot;</div><div class="line"></div><div class="line">CC=$CC CFLAGS=$CXXFLAGS LDFLAGS=$LDFLAGS CPPFLAGS=$CXXFLAGS CXX=$CC CXXFLAGS=$CXXFLAGS  $CWD/$SOURCE/configure \</div><div class="line">$CONFIGURE_FLAGS \</div><div class="line">$HOST \</div><div class="line">--prefix=&quot;$THIN/$ARCH&quot; \</div><div class="line">--disable-shared \</div><div class="line">--without-mp4v2</div><div class="line"></div><div class="line">make clean &amp;&amp; make &amp;&amp; make install-strip</div><div class="line">cd $CWD</div><div class="line">done</div><div class="line">fi</div><div class="line"></div><div class="line">if [ &quot;$LIPO&quot; ]</div><div class="line">then</div><div class="line">echo &quot;building fat binaries...&quot;</div><div class="line">mkdir -p $FAT/lib</div><div class="line">set - $ARCHS</div><div class="line">CWD=`pwd`</div><div class="line">cd $THIN/$1/lib</div><div class="line">for LIB in *.a</div><div class="line">do</div><div class="line">cd $CWD</div><div class="line">lipo -create `find $THIN -name $LIB` -output $FAT/lib/$LIB</div><div class="line">done</div><div class="line"></div><div class="line">cd $CWD</div><div class="line">cp -rf $THIN/$1/include $FAT</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>ç»™äºˆæ‰§è¡Œæƒé™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod +x build_fadd2.sh</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶ç›®å½•ç»“æ„å¦‚ä¸‹:<br><img src="/upload/images/2018/02/14/4.jpg" alt="1"></p>
<p>æ‰§è¡Œç¼–è¯‘è„šæœ¬, åœ¨å½“å‰ç›®å½•ç”Ÿæˆ <code>scratch-faad</code> å’Œ <code>fat-faad</code> ä»¥åŠ <code>thin-faad</code> ç›®å½•, å¦‚ä¸‹:<br><img src="/upload/images/2018/02/14/5.jpg" alt="1"></p>
<p>ä½¿ç”¨ <code>fat-faad</code> é‡Œé¢çš„åº“å’Œæ–‡ä»¶å³å¯.</p>
<p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹å¯¹åº”çš„ <code>.a</code> æ–‡ä»¶æ‰€æ”¯æŒçš„æ¶æ„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lipo -info libfaad.a</div></pre></td></tr></table></figure>
<p>ä¼šå¾—åˆ°å¯¹åº”çš„è¾“å‡º:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Architectures in the fat file: libfaad.a are: i386 armv7 armv7s arm64</div></pre></td></tr></table></figure>
<p>åŒæ ·å¯ä»¥æŸ¥çœ‹ <code>libfaac.a</code>.</p>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ç¼–è¯‘å¥½çš„æ–‡ä»¶, å·²ç»æ”¾åˆ° github ä¸Šé¢äº†, æœ‰éœ€è¦çš„å¯ä»¥ä¸‹è½½ä½¿ç”¨, ç‚¹å‡» <a href="https://github.com/veryitman/faacfaad2" target="_blank" rel="noopener">ä¸‹è½½é“¾æ¥</a> è¿›å…¥.</p>
<p>æ„Ÿè°¢ <a href="https://github.com/fflydev/faac-ios-build" target="_blank" rel="noopener">fflydev/faac-ios-build</a> æä¾›ç¼–è¯‘ <code>faac</code> çš„ shell, åªéœ€è¦å°†é‡Œé¢å¯¹åº”çš„ SDK æ”¹ä¸ºæœ¬æœºæœ€æ–°çš„ SDK å³å¯.</p>
<h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><ul>
<li><p><a href="http://www.voidcn.com/article/p-ftajkybd-p.html" target="_blank" rel="noopener">faac 1.28çš„äº¤å‰ç¼–è¯‘ä¸é—®é¢˜è§£å†³</a></p>
</li>
<li><p><a href="http://blog.csdn.net/coloriy/article/details/52053144" target="_blank" rel="noopener">ä½¿ç”¨FAADåº“è§£ç AACå®ä¾‹</a></p>
</li>
<li><p><a href="https://magiclen.org/linux-fdk-aac-2/" target="_blank" rel="noopener">åœ¨Linuxä¸Šä½¿ç”¨FDK AACå°‡éŸ³æ¨‚è½‰æˆM4A(AACã€HE-AACã€HE-AACv2)æ ¼å¼</a></p>
</li>
<li><p><a href="https://www.jianshu.com/p/45928cdafde0" target="_blank" rel="noopener">aacæ–‡ä»¶è½¬ç ä¸ºwavæ–‡ä»¶</a></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éŸ³è§†é¢‘ faac faad2 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS å¤šçº¿ç¨‹: åˆæ­¥è®¤è¯†]]></title>
      <url>/2018/02/12/iOS-%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/</url>
      <content type="html"><![CDATA[<p>å‡ ä¹æ¯ä¸ªç¼–ç¨‹è¯­è¨€æˆ–è€…å¹³å°éƒ½ä¼šé‡åˆ°å¤šçº¿ç¨‹çš„é—®é¢˜, è¯´æ˜å¤šçº¿ç¨‹æ˜¯ä¸€ä¸ªéå¸¸é‡è¦ä¸”å¼€å‘è€…å¿…é¡»äº†è§£å’ŒæŒæ¡çš„.</p>
<p>å¤šçº¿ç¨‹ä¹Ÿæ˜¯é¢è¯•å®˜æ¯”è¾ƒå–œæ¬¢é—®çš„é—®é¢˜, ä¾‹å¦‚:</p>
<ul>
<li>è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«, Android æ˜¯å¦æ”¯æŒå¤šè¿›ç¨‹?</li>
<li>çº¿ç¨‹æ± å¦‚ä½•å®ç°çš„?</li>
<li>é”æœºåˆ¶?</li>
<li>å¤šçº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡?</li>
</ul>
<p>è°ˆåŠ iOS ä¸­çš„å¤šçº¿ç¨‹ï¼Œä¸€èˆ¬è¯´çš„æ˜¯ pthreadï¼ŒNSthreadï¼ŒGCDï¼ŒNSOperation è¿™å››ç§, ç”¨çš„æœ€å¤šä¹Ÿæœ€æ–¹ä¾¿çš„å°±æ˜¯ GCD äº†. å…³äºè¿™å››è€…, åç»­ä¼šä¸ºå¤§å®¶ä¸€ä¸€åˆ†äº«.</p>
<p>phtread æ˜¯è·¨å¹³å°çš„, C/C++ ä¸­éƒ½æœ‰å®ƒçš„å£°å½±, GCD å’Œ NSOperation éƒ½æ˜¯å¸¸ç”¨çš„ï¼ŒNSOperation æ˜¯åŸºäº GCD çš„. GCD çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯å°†ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ï¼ŒæŒ‡å®šä»»åŠ¡æ‰§è¡Œçš„æ–¹æ³•ï¼Œç„¶åæ‰§è¡Œ, NSOperation åˆ™æ˜¯ç›´æ¥å°†ä¸€ä¸ªæ“ä½œæ·»åŠ åˆ°é˜Ÿåˆ—ä¸­.</p>
<p>è¯¥ç³»åˆ—æ–‡ç« æ¥è·Ÿå¤§å®¶åˆ†äº«å…³äº iOS ä¸­çš„å¤šçº¿ç¨‹.</p>
<ul>
<li>iOS å¤šçº¿ç¨‹: åˆæ­¥è®¤è¯†(æœ¬ç¯‡)</li>
</ul>
<h2 id="è¿›ç¨‹å’Œçº¿ç¨‹"><a href="#è¿›ç¨‹å’Œçº¿ç¨‹" class="headerlink" title="è¿›ç¨‹å’Œçº¿ç¨‹"></a>è¿›ç¨‹å’Œçº¿ç¨‹</h2><p>è¿›ç¨‹å’Œçº¿ç¨‹çš„å®šä¹‰, å¤§å®¶å¯ä»¥è‡ªè¡Œåˆ°ç»´åŸºç™¾ç§‘ä¸Šé¢å»æŸ¥.</p>
<p>è¿™é‡Œåªè¯´äºŒè€…çš„åŒºåˆ«.</p>
<ul>
<li><p>ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹, ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹å¦‚ä¸»çº¿ç¨‹.</p>
</li>
<li><p>å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜.</p>
</li>
<li><p>è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œå¤šçº¿ç¨‹æ˜¯å…±äº«å†…å­˜çš„ï¼Œä»è€Œæå¤§åœ°æé«˜äº†ç¨‹åºçš„è¿è¡Œæ•ˆç‡.</p>
</li>
<li><p>æ¯ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å…¥å£ã€é¡ºåºæ‰§è¡Œåºåˆ—å’Œç¨‹åºçš„å‡ºå£. çº¿ç¨‹ä¸èƒ½å¤Ÿç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ§åˆ¶.</p>
</li>
<li><p>æ“ä½œç³»ç»Ÿå¹¶æ²¡æœ‰å°†å¤šä¸ªçº¿ç¨‹çœ‹åšå¤šä¸ªç‹¬ç«‹çš„åº”ç”¨, å¤šçº¿ç¨‹çš„æ„ä¹‰åœ¨äºä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰å¤šä¸ªæ‰§è¡Œéƒ¨åˆ†å¯ä»¥åŒæ—¶æ‰§è¡Œ, ä»è€Œå®ç°äº†è¿›ç¨‹çš„è°ƒåº¦å’Œç®¡ç†ä»¥åŠèµ„æºåˆ†é….</p>
</li>
</ul>
<h2 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h2><p>iOS ä¸­, é˜Ÿåˆ—ä¸»è¦åˆ†ä¸º:</p>
<ul>
<li>å…¨å±€é˜Ÿåˆ—</li>
<li>ä¸»é˜Ÿåˆ—.</li>
<li>ä¸²è¡Œé˜Ÿåˆ—.</li>
<li>å¹¶å‘é˜Ÿåˆ—.</li>
</ul>
<blockquote>
<ul>
<li><p>Concurrent:<br>tasks are dequeued in FIFO order, but run concurrently and can finish in any order.</p>
</li>
<li><p>Serial: .<br>tasks execute one at a time in FIFO order</p>
</li>
</ul>
</blockquote>
<p>å¹¶å‘: ä»»åŠ¡ä»¥ FIFO ä»åºåˆ—ä¸­ç§»é™¤ï¼Œç„¶åå¹¶å‘è¿è¡Œï¼Œå¯ä»¥æŒ‰ç…§ä»»ä½•é¡ºåºå®Œæˆ.</p>
<p>ä¸²è¡Œ: ä»»åŠ¡ä»¥FIFOä»åºåˆ—ä¸­ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œ. ä¸€æ¬¡åªè°ƒåº¦ä¸€ä¸ªä»»åŠ¡.</p>
<p>åœ¨ iOS ä¸­, å¹¶å‘ä¸ä¸€å®šä¼šå¼€å¯å¤šä¸ªçº¿ç¨‹, ä¸²è¡Œä¹Ÿä¸ä¸€å®šåªå¼€å¯ä¸€ä¸ªçº¿ç¨‹. å› ä¸ºè¿™é‡Œä¼šç‰µæ‰¯åˆ°æ˜¯å¼‚æ­¥è¿˜æ˜¯åŒæ­¥æ‰§è¡Œ.</p>
<p>ä¸»é˜Ÿåˆ—, å³ mainQueue.</p>
<blockquote>
<p>Returns the default queue that is bound to the main thread.</p>
</blockquote>
<p>ä¼šå…³è”ä¸»çº¿ç¨‹.</p>
<p>å…¨å±€é˜Ÿåˆ—, å³ globalQueue.</p>
<blockquote>
<p>The well-known global concurrent queues may not be modified.</p>
</blockquote>
<p>å…¨å±€é˜Ÿåˆ—ä¸­æ‰§è¡Œä¸ä¸€å®šä¼šå¼€å¯æ–°çº¿ç¨‹.</p>
<h2 id="åŒæ­¥å’Œå¼‚æ­¥"><a href="#åŒæ­¥å’Œå¼‚æ­¥" class="headerlink" title="åŒæ­¥å’Œå¼‚æ­¥"></a>åŒæ­¥å’Œå¼‚æ­¥</h2><p>åœ¨ iOS çš„ GCD ä¸­, è¿˜æœ‰åŒæ­¥å’Œå¼‚æ­¥æ‰§è¡Œçš„åŒºåˆ«.</p>
<blockquote>
<p>åŒæ­¥</p>
</blockquote>
<p>åŒæ­¥æ‰§è¡Œä»£ç å—, è¯¸å¦‚ dispatch_async ä¸­æ‰§è¡Œçš„.</p>
<blockquote>
<p>å¼‚æ­¥</p>
</blockquote>
<p>å¼‚æ­¥æ‰§è¡Œä»£ç å—, è¯¸å¦‚ dispatch_sync ä¸­æ‰§è¡Œçš„.</p>
<h2 id="åˆ›å»ºé˜Ÿåˆ—çš„æ–¹æ³•"><a href="#åˆ›å»ºé˜Ÿåˆ—çš„æ–¹æ³•" class="headerlink" title="åˆ›å»ºé˜Ÿåˆ—çš„æ–¹æ³•"></a>åˆ›å»ºé˜Ÿåˆ—çš„æ–¹æ³•</h2><p><strong>åˆ›å»ºä¸»é˜Ÿåˆ—</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dispatch_queue_t dispatch_get_main_queue(void);</div></pre></td></tr></table></figure>
<p><strong>åˆ›å»ºå…¨å±€é˜Ÿåˆ—</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dispatch_queue_t dispatch_get_global_queue(long identifier, unsigned long flags);</div></pre></td></tr></table></figure>
<p>å‚æ•° identifier ç”¨æ¥è¡¨ç¤ºä¼˜å…ˆçº§. å¯¹åº”çš„ä¼˜å…ˆçº§ä¸º:</p>
<ul>
<li>DISPATCH_QUEUE_PRIORITY_HIG</li>
<li>DISPATCH_QUEUE_PRIORITY_DEFAULT</li>
<li>DISPATCH_QUEUE_PRIORITY_LOW</li>
<li>DISPATCH_QUEUE_PRIORITY_BACKGROUND</li>
</ul>
<p>å¦‚æœä¼ å…¥ 0 æ ‡ç¤º DISPATCH_QUEUE_PRIORITY_DEFAULT.</p>
<p>å‚æ•° flags æ˜¯ä¸€ä¸ªä¿ç•™å‚æ•°, API æ–‡æ¡£è¦æ±‚ä¼ å…¥ 0, é0å€¼å¯èƒ½ä¼šå¯¼è‡´è¿”å›ç»“æœä¸º NULL.</p>
<p><strong>è‡ªå®šä¹‰é˜Ÿåˆ—</strong></p>
<p>dispatch_queue_t dispatch_queue_create(const char *label, dispatch_queue_attr_t attr);</p>
<p>å‚æ•° label æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸².</p>
<p>å‚æ•° attr ç”¨æ¥æ ‡ç¤ºæ˜¯ä¸²è¡Œè¿˜æ˜¯å¹¶è¡Œé˜Ÿåˆ—. å¯ä»¥ä» DISPATCH_QUEUE_SERIAL, DISPATCH_QUEUE_CONCURRENT äºŒè€…ä¸­å–å€¼.</p>
<p>å¦‚æœè¯¥å‚æ•°ä¼ å…¥ NULL, é»˜è®¤æ˜¯ DISPATCH_QUEUE_SERIAL ä¸²è¡Œé˜Ÿåˆ—.</p>
<h2 id="ä¸²è¡Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹"><a href="#ä¸²è¡Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹" class="headerlink" title="ä¸²è¡Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹"></a>ä¸²è¡Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹</h2><p>ä¸²è¡Œé˜Ÿåˆ—åˆ°åº•æ˜¯å¼€äº†ä¸€ä¸ªçº¿ç¨‹, è¿˜æ˜¯å¼€äº†å¤šä¸ªçº¿ç¨‹, æˆ‘ä»¬ä¸€æ¢ç©¶ç«Ÿ.</p>
<p>å…ˆçœ‹ä¾‹å­1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.veryitman&quot;, DISPATCH_QUEUE_SERIAL);</div><div class="line">    </div><div class="line">for (int i=0; i&lt;10; i++) &#123;</div><div class="line">    </div><div class="line">    dispatch_async(serialQueue, ^&#123;</div><div class="line">        NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2018/02/12/1.jpg" alt="1"></p>
<p>å¯ä»¥çœ‹å‡º, åªå¼€å¯ä¸€ä¸ªæ–°çº¿ç¨‹.</p>
<p>å†çœ‹ä¾‹å­2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.veryitman&quot;, DISPATCH_QUEUE_SERIAL);</div><div class="line">    </div><div class="line">dispatch_async(serialQueue, ^&#123;</div><div class="line">    NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</div><div class="line">    sleep(2);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">dispatch_async(serialQueue, ^&#123;</div><div class="line">    NSLog(@&quot;dispatch_sync. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2018/02/12/2.jpg" alt="1"></p>
<p>å¯ä»¥çœ‹å‡º, ä¹Ÿåªå¼€å¯ä¸€ä¸ªæ–°çº¿ç¨‹.</p>
<p>æ”¹é€ ä¸€ä¸‹ä¾‹å­2, å°†å…¶ä¸­çš„ä¸€ä¸ªå¼‚æ­¥æ”¹ä¸ºåŒæ­¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;com.veryitman&quot;, DISPATCH_QUEUE_SERIAL);</div><div class="line">    </div><div class="line">dispatch_async(serialQueue, ^&#123;</div><div class="line">    NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</div><div class="line">    sleep(2);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">dispatch_sync(serialQueue, ^&#123;</div><div class="line">    NSLog(@&quot;dispatch_sync. DISPATCH_QUEUE_SERIAL CurrentThread: %@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2018/02/12/3.jpg" alt="1"></p>
<p>å¯ä»¥çœ‹å‡º, åŒæ­¥çš„æ‰§è¡Œåœ¨ä¸»çº¿ç¨‹, äºŒè€…å¹¶ä¸æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ.</p>
<p>æ‰€ä»¥, ä¸²è¡Œé˜Ÿåˆ—ä¸­æ‰§è¡Œçš„ä»£ç , ä¸ä¸€å®šéƒ½åœ¨å­çº¿ç¨‹ä¸­, å¦‚æœæ˜¯å¼‚æ­¥éƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ.å¦‚æœæ˜¯åŒæ­¥çš„è¯, ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ.</p>
<p><strong>åŒç†, å¹¶è¡Œé˜Ÿåˆ—ä¸­çš„å¼‚æ­¥æ‰§è¡Œä¼šå¼€å¯å¤šä¸ªçº¿ç¨‹æ¥æ‰§è¡Œ.</strong></p>
<h2 id="æ‰§è¡Œæ–¹å¼å’Œé˜Ÿåˆ—"><a href="#æ‰§è¡Œæ–¹å¼å’Œé˜Ÿåˆ—" class="headerlink" title="æ‰§è¡Œæ–¹å¼å’Œé˜Ÿåˆ—"></a>æ‰§è¡Œæ–¹å¼å’Œé˜Ÿåˆ—</h2><p>è¿™é‡Œçš„æ‰§è¡Œæ–¹å¼æŒ‡çš„æ˜¯åŒæ­¥æˆ–è€…å¼‚æ­¥æ‰§è¡Œ.</p>
<p>å…ˆçœ‹å¼‚æ­¥æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">/// å¼‚æ­¥å…¨å±€é˜Ÿåˆ—å’Œä¸»é˜Ÿåˆ—</div><div class="line">    &#123;</div><div class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">            // 1</div><div class="line">            NSLog(@&quot;dispatch_async. mainQueue. isMainThread: %i&quot;, [NSThread isMainThread]);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        dispatch_async(dispatch_get_global_queue(0, 0), ^&#123;</div><div class="line">            // 0</div><div class="line">            NSLog(@&quot;dispatch_async. globalQueue. isMainThread: %i&quot;, [NSThread isMainThread]);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// å¼‚æ­¥ä¸²è¡Œå’Œå¹¶è¡Œé˜Ÿåˆ—</div><div class="line">    &#123;</div><div class="line">        dispatch_async(dispatch_queue_create(&quot;&quot;, DISPATCH_QUEUE_SERIAL), ^&#123;</div><div class="line">            // 0</div><div class="line">            NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_SERIAL. isMainThread: %i&quot;, [NSThread isMainThread]);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        dispatch_async(dispatch_queue_create(&quot;&quot;, DISPATCH_QUEUE_CONCURRENT), ^&#123;</div><div class="line">            // 0</div><div class="line">            NSLog(@&quot;dispatch_async. DISPATCH_QUEUE_CONCURRENT. isMainThread: %i&quot;, [NSThread isMainThread]);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2018/02/12/4.jpg" alt="1"></p>
<p>å†çœ‹åŒæ­¥æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">/// åŒæ­¥å…¨å±€é˜Ÿåˆ—å’Œä¸»é˜Ÿåˆ—</div><div class="line">    &#123;</div><div class="line"></div><div class="line">    #if 0</div><div class="line">        // ä¼šæ­»é”</div><div class="line">        dispatch_sync(dispatch_get_main_queue(), ^&#123;</div><div class="line">            NSLog(@&quot;dispatch_sync. mainQueue. isMainThread: %i&quot;, [NSThread isMainThread]);</div><div class="line">        &#125;);</div><div class="line">    #endif</div><div class="line"></div><div class="line">        dispatch_sync(dispatch_get_global_queue(0, 0), ^&#123;</div><div class="line">            // 1</div><div class="line">            NSLog(@&quot;dispatch_sync. globalQueue. isMainThread: %i&quot;, [NSThread isMainThread]);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// åŒæ­¥ä¸²è¡Œå’Œå¹¶è¡Œé˜Ÿåˆ—</div><div class="line">    &#123;</div><div class="line">        dispatch_sync(dispatch_queue_create(&quot;&quot;, DISPATCH_QUEUE_SERIAL), ^&#123;</div><div class="line">            // 1</div><div class="line">            NSLog(@&quot;dispatch_sync. DISPATCH_QUEUE_SERIAL. isMainThread: %i&quot;, [NSThread isMainThread]);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        dispatch_sync(dispatch_queue_create(&quot;&quot;, DISPATCH_QUEUE_CONCURRENT), ^&#123;</div><div class="line">            // 1</div><div class="line">            NSLog(@&quot;dispatch_sync. DISPATCH_QUEUE_CONCURRENT. isMainThread: %i&quot;, [NSThread isMainThread]);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2018/02/12/5.jpg" alt="1"></p>
<blockquote>
<p>å¾—å‡ºç»“è®º</p>
</blockquote>
<ul>
<li>ä»»ä½•é˜Ÿåˆ—çš„åŒæ­¥æ‰§è¡Œ, éƒ½æ²¡æœ‰å¼€å¯æ–°çº¿ç¨‹, åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ.</li>
<li>ä¸»é˜Ÿåˆ—çš„åŒæ­¥æ‰§è¡Œä¼šé€ æˆæ­»é”.</li>
<li>ä¸»é˜Ÿåˆ—çš„å¼‚æ­¥æ‰§è¡Œ, æ²¡æœ‰å¼€å¯æ–°çº¿ç¨‹. åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ.</li>
<li>ä¸²è¡Œå’Œå¹¶è¡Œä»¥åŠå…¨å±€é˜Ÿåˆ—çš„å¼‚æ­¥æ‰§è¡Œ, éƒ½ä¼šå¼€å¯æ–°çº¿ç¨‹.</li>
</ul>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><p><a href="http://blog.csdn.net/robbyo/article/details/8549904" target="_blank" rel="noopener">è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«</a></p>
</li>
<li><p><a href="http://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html" target="_blank" rel="noopener">è¿›ç¨‹ä¸çº¿ç¨‹çš„ä¸€ä¸ªç®€å•è§£é‡Š</a></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS å¤šçº¿ç¨‹ è¿›ç¨‹ GCD </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[C/C++: å¦‚ä½•ç›¸äº’è°ƒç”¨]]></title>
      <url>/2018/02/12/C-C-%E5%A6%82%E4%BD%95%E7%9B%B8%E4%BA%92%E8%B0%83%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>C++ ä¸­è°ƒç”¨ C æ¯”è¾ƒç®€å•. ä½†æ˜¯ C è°ƒç”¨ C++ ç¨å¾®å¤æ‚ä¸€äº›.</p>
<p>C è°ƒç”¨ C++ åˆ†ä¸ºå¯ä»¥è°ƒç”¨ C++ ç±»ä¸­çš„å‡½æ•°å’Œæ™®é€š cpp ä¸­çš„å‡½æ•°. æ— è®ºæ˜¯å“ªç§å‡½æ•°, æˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨å°è£…äº† C++ çš„æ–‡ä»¶ä½œä¸ºé€‚é…ä¾›ç»™ C æ¥ä½¿ç”¨.</p>
<p>ä¸‹é¢çœ‹å…·ä½“çš„ä¾‹å­.</p>
<h2 id="C-è°ƒç”¨-C"><a href="#C-è°ƒç”¨-C" class="headerlink" title="C++ è°ƒç”¨ C"></a>C++ è°ƒç”¨ C</h2><p>é¦–å…ˆåˆ›å»º CFile.h å’Œ CFile.c æ–‡ä»¶.</p>
<blockquote>
<p>CFile.h</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#ifndef CFile_h</div><div class="line">#define CFile_h</div><div class="line"></div><div class="line">#include &lt;stdio.h&gt;</div><div class="line"></div><div class="line">extern void start_c(int cmd);</div><div class="line"></div><div class="line">#endif /* CFile_h */</div></pre></td></tr></table></figure>
<blockquote>
<p>CFile.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#include &quot;CFile.h&quot;</div><div class="line"></div><div class="line">void start_c(int cmd) &#123;</div><div class="line">    </div><div class="line">    printf(&quot;start_c by cmd: %i\n&quot;, cmd);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ C++ æ–‡ä»¶ä¸­è°ƒç”¨ C ä»£ç , ç¤ºä¾‹å¦‚ä¸‹:</p>
<blockquote>
<p>main.cpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">extern &quot;C&quot; &#123;</div><div class="line">#include &quot;CFile.h&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">int main(int argc, const char * argv[]) &#123;</div><div class="line">    </div><div class="line">    start_c(1);</div><div class="line">    </div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°å¯¼å…¥ C æ–‡ä»¶çš„æ–¹å¼:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">extern &quot;C&quot; &#123;</div><div class="line">#include &quot;CFile.h&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœç›´æ¥å¯¼å…¥, å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#include &quot;CFile.h&quot;</div><div class="line"></div><div class="line">int main(int argc, const char * argv[]) &#123;</div><div class="line">    </div><div class="line">    start_c(1);</div><div class="line">    </div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘æŠ¥é”™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Undefined symbols for architecture x86_64:</div><div class="line">  &quot;start_c(int)&quot;, referenced from:</div><div class="line">      _main in main.o</div><div class="line">ld: symbol(s) not found for architecture x86_64</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ <code>extern &quot;C&quot;</code> å‘Šè¯‰ç¼–è¯‘å™¨, è¦æŒ‰ç…§ C çš„é“¾æ¥çº¦å®šï¼Œè€Œä¸æ˜¯ C++ çš„é“¾æ¥çº¦å®š.</p>
<p>C ç¼–è¯‘å™¨ä¸æ”¯æŒ <code>extern &quot;C&quot;</code>.</p>
<h2 id="C-è°ƒç”¨æ™®é€š-C-çš„å‡½æ•°"><a href="#C-è°ƒç”¨æ™®é€š-C-çš„å‡½æ•°" class="headerlink" title="C è°ƒç”¨æ™®é€š C++ çš„å‡½æ•°"></a>C è°ƒç”¨æ™®é€š C++ çš„å‡½æ•°</h2><p>C è°ƒç”¨ C++ æœ‰ç‚¹æ›²æŠ˜.</p>
<blockquote>
<p>CPPFile.hpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#ifndef CPPFile_hpp</div><div class="line">#define CPPFile_hpp</div><div class="line"></div><div class="line">void start_cpp(int cmd);</div><div class="line"></div><div class="line">#endif /* CPPFile_hpp */</div></pre></td></tr></table></figure>
<blockquote>
<p>CPPFile.cpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#include &quot;CPPFile.hpp&quot;</div><div class="line">#include &lt;iostream&gt;</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line">void start_cpp(int cmd) &#123;</div><div class="line">    </div><div class="line">    cout &lt;&lt; &quot;start_cpp by cmd: &quot; &lt;&lt; cmd &lt;&lt; endl;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œéœ€è¦å†™ä¸€ä¸ªä¸­é—´çš„ cpp(CPPAdapter.cpp)æ–‡ä»¶, æä¾›æ–¹æ³•ç»™ C æ¥ä½¿ç”¨.</p>
<p>æ³¨æ„: è¿™é‡Œæ²¡æœ‰ <code>CPPAdapter.hpp</code> å¤´æ–‡ä»¶.</p>
<blockquote>
<p>CPPAdapter.cpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#include &quot;CPPFile.hpp&quot;</div><div class="line"></div><div class="line">#ifdef __cplusplus</div><div class="line">extern &quot;C&quot; &#123;</div><div class="line">#endif</div><div class="line">    </div><div class="line">    void adapter_start_cpp(int cmd) &#123;</div><div class="line">        </div><div class="line">        //è°ƒç”¨ CPPFile ä¸­çš„æ–¹æ³•</div><div class="line">        start_cpp(cmd);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">#ifdef __cplusplus</div><div class="line">&#125;</div><div class="line">#endif</div></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ C ä¸­è°ƒç”¨ C++ çš„ä»£ç :</p>
<blockquote>
<p>CFile.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#include &quot;CFile.h&quot;</div><div class="line"></div><div class="line">//å£°æ˜å‡½æ•°</div><div class="line">extern void adapter_start_cpp(int cmd);</div><div class="line"></div><div class="line">void start_c(int cmd) &#123;</div><div class="line">        </div><div class="line">    //è°ƒç”¨ c++ ä»£ç </div><div class="line">    adapter_start_cpp(5);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="C-è°ƒç”¨-C-ç±»ä¸­çš„æ–¹æ³•"><a href="#C-è°ƒç”¨-C-ç±»ä¸­çš„æ–¹æ³•" class="headerlink" title="C è°ƒç”¨ C++ ç±»ä¸­çš„æ–¹æ³•"></a>C è°ƒç”¨ C++ ç±»ä¸­çš„æ–¹æ³•</h2><p>å’Œä¸Šé¢ä¾‹å­çš„åŸç†ä¸€æ ·çš„.</p>
<blockquote>
<p>CPPClassFile.hpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">#ifndef CPPClassFile_hpp</div><div class="line">#define CPPClassFile_hpp</div><div class="line"></div><div class="line">#include &lt;iostream&gt;</div><div class="line">#include &lt;string&gt;</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line">class Person &#123;</div><div class="line">private:</div><div class="line">    string name;</div><div class="line">    </div><div class="line">public:</div><div class="line">    Person();</div><div class="line">    ~Person();</div><div class="line">    </div><div class="line">    int setName(string name);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">#endif /* CPPClassFile_hpp */</div></pre></td></tr></table></figure>
<blockquote>
<p>CPPClassFile.cpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">#include &quot;CPPClassFile.hpp&quot;</div><div class="line"></div><div class="line">Person::Person() &#123;</div><div class="line">    </div><div class="line">    cout &lt;&lt; &quot;Person()&quot; &lt;&lt; endl;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Person::~Person() &#123;</div><div class="line">    </div><div class="line">    cout &lt;&lt; &quot;~Person()&quot; &lt;&lt; endl;</div><div class="line">&#125;</div><div class="line"></div><div class="line">int Person::setName(string name) &#123;</div><div class="line">    </div><div class="line">    this-&gt;name = name;</div><div class="line">    </div><div class="line">    cout &lt;&lt; &quot;Set name: &quot; &lt;&lt; name &lt;&lt; endl;</div><div class="line">    </div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>CPPAdapter.cpp</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">#include &quot;CPPFile.hpp&quot;</div><div class="line">#include &quot;CPPClassFile.hpp&quot;</div><div class="line"></div><div class="line">#ifdef __cplusplus</div><div class="line">extern &quot;C&quot; &#123;</div><div class="line">#endif</div><div class="line">    </div><div class="line">    void adapter_start_cpp(int cmd) &#123;</div><div class="line">        </div><div class="line">        //è°ƒç”¨ CPPFile ä¸­çš„æ–¹æ³•</div><div class="line">        start_cpp(cmd);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    int adapter_set_name(const char *cName) &#123;</div><div class="line">        </div><div class="line">        Person *person = new Person();</div><div class="line">        int ret = person-&gt;setName(cName);</div><div class="line">        delete person;</div><div class="line">        </div><div class="line">        return ret;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">#ifdef __cplusplus</div><div class="line">&#125;</div><div class="line">#endif</div></pre></td></tr></table></figure>
<p>åœ¨ C ä¸­å¯ä»¥è°ƒç”¨äº†, å¦‚ä¸‹ä»£ç :</p>
<blockquote>
<p>CFile.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">#include &quot;CFile.h&quot;</div><div class="line"></div><div class="line">///å£°æ˜ CPPFile ä¸­çš„æ–¹æ³•</div><div class="line">extern void adapter_start_cpp(int cmd);</div><div class="line"></div><div class="line">///å£°æ˜ CPPClassFile ä¸­çš„æ–¹æ³•</div><div class="line">extern int adapter_set_name(const char *cName);</div><div class="line"></div><div class="line">void start_c(int cmd) &#123;</div><div class="line">    </div><div class="line">    printf(&quot;start_c by cmd: %i\n&quot;, cmd);</div><div class="line">    </div><div class="line">    //è°ƒç”¨ CPPFile ä¸­çš„æ–¹æ³•</div><div class="line">    adapter_start_cpp(5);</div><div class="line">    </div><div class="line">    //è°ƒç”¨ CPPClassFile ä¸­çš„æ–¹æ³•</div><div class="line">    adapter_set_name(&quot;www.veryitman.com&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="extern-â€œCâ€"><a href="#extern-â€œCâ€" class="headerlink" title="extern â€œCâ€"></a>extern â€œCâ€</h2><p><code>extern &quot;C&quot;</code> ä¸­çš„ â€œCâ€ å¹¶ä¸è¡¨ç¤º C è¯­è¨€ï¼Œâ€Câ€ è¡¨ç¤ºçš„æ˜¯ä¸€ç§é“¾æ¥çº¦å®š.</p>
<p><code>extern &quot;C&quot;</code> æŒ‡ä»¤æè¿°çš„æ˜¯ä¸€ç§é“¾æ¥çº¦å®šï¼Œå®ƒå¹¶ä¸å½±å“è°ƒç”¨å‡½æ•°çš„å®šä¹‰ï¼Œå³ä½¿åšäº†è¯¥å£°æ˜ï¼Œå¯¹å‡½æ•°ç±»å‹çš„æ£€æŸ¥å’Œå‚æ•°è½¬æ¢ä»è¦éµå¾ª C++ çš„æ ‡å‡†ï¼Œè€Œä¸æ˜¯ C çš„æ ‡å‡†.</p>
<p>ä¸åŒçš„ç¼–ç¨‹è¯­è¨€(ç¼–è¯‘å‹)é“¾æ¥ç‰¹æ€§æ˜¯ä¸åŒçš„ï¼Œè¿™ä¹Ÿå†³å®šäº†å®ƒä»¬ç¼–è¯‘åçš„é“¾æ¥ç¬¦å·çš„ä¸åŒ.</p>
<p>å¦‚å‡½æ•° <code>void function(int d)</code>ï¼ŒC è¯­è¨€ä¼šæŠŠå®ƒç¼–è¯‘æˆç±»ä¼¼ <code>_function</code> è¿™æ ·çš„ç¬¦å·ï¼ŒC é“¾æ¥å™¨åªè¦æ‰¾åˆ°è¯¥å‡½æ•°ç¬¦å·å°±å¯ä»¥é“¾æ¥æˆåŠŸ.</p>
<p>C++ ä¼šæŠŠè¿™ä¸ªå‡½æ•°ç¼–è¯‘æˆç±»ä¼¼ <code>_function_int</code> æˆ– <code>_xxx_functionIntxxx</code> è¿™æ ·çš„ç¬¦å·ï¼Œå³åœ¨ç¬¦å·ä¸Šå¢åŠ äº†ç±»å‹ä¿¡æ¯ï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆ C++ å¯ä»¥å®ç°å‡½æ•°é‡è½½äº†.</p>
<p>é‚£ä¹ˆï¼Œå¯¹äºç”¨ C ç¼–è¯‘å™¨ç¼–è¯‘æˆçš„åº“ï¼Œç”¨ C++ ç›´æ¥é“¾æ¥åŠ¿å¿…ä¼šå‡ºç°ä¸èƒ½è¯†åˆ«ç¬¦å·çš„é—®é¢˜ï¼Œç”¨ <code>extern &quot;C&quot;</code> å°±å¯ä»¥è§£å†³, æ­£å¦‚ä¸Šé¢çš„ä¾‹å­.</p>
<p>ç®€å•æ¥è¯´, <code>extern &quot;C&quot;</code> çš„ä½œç”¨å°±æ˜¯è®©ç¼–è¯‘å™¨çŸ¥é“è¦ä»¥ C è¯­è¨€çš„æ–¹å¼ç¼–è¯‘å’Œé“¾æ¥å‡½æ•°.</p>
<h2 id="cplusplus-å®"><a href="#cplusplus-å®" class="headerlink" title="__cplusplus å®"></a>__cplusplus å®</h2><p><code>__cplusplus</code> å®æ˜¯ C++ ç¼–è¯‘å™¨é»˜è®¤å®šä¹‰çš„.</p>
<p>ç±»ä¼¼å¦‚ä¸‹çš„ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#ifdef __cplusplus</div><div class="line">extern &quot;C&quot;&#123;</div><div class="line">#endif</div><div class="line"></div><div class="line">void fun(int, size_t);</div><div class="line"></div><div class="line">#ifdef __cplusplus</div><div class="line">&#125;</div><div class="line">#endif</div></pre></td></tr></table></figure>
<p>åœ¨ C++ ä¸­, ç¼–è¯‘å™¨å°† fun æŒ‰ç…§ C çš„é“¾æ¥çº¦å®šæ¥ç¼–è¯‘, è€Œå¦‚æœæ˜¯ C ç¼–è¯‘å™¨, ç›´æ¥æŒ‰ç…§ C çš„é“¾æ¥çº¦å®šæ¥ç¼–è¯‘å³å¯.</p>
<p><code>__cplusplus</code> æ˜¯åœ¨ C++ ç¼–è¯‘å™¨ä¸­é»˜è®¤å®šä¹‰çš„,ï¼£è¯­è¨€ä¸æ”¯æŒ <code>extern &quot;ï¼£&quot;</code>.</p>
<p>ä¸Šé¢çš„ä»£ç å¾ˆå®ç”¨, ä¹Ÿæ˜¯ä¸€ç§ç¼–ç¨‹æŠ€å·§.</p>
]]></content>
      
        <categories>
            
            <category> C/C++ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> C C++ ç¼–ç¨‹è¯­è¨€ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS APNs: Background Fetch]]></title>
      <url>/2018/02/08/iOS-APNs-Background-Fetch/</url>
      <content type="html"><![CDATA[<p>åœ¨å‰é¢çš„å‡ ç¯‡æ–‡ç« ä¸­, ç»™å¤§å®¶ä»‹ç»äº†è·Ÿæ¨é€ç›¸å…³çš„å†…å®¹.</p>
<p>ä»Šå¤©è·Ÿå¤§å®¶èŠä¸€èŠ iOS7 æ–°åŠ å…¥çš„ <code>Background Fetch</code> åŠŸèƒ½.</p>
<p>è¯¥ç³»åˆ—åšå®¢:</p>
<blockquote>
<p><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: è¿œç¨‹æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: æœ¬åœ°æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/" target="_blank" rel="noopener">iOS APNs: å¤„ç†æ•°æ®</a><br><a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: é™é»˜æ¨é€</a><br>iOS APNs: Background Fetch(æœ¬ç¯‡)</p>
</blockquote>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ä» <code>Background Fetch</code> å­—é¢ä¸Šæ¥çœ‹, å¤§è‡´æ„æ€æ˜¯å¯åœ¨åå°è·å–æ•°æ®.</p>
<p>åœ¨ iOS7 ä¸­ï¼ŒApple ä¸ºå¼€å‘è€…æä¾›äº†å¯ä»¥åœ¨åå°æ›´æ–°åº”ç”¨ç¨‹åºç•Œé¢å’Œå†…å®¹çš„ API, å³ <code>Background Fetch</code>.</p>
<p>è¯¥ç‰¹æ€§å…è®¸å¼€å‘è€…åœ¨ä¸€ä¸ªå‘¨æœŸé—´éš”åè¿›è¡Œç‰¹å®šçš„åŠ¨ä½œï¼Œå¦‚è·å–ç½‘ç»œå†…å®¹, æ›´æ–° UI æ“ä½œç­‰.</p>
<p>åŒæ—¶åœ¨ iOS7 ä¸­, ä¹ŸåŠ å…¥äº†å¦ä¸€ä¸ªç‰¹æ€§, å°±æ˜¯åšæ–‡ <a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: é™é»˜æ¨é€</a> é‡Œé¢è¯´çš„é™é»˜æ¨é€.</p>
<p>è¿™äº›éƒ½æ˜¯å¯¹ iOS åå°å¤šä»»åŠ¡çš„è¡¥å……å’Œå®Œå–„, Apple ä¸€ç›´åœ¨ä¼˜åŒ–ç³»ç»Ÿä»è€Œå¢å¼ºç”¨æˆ·ä½“éªŒ.</p>
<h2 id="å¼€å¯-Background-Fetch"><a href="#å¼€å¯-Background-Fetch" class="headerlink" title="å¼€å¯ Background Fetch"></a>å¼€å¯ Background Fetch</h2><p><strong>1.éœ€è¦ APP æ”¯æŒ</strong></p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤º, å‹¾é€‰å³å¯.</p>
<p><img src="/upload/images/2018/02/08/1.png" alt="1"></p>
<p><strong>2.è®¾ç½® fetch æ—¶é—´é—´éš”</strong></p>
<p>åœ¨ AppDelegate ä¸­è®¾ç½®.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; </div><div class="line"></div><div class="line">    // è®¾ç½® fetch æ—¶é—´é—´éš”</div><div class="line">    [application setMinimumBackgroundFetchInterval:UIApplicationBackgroundFetchIntervalMinimum];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>UIApplicationBackgroundFetchIntervalMinimum</code> æ˜¯ç³»ç»Ÿè‡ªå®šä¹‰çš„æ—¶é—´. å¦‚æœä¸è®¾ç½®, é»˜è®¤æ˜¯ <code>UIApplicationBackgroundFetchIntervalNever</code>, è¿™æ ·å°±ä¸ä¼šè®© <code>Background Fetch</code> ç”Ÿæ•ˆäº†.</p>
<p>å¯ä»¥æŸ¥çœ‹å¯¹ UIApplicationBackgroundFetchIntervalNever çš„å®˜æ–¹è§£é‡Š.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">UIApplicationBackgroundFetchIntervalNever</div><div class="line"></div><div class="line">A fetch interval large enough to prevent fetch operations from occurring.</div></pre></td></tr></table></figure>
<p>å½“ç„¶, ä½ ä¹Ÿå¯ä»¥è®¾ç½®è‡ªå·±å®šä¹‰çš„æ—¶é—´çš„é—´éš”, ä½†æ˜¯åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆä½œç”¨, å› ä¸ºè¿™ä¸ªæ—¶é—´é—´éš”å®Œå…¨ç”±ç³»ç»Ÿæ¥å†³å®š, ç³»ç»Ÿä¼šæ ¹æ®ä½ çš„ç”µé‡ä»¥åŠä½¿ç”¨é¢‘ç‡æ¥å†³å®š.</p>
<p>æ‰€ä»¥, å¯ä»¥ç†è§£ä¸º <code>setMinimumBackgroundFetchInterval</code> æ–¹æ³•åªæ˜¯å¼€å¯äº† <code>Background Fetch</code> åŠŸèƒ½.</p>
<p><strong>3.å¼€å¯äº†ç³»ç»Ÿåå°æ›´æ–°åŠŸèƒ½</strong></p>
<p>åœ¨ iOS ç³»ç»Ÿä¸­, è®¾ç½®/é€šç”¨/åå°åº”ç”¨åˆ·æ–°ä¸­ä¸€å®šè¦å¼€å¯å¯¹åº” APP çš„åŠŸèƒ½.</p>
<p>åˆ¤æ–­æ˜¯å¦å·²ç»å¼€å¯è¯¥åŠŸèƒ½çš„ç¤ºä¾‹ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if ([[UIApplication sharedApplication] backgroundRefreshStatus] != UIBackgroundRefreshStatusAvailable) &#123;</div><div class="line"></div><div class="line">    //ä¸å¯ç”¨æç¤ºç”¨æˆ·</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å¤„ç†å›è°ƒ"><a href="#å¤„ç†å›è°ƒ" class="headerlink" title="å¤„ç†å›è°ƒ"></a>å¤„ç†å›è°ƒ</h2><p>åœ¨å®é™…çš„åº”ç”¨ç¯ä¸­ï¼Œ<code>Background Fetch</code> äº‹ä»¶æ˜¯ç”±ç³»ç»Ÿç®¡ç†çš„ï¼Œæˆ‘ä»¬å¼€å‘è€…æ˜¯æ— æ³•é¢„å…ˆçŸ¥é“ Fetch äº‹ä»¶è¾¾åˆ°çš„æ—¶æœºçš„. </p>
<p>ç½‘ä¸Šå¾ˆå¤šè¯´å¯ä»¥ä½¿ç”¨ Xcode æ¨¡æ‹Ÿè¿™ä¸ªäº‹ä»¶, ä¼°è®¡ä¹Ÿæ˜¯ä¹‹å‰çš„ç³»ç»Ÿå’Œ Xcode ç‰ˆæœ¬, ç°åœ¨çš„ Xcode9 è²Œä¼¼ä¸è¡Œäº†.</p>
<p>ä½†æ˜¯, ä½ çš„æ‰‹æœºåœ¨åå°ç­‰å‡ åˆ†é’Ÿ, æœ‰æ—¶å€™ä¼šè¢«ç³»ç»Ÿè§¦å‘è¯¥äº‹ä»¶, è§¦å‘å, å¯¹åº”çš„ç³»ç»Ÿå›è°ƒ(åœ¨ AppDelegate ä¸­)ä¼šè¢«è°ƒç”¨.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// Background fetch å›è°ƒ</div><div class="line">- (void)application:(UIApplication *)application</div><div class="line">performFetchWithCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;AppDelegate. Background fetch.&quot;);</div><div class="line">    </div><div class="line">    //å¯è¿›è¡Œå¯¹åº”çš„è€—æ—¶æ“ä½œ, å¦‚ä¸‹è½½ç­‰.</div><div class="line">    </div><div class="line">    completionHandler(UIBackgroundFetchResultNoData);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>Background Fetch</code> ä¼šä¸ºæˆ‘ä»¬çš„ App äº‰å–æ›´å¤šçš„åå°æ—¶é—´, ä½†æ˜¯ä¸€èˆ¬æ˜¯å‡ åç§’å·¦å³, ä¸ä¼šå¤ªå¤š. æ‰€ä»¥, ä¸è¦åœ¨å›è°ƒä¸­åšå¤ªå¤šè€—æ—¶çš„æ“ä½œ.</p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> APNs è¿œç¨‹æ¨é€ BackgroundFetch </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS APNs: é™é»˜æ¨é€]]></title>
      <url>/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©è·Ÿå¤§å®¶ä»‹ç»ä¸€ä¸‹ ios çš„é™é»˜æ¨é€åŠŸèƒ½.</p>
<p>é™é»˜æ¨é€, ç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡æ¨é€å®ç°ç”¨æˆ·æ— æ„ŸçŸ¥çš„æ¶ˆæ¯é€šçŸ¥.</p>
<p>è¯¥ç³»åˆ—åšæ–‡:</p>
<blockquote>
<p><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: è¿œç¨‹æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: æœ¬åœ°æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/" target="_blank" rel="noopener">iOS APNs: å¤„ç†æ•°æ®</a><br>iOS APNs: é™é»˜æ¨é€(æœ¬ç¯‡)</p>
</blockquote>
<h2 id="æ™®é€šæ¨é€"><a href="#æ™®é€šæ¨é€" class="headerlink" title="æ™®é€šæ¨é€"></a>æ™®é€šæ¨é€</h2><p>ä¾‹å¦‚å¾®ä¿¡, å¥½å‹ç»™ä½ å‘é€äº†ä¸€æ¡æ¶ˆæ¯, ä½ çš„å¾®ä¿¡APP åœ¨åå°, æ­¤æ—¶ä¼šæ”¶åˆ°å¸¦å£°éŸ³çš„ä¸€ä¸ªæ¶ˆæ¯æç¤º.</p>
<p>è¿™æ¡æ¨é€æœºæ²¹æœ‰æ–‡å­—åˆæœ‰å£°éŸ³, ç‚¹å¼€è¿™ä¸ªæ¨é€å¯ä»¥ç›´æ¥æ‰“å¼€ APP.</p>
<p>ä»ç¨‹åºçš„è§’åº¦æ¥è®², è¿›å…¥ App åä¼šè°ƒç”¨ä¸‹é¢çš„æ–¹æ³•:</p>
<p>iOS10.0.x å’Œå…¶ä¹‹å‰çš„ç³»ç»Ÿè°ƒç”¨ä¸‹é¢çš„æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo</div></pre></td></tr></table></figure>
<p>iOS10.0.x ä¹‹åçš„ç³»ç»Ÿ, ä¼šè°ƒç”¨å¦‚ä¸‹çš„æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application</div><div class="line">                    didReceiveRemoteNotification:(NSDictionary *)userInfo</div><div class="line">                    fetchCompletionHandler:(void (^)(UIBackgroundFetchResult result))completionHandler</div></pre></td></tr></table></figure>
<h2 id="é™é»˜æ¨é€çš„å¼‚åŒ"><a href="#é™é»˜æ¨é€çš„å¼‚åŒ" class="headerlink" title="é™é»˜æ¨é€çš„å¼‚åŒ"></a>é™é»˜æ¨é€çš„å¼‚åŒ</h2><p><strong>1.æ²¡æœ‰å¼¹å‡ºæ¡†</strong></p>
<p>æ²¡æœ‰æ¨é€çš„å¼¹æ¡†å‡ºç°, ç”¨æˆ·æ¯«æ— æ„ŸçŸ¥çš„æ¥æ”¶åˆ°äº†è¿™ä¸ªæ¨é€æ¶ˆæ¯. æœ‰ <code>æ¶¦ç‰©ç»†æ— å£°</code> çš„æ„Ÿè§‰.</p>
<p>è¯¥æ¨é€æ—¢æ²¡æœ‰æ–‡å­—åˆæ²¡æœ‰å£°éŸ³.</p>
<p><strong>2.éœ€è¦ç”¨æˆ·æˆæƒå…è®¸æ¨é€</strong></p>
<p>è¿™ä¸ªè·Ÿæ™®é€šæ¨é€ä¸€æ ·, éƒ½éœ€è¦ç”¨æˆ·æˆæƒæ‰å¯ä»¥æ¨é€.</p>
<p><strong>3.ä¼šæ‰§è¡Œä»£ç†æ–¹æ³•</strong></p>
<p>é™é»˜æ¨é€æ¥çš„æ—¶å€™, ä¹Ÿèƒ½æ‰§è¡Œä¸Šé¢çš„å›è°ƒæ–¹æ³•. æ‰§è¡Œä¸Šé¢æ–¹æ³•çš„åœºæ™¯å¦‚ä¸‹::</p>
<blockquote>
<p>1.App åœ¨å‰å°.<br>2.App åœ¨åå°, ä½†æ˜¯æ²¡æœ‰è¢« kill æ‰.</p>
</blockquote>
<p><strong>4.iOS7 ä»¥åæ‰æœ‰çš„</strong></p>
<p>å¯¹äº iOS ä¹‹å‰æ˜¯æ²¡æœ‰é™é»˜æ¨é€çš„.</p>
<p><strong>5.å¯ä»¥å»¶é•¿åå°æ—¶é—´</strong></p>
<p>æ”¶åˆ°é™é»˜æ¨é€å, åœ¨åº”ç”¨ç¨‹åºæŒ‚èµ·ä¹‹å‰æœ‰ 30 ç§’å·¦å³å¯ä»¥æ‰§è¡Œç›¸å…³çš„æ“ä½œ.</p>
<p>6.æ¨é€é¢‘ç‡çš„æ§åˆ¶</p>
<p>é™é»˜çš„æ¨é€æ˜¯è‹¹æœæ¨é€æœåŠ¡å™¨æ§åˆ¶æ¨é€é¢‘ç‡çš„.</p>
<p>è‹¹æœæ¨é€æœåŠ¡æ ¹æ®åå°æ¨é€ä»»åŠ¡çš„èƒ½è€—(ç”¨ç”µé‡,æ¥æ”¶æƒ…å†µ)æ¥æ§åˆ¶åå°æ¨é€çš„æ¨é€é¢‘ç‡å’Œå»¶è¿Ÿæ—¶é—´.</p>
<hr>
<p><strong>æ€»ä¹‹</strong>, é™é»˜æ¨é€æ˜¯æ™®é€šæ¨é€çš„ä¸€ç§å˜ç§è€Œå·². </p>
<p>æ— è®ºæ˜¯é™é»˜æ¨é€è¿˜æ˜¯æ™®é€šæ¨é€, å¼€å‘è€…è¯ä¹¦é‡Œé¢å¿…é¡»å¼€é€š push ç›¸å…³çš„åŠŸèƒ½, å¹¶ä¸”ä¹Ÿéœ€è¦ç”¨æˆ·å¼€å¯å…è®¸æ¨é€çš„æˆæƒ.</p>
<p>è¿™ä¸ªåœ¨ <a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: è¿œç¨‹æ¨é€</a> é‡Œé¢å·²ç»ä»‹ç»è¿‡, ä¸åœ¨è¿™é‡Œèµ˜è¿°.</p>
<h2 id="æ¨é€çš„æ ¼å¼"><a href="#æ¨é€çš„æ ¼å¼" class="headerlink" title="æ¨é€çš„æ ¼å¼"></a>æ¨é€çš„æ ¼å¼</h2><p>æ™®é€šæ¨é€çš„æ ¼å¼, å¤§è‡´æ˜¯è¿™ä¸ªæ ·å­:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;aps&quot;:</div><div class="line">        &#123;</div><div class="line">            &quot;alert&quot;:&quot;Testing.. (15),</div><div class="line">            &quot;badge&quot;:1,</div><div class="line">            &quot;sound&quot;:&quot;default&quot;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é™é»˜æ¨é€æ˜¯ä¸å…è®¸å¸¦ <code>alert</code> <code>badge</code>  <code>sound</code> ç­‰å­—æ®µçš„. ä½†æ˜¯å¿…é¡»åŒ…å« <code>&quot;content-available&quot;:1</code>.</p>
<p>ä¾‹å¦‚ä¸‹é¢çš„å½¢å¼éƒ½å¯ä»¥:</p>
<blockquote>
<p>å½¢å¼1</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;aps&quot;:</div><div class="line">        &#123;</div><div class="line">            &quot;content-available&quot;:1</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>å½¢å¼2</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;aps&quot;:</div><div class="line">        &#123;</div><div class="line">            &quot;custom&quot;:&quot;open_profile_page&quot;</div><div class="line">            &quot;content-available&quot;:1</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­, custom æ˜¯è‡ªå·±å®šä¹‰çš„, å¤§å®¶æ ¹æ®éœ€æ±‚è‡ªè¡Œæ‰©å±•å³å¯.</p>
<blockquote>
<p>å½¢å¼3</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;aps&quot; : &#123;</div><div class="line">        &quot;content-available&quot; : 1</div><div class="line">    &#125;,</div><div class="line">    &quot;acme1&quot; : &quot;bar&quot;,</div><div class="line">    &quot;acme2&quot; : 42</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ¥è‡ªè‹¹æœå¼€å‘è€… <a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html" target="_blank" rel="noopener">æ–‡æ¡£</a>.</p>
<h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>å…·ä½“çš„ä½¿ç”¨åœºæ™¯, éœ€è¦ç»“åˆæœ¬èº«çš„ä¸šåŠ¡å’ŒåŠŸèƒ½ç‰¹ç‚¹æ¥è¯´.</p>
<p>é™é»˜æ¨é€çš„å‰ææ˜¯ APP æ²¡æœ‰è¢«æ€æ­», å¯ä»¥é€šè¿‡å›è°ƒå‡½æ•°æ¥æ‰§è¡Œç›¸å…³çš„ä»£ç .</p>
<p>å¦å¤–, é™é»˜æ¨é€ä¸ä¼šæ‰“æ‰°ç”¨æˆ·, æ¯”å¦‚ç”¨æˆ·æ­£åœ¨æ¸¸æˆä¸­æˆ˜æ–—, ä½ é¢‘ç¹çš„ä½¿ç”¨æ™®é€šæ¨é€ç»™ä»–, ä¼°è®¡ä»–éƒ½è¦ç–¯äº†. </p>
<p>æˆ‘ä¸ªäººä½¿ç”¨é™é»˜æ¨é€çš„åœºæ™¯å¤§è‡´æ˜¯è¿™æ ·çš„, APP å°†è¦æŒ‚èµ·çš„æ—¶å€™, è¯·æ±‚æœåŠ¡å™¨å»å‘ä¸€æ¡é™é»˜æ¨é€, ç„¶åä½¿ç”¨æœ¬åœ°é€šçŸ¥çš„æ–¹å¼å”¤èµ·ç”¨æˆ·æ¥æ‰“å¼€ APP, ä»è€Œä¿è¯ APP å¤„äºä¿æ´»çš„çŠ¶æ€, è‡³å°‘é™é»˜æ¨é€å¯ä»¥å¢åŠ åå°æŒ‚èµ·çš„æ—¶é—´.</p>
<p>å…³äºæœ¬åœ°é€šçŸ¥çš„å†…å®¹, å¯ä»¥å‚è€ƒä¹‹å‰çš„æ–‡ç«  <a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: æœ¬åœ°æ¨é€</a>.</p>
<p>æ›´å¤šçš„ä½¿ç”¨åœºæ™¯ç­‰å¤§å®¶åœ¨ä¸šåŠ¡ä¸­å»æŒ–æ˜.</p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> APNs æ¨é€ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hi 2018, æˆ‘åˆæ¥äº†]]></title>
      <url>/2018/02/02/Hi-2018-%E6%88%91%E5%8F%88%E6%9D%A5%E4%BA%86/</url>
      <content type="html"><![CDATA[<p>å¥½ä¹…æ²¡æœ‰æ›´æ–°è‡ªå·±çš„åšå®¢äº†, ä»¥å‰åšæŒä¸€å‘¨è‡³å°‘ä¸¤ä¸‰ç¯‡åšæ–‡çš„æˆ‘, ä» 2017 å¹´ 10 æœˆä»½åˆ°ç°åœ¨å±…ç„¶åœæ­¢äº†. </p>
<p>å…¶å®, è¿™æ˜¯æœ‰åŸå› çš„â€¦</p>
<h2 id="æ•°æ®ä¸¢äº†"><a href="#æ•°æ®ä¸¢äº†" class="headerlink" title="æ•°æ®ä¸¢äº†"></a>æ•°æ®ä¸¢äº†</h2><p>2017 å¹´ 10 æœˆ 15 æ—¥æ™š, æˆ‘äº²æ‰‹æŠŠè‡ªå·±çš„ä¹‹å‰å†™çš„æ–‡ç« (åŸæ•°æ®)ç»™å¼„ä¸¢äº†. æˆ‘è‡ªå·±æ­å»ºçš„åšå®¢ç³»ç»Ÿæ˜¯ä½¿ç”¨ GitHub + Hexo éƒ¨ç½²å’Œå‘å¸ƒçš„.</p>
<p>äº‹æƒ…å¤§è‡´ç»è¿‡æ˜¯è¿™æ ·çš„â€¦</p>
<p>Mac æ“ä½œç³»ç»Ÿæç¤º, æœ‰æ›´æ–°çš„ç³»ç»Ÿå¯ä»¥ä½¿ç”¨äº†, é—®æ˜¯å¦ç«‹å³å®‰è£…, åœ¨å…¬å¸çš„æ—¶å€™, æˆ‘å¿ƒæƒ³, æ›´æ–°å, è‡ªå·±å®‰è£…çš„ä¸€äº›åº“, ä¼°è®¡ä¹Ÿè¦é‡æ–°å®‰è£…, å«Œéº»çƒ¦å°±ç›´æ¥è·³è¿‡äº†.</p>
<p>è¿‡äº†å‡ å¤©, æˆ‘æ™šä¸Šä¸‹ç­å›å®¶, ç³»ç»Ÿåˆæç¤ºæˆ‘æ›´æ–°. å½“æ—¶, æˆ‘å°±æ²¡æœ‰å¿ä½, ç›´æ¥æ›´æ–°äº†, æ¯•ç«Ÿæ—©æ™šéƒ½è¦æ›´æ–°çš„, å†è¯´äº† MacOS è¿˜æ˜¯æ¯”è¾ƒè®©äººæ”¾å¿ƒçš„.</p>
<p>è¶ç”µè„‘æ›´æ–°ç³»ç»Ÿçš„æ—¶å€™, æˆ‘å°±å»æ´—äº†æ¾¡, å›æ¥å‘ç°ç³»ç»Ÿæ›´æ–°å·²ç»å®Œæˆäº†. </p>
<p>å¿ƒä¸­æƒ³æ­£å¥½å¯ä»¥æŠŠä¹‹å‰æ²¡æœ‰å®Œæˆçš„åšå®¢å»å®Œå–„ä¸€ä¸‹, è°çŸ¥é“â€¦å¤©ä¸é‚æˆ‘æ„¿å‘€! å†å»ä½¿ç”¨ Hexo çš„æ—¶å€™, æç¤ºæˆ‘å¤±è´¥, å±…ç„¶æ— æ³•ä½¿ç”¨äº†. è¿™å¯æŠŠæˆ‘æ€¥çš„å¤Ÿå‘›, ä¸€æ°”ä¹‹ä¸‹(è„‘å­ä¼°è®¡å½“æ—¶è¿›æ°´äº†), ç›´æ¥åˆ äº† Hexo ç›®å½•, æ˜¯é‚£ç§ç¨‹åºå‘˜å¼çš„æ¯«ä¸ç•™æƒ…çš„åˆ é™¤.</p>
<pre><code>rm -fr ./hexo
</code></pre><p>æ½‡æ´’çš„æ“ä½œå, é‡æ–°å®‰è£… Hexo, åˆæŠ˜è…¾äº†ä¸¤ä¸ªæ™šä¸Š, æœ€ç»ˆä¹Ÿæ˜¯å®‰è£…å¥½äº†, å¯ä»¥å†™ä¸œä¸œäº†.</p>
<p>ä½†æ˜¯å‘ç°ä» Github ä¸Šé¢ clone åçš„æ–‡ä»¶, æ— æ³•è¿˜åŸæˆè‡ªå·±å½“åˆçš„ MarkDown æ–‡ä»¶äº†.</p>
<p>é›ªèŠ±é‚£ä¸ªé£˜å•Šé£˜, åŒ—é£é‚£ä¸ªè§å‘€è§â€¦</p>
<p>ä¸€åˆ‡éƒ½æ™šäº†! ^^</p>
<p>å”¯ä¸€å€¼å¾—åº†å¹¸çš„æ˜¯, åŸæ¥è‡ªå·±çš„ç½‘ç«™åšæ–‡è¿˜åœ¨é‚£é‡Œ.</p>
<h2 id="è¿˜åŸæ•°æ®"><a href="#è¿˜åŸæ•°æ®" class="headerlink" title="è¿˜åŸæ•°æ®"></a>è¿˜åŸæ•°æ®</h2><p>ä»å“ªé‡Œè·Œå€’, å°±ä»å“ªé‡Œçˆ¬èµ·æ¥, æˆ‘å†³å®šæŠŠä¹‹å‰çš„æ•°æ®ä½¿ç”¨ <code>äººå·¥æ™ºèƒ½</code> çš„æ–¹å¼è¿˜åŸå›æ¥.</p>
<p>ğŸ˜†æˆ‘å°±æ˜¯é‚£ä¸ª <code>äººå·¥</code>, æ‰‹åŠ¨çš„å°† HTML è½¬æ¢ä¸º MarkDown æ–‡æ¡£, å‹æ ¹æ²¡æœ‰ä»€ä¹ˆ <code>æ™ºèƒ½</code>.</p>
<p>å¥½æ­¹é‚£ä¹Ÿæ˜¯è‡ªå·±ç†¬è¿‡å¤šå°‘ä¸ªæ—¥å¤œçš„æˆæœå‘€, æ²¡æœ‰åŠŸåŠ³ä¹Ÿæœ‰è‹¦åŠ³, æˆ‘ä¸å¿å¿ƒå°±è¿™æ ·è®©å®ƒä¸¢æ‰, å«ç€æ³ªä¹Ÿè¦æŠŠå®ƒä»¬ç»™æ‰¾å›æ¥!</p>
<p>è‡ªå·±ä¸‹åŠå¹´ä¹Ÿæ¯”è¾ƒå¿™, å‘¨æœ«éƒ½åœ¨åŠ ç­, åªèƒ½æ¯å¤©æ™šä¸Šå›å®¶æŠ½äº›æ—¶é—´è¿˜åŸä¸€ç‚¹, æœ‰æ—¶å€™å¤ªå›°, å°±æ¨è¿Ÿåˆ°ä¸‹ä¸ªæ™šä¸Š. å¤§æ¦‚ç”¨äº† 3 ä¸ªæœˆå·¦å³çš„æ—¶é—´, åŸºæœ¬è¿˜åŸå›æ¥äº†. </p>
<p>æ¯ç¯‡æ–‡ç« åŸºæœ¬éƒ½æœ‰é…å›¾, éƒ½æœ‰è·³è½¬é“¾æ¥, æ¢å¤èµ·æ¥, è¿˜æ˜¯éœ€è¦ä¸€ç‚¹æ—¶é—´å’Œæ¯…åŠ›çš„, ä¸­é€”æˆ‘ä¹Ÿæ”¾å¼ƒè¿‡, ä½†æ˜¯æƒ³æƒ³å®ƒä»¬å°±è¦è¿™æ ·çš„è¢«æˆ‘æŠ¹æ€äº†, å®åœ¨å¤ªå¯æ€œäº†, å°±åšæŒä¸‹æ¥äº†.</p>
<h2 id="åæ€å’Œæ€»ç»“"><a href="#åæ€å’Œæ€»ç»“" class="headerlink" title="åæ€å’Œæ€»ç»“"></a>åæ€å’Œæ€»ç»“</h2><p>è¿˜åŸä¹‹å‰çš„æ•°æ®, æ¯”å†™æ–°æ–‡ç« è¿˜ç´¯, ä¸»è¦æ˜¯å¿ƒç´¯.</p>
<p>åˆšå¼€å§‹çš„æ—¶å€™, æˆ‘æ¯ç¯‡éƒ½æƒ³ä¸€æ­¥åˆ°ä½çš„è¿˜åŸ, å‘ç°åšæŒå‡ ä¸ªæ™šä¸Š, æ•ˆç‡å¾ˆä½, å¾ˆå®¹æ˜“æ”¾å¼ƒ.</p>
<p>æœ€å, æˆ‘è°ƒèŠ‚äº†ä¸€ä¸‹å¿ƒæ€, åˆ† <code>è¿­ä»£</code> å»åš.</p>
<p><strong>ç¬¬ä¸€ä¸ªé˜¶æ®µ</strong>, æŠŠ HTML æ–‡ç« æ‹·è´åˆ° MarkDown å·¥å…·ä¸­, ä¸åšä»»ä½•çš„ä¿®é¥°å’Œä¿®æ”¹.</p>
<p><strong>ç¬¬äºŒä¸ªé˜¶æ®µ</strong>, æ¢³ç† MarkDown æ–‡æ¡£, æŠŠç¼ºå¤±çš„å›¾ç‰‡è¡¥ä¸Šå».</p>
<p><strong>ç¬¬ä¸‰ä¸ªé˜¶æ®µ</strong>, æŠŠæ–‡ç« ä¸­çš„é“¾æ¥å°½é‡è¡¥å…¨.</p>
<p>ç»è¿‡è¿™ä¸‰ä¸ªé˜¶æ®µå, æ–‡ç« åŸºæœ¬å·²ç»å¤åŸäº†, åªæ˜¯æ ¼å¼ä¸Šçœ‹èµ·æ¥æœ‰ç‚¹ç³Ÿç³•. </p>
<p><strong>ç¬¬å››ä¸ªé˜¶æ®µ</strong>, æ•´ç†æ–‡ç« çš„æ’ç‰ˆ, å¯¹æ¯”å·²ç»å‘å¸ƒçš„æ–‡ç« , æŸ¥æ¼è¡¥ç¼º.</p>
<p>ç¬¬å››ä¸ªé˜¶æ®µç»“æŸå, æ–‡ç« åŸºæœ¬éƒ½å¤æ´»äº†, æ¥ä¸‹æ¥å°±æ˜¯éƒ¨ç½²å’Œå‘å¸ƒäº†.</p>
<p><strong>ç¬¬äº”ä¸ªé˜¶æ®µ</strong>, æ•´ç† Hexo, é…ç½®ç›¸å…³çš„ä¸»é¢˜.</p>
<p><strong>ç¬¬å…­ä¸ªé˜¶æ®µ</strong>, æœ¬åœ°é¢„è§ˆå’Œå†æ¬¡æ ¡éªŒæ–‡ç« , ç»Ÿä¸€å‘å¸ƒ.</p>
<p>æ¯ä¸ªé˜¶æ®µ, æˆ‘éƒ½ç»™è‡ªå·±ä¸€ä¸ªå°ç›®æ ‡, ä¸æ–­çš„å»å®Œå–„, æœ€åå°†å„ä¸ªé˜¶æ®µçš„æˆæœä¸²è”èµ·æ¥, å°±å®Œæˆäº†. å½“è‡ªå·±é‡åˆ°å›°éš¾çš„æ—¶å€™, ä¸å¦¨åˆ†è§£ä¸€ä¸‹ä»»åŠ¡, ä¸æ–­çš„å»å®Œæˆæ¯ä¸ªå°ä»»åŠ¡, æ¯ä¸ªå®Œæˆçš„å°ä»»åŠ¡éƒ½æ˜¯å¯¹è‡ªå·±æœ€å¤§çš„å¥–åŠ±.</p>
<p>æ•´ä¸ªè¿˜åŸçš„è¿‡ç¨‹, åˆè®©æˆ‘é‡æ–°æ¢³ç†äº†ä¸€ä¸‹ä¹‹å‰çš„æ–‡ç« , åŒ…æ‹¬ç›®å½•è§„åˆ’å’Œæ–‡ç« ä¸­çš„æªè¾, ä¹Ÿå¯¹å›¾ç‰‡è¿›è¡Œäº†å‹ç¼©å’Œå¤„ç†. æ”¶è·é¢‡å¤š.</p>
<p>å¦‚æœå½“åˆè‡ªå·±ä¸é‚£ä¹ˆå†²åŠ¨, å¦‚æœå½“åˆè‡ªå·±å¤‡ä»½äº†æ–‡ä»¶, åº”è¯¥å°±ä¸ä¼šæœ‰è¿™ä¹ˆä¸€ä¸ªè‰°è¾›çš„å†ç¨‹äº†.</p>
<blockquote>
<p>æ•°æ®å¤‡ä»½å¾ˆé‡è¦, å†²åŠ¨æ˜¯è¦ä»˜å‡ºä»£ä»·çš„.</p>
</blockquote>
<p>ç°åœ¨æˆ‘æŠŠåŸæ•°æ®ä¿å­˜åœ¨äº‘ç›˜ä¸­, æœ¬åœ°ä¹Ÿä¿ç•™ä¸€ä»½, å®šæœŸæ›´æ–°åˆ°äº‘ç›˜ä¸­. è¿™æ ·å°±å¯ä»¥é˜²æ­¢æ•°æ®ä¸¢å¤±äº†.</p>
<p>ç¥å¤§å®¶åœ¨ 2018 å‘å‘å‘, èº«ä½“å¥åº·, å¹¸ç¦å®‰åº·!</p>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p>æ¨èç»™ Mac ç”¨æˆ·ä¸€ä¸ªå›¾ç‰‡å‹ç¼©å·¥å…· <a href="https://imageoptim.com/mac" target="_blank" rel="noopener">imageoptim</a>.</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> å­¦ä¹  ç”Ÿæ´» åæ€ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GCC: é™æ€åº“]]></title>
      <url>/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>å¦‚æœä½ å¯¹ GCC çš„ç¼–è¯‘ Cè¯­è¨€çš„æµç¨‹ä¸æ¸…æ¥š, å»ºè®®åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰å…ˆå»çœ‹ä¸€ä¸‹ <a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">GCC: ç¼–è¯‘Cè¯­è¨€çš„æµç¨‹</a> è¿™ç¯‡æ–‡ç« , ç¯‡å¹…çŸ­å°ç²¾æ‚, é˜…è¯»å, è‡³å°‘å¯ä»¥æ‰«æ‰«ç›²ğŸ˜œ.</p>
<p>æœ¬ç¯‡åšæ–‡ç”¨åˆ°çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ç‚¹:</p>
<p><strong>1.GCC</strong></p>
<p>gcc -c é€‰é¡¹å«ä¹‰:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Only run preprocess, compile, and assemble steps</div></pre></td></tr></table></figure>
<p>æ˜¯ <code>-c</code> é€‰é¡¹åªæ˜¯è¿›è¡Œäº†é¢„å¤„ç†, ç¼–è¯‘, æ±‡ç¼–çš„é˜¶æ®µ, ä¸ä¼šè¿›è¡Œé“¾æ¥çš„æ“ä½œ.</p>
<p><strong>2.é™æ€åº“</strong></p>
<p>Linux ä¸Šçš„é™æ€åº“ï¼Œæœ¬è´¨æ˜¯ä¸€äº›ç›®æ ‡æ–‡ä»¶çš„å½’æ¡£æ–‡ä»¶.</p>
<p><strong>3.é™æ€åº“å’Œå…±äº«åº“åŒºåˆ«</strong></p>
<p>[1].ä½¿ç”¨å…±äº«åº“å¯ä»¥èŠ‚çœå†…å­˜.</p>
<blockquote>
<p>æ¯”å¦‚ libcï¼Œç³»ç»Ÿä¸­å‡ ä¹æ‰€æœ‰çš„è¿›ç¨‹éƒ½æ˜ å°„ libc åˆ°è‡ªå·±çš„è¿›ç¨‹åœ°å€ç©ºé—´ï¼Œè€Œ libc çš„åªè¯»éƒ¨åˆ†åœ¨ç‰©ç†å†…å­˜ä¸­åªéœ€è¦å­˜åœ¨ä¸€ä»½ï¼Œå°±å¯ä»¥è¢«æ‰€æœ‰è¿›ç¨‹å…±äº«ï¼Œè¿™å°±æ˜¯â€œå…±äº«åº“â€è¿™ä¸ªåç§°çš„ç”±æ¥äº†.</p>
</blockquote>
<p>[2].ä½¿ç”¨å…±äº«åº“å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å‡çº§åº“æ–‡ä»¶è€Œä¸éœ€è¦é‡æ–°ç¼–è¯‘åº”ç”¨ç¨‹åº.</p>
<p>[3].å…±äº«åº“å ç”¨æ›´å°‘çš„ä½“ç§¯.</p>
<blockquote>
<p>åœ¨è¿è¡Œæ—¶åšåŠ¨æ€é“¾æ¥.è€Œåœ¨é“¾æ¥é™æ€åº“æ—¶, é“¾æ¥å™¨ä¼šæŠŠé™æ€åº“ä¸­çš„ç›®æ ‡æ–‡ä»¶å–å‡ºæ¥å’Œå¯æ‰§è¡Œæ–‡ä»¶çœŸæ­£é“¾æ¥åœ¨ä¸€èµ·.</p>
</blockquote>
<h2 id="åˆ›å»ºæ­¥éª¤"><a href="#åˆ›å»ºæ­¥éª¤" class="headerlink" title="åˆ›å»ºæ­¥éª¤"></a>åˆ›å»ºæ­¥éª¤</h2><p>åˆ›å»ºé™æ€åº“çš„æ­¥éª¤å¦‚ä¸‹:</p>
<p>[1]. å†™æºæ–‡ä»¶.<br>[2]. é€šè¿‡ gcc -c x.c ç”Ÿæˆç›®æ ‡æ–‡ä»¶.<br>[2]. å½’æ¡£. ç”¨ ar å½’æ¡£ç›®æ ‡æ–‡ä»¶ï¼Œç”Ÿæˆé™æ€åº“.<br>[3]. å†™å¤´æ–‡ä»¶, ä¾¿äºä½¿ç”¨è€…çŸ¥é“æ€ä¹ˆä½¿ç”¨è¯¥é™æ€åº“.</p>
<p>ä½¿ç”¨é™æ€åº“æ—¶ï¼Œåœ¨æºç ä¸­åŒ…å«å¯¹åº”çš„å¤´æ–‡ä»¶ï¼Œé“¾æ¥æ—¶è®°å¾—é“¾æ¥è‡ªå·±çš„åº“.</p>
<p>ä¸‹é¢ç»“åˆå…·ä½“ä¾‹å­, å±•å¼€è®².</p>
<h2 id="å†™æºæ–‡ä»¶"><a href="#å†™æºæ–‡ä»¶" class="headerlink" title="å†™æºæ–‡ä»¶"></a>å†™æºæ–‡ä»¶</h2><p>ç›®å½•ç»“æ„<br><img src="/upload/images/2017/10/08/1.jpg" alt="1"></p>
<p>ç¤ºä¾‹æ–‡ä»¶éƒ½æ˜¯å¾ˆç®€å•çš„ä»£ç , é™„å½•å¯ä»¥æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹.</p>
<h2 id="ç”Ÿæˆç›®æ ‡æ–‡ä»¶"><a href="#ç”Ÿæˆç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆç›®æ ‡æ–‡ä»¶"></a>ç”Ÿæˆç›®æ ‡æ–‡ä»¶</h2><p>å°† libs ç›®å½•ä¸‹é¢çš„(c)æºæ–‡ä»¶è¿›è¡Œé¢„å¤„ç†, ç¼–è¯‘å’Œæ±‡ç¼–.<br>æ³¨æ„è¿™é‡Œæ²¡æœ‰è¿›è¡Œé“¾æ¥.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -c libs/person.c libs/eat.c libs/play.c libs/sleep.c</div></pre></td></tr></table></figure>
<p>æ‰§è¡ŒåŸå, ä¼šç”Ÿæˆå¯¹åº”çš„ .o æ–‡ä»¶.</p>
<h2 id="å½’æ¡£"><a href="#å½’æ¡£" class="headerlink" title="å½’æ¡£"></a>å½’æ¡£</h2><p><code>libperson.a</code> æ˜¯è¦ç”Ÿæˆçš„åº“æ–‡ä»¶.</p>
<p>åº“æ–‡ä»¶éƒ½ä»¥ lib å¼€å¤´, é™æ€åº“ä»¥. a ä¸ºåç¼€. æ‰€ä»¥ä¸€èˆ¬æ˜¯ lib+ åå­—.a</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ar rs libperson.a person.o sleep.o play.o eat.o</div></pre></td></tr></table></figure>
<p>ar: ç±»ä¼¼äº tar, ç”¨æ¥å¯¹æ–‡ä»¶è¿›è¡Œåº“æ‰“åŒ….</p>
<p>r é€‰é¡¹: å°†å…¶åé¢çš„æ–‡ä»¶åˆ—è¡¨æ·»åŠ åˆ°æ–‡ä»¶åŒ…(libperson.a)ä¸­, å¦‚æœ libperson.a ä¸å­˜åœ¨å°±åˆ›å»ºå®ƒ, å¦‚æœ libperson.a å·²ç»å­˜åœ¨ä¸”é‡Œé¢æœ‰åŒåçš„ç›®æ ‡æ–‡ä»¶å°±è¿›è¡Œæ›¿æ¢æ“ä½œ.</p>
<p>s é€‰é¡¹: ä¸ºé™æ€åº“åˆ›å»ºç´¢å¼•.è¿™ä¸ªç´¢å¼•ä¼šè¢«é“¾æ¥å™¨ä½¿ç”¨.</p>
<blockquote>
<p>ranlib å‘½ä»¤ä¹Ÿå¯ä»¥ä¸ºé™æ€åº“åˆ›å»ºç´¢å¼•. æ‰€ä»¥ä¸Šé¢çš„å‘½ä»¤å¯ä»¥ç­‰æ•ˆä¸ºä¸‹é¢çš„ä¸¤ä¸ªå‘½ä»¤.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ar r libperson.a person.o sleep.o play.o eat.o</div><div class="line">ranlib libperson.a</div></pre></td></tr></table></figure>
<h2 id="å†™å¤´æ–‡ä»¶"><a href="#å†™å¤´æ–‡ä»¶" class="headerlink" title="å†™å¤´æ–‡ä»¶"></a>å†™å¤´æ–‡ä»¶</h2><p>å†™ä¸€ä¸ª person.h æ–‡ä»¶, ä¾¿äºè°ƒç”¨è€…æŸ¥çœ‹åº“å¦‚ä½•ä½¿ç”¨.</p>
<p>person.h</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#ifndef _PERSON_H</div><div class="line">#define _PERSON_H</div><div class="line">extern void init(int pUid);</div><div class="line">extern void eat();</div><div class="line">extern void play();</div><div class="line">extern void sleep();</div><div class="line">#endif</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨é™æ€åº“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc main.c -L. -lperson -Ilibs -o main</div></pre></td></tr></table></figure>
<p>-L é€‰é¡¹: å‘Šè¯‰ç¼–è¯‘å™¨å»å“ªé‡Œæ‰¾åº“æ–‡ä»¶, è¿™é‡Œçš„ _L. è¡¨ç¤ºåœ¨å½“å‰ç›®å½•.<br>å¦‚æœä¸ç”¨ -L é€‰é¡¹, å³ä½¿åº“æ–‡ä»¶åœ¨å½“å‰ç›®å½•, ç¼–è¯‘å™¨ä¹Ÿä¸ä¼šå»æ‰¾, æ‰€ä»¥è¯¥é€‰é¡¹ä¸èƒ½å°‘.</p>
<p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ld: library not found for -lperson</div><div class="line">clang: error: linker command failed with exit code 1 (use -v to see invocation)</div></pre></td></tr></table></figure>
<p>-lperson: å‘Šè¯‰ç¼–è¯‘å™¨è¦é“¾æ¥ libperson.a åº“.</p>
<p>-I: å‘Šè¯‰ç¼–è¯‘å™¨åˆ°å“ªé‡Œæ‰¾å¤´æ–‡ä»¶.<br>å¦‚æœä¸æŒ‡å®šå¤´æ–‡ä»¶çš„æŸ¥æ‰¾ç›®å½•, ä¹Ÿä¼šæŠ¥é”™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">main.c:2:10: fatal error: &apos;person.h&apos; file not found</div><div class="line">#include &quot;person.h&quot;</div><div class="line">         ^~~~~~~~~~</div><div class="line">1 error generated.</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶çš„ç›®å½•ç»“æ„:<br><img src="/upload/images/2017/10/08/2.jpg" alt="1"></p>
<p>é“¾æ¥æˆåŠŸå, å¯ä»¥æ‰§è¡Œç”Ÿæˆçš„ main (å¯æ‰§è¡Œ)æ–‡ä»¶.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./main</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">uid: 101 eating</div><div class="line">uid: 101 playing</div><div class="line">uid: 101 has sleep</div></pre></td></tr></table></figure>
<h2 id="æœ‰è¶£çš„å®éªŒ"><a href="#æœ‰è¶£çš„å®éªŒ" class="headerlink" title="æœ‰è¶£çš„å®éªŒ"></a>æœ‰è¶£çš„å®éªŒ</h2><p>çŒœæƒ³ä¸€ä¸‹å¦‚æœæœ‰ä¸¤ä¸ªåº“ä¸€ä¸ªæ˜¯å…±äº«åº“, ä¸€ä¸ªæ˜¯é™æ€åº“, è€Œä¸”äºŒè€…é™¤äº†åç¼€ä¸ä¸€æ ·, åå­—éƒ½ä¸€æ ·å¦‚ libperson.a å’Œ libperson.so, é‚£ä¹ˆè°ƒç”¨æ–¹å¦‚ä½•æ¥é€‰æ‹©å¯¹åº”çš„åº“æ–‡ä»¶å‘¢?</p>
<p>æˆ‘ä»¬æŠŠ GCC: å…±äº«åº“ é‡Œé¢ç”Ÿæˆçš„å…±äº«åº“ libperson.so æ”¾åˆ°å½“å‰çš„ç›®å½•, é‡æ–°ç¼–è¯‘é“¾æ¥ main.c æ–‡ä»¶.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc main.c -L. -lperson -Ilibs -o main</div></pre></td></tr></table></figure>
<p>å†æ¬¡æ‰§è¡Œ ./main, å¾—åˆ°ç»“æœæ˜¯è¿™æ ·çš„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">From sharedlib.uid: 101 eating</div><div class="line">From sharedlib.uid: 101 playing</div><div class="line">From sharedlib.uid: 101 has sleep</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šçš„ç»“æœ, è¯´æ˜é“¾æ¥å™¨ä¼šä¼˜å…ˆé€‰æ‹©å…±äº«åº“å…¶æ¬¡æ‰æ˜¯é™æ€åº“.</p>
<blockquote>
<p>Linux(MacOS ä¹Ÿä¸€æ ·) çš„ GCC é»˜è®¤é“¾æ¥åŠ¨æ€åº“ï¼Œåªæœ‰å½“åŠ¨æ€åº“ä¸å­˜åœ¨æ—¶ï¼Œæ‰å»é“¾æ¥é™æ€åº“.<br>è‹¥æ˜¯éœ€è¦å¼ºåˆ¶æŒ‡å®šé™æ€åº“éœ€è¦æŒ‡å®šé€‰é¡¹ -static.ä½†æ˜¯åœ¨ MacOS ä¸Šé¢ä¸æ”¯æŒè¯¥é€‰é¡¹.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -static main.c -L. -lperson -Ilibs -o main</div></pre></td></tr></table></figure>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ç¤ºä¾‹å®Œæ•´ä»£ç </p>
<blockquote>
<p>main.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &quot;person.h&quot;</div><div class="line">int main() &#123;</div><div class="line">    init(101);</div><div class="line">    eat();</div><div class="line">    play();</div><div class="line">    sleep();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>person.h</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#ifndef _PERSON_H</div><div class="line">#define _PERSON_H</div><div class="line">extern void init(int pUid);</div><div class="line">extern void eat();</div><div class="line">extern void play();</div><div class="line">extern void sleep();</div><div class="line">#endif</div></pre></td></tr></table></figure>
<blockquote>
<p>person.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">int uid;</div><div class="line">void init(int pUid) &#123;</div><div class="line">    uid = pUid;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>eat.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">extern int uid;</div><div class="line">void eat() &#123;</div><div class="line">    printf(&quot;uid: %i eating\n&quot;, uid);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>play.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">extern int uid;</div><div class="line">void play() &#123;</div><div class="line">    printf(&quot;uid: %i playing\n&quot;, uid);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>sleep.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">extern int uid;</div><div class="line">void sleep() &#123;</div><div class="line">    printf(&quot;uid: %i has sleep\n&quot;, uid);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="GCC-ç³»åˆ—åšæ–‡"><a href="#GCC-ç³»åˆ—åšæ–‡" class="headerlink" title="GCC ç³»åˆ—åšæ–‡"></a>GCC ç³»åˆ—åšæ–‡</h2><p><a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">GCC: ç¼–è¯‘ C è¯­è¨€çš„æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/" target="_blank" rel="noopener">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a></p>
<p><a href="http://www.veryitman.com/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/" target="_blank" rel="noopener">GCC: å…±äº«åº“</a></p>
<p><a href="http://www.veryitman.com/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/" target="_blank" rel="noopener">GCC: é™æ€åº“</a></p>
]]></content>
      
        <categories>
            
            <category> C/C++ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GCC ç¼–è¯‘å™¨ é™æ€åº“ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GCC: å…±äº«åº“]]></title>
      <url>/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/</url>
      <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>å…±äº«åº“: åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´éœ€è¦è°ƒç”¨åˆ°å…±äº«åº“çš„æ—¶å€™æ‰åŠ è½½åˆ°å†…å­˜é‡Œé¢ï¼Œå¯ä»¥è¢«å¤šä¸ªç¨‹åºå…±äº«ä½¿ç”¨.</p>
<p>åœ¨ MacOS ä¸Šé¢åˆ›å»ºå’Œä½¿ç”¨å…±äº«åº“è¦æ¯”åœ¨ Linux ä¸Šé¢ç®€å•.<br>åœ¨ Linux ä¸Šé¢è¿˜ä¼šç‰µæ‰¯åˆ°å…±äº«åº“è·¯å¾„é—®é¢˜, åœ¨ Mac ä¸Šé¢å°±æ²¡æœ‰è¿™æ ·çš„é—®é¢˜.</p>
<p>åœ¨ MacOS ä¸Šé¢ä½¿ç”¨çš„ GCC å…¶æœ¬è´¨æ˜¯ LLVM. ä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -v</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å¯¹åº”çš„è¾“å‡ºç»“æœ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/c++/4.2.1</div><div class="line">Apple LLVM version 9.0.0 (clang-900.0.37)</div><div class="line">Target: x86_64-apple-darwin16.7.0</div><div class="line">Thread model: posix</div><div class="line">InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</div></pre></td></tr></table></figure>
<h2 id="åˆ›å»ºå…±äº«åº“æ­¥éª¤"><a href="#åˆ›å»ºå…±äº«åº“æ­¥éª¤" class="headerlink" title="åˆ›å»ºå…±äº«åº“æ­¥éª¤"></a>åˆ›å»ºå…±äº«åº“æ­¥éª¤</h2><p>[1].å†™æºæ–‡ä»¶.è¿™é‡Œä»¥ Cæ–‡ä»¶ä¸ºåŸºç¡€.<br>[2].å°†æºæ–‡ä»¶ç”Ÿæˆç›®æ ‡æ–‡ä»¶.<br>[3].åˆ›å»ºå…±äº«åº“.<br>[4].å†™å¤´æ–‡ä»¶, ä¾›è°ƒç”¨æ–¹ä½¿ç”¨.</p>
<p>ä¸‹é¢ç»“åˆå®ä¾‹æ¥åˆ†äº«ä¸€ä¸‹å¦‚ä½•åœ¨ Mac ä¸Šé¢åˆ›å»ºå…±äº«åº“.</p>
<h2 id="å†™æºæ–‡ä»¶"><a href="#å†™æºæ–‡ä»¶" class="headerlink" title="å†™æºæ–‡ä»¶"></a>å†™æºæ–‡ä»¶</h2><p>ç›®å½•ç»“æ„:<br><img src="/upload/images/2017/10/07/1.jpg" alt="1"></p>
<p>å¯¹åº”çš„å®Œæ•´ä»£ç å¯ä»¥çœ‹æ–‡æœ«çš„é™„å½•.</p>
<h2 id="ç”Ÿæˆç›®æ ‡æ–‡ä»¶"><a href="#ç”Ÿæˆç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆç›®æ ‡æ–‡ä»¶"></a>ç”Ÿæˆç›®æ ‡æ–‡ä»¶</h2><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -Wall -c -fPIC libs/eat.c libs/play.c libs/sleep.c libs/person.c</div></pre></td></tr></table></figure>
<p>æ³¨æ„: <code>-fPIC</code> é€‰é¡¹ä¸€å®šè¦åŠ .</p>
<blockquote>
<p>PIC(position independent code), äº§ç”Ÿä½ç½®æ— å…³ç </p>
</blockquote>
<h2 id="ç”Ÿæˆå…±äº«åº“"><a href="#ç”Ÿæˆå…±äº«åº“" class="headerlink" title="ç”Ÿæˆå…±äº«åº“"></a>ç”Ÿæˆå…±äº«åº“</h2><p>è¿™é‡ŒæŠŠå…±äº«åº“æš‚ä¸”ç§°ä¹‹ä¸º <code>libperson.so</code>.</p>
<p>æ‰§è¡Œä¸‹é¢å‘½ä»¤åˆ›å»º:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc -shared -fPIC eat.o play.o sleep.o person.o -o libperson.so</div></pre></td></tr></table></figure>
<h2 id="å†™å¤´æ–‡ä»¶"><a href="#å†™å¤´æ–‡ä»¶" class="headerlink" title="å†™å¤´æ–‡ä»¶"></a>å†™å¤´æ–‡ä»¶</h2><p>è¿™é‡Œå¤´æ–‡ä»¶ä¸»è¦æ˜¯ <code>person.h</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#ifndef _PERSON_H</div><div class="line">#define _PERSON_H</div><div class="line">extern void init(int pUid);</div><div class="line">extern void eat();</div><div class="line">extern void play();</div><div class="line">extern void sleep();</div><div class="line">#endif</div></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨å…±äº«åº“"><a href="#ä½¿ç”¨å…±äº«åº“" class="headerlink" title="ä½¿ç”¨å…±äº«åº“"></a>ä½¿ç”¨å…±äº«åº“</h2><p>main.c æ˜¯ä½¿ç”¨æ–¹, ç¼–è¯‘é“¾æ¥å³å¯.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc main.c -L. -lperson -Ilibs -o main</div></pre></td></tr></table></figure>
<p>ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ main, æ‰§è¡Œç»“æœ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">From sharedlib.uid: 101 eating</div><div class="line">From sharedlib.uid: 101 playing</div><div class="line">From sharedlib.uid: 101 has sleep</div></pre></td></tr></table></figure>
<p><strong>æ³¨æ„:</strong><br>-L é€‰é¡¹, å‘Šè¯‰ç¼–è¯‘å™¨å»å“ªé‡Œæ‰¾åº“æ–‡ä»¶, è¿™é‡Œçš„ _L. è¡¨ç¤ºåœ¨å½“å‰ç›®å½•.</p>
<p>-lperson, è¡¨ç¤º libperson.so åº“.</p>
<p>-Ilibs å‘Šè¯‰ç¼–è¯‘å™¨å¤´æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•.</p>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ç¤ºä¾‹å®Œæ•´ä»£ç </p>
<blockquote>
<p>main.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &quot;person.h&quot;</div><div class="line">int main() &#123;</div><div class="line">    init(101);</div><div class="line">    eat();</div><div class="line">    play();</div><div class="line">    sleep();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>person.h</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#ifndef _PERSON_H</div><div class="line">#define _PERSON_H</div><div class="line">extern void init(int pUid);</div><div class="line">extern void eat();</div><div class="line">extern void play();</div><div class="line">extern void sleep();</div><div class="line">#endif</div></pre></td></tr></table></figure>
<blockquote>
<p>person.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">int uid;</div><div class="line">void init(int pUid) &#123;</div><div class="line">    uid = pUid;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>eat.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">extern int uid;</div><div class="line">void eat() &#123;</div><div class="line">    printf(&quot;From sharedlib.uid: %i eating\n&quot;, uid);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>play.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">extern int uid;</div><div class="line">void play() &#123;</div><div class="line">    printf(&quot;From sharedlib.uid: %i playing\n&quot;, uid);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>sleep.c</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">extern int uid;</div><div class="line">void sleep() &#123;</div><div class="line">    printf(&quot;From sharedlib.uid: %i has sleep\n&quot;, uid);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="GCC-ç³»åˆ—åšæ–‡"><a href="#GCC-ç³»åˆ—åšæ–‡" class="headerlink" title="GCC ç³»åˆ—åšæ–‡"></a>GCC ç³»åˆ—åšæ–‡</h2><p><a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">GCC: ç¼–è¯‘ C è¯­è¨€çš„æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/" target="_blank" rel="noopener">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a></p>
<p><a href="http://www.veryitman.com/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/" target="_blank" rel="noopener">GCC: å…±äº«åº“</a></p>
<p><a href="http://www.veryitman.com/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/" target="_blank" rel="noopener">GCC: é™æ€åº“</a></p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> C/C++ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GCC ç¼–è¯‘å™¨ å…±äº«åº“ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GCC: Homebrew å®‰è£… GCC å’Œ Binutils]]></title>
      <url>/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/</url>
      <content type="html"><![CDATA[<h2 id="æ–‡ç« èƒŒæ™¯"><a href="#æ–‡ç« èƒŒæ™¯" class="headerlink" title="æ–‡ç« èƒŒæ™¯"></a>æ–‡ç« èƒŒæ™¯</h2><p>å‰æ®µæ—¶é—´ï¼Œæœ‰ä¸ªåšå®¢ä¸Šé¢çš„å°ä¼™ä¼´ç»™æˆ‘å‘æ¥é‚®ä»¶ï¼Œé—®æˆ‘å…³äº GCC ç›¸å…³çš„çŸ¥è¯†ï¼Œå¯¹äº GCC æˆ‘ä¹Ÿåªæ˜¯å‡­ç€ä¹‹å‰çš„äº†è§£ï¼Œå›å¤ä»–äº†ã€‚ä¹¦åˆ°ç”¨æ—¶æ–¹æ¨å°‘å‘€ï¼</p>
<p>è¿™ä½å°ä¼™ä¼´è¿˜åœ¨è¯»å¤§å­¦ï¼Œè‡ªå­¦èƒ½åŠ›æ¯”è¾ƒå¼ºï¼Œè‡ªå·±å‡ºäº†å®Œæˆè¯¾æ—¶ä¹‹å¤–ï¼Œè¿˜ä¼šåœ¨ç½‘ä¸Šæ‰¾èµ„æ–™è‡ªå­¦ã€‚</p>
<p>æˆ‘è®°å¾—è‡ªå·±åœ¨å¤§å­¦çš„æ—¶å€™ï¼Œå¯¹ GCC ä¸€çªä¸é€šï¼ŒåªçŸ¥é“ Turbo-C å’Œé‚£äº›è¢«å¼ºåˆ¶è®°ä½çš„å…³é”®å­—ã€‚</p>
<p>æœ€åå‘Šè¯‰ä»–, æˆ‘ä¼šåšæŒæŠŠè‡ªå·±ä»¥å‰å­¦ä¹ è¿‡ç›¸å…³ GCC çš„çŸ¥è¯†ï¼Œä»¥åšå®¢çš„å½¢å¼è¾“å‡ºã€‚äºæ˜¯ã€‚å°±æœ‰äº† <a href="http://www.veryitman.com/categories/C-C/" target="_blank" rel="noopener">GCC ç³»åˆ—</a> çš„æ–‡ç« ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åˆ°å¤§å®¶ã€‚</p>
<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>è¿™ç¯‡åšå®¢ä¸»è¦åˆ†äº« MacOS ä¸‹å®‰è£… GCC å’Œ Binutils å·¥å…·ã€‚</p>
<p>MacOS ä¸‹è¾“å…¥ <code>gcc -v</code>, å…¶å®æ˜¯é“¾æ¥æŒ‡å‘äº† LLVM ç¼–è¯‘å™¨, ä¸æ˜¯ GNU çš„ GCC.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/c++/4.2.1</div><div class="line">Apple LLVM version 9.0.0 (clang-900.0.37)</div><div class="line">Target: x86_64-apple-darwin16.7.0</div><div class="line">Thread model: posix</div><div class="line">InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</div></pre></td></tr></table></figure>
<h2 id="å®‰è£…-GCC"><a href="#å®‰è£…-GCC" class="headerlink" title="å®‰è£… GCC"></a>å®‰è£… GCC</h2><p>å…³äº GCC, å¯ä»¥å‚è€ƒ <a href="https://zh.wikipedia.org/wiki/GCC" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a>.</p>
<p>æ‰§è¡Œä¸‹é¢å‘½ä»¤, å³å¯å¼€å§‹å®‰è£…:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">brew tap homebrew/versions</div><div class="line"></div><div class="line">brew install gcc49</div></pre></td></tr></table></figure>
<p>brew ä¼šè‡ªåŠ¨ä¸ºä½ å®‰è£…ç›¸å…³ä¾èµ–ï¼Œå¦‚ gmp4ã€mpfr2ã€libmpc08ã€isl011ã€cloog018.</p>
<p>è¿™é‡Œå®‰è£…éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´â€¦</p>
<p>çœ‹åˆ°ä¸‹é¢çš„å†…å®¹, è¡¨ç¤ºå®‰è£…å®Œæ¯•.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Pouring gcc49-4.9.2_1.yosemite.bottle.1.tar.gz</div><div class="line"></div><div class="line">/usr/local/Cellar/gcc49/4.9.2_1: 1138 files, 164M</div></pre></td></tr></table></figure>
<p>å®‰è£…æˆåŠŸå, å®‰è£…ç›®å½•åœ¨:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/Cellar/gcc49/4.9.2_1</div></pre></td></tr></table></figure>
<p>ä½ åœ¨ç»ˆç«¯ç›´æ¥è¾“å…¥ <code>gcc -v</code>ï¼Œå…¶å®è¿˜æ˜¯ LLVMï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨æˆ‘ä»¬ åˆšå®‰è£…çš„ gcc?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/Cellar/gcc49/4.9.2_1/bin</div><div class="line"></div><div class="line">ls -l</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">c++-4.9</div><div class="line">cpp-4.9</div><div class="line">g++-4.9</div><div class="line">gcc-4.9</div><div class="line">gcc-ar-4.9</div><div class="line">gcc-nm-4.9</div><div class="line">gcc-ranlib-4.9</div><div class="line">gcov-4.9</div><div class="line">x86_64-apple-darwin14.3.0-c++-4.9</div><div class="line">x86_64-apple-darwin14.3.0-g++-4.9</div><div class="line">x86_64-apple-darwin14.3.0-gcc-4.9</div><div class="line">x86_64-apple-darwin14.3.0-gcc-4.9.2</div><div class="line">x86_64-apple-darwin14.3.0-gcc-ar-4.9</div><div class="line">x86_64-apple-darwin14.3.0-gcc-nm-4.9</div><div class="line">x86_64-apple-darwin14.3.0-gcc-ranlib-4.9</div></pre></td></tr></table></figure>
<p>Okï¼Œä½ åº”è¯¥æ˜ç™½äº†, åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gcc-4.9 -v</code> å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬åˆšå®‰è£…çš„ GCC äº†ï¼ŒåŒ…æ‹¬ g++ ç­‰å·¥å…·.</p>
<p>ä»¥åä½¿ç”¨ GNU çš„ GCC è¾“å…¥ <code>gcc-4.9</code> å°±å¥½äº†ã€‚</p>
<h2 id="å®‰è£…-Binutils"><a href="#å®‰è£…-Binutils" class="headerlink" title="å®‰è£… Binutils"></a>å®‰è£… Binutils</h2><p>å…³äº Binutils å¯ä»¥å‚è€ƒ <a href="https://zh.wikipedia.org/zh-cn/GNU_Binutils" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a>.</p>
<p>æ‰§è¡Œä¸‹é¢å‘½ä»¤, ç›´æ¥å®‰è£…:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install binutils</div></pre></td></tr></table></figure>
<p>åŒç†:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/Cellar/binutils/2.25/bin</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä½ éœ€è¦çš„å·¥å…·:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">gaddr2line</div><div class="line">gar</div><div class="line">gc++filt</div><div class="line">gcoffdump</div><div class="line">gdlltool</div><div class="line">gdllwrap</div><div class="line">gelfedit</div><div class="line">gnlmconv</div><div class="line">gnm</div><div class="line">gobjcopy</div><div class="line">gobjdump</div><div class="line">granlib</div><div class="line">greadelf</div><div class="line">gsize</div><div class="line">gsrconv</div><div class="line">gstrings</div><div class="line">gstrip</div><div class="line">gsysdump</div><div class="line">gwindmc</div><div class="line">gwindres</div></pre></td></tr></table></figure>
<h2 id="ä¸ªäººæ„Ÿå—"><a href="#ä¸ªäººæ„Ÿå—" class="headerlink" title="ä¸ªäººæ„Ÿå—"></a>ä¸ªäººæ„Ÿå—</h2><p>åœ¨ MacOS ä¸Šé¢ï¼Œå³ä½¿å®‰è£…äº† GNU çš„ GCCï¼Œä¹Ÿæ²¡æœ‰åœ¨ Linux ä¸Šé¢ç”¨çš„é‚£ä¹ˆçˆ½ï¼Œå¾ˆå¤š GCC çš„å‘½ä»¤é€‰é¡¹åœ¨ MacOS ä¸Šé¢æ— æ³•ä½¿ç”¨ï¼Œä½†ä¸å¾—ä¸æ‰¿è®¤ LLVM æ˜¯æ¯”è¾ƒä¼˜ç§€çš„ç¼–è¯‘å™¨ã€‚</p>
<h2 id="GCC-ç³»åˆ—åšæ–‡"><a href="#GCC-ç³»åˆ—åšæ–‡" class="headerlink" title="GCC ç³»åˆ—åšæ–‡"></a>GCC ç³»åˆ—åšæ–‡</h2><p><a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">GCC: ç¼–è¯‘ C è¯­è¨€çš„æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/" target="_blank" rel="noopener">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a></p>
<p><a href="http://www.veryitman.com/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/" target="_blank" rel="noopener">GCC: å…±äº«åº“</a></p>
<p><a href="http://www.veryitman.com/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/" target="_blank" rel="noopener">GCC: é™æ€åº“</a></p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> C/C++ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GCC C ç¼–è¯‘å™¨ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GCC: ç¼–è¯‘Cè¯­è¨€çš„æµç¨‹]]></title>
      <url>/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>å†çœ‹ä¸‹æ–‡ä¹‹å‰ï¼Œå…ˆæ™®åŠä¸€ä¸‹ Linux å’Œ gcc çš„å†å²ï¼Œä¸‹é¢çš„è¿™æ®µå†…å®¹æ¥è‡ªäºç½‘ç»œã€‚</p>
<blockquote>
<p>æ—©åœ¨ 20 ä¸–çºª 70 å¹´ä»£ï¼ŒUNIX ç³»ç»Ÿæ˜¯å¼€æºè€Œä¸”å…è´¹çš„ã€‚ä½†æ˜¯åœ¨ 1979 å¹´æ—¶ï¼ŒAT&amp;T å…¬å¸å®£å¸ƒäº†å¯¹ UNIX ç³»ç»Ÿçš„å•†ä¸šåŒ–è®¡åˆ’ï¼Œéšä¹‹å¼€æºè½¯ä»¶ä¸šè½¬å˜æˆäº†ç‰ˆæƒå¼è½¯ä»¶äº§ä¸šï¼Œæºä»£ç è¢«å½“ä½œå•†ä¸šæœºå¯†ï¼Œæˆä¸ºä¸“åˆ©äº§å“ï¼Œäººä»¬å†ä¹Ÿä¸èƒ½è‡ªç”±åœ°äº«å—ç§‘æŠ€æˆæœã€‚</p>
<p>äºæ˜¯åœ¨ 1984 å¹´ï¼ŒRichard Stallman é¢å¯¹äºå¦‚æ­¤å°é—­çš„è½¯ä»¶åˆ›ä½œç¯å¢ƒï¼Œå‘èµ·äº† GNU æºä»£ç å¼€æ”¾è®¡åˆ’å¹¶åˆ¶å®šäº†è‘—åçš„ GPL è®¸å¯åè®®ã€‚</p>
<p>1987 å¹´æ—¶ï¼ŒGNU è®¡åˆ’è·å¾—äº†ä¸€é¡¹é‡å¤§çªç ´â€”gccç¼–è¯‘å™¨å‘å¸ƒï¼Œè¿™ä½¿å¾—ç¨‹åºå‘˜å¯ä»¥åŸºäºè¯¥ç¼–è¯‘å™¨ç¼–å†™å‡ºå±äºè‡ªå·±çš„å¼€æºè½¯ä»¶ã€‚</p>
<p>éšä¹‹ï¼Œåœ¨ 1991 å¹´10 æœˆï¼ŒèŠ¬å…°èµ«å°”è¾›åŸºå¤§å­¦çš„åœ¨æ ¡ç”Ÿ Linus Torvalds ç¼–å†™äº†ä¸€æ¬¾åä¸º Linux çš„æ“ä½œç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿå› å…¶è¾ƒé«˜çš„ä»£ç è´¨é‡ä¸”åŸºäº GNU GPL è®¸å¯åè®®çš„å¼€æ”¾æºä»£ç ç‰¹æ€§ï¼Œè¿…é€Ÿå¾—åˆ°äº† GNU è®¡åˆ’å’Œä¸€å¤§æ‰¹é»‘å®¢ç¨‹åºå‘˜çš„æ”¯æŒã€‚</p>
<p>éšå Linux ç³»ç»Ÿä¾¿è¿›å…¥äº†å¦‚ç«å¦‚è¼çš„å‘å±•é˜¶æ®µã€‚</p>
<p>1994 å¹´ 1 æœˆï¼ŒBob Young åœ¨ Linux ç³»ç»Ÿå†…æ ¸çš„åŸºç¡€ä¹‹ä¸Šï¼Œé›†æˆäº†ä¼—å¤šçš„æºä»£ç å’Œç¨‹åºè½¯ä»¶ï¼Œå‘å¸ƒäº†çº¢å¸½ç³»ç»Ÿå¹¶å¼€å§‹å‡ºå”®æŠ€æœ¯æœåŠ¡ï¼Œè¿™è¿›ä¸€æ­¥æ¨åŠ¨äº† Linux ç³»ç»Ÿçš„æ™®åŠã€‚</p>
<p>1998 å¹´ä»¥åï¼Œéšç€ GNU æºä»£ç å¼€æ”¾è®¡åˆ’å’Œ Linux ç³»ç»Ÿçš„ç»§ç»­ç«çƒ­ï¼Œä»¥ IBM å’Œ Intel ä¸ºé¦–çš„å¤šå®¶ IT ä¼ä¸šå·¨å¤´å¼€å§‹å¤§åŠ›æ¨åŠ¨å¼€æ”¾æºä»£ç è½¯ä»¶çš„å‘å±•ã€‚</p>
<p>åˆ°äº† 2017 å¹´å¹´åº•ï¼ŒLinux å†…æ ¸å·²ç»å‘å±•åˆ°äº† 4.13 ç‰ˆæœ¬ï¼Œå¹¶ä¸” Linux ç³»ç»Ÿç‰ˆæœ¬ä¹Ÿæœ‰æ•°ç™¾ä¸ªä¹‹å¤šï¼Œä½†å®ƒä»¬ä¾ç„¶éƒ½ä½¿ç”¨ Linus Torvalds å¼€å‘ã€ç»´æŠ¤çš„Linux ç³»ç»Ÿå†…æ ¸ã€‚RedHat å…¬å¸ä¹Ÿæˆä¸ºäº†å¼€æºè¡Œä¸šåŠ Linux ç³»ç»Ÿçš„å¸¦å¤´å…¬å¸ã€‚</p>
</blockquote>
<h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>è¿™ç¯‡åšæ–‡ <a href="http://blog.csdn.net/veryitman/article/details/7340668" target="_blank" rel="noopener">makefile: gcc å·¥ä½œæµç¨‹</a> æ—©æœŸè¢«æˆ‘æ”¾åœ¨ CSDN ä¸Šé¢è¿‡.æ—¶éš”å¤šå¹´, ä»ä¸èƒ½å¿˜æ€€, ç°ä¹”è¿è‡³æ­¤.</p>
<p>æœ¬æ–‡æ¯”è¾ƒç®€å•, æ¯”è¾ƒé€‚åˆåˆå­¦è€….<br>æˆ‘åªæ˜¯è¯•å›¾ä»¥å®ä¾‹çš„æ–¹å¼ç»™å¤§å®¶è®²è§£ä¸€ä¸‹ GCC ç¼–è¯‘é“¾æ¥ Cè¯­è¨€ç¨‹åºçš„æµç¨‹, å¹¶æ²¡æœ‰é«˜æ·±çš„çŸ¥è¯†.</p>
<h2 id="ç¼–è¯‘æµç¨‹"><a href="#ç¼–è¯‘æµç¨‹" class="headerlink" title="ç¼–è¯‘æµç¨‹"></a>ç¼–è¯‘æµç¨‹</h2><p>C è¯­è¨€ç»è¿‡é¢„å¤„ç†ã€ç¼–è¯‘ã€è¿æ¥æœ€åç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶.</p>
<p>åœ¨ Linux çš„ GCC ä¸‹é¢ï¼Œçœ‹çœ‹å…¶å·¥ä½œæµç¨‹. æµç¨‹å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="/upload/images/2017/10/03/1.jpg" alt="1"></p>
<p>é¢„å¤„ç†ï¼Œå°†åŒ…å«çš„ <em>.h æ–‡ä»¶æˆ–è€…ä¸€äº›é¢„å¤„ç†è¯­å¥ï¼ˆå¦‚ #defineï¼‰å¤„ç†ä¸€ä¸‹ï¼Œç„¶åå°† </em>.c æ–‡ä»¶ç”Ÿæˆ *.i çš„ä¸­é—´æ–‡ä»¶.</p>
<blockquote>
<p>æ³¨æ„äº† GCC ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆè¿™æ ·ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦ï¼Œè‡ªå·±åŠ  -E å‚æ•°å³å¯.</p>
</blockquote>
<p>ç¼–è¯‘ã€æ±‡ç¼–é˜¶æ®µç”Ÿæˆ *.o ç›®æ ‡æ–‡ä»¶ï¼Œæœ€åç»è¿‡é“¾æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶.</p>
<blockquote>
<p>æ³¨æ„ï¼šå¯æ‰§è¡Œæ–‡ä»¶ä¸ä¸€å®šæ˜¯ exe æ–‡ä»¶.</p>
</blockquote>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>ä¸‹é¢ä»¥ä¸€ä¸ªå®ä¾‹ hello.cï¼Œè¯´æ˜è¿™ä¸ªè¿‡ç¨‹.</p>
<p><img src="/upload/images/2017/10/03/2.jpg" alt="1"></p>
<p>æºæ–‡ä»¶å¾ˆç®€å•ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†è¯´æ˜é—®é¢˜.</p>
<p>åœ¨å‘½ä»¤è¡Œï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å®Œæˆé¢„å¤„ç†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc  -E  hello.c  -o  hello.i</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œä¹‹åï¼Œä½ å¯ä»¥æ‰“å¼€ hello.i æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤š extern ä»¥åŠå°† MAX è§£é‡Šä¸º 20ï¼š<br><img src="/upload/images/2017/10/03/3.jpg" alt="1"></p>
<p>åœ¨å‘½ä»¤è¡Œï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤, å®Œæˆç¼–è¯‘é˜¶æ®µ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc  -S  hello.i  -o hello.s</div></pre></td></tr></table></figure>
<p>è¿™æ—¶å¯ä»¥ç”Ÿæˆ *.s æ–‡ä»¶ï¼Œå…¶å®å°±æ˜¯ä¸€äº›æ±‡ç¼–è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="/upload/images/2017/10/03/4.jpg" alt="1"></p>
<p>é‚£éº½ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥æ±‡ç¼–é˜¶æ®µäº†ï¼Œæ‰§è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc  -c  hello.s  -o hello.o</div></pre></td></tr></table></figure>
<p>æ‰“å¼€è¿™ä¸ª hello.o æ–‡ä»¶ï¼Œéƒ½æ˜¯ä¸€äº›æœºå™¨ç .</p>
<p>æœ€åä¸€ä¸ªè¿æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc hello.o -o hello</div></pre></td></tr></table></figure>
<p>åœ¨å½“å‰ç›®å½•å°±å¯ä»¥ç”Ÿæˆ hello è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶.</p>
<p>æ‰§è¡Œ ./helloï¼Œå°±ä¼šè¾“å‡ºï¼š<br><img src="/upload/images/2017/10/03/5.jpg" alt="1"></p>
<p>åˆ°æ­¤ï¼ŒGCC ç¼–è¯‘è¿æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶å®Œæ¯•ï¼</p>
<p>å½“å‰ç›®å½•ä¸‹é¢çš„æ–‡ä»¶ï¼š<br><img src="/upload/images/2017/10/03/6.jpg" alt="1"></p>
<p>ä»¥ä¸Šçš„æ­¥éª¤ï¼Œå…¶å®ä¸€å¥å‘½ä»¤å³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gcc  hello.c  -o  hello</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶ç›®å½•å†…å®¹å¦‚ä¸‹ï¼š<br><img src="/upload/images/2017/10/03/7.jpg" alt="1"></p>
<p>è‡ªå·±åŠ¨æ‰‹æ„Ÿå—ä¸€ä¸‹ï¼Œä½ ä¼šæ”¶è·æ›´å¤šï¼</p>
<h2 id="GCC-ç³»åˆ—åšæ–‡"><a href="#GCC-ç³»åˆ—åšæ–‡" class="headerlink" title="GCC ç³»åˆ—åšæ–‡"></a>GCC ç³»åˆ—åšæ–‡</h2><p><a href="http://www.veryitman.com/2017/10/03/GCC-%E7%BC%96%E8%AF%91C%E8%AF%AD%E8%A8%80%E7%9A%84%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">GCC: ç¼–è¯‘ C è¯­è¨€çš„æµç¨‹</a></p>
<p><a href="http://www.veryitman.com/2017/10/07/GCC-Homebrew-%E5%AE%89%E8%A3%85-GCC-%E5%92%8C-Binutils/" target="_blank" rel="noopener">GCC: Homebrew å®‰è£… GCC å’Œ Binutils</a></p>
<p><a href="http://www.veryitman.com/2017/10/07/GCC-%E5%85%B1%E4%BA%AB%E5%BA%93/" target="_blank" rel="noopener">GCC: å…±äº«åº“</a></p>
<p><a href="http://www.veryitman.com/2017/10/08/GCC-%E9%9D%99%E6%80%81%E5%BA%93/" target="_blank" rel="noopener">GCC: é™æ€åº“</a></p>
]]></content>
      
        <categories>
            
            <category> C/C++ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GCC C ç¼–è¯‘å™¨ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS APNs: å¤„ç†æ•°æ®]]></title>
      <url>/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/</url>
      <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åšæ–‡: <a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS ç»†è¯´æ¨é€: è¿œç¨‹æ¨é€</a> å’Œ <a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/" target="_blank" rel="noopener">iOS ç»†è¯´æ¨é€: æœ¬åœ°æ¨é€</a><br>åˆ†åˆ«ä»‹ç»äº† iOS çš„ä¸¤ç§å…¸å‹æ¨é€, iOS è¿˜æœ‰å¾ˆå¤šç±»å‹çš„æ¨é€, å¦‚é™é»˜æ¨é€, VOIP æ¨é€(iOS8)ç­‰, åé¢ä¼šæ…¢æ…¢ä»‹ç»ç»™å¤§å®¶.</p>
<p>ä»Šå¤©è·Ÿå¤§å®¶èŠèŠå…³äºå¦‚ä½•å¤„ç†æ¨é€çš„æ•°æ®(payload).</p>
<p>è¯¥ç³»åˆ—åšå®¢:</p>
<blockquote>
<p><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: è¿œç¨‹æ¨é€</a><br><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: æœ¬åœ°æ¨é€</a><br>iOS APNs: å¤„ç†æ•°æ®(æœ¬ç¯‡)<br><a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: é™é»˜æ¨é€</a><br><a href="http://www.veryitman.com/2018/02/08/iOS-APNs-Background-Fetch/" target="_blank" rel="noopener">iOS APNs: Background Fetch</a></p>
</blockquote>
<h2 id="æ¨é€çš„ä»£ç†å›è°ƒæ—¶æœº"><a href="#æ¨é€çš„ä»£ç†å›è°ƒæ—¶æœº" class="headerlink" title="æ¨é€çš„ä»£ç†å›è°ƒæ—¶æœº"></a>æ¨é€çš„ä»£ç†å›è°ƒæ—¶æœº</h2><p>è¿˜è®°å¾— AppDelegate é‡Œé¢å…³äºæ¨é€çš„å‡ ä¸ªä»£ç†æ–¹æ³•å§.<br>~ ä¼°è®¡ä½ ä¹Ÿå¿˜è®°äº†, æ²¡å…³ç³», æˆ‘ä»¬å†ä¸€èµ·æ•´ç†ä¸€ä¸‹.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;markApp push. RemotePush userInfo: %@&quot;, userInfo);</div><div class="line">    </div><div class="line">    // å¯ä»¥æ ¹æ®æ¨é€å†…å®¹å†³å®šä¸‹ä¸€æ­¥çš„è¡Œä¸º</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•åœ¨æ¥æ”¶åˆ° RemotePush çš„æ—¶å€™, è°ƒç”¨æ—¶æœº:</p>
<p>1.APP åœ¨å‰å°è¿è¡Œçš„, RemotePush è¢«æ¨é€è¿‡æ¥äº†.<br>2.APP åœ¨åå°è¿è¡Œ, æ— è®ºæ˜¯å¦è¢«æŒ‚èµ·åªè¦æ²¡æœ‰è¢«æ€æ­», ç‚¹å‡»æ¨é€å†…å®¹.</p>
<p>ä»¥ä¸Šä¸¤ç§æƒ…å†µå‡å¯ä»¥è¿›å…¥ didReceiveRemoteNotification æ–¹æ³•.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App push. LocalPush notification: %@&quot;, notification);</div><div class="line">    </div><div class="line">    // å¯ä»¥æ ¹æ®æ¨é€å†…å®¹å†³å®šä¸‹ä¸€æ­¥çš„è¡Œä¸º</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•æ¥æ”¶åˆ° LocalPush çš„æ—¶å€™, è°ƒç”¨æ—¶æœº:</p>
<p>1.APP åœ¨å‰å°è¿è¡Œçš„, LocalPush è¢«æ¨é€è¿‡æ¥äº†.<br>2.APP åœ¨åå°è¿è¡Œ, æ— è®ºæ˜¯å¦è¢«æŒ‚èµ·åªè¦æ²¡æœ‰è¢«æ€æ­», ç‚¹å‡»æ¨é€å†…å®¹.</p>
<p>ä»¥ä¸Šä¸¤ç§æƒ…å†µå‡å¯ä»¥è¿›å…¥ didReceiveLocalNotification æ–¹æ³•.</p>
<p>è¿™ä¸¤ä¸ªå›è°ƒæ–¹æ³•, åˆ†åˆ«æ¥æ”¶ RemotePush å’Œ LocalPush çš„æ¨é€æ¶ˆæ¯.</p>
<p>æœ‰äº›äººä¼šé—®äº†, å‡å¦‚è¿™ä¸ªæ—¶å€™æˆ‘çš„åº”ç”¨åœ¨åå°, è¢«ç³»ç»Ÿæ€æ­»äº†æˆ–è€…è¢«ç”¨æˆ·åŒå‡» Home é”®æ€æ­»äº†, æ­¤æ—¶è¿œç¨‹æ¨é€è¿‡æ¥äº†, æˆ–è€…çŠ¶æ€æ é‡Œé¢æœ‰æœ¬åœ°æ¨é€çš„æ¶ˆæ¯, æˆ‘ç‚¹å‡»æ¨é€æ¶ˆæ¯, è¿™ä¸¤ä¸ªæ–¹æ³•ä¼šè¢«è°ƒç”¨å—?</p>
<p>ç±»ä¼¼è¿™ç§æ•ˆæœ, ä¸Šé¢æ˜¯ RemotePush, ä¸‹é¢æ˜¯ LocalPush.</p>
<p><img src="/upload/images/2017/08/07/1.jpg" alt="1"></p>
<p>æˆ‘è‚¯å®šçš„å‘Šè¯‰å¤§å®¶, åº”ç”¨è¢«æ€æ­»çš„æƒ…å†µä¸‹, ç‚¹å‡»æ¨é€å†…å®¹, didReceiveRemoteNotification å’Œ didReceiveLocalNotification éƒ½ä¸ä¼šè¢«è°ƒç”¨.</p>
<p>è¿™ä¸ªæ—¶å€™, AppDelegate ä¸­çš„å¦ä¸€ä¸ªæ–¹æ³•ä¸Šåœºäº†.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application </div><div class="line">    didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</div></pre></td></tr></table></figure>
<p>çœ‹ä¸€ä¸‹ didFinishLaunchingWithOptions çš„å…·ä½“å®ç°, ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</div><div class="line">    </div><div class="line">    /// å°†åº”ç”¨å›¾æ ‡çš„ badge æ¸…é›¶</div><div class="line">    &#123;</div><div class="line">        [[UIApplication sharedApplication] setApplicationIconBadgeNumber:1];</div><div class="line">        [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0];</div><div class="line">        [[UIApplication sharedApplication] cancelAllLocalNotifications];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if (nil != launchOptions) &#123;</div><div class="line">        /// å¤„ç† LocalPush</div><div class="line">        &#123;</div><div class="line">            // è¿™é‡Œå¯ä»¥å¾—åˆ° UILocalNotification å¯¹è±¡</div><div class="line">            id localPushNotify = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];</div><div class="line">            </div><div class="line">            MZLOG(@&quot;AppDelegate localPush: %@&quot;, localPushNotify);</div><div class="line">            </div><div class="line">            if (nil != localPushNotify) &#123;</div><div class="line">                if ([localPushNotify isKindOfClass:[UILocalNotification class]]) &#123;</div><div class="line">                    // è·å– userinfo æ•°æ®</div><div class="line">                    NSDictionary *userInfo = [(UILocalNotification *)localPushNotify userInfo];</div><div class="line">                    MZLOG(@&quot;AppDelegate localPush of UILocalNotification: %@&quot;, userInfo);</div><div class="line">                    </div><div class="line">                    // æ ¹æ® userInfo çš„å†…å®¹å¤„ç†å¦‚é¡µé¢è·³è½¬ç­‰</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        /// å¤„ç† RemotePush</div><div class="line">        &#123;</div><div class="line">            NSDictionary *remotePushNotify = [launchOptions objectForKey:UIApplicationLaunchOptionsRemoteNotificationKey];</div><div class="line">            MZLOG(@&quot;AppDelegate remotePush: %@&quot;, remotePushNotify);</div><div class="line">            </div><div class="line">            if (nil != remotePushNotify) &#123;</div><div class="line">                NSDictionary *remoteAps = [remotePushNotify objectForKey:@&quot;aps&quot;];</div><div class="line">                MZLOG(@&quot;AppDelegate remotePush. The aps&apos; info, alert: %@, badge: %@, sound: %@&quot;,</div><div class="line">                      [remoteAps objectForKey:@&quot;alert&quot;],</div><div class="line">                      [remoteAps objectForKey:@&quot;badge&quot;], [remoteAps objectForKey:@&quot;sound&quot;]);</div><div class="line">                // æ ¹æ®æ¨é€çš„å†…å®¹å¤„ç†å¦‚é¡µé¢è·³è½¬ç­‰</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;AppDelegate. launchOptions: %@&quot;, launchOptions);</div><div class="line">    </div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯¹åº”çš„æ‰“å°è¾“å‡ºå†…å®¹, å¦‚ä¸‹</p>
<p>æœ¬åœ°æ¨é€çš„å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> AppDelegate localPush of UILocalNotification: &#123;</div><div class="line">    &quot;user_info_key&quot; = &quot;user_info_value_json_str&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿œç¨‹æ¨é€çš„å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">aps = &#123;</div><div class="line">            alert = &quot;Testing.. (2)&quot;;</div><div class="line">            badge = 1;</div><div class="line">            sound = default;</div><div class="line">      &#125;;</div><div class="line">            </div><div class="line">The aps&apos; info, alert: Testing.. (19), badge: 1, sound: default</div></pre></td></tr></table></figure>
<h2 id="è‡ªå®šä¹‰æ¨é€å†…å®¹"><a href="#è‡ªå®šä¹‰æ¨é€å†…å®¹" class="headerlink" title="è‡ªå®šä¹‰æ¨é€å†…å®¹"></a>è‡ªå®šä¹‰æ¨é€å†…å®¹</h2><blockquote>
<p>å¯¹äºæ¨é€çš„æ•°æ®æ ¼å¼, æ˜¯è‹¹æœè§„å®šçš„æ ¼å¼, æˆ‘ä»¬å¯ä»¥åœ¨å…¶åŸºç¡€ä¸Šæ·»åŠ æˆ‘ä»¬éœ€è¦çš„æ•°æ®.</p>
</blockquote>
<p>åœ¨ä»‹ç»ä¸‹é¢å†…å®¹ä¹‹å‰, å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ payload.</p>
<blockquote>
<p>payload æ˜¯æ¨é€é€šçŸ¥çš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸€æ¡æ¨é€é€šçŸ¥éƒ½åŒ…å«ä¸€ä¸ª Payload.<br>å®ƒåŒ…å«äº†ç³»ç»Ÿæé†’ç”¨æˆ·é€šçŸ¥åˆ°è¾¾çš„æ–¹å¼ï¼Œè¿˜å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„æ•°æ®, å³é€šçŸ¥ä¸»è¦ä¼ é€’çš„æ•°æ®ä¸º payload.</p>
<p>Payload æœ¬èº«ä¸º JSON æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå®ƒå†…éƒ¨å¿…é¡»è¦åŒ…å«ä¸€ä¸ªé”®ä¸º aps çš„å­—å…¸.ä¹Ÿå°±æ˜¯è¯´ payload æ˜¯æ•´ä¸ªå­—ç¬¦ä¸².</p>
</blockquote>
<p>å…³äº payload çš„é™åˆ¶</p>
<p>åœ¨æ—©æœŸçš„æ¨é€ä¸­, payload ä¸èƒ½è¶…è¿‡ 256bytes, ä¸­é—´è¿˜ç»å†è¿‡æ¨é€çš„ payload æœ€å¤§ä¸º 2KB.<br>ç°åœ¨è‹¹æœæ”¯æŒæœ€å¤§ä¸º5KB(VOIP æ¨é€), å®˜æ–¹æ–‡æ¡£æœ‰è¯´, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">For regular remote notifications, the maximum size is 4KB (4096 bytes)</div><div class="line">For Voice over Internet Protocol (VoIP) notifications, the maximum size is 5KB (5120 bytes)</div><div class="line">NOTE</div><div class="line">If you are using the legacy APNs binary interface to send notifications instead of an HTTP/2 request, the maximum payload size is 2KB (2048 bytes)</div></pre></td></tr></table></figure>
<p>ä¸Šé¢æ˜¯ <a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html#//apple_ref/doc/uid/TP40008194-CH10-SW1" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a> çš„åŸæ–‡, å¤§æ¦‚æ„æ€æ˜¯:</p>
<blockquote>
<p>ç°åœ¨ APNs æ”¯æŒ payload ä¸º 4KB, å¦‚æœæ˜¯ VoIP æ¨é€çš„è¯, æ”¯æŒ 5KB. ä½†æ˜¯, å¦‚æœä½ ä½¿ç”¨ä¼ ç»Ÿçš„ APNs è€Œä¸æ˜¯ä½¿ç”¨ HTTP/2 çš„è¯, æœ€å¤§æ”¯æŒ 2KB. ä¹Ÿå°±æ˜¯è¯´, æ¨é€çš„ payload å¤§å°å’Œ iOS ç³»ç»Ÿæ— å…³, è€Œæ˜¯å’Œåè®®æœ‰å…³.</p>
</blockquote>
<p>å¯ä»¥ä½¿ç”¨ä¸‹é¢ä»£ç , æŸ¥çœ‹ payload é•¿åº¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">payload.getBytes().length</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ­£å¸¸çš„æ¨é€å†…å®¹æ˜¯è¿™æ ·çš„, æ­£å¸¸æ ¼å¼:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&quot;aps&quot;:&#123;&quot;alert&quot;:&quot;Testing.. (21)&quot;,&quot;badge&quot;:1,&quot;sound&quot;:&quot;default&quot;&#125;&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³å¯¹æ¨é€å†…å®¹åšè‡ªå®šä¹‰, å¯ä»¥è‡ªå·±æ·»åŠ é¢å¤–çš„æ•°æ®, å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&quot;aps&quot;:&#123;&quot;alert&quot;:&quot;Testing.. (21)&quot;,&quot;badge&quot;:1,&quot;sound&quot;:&quot;default&quot;&#125;, &quot;ext&quot;:&#123;&quot;key&quot;:&quot;value&quot;&#125;&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­, ext å°±æ˜¯é¢å¤–æ·»åŠ çš„æ•°æ®æ¨¡å‹.</p>
<p>åœ¨ APP æ”¶åˆ°è¿™æ ·çš„æ•°æ®æ¨¡å‹æ—¶, å¯ä»¥å¯¹åº”ä¸åŒçš„è¡Œä¸º.</p>
<p>å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚, è‡ªè¡Œå®šä¹‰æ•°æ®æ ¼å¼.</p>
<p>è‡ªå®šä¹‰çš„æ•°æ®æ ¼å¼, æ³¨æ„å†…å®¹çš„é•¿åº¦, åœ¨ä¸åŒçš„ iOS ç³»ç»Ÿä¸Šé¢, å¯¹äºæ¨é€çš„å†…å®¹æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„.</p>
<h2 id="å†å” å¨å‡ å¥"><a href="#å†å” å¨å‡ å¥" class="headerlink" title="å†å” å¨å‡ å¥"></a>å†å” å¨å‡ å¥</h2><p>å…³äº iOS7 ä»¥åæ·»åŠ çš„æ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application </div><div class="line">    didReceiveRemoteNotification:(NSDictionary *)userInfo </div><div class="line">    fetchCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯åœ¨ AppDelegate ä¸­å®ç°çš„.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application </div><div class="line">    didReceiveRemoteNotification:(NSDictionary *)userInfo</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•åœ¨ iOS3 å°±å·²ç»æœ‰äº†, å¯è°“æ˜¯å†å²æ‚ ä¹….æˆ‘å§‘ä¸”ç§°ä¹‹ä¸ºè¯¥æ–¹æ³•ä¸º FatherMethod, ä¸Šé¢é‚£ä¸ªæ–°åŠ å…¥çš„ç§°ä¹‹ä¸º SonMethod.</p>
<p><strong>æ³¨æ„äº‹é¡¹:</strong></p>
<p>[1]. å®ç°äº† FatherMethod, å³ä½¿ä½ å®ç°äº† SonMethod, SonMethod ä¹Ÿä¸ä¼šè¢«è°ƒç”¨.<br>[2]. SonMethod æ¯” FatherMethod å¤šäº†ä¸€ä¸ªå‚æ•° completionHandler, è¿™ä¸ªåœ¨åé¢ä¼šè¯´åˆ°.ä¸»è¦ç”¨äº Background Mode ä¸­çš„ Background Fetch.<br>[3]. æ¨é€è¢«è°ƒç”¨çš„æ—¶æœº, é™¤äº† FatherMethod çš„æ—¶æœºå¤–, è¿˜å¤šäº†ä¸€ç§æ—¶æœº, å°±æ˜¯åœ¨ APP è¢«æ€æ­»å, ç‚¹å‡»æ¨é€å†…å®¹æ‰“å¼€ APP, æ­¤æ—¶ APP å†æ¬¡å›åˆ°å‰å°çš„æ—¶å€™, è¯¥æ–¹æ³•ä¹Ÿä¼šè¢«è°ƒç”¨(didFinishLaunchingWithOptionsä¹Ÿä¼šè°ƒç”¨), æ‰€ä»¥åœ¨å¤„ç†è¿œç¨‹æ¨é€å†…å®¹çš„æ—¶å€™, è¦æ³¨æ„è¿™ä¸€ç‚¹.</p>
<p>é’ˆå¯¹æ³¨æ„äº‹é¡¹[3], ç›®å‰æˆ‘èƒ½ç»™å‡ºçš„æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆ:</p>
<p>ç¬¬ä¸€, åˆ¤æ–­æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ APP, å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ APP, ç»Ÿä¸€åœ¨didFinishLaunchingWithOptions ä¸­å¤„ç†, ä¸åœ¨ SonMethod ä¸­å¤„ç†.</p>
<p>ç¬¬äºŒ, è¿œç¨‹æ¨é€ç»Ÿä¸€åœ¨ SonMethod ä¸­å¤„ç†, didFinishLaunchingWithOptions ä¸­åªå¤„ç†åœ¨ APP è¢«æ€æ­»çš„æƒ…å†µä¸‹, ç”¨æˆ·ç‚¹å‡»æ¨é€æœ¬åœ°çš„å†…å®¹.</p>
<p>æˆ‘ä¸ªäººé‡‡ç”¨çš„æ˜¯ç¬¬äºŒä¸­æ–¹æ¡ˆ.</p>
<h2 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h2><p>åœ¨æ¨é€å·¥å…· NWPusher å’Œ Xcode çš„ Window/Devices/Console å¸®åŠ©ä¸‹, æ‰å¾—ä»¥å®Œå–„åšæ–‡.</p>
<p>NWPusher ç”¨æ¥å‘é€æ¨é€å†…å®¹.</p>
<p>Window/Devices/Console ç”¨äºæŸ¥çœ‹è¾“å‡ºæ—¥å¿—.</p>
<h2 id="å¿…çœ‹æ–‡æ¡£"><a href="#å¿…çœ‹æ–‡æ¡£" class="headerlink" title="å¿…çœ‹æ–‡æ¡£"></a>å¿…çœ‹æ–‡æ¡£</h2><p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html#//apple_ref/doc/uid/TP40008194-CH10-SW1" target="_blank" rel="noopener">Creating the Remote Notification Payload</a></p>
<p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/PayloadKeyReference.html#//apple_ref/doc/uid/TP40008194-CH17-SW1" target="_blank" rel="noopener">Payload Key Reference</a></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> APNs æ¨é€ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS APNs: æœ¬åœ°æ¨é€]]></title>
      <url>/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚æ‹¬"><a href="#æ¦‚æ‹¬" class="headerlink" title="æ¦‚æ‹¬"></a>æ¦‚æ‹¬</h2><p><code>iOS APNs: è¿œç¨‹æ¨é€</code> è¯´è¿‡è¿œç¨‹æ¨é€(RemotePush).</p>
<p>ä»Šå¤©è¯´è¯´æœ¬åœ°æ¨é€, æœ¬åœ°æ¨é€ä¹Ÿå°±æ˜¯å¹³æ—¶æ‰€è¯´çš„ LocalPush.</p>
<p>è¯¥ç³»åˆ—åšå®¢:</p>
<blockquote>
<ul>
<li><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: è¿œç¨‹æ¨é€</a></li>
<li>iOS APNs: æœ¬åœ°æ¨é€(æœ¬ç¯‡)</li>
<li><a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/" target="_blank" rel="noopener">iOS APNs: å¤„ç†æ•°æ®</a></li>
<li><a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: é™é»˜æ¨é€</a></li>
<li><a href="http://www.veryitman.com/2018/02/08/iOS-APNs-Background-Fetch/" target="_blank" rel="noopener">iOS APNs: Background Fetch</a></li>
</ul>
</blockquote>
<h2 id="ä¸šåŠ¡åœºæ™¯"><a href="#ä¸šåŠ¡åœºæ™¯" class="headerlink" title="ä¸šåŠ¡åœºæ™¯"></a>ä¸šåŠ¡åœºæ™¯</h2><p>åœ¨å…·ä½“å®ç°ä¹‹å‰, å…ˆè¯´ä¸€ä¸‹ä¸šåŠ¡åœºæ™¯.</p>
<p>å‡å¦‚ä½ çš„ APP å…·æœ‰ IM(å³æ—¶é€šè®¯) åŠŸèƒ½, è¿™ä¸ªæ—¶å€™, ä½ å¯ä»¥æ ¹æ®è¿æ¥æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨çº¿, å¦‚æœä¸åœ¨çº¿, å¯ä»¥ä½¿ç”¨è¿œç¨‹æ¨é€å°†æ¨é€å†…å®¹å‘ŠçŸ¥ç”¨æˆ·.å¦‚æœåœ¨çº¿, å¯ä»¥é€šè¿‡ IM æŠŠå†…å®¹å‘Šè¯‰ APP, APP æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯å, å¯ä»¥ä½¿ç”¨æœ¬åœ°æ¨é€å‘ŠçŸ¥ç»™ç”¨æˆ·.</p>
<p>æ®è¯´ APNs æ¯å¤©è¦å¤„ç†çš„æ¨é€åœ¨äº¿çº§åˆ«, æ‰€ä»¥å¦‚æœå¯ä»¥ä½¿ç”¨ LocalPush å®Œæˆçš„ä¸šåŠ¡, æˆ‘å»ºè®®å¤§å®¶è¿˜æ˜¯ä¸è¦ä½¿ç”¨è¿œç¨‹æ¨é€, å†µä¸”è‹¹æœå¹¶ä¸ä¸€å®šä¿è¯è¿œç¨‹æ¨é€ä¸€å®šæˆåŠŸ, å¦‚æœç½‘ç»œæˆ–è€… APNs å‹åŠ›å¤§, æ¨é€ä¹Ÿä¼šå»¶æ—¶.</p>
<p>ç»™è‹¹æœå‡å°‘ç‚¹å‹åŠ›å§, å“ˆå“ˆ!</p>
<p>å†è¯´ä¸€ä¸ªä¸šåŠ¡åœºæ™¯, ä½ çš„ APP åœ¨åå°è¿è¡Œæ—¶é—´å¿«åˆ°è¦è¢«ç³»ç»ŸæŒ‚èµ·çš„æ—¶å€™äº†, ä½ å¯ä»¥å‘é€ä¸€ä¸ª LocalPush æ¥æç¤ºç”¨æˆ·æˆ–è€…åˆºæ¿€ç”¨æˆ·, å†æ¬¡å°† APP æ‹‰å›å‰å°è¿è¡Œ. è¿™æ ·å¯ä»¥ä¿è¯ APP å¯ä»¥æ­£å¸¸è¿è¡Œäº†.</p>
<p>ä¸Šé¢è¯´çš„ç¬¬äºŒä¸ªä¸šåŠ¡åœºæ™¯, æ˜¯ä»Šå¤©ä¾‹å­çš„åŸºç¡€, ä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…ä¸šåŠ¡åœºæ™¯æ¥ä½¿ç”¨ LocalPush åŠŸèƒ½.</p>
<h2 id="LocalPush-ç®€ä»‹"><a href="#LocalPush-ç®€ä»‹" class="headerlink" title="LocalPush ç®€ä»‹"></a>LocalPush ç®€ä»‹</h2><p>LocalPush å…è®¸ APP å‘ç”¨æˆ·å‘é€é€šçŸ¥, å¯¹äºç”¨æˆ·æ¥è¯´, å°±è·Ÿè¿œç¨‹æ¨é€æ˜¯ä¸€æ ·çš„, åŸºæœ¬æ²¡æœ‰æ„ŸçŸ¥, å¼€å‘è€…ä¹Ÿä¸å¸Œæœ›ç”¨æˆ·æœ‰æ„ŸçŸ¥.</p>
<p>æ¨é€æ•ˆæœå›¾:</p>
<p><img src="/upload/images/2017/08/06/1.png" alt="1"></p>
<blockquote>
<p>æ³¨æ„: å¦‚æœä½ çš„ APP åœ¨å‰å°, å‘é€ LocalPush æ˜¯ä¸ä¼šè¦ä¸Šè¿°æ•ˆæœçš„.<br>å¦‚æœåœ¨å‰å°, å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„å¼¹æ¡†æ¥æç¤ºç”¨æˆ·.</p>
</blockquote>
<p>LocalPush åŒæ ·éœ€è¦ç”¨æˆ·æˆæƒæ¨é€çš„æƒé™, å¦åˆ™ä¹Ÿæ— æ³•å‘é€æˆåŠŸ.è¿™ä¸ªè·Ÿè¿œç¨‹æ¨é€æ˜¯ä¸€æ ·çš„.</p>
<p>å¦å¤–, LocalPush éœ€è¦ APP åœ¨åå°æ²¡æœ‰è¢«æŒ‚èµ·çš„æƒ…å†µä¸‹, æ‰èƒ½å‘é€, å¦åˆ™æ— æ³•å¯ç”¨.</p>
<p>å‘é€ LocalPush çš„ä¸€ä¸ªå¥½å¤„æ˜¯ä¸éœ€è¦ç”¨æˆ·è¿æ¥ç½‘ç»œ, è¿™ä¸ªæ˜¯åŒºåˆ«äºè¿œç¨‹æ¨é€çš„, å› ä¸ºè¿œç¨‹æ¨é€å¿…é¡»è¦æ±‚ç”¨æˆ·è¿æ¥ç½‘ç»œçš„.å¾ˆå¤šå•æœºæ¸¸æˆæˆ–è€…å¼±è”ç½‘çš„æ¸¸æˆ, å‘é€çš„æ¨é€éƒ½æ˜¯ LocalPush, è€Œéè¿œç¨‹æ¨é€.</p>
<p>åœ¨é˜…è¯»ä¸‹é¢å†…å®¹ä¹‹å‰, å»ºè®®å¤§å®¶å…ˆçœ‹çœ‹ iOS åå°æ¨¡å¼ è¿™ç¯‡æ–‡ç« .æœ¬ç¯‡ä¹Ÿæ˜¯åŸºäºè¿™ä¸ªä¸ºåŸºç¡€çš„.</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>è¿™ä¸ªç¤ºä¾‹, å®ç°çš„åœºæ™¯å¦‚ä¸‹:</p>
<p>ç”¨æˆ·æ‰“å¼€ APP, æˆæƒäº†æ¨é€çš„æƒé™, ç”¨æˆ·è¯•ç©ä¸€ä¼šä¹‹å, å°† APP é€€åˆ°äº†åå°, APP ç›‘å¬é€€åˆ°åå°ä¹‹å, å»¶æ—¶ä¸€å®šæ—¶é—´å‘é€ LocalPush ç»™ç”¨æˆ·.</p>
<p>AppDelegate.m ä¸­ä½¿ç”¨åå°æ¨¡å¼</p>
<p>å…³äº MZBackgroundTask çš„å®ç°, é™„å½•ç»™å‡º.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (void)applicationDidEnterBackground:(UIApplication *)application &#123;</div><div class="line">    </div><div class="line">    [[MZBackgroundTask sharedTask] startTask];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>ViewController.m</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    [[NSNotificationCenter defaultCenter] addObserver:self</div><div class="line">                                             selector:@selector(onDidEnterBackground:)</div><div class="line">                                                 name:UIApplicationDidEnterBackgroundNotification</div><div class="line">                                               object:nil];</div><div class="line">&#125;</div><div class="line">- (void)onDidEnterBackground:(NSNotification *)notification &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App Background. Enter onDidEnterBackground.&quot;);</div><div class="line">    </div><div class="line">    // ç­‰å¾… 6s å, è¿™ä¸ªæ—¶é—´å¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µå»ä¿®æ”¹, è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿ</div><div class="line">    int delta = 6;</div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delta * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">        </div><div class="line">        MZLOG(@&quot;App Background. Enter onDidEnterBackground diapatch.&quot;);</div><div class="line">        </div><div class="line">        if (UIApplicationStateBackground == [UIApplication sharedApplication].applicationState) &#123;</div><div class="line">            UILocalNotification *notification = [UILocalNotification new];</div><div class="line">            notification.alertBody = @&quot;èµ°, å»highå§!&quot;;</div><div class="line">            notification.soundName = UILocalNotificationDefaultSoundName;</div><div class="line">            // åº”ç”¨å›¾æ ‡ä¸Šé¢æ˜¾ç¤ºçš„æ•°å­—</div><div class="line">            notification.applicationIconBadgeNumber = notification.applicationIconBadgeNumber + 1;</div><div class="line">            // å¯ä»¥è‡ªå®šä¹‰æ•°æ®</div><div class="line">            notification.userInfo = @&#123;@&quot;user_info_key&quot;: @&quot;user_info_value_json_str&quot;&#125;;</div><div class="line">            </div><div class="line">            [[UIApplication sharedApplication] scheduleLocalNotification:notification];</div><div class="line">        &#125;</div><div class="line">        else &#123;</div><div class="line">        	// æ˜¾ç¤ºè‡ªå®šä¹‰å¼¹æ¡†ç­‰</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å°† APP ç‚¹å‡» Home é”®é€€åˆ°åå°, 6s åå¯ä»¥çœ‹åˆ°æ¨é€çš„æ•ˆæœ.</p>
<p>ç‚¹å‡»æ¨é€çš„æç¤ºæ¡†, å†æ¬¡æ‰“å¼€äº† APP, ä¼šæ‰§è¡Œ AppDelegate ä¸­çš„æ–¹æ³•, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App push. notification: %@&quot;, notification);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°å‡ºæ¥çš„ notification, å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="/upload/images/2017/08/06/2.jpg" alt="1"></p>
<p>å…¶ä¸­, user_info æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ•°æ®éƒ¨åˆ†.</p>
<p>é™„å½•</p>
<blockquote>
<p>MZBackgroundTask å®ç°</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line">#import &quot;MZBackgroundTask.h&quot;</div><div class="line"></div><div class="line">@implementation MZBackgroundTask</div><div class="line"></div><div class="line">+ (instancetype)sharedTask &#123;</div><div class="line">    </div><div class="line">    static MZBackgroundTask *_task;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        _task = [[self alloc] init];</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    return _task;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)startTask &#123;</div><div class="line">    </div><div class="line">    if (![self _checkSupportBackgroundTask]) &#123;</div><div class="line">        MZLOG(@&quot;BackgroundTask. Current device don&apos;t support backgroundTask.&quot;);</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    UIApplication *application = [UIApplication sharedApplication];</div><div class="line">    </div><div class="line">    __block UIBackgroundTaskIdentifier taskId;</div><div class="line">    </div><div class="line">    /// ç”³è¯·åå°æ‰§è¡Œ</div><div class="line">    /// æ³¨æ„: åœ¨iOS7å’Œè¯¥ç‰ˆæœ¬å‰ï¼Œåå°å¯ä»¥ç”¨ä¸‹é¢çš„çš„æ–¹å¼åœ¨åå°å­˜æ´»5-10åˆ†é’Ÿï¼Œåœ¨iOS8åŠåï¼Œæœ€å¤šå­˜æ´»3åˆ†é’Ÿ</div><div class="line">    &#123;</div><div class="line">        taskId = [application beginBackgroundTaskWithName:NSStringFromClass([self class]) expirationHandler:^&#123;</div><div class="line">            </div><div class="line">            MZLOG(@&quot;BackgroundTask. BackgroundTask is Over. The remained time: %f&quot;, application.backgroundTimeRemaining);</div><div class="line">            </div><div class="line">            [application endBackgroundTask:taskId];</div><div class="line">            </div><div class="line">            taskId = UIBackgroundTaskInvalid;</div><div class="line">        &#125;];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if (UIBackgroundTaskInvalid == taskId) &#123;</div><div class="line">        </div><div class="line">        MZLOG(@&quot;BackgroundTask. Apply backgroundTask failed.&quot;);</div><div class="line">        </div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    /// å¯ä»¥ç›‘æ§åå°ä»»åŠ¡å‰©ä½™çš„æ—¶é—´, é’ˆå¯¹ä¸šåŠ¡å¯ä»¥å»å¤„ç†</div><div class="line">    &#123;</div><div class="line">        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">            </div><div class="line">            while (true) &#123;</div><div class="line">                // å‰©ä½™å¯ä»¥åå°æ‰§è¡Œçš„æ—¶é—´</div><div class="line">                NSTimeInterval remainedTime = application.backgroundTimeRemaining;</div><div class="line">                MZLOG(@&quot;BackgroundTask. The remained time: %f&quot;, remainedTime);</div><div class="line">                </div><div class="line">                if (remainedTime &lt; 2) &#123;</div><div class="line">                    // å¯ä»¥å‘Šè¯‰å…¶ä»–ä¸šåŠ¡, åå°ä»»åŠ¡å³å°†ç»“æŸäº†</div><div class="line">                    break;</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">                // ç¡çœ (å»¶æ—¶)1s</div><div class="line">                [NSThread sleepForTimeInterval:1.f];</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            /// è¿™é‡Œå¯ä»¥åšä¸€äº›æ¸…é™¤å·¥ä½œ</div><div class="line">            &#123;</div><div class="line">                // clean up</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            [application endBackgroundTask:taskId];</div><div class="line">            </div><div class="line">            taskId = UIBackgroundTaskInvalid;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - Private.</div><div class="line"></div><div class="line">/**</div><div class="line"> *  å½“å‰è®¾å¤‡æ˜¯å¦æ”¯æŒåå°ä»»åŠ¡.</div><div class="line"> *</div><div class="line"> *  @return YES, æ”¯æŒåå°ä»»åŠ¡. å¦åˆ™, ä¸æ”¯æŒåå°ä»»åŠ¡.</div><div class="line"> */</div><div class="line">- (BOOL)_checkSupportBackgroundTask &#123;</div><div class="line">    </div><div class="line">    SEL sel = @selector(isMultitaskingSupported);</div><div class="line">    BOOL supportBTask = [[UIDevice currentDevice] respondsToSelector:sel];</div><div class="line">    </div><div class="line">    return supportBTask;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> APNs è¿œç¨‹æ¨é€ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS APNs: è¿œç¨‹æ¨é€]]></title>
      <url>/2017/08/06/iOS-APNs-%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>æœ¬ç¯‡åšæ–‡, ä½ é¦–å…ˆéœ€è¦çŸ¥é“çš„å†…å®¹:</p>
<blockquote>
<p>1.äº†è§£è¿‡ Push.<br>2.é˜…è¯»è¿‡ [iOS åå°æ¨¡å¼] è¿™ç¯‡æ–‡ç« .<br>3.ç”³è¯·è¿‡è‹¹æœè¯ä¹¦æˆ–è€…çŸ¥é“å¦‚ä½•ç”³è¯·å’Œåˆ¶ä½œè¯ä¹¦.<br>4.iOS å¼€å‘åŸºæœ¬çŸ¥è¯†.</p>
</blockquote>
<p>ä½ åœ¨è¿™ç¯‡åšæ–‡å°†ä¼šå­¦åˆ°:</p>
<blockquote>
<p>1.Push çš„å‘å±•å†ç¨‹.<br>2.å¼€æºæ¨é€å·¥å…· NWPusher çš„ä½¿ç”¨.<br>3.Push çš„åŸºæœ¬åŸç†.</p>
</blockquote>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>APNs, è‹¹æœæ¨é€é€šçŸ¥æœåŠ¡. å…¨ç§°æ˜¯: Apple Push Notification Service.</p>
<p>æ¨é€æŒ‡çš„æ˜¯ç”± APNs æœåŠ¡å™¨ã€ProviderServiceã€iOS ç³»ç»Ÿã€App æ„æˆçš„é€šè®¯ç³»ç»Ÿï¼Œä¹Ÿæ˜¯ç§»åŠ¨äº’è”ç½‘ä¸ä¼ ç»Ÿçš„ Web æœ€æ˜æ˜¾ä¸åŒçš„.</p>
<p>å®˜æ–¹æœ‰æ¯”è¾ƒè¯¦ç»†çš„æ–‡æ¡£ä»‹ç», å¯ä»¥æˆ³è¿™é‡Œ <a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/APNSOverview.html#//apple_ref/doc/uid/TP40008194-CH8-SW1" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a> æŸ¥çœ‹.</p>
<p>è‹¹æœçš„æ–‡æ¡£å†™çš„ç¡®å®å¥½, ä½†æ˜¯ä½œä¸ºç¨‹åºå‘˜, æœ€é‡è¦çš„è¿˜æ˜¯è¦ç»“åˆç†è®ºå»å®è·µ.</p>
<p>æœ¬ç¯‡ç»“åˆè‡ªå·±çš„å®è·µå’Œå¯¹æ¨é€çš„ç†è§£, è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æ¨é€ç›¸å…³çš„çŸ¥è¯†.</p>
<h2 id="Push-å‘å±•å†ç¨‹"><a href="#Push-å‘å±•å†ç¨‹" class="headerlink" title="Push å‘å±•å†ç¨‹"></a>Push å‘å±•å†ç¨‹</h2><p>iOS å†ç»å¾ˆå¤šç‰ˆæœ¬, ä¸€ç›´åœ¨ä¼˜åŒ–æˆ–è€…è¯´æ˜¯è¿›åŒ–æ¨é€ç›¸å…³çš„å†…å®¹, æ— è®ºæ˜¯ä»å®ç”¨æ€§å’ŒæŠ€æœ¯ä¸Šæ¥çœ‹, æ¨é€æ˜¯è‡³å…³é‡è¦çš„.</p>
<p>çœ‹ä¸€ä¸‹ push å‘å±•å†ç¨‹</p>
<ul>
<li><p>iOS 3 - å¼•å…¥æ¨é€é€šçŸ¥ UIApplication çš„ registerForRemoteNotificationTypes ä¸ UIApplicationDelegate çš„ application(:didRegisterForRemoteNotificationsWithDeviceToken:)ï¼Œapplication(:didReceiveRemoteNotification:)</p>
</li>
<li><p>iOS 4 - å¼•å…¥æœ¬åœ°é€šçŸ¥ scheduleLocalNotificationï¼ŒpresentLocalNotificationNow:ï¼Œ application(_:didReceive:)</p>
</li>
<li><p>iOS 5 - åŠ å…¥é€šçŸ¥ä¸­å¿ƒé¡µé¢</p>
</li>
<li><p>iOS 6 - é€šçŸ¥ä¸­å¿ƒé¡µé¢ä¸ iCloud åŒæ­¥</p>
</li>
<li><p>iOS 7 - åå°é™é»˜æ¨é€ application(_:didReceiveRemoteNotification:fetchCompletionHandle:)</p>
</li>
<li><p>iOS 8 - é‡æ–°è®¾è®¡ notification æƒé™è¯·æ±‚ï¼ŒActionable é€šçŸ¥ registerUserNotificationSettings(:)ï¼ŒUIUserNotificationAction ä¸ UIUserNotificationCategoryï¼Œapplication(:handleActionWithIdentifier:forRemoteNotification:completionHandler:) ç­‰</p>
</li>
<li><p>iOS 9 - Text Input actionï¼ŒåŸºäº HTTP/2 çš„æ¨é€è¯·æ±‚ UIUserNotificationActionBehaviorï¼Œå…¨æ–°çš„ Provider API ç­‰</p>
</li>
<li><p>iOS 10- æ”¯æŒImages, GIFs, Audio and Videoç±»å‹, å¹¶ä¸”æœ‰ Notification Service Extension ä¸ Notification Content Extensionï¼Œå¯ä»¥å®ç°æ¨é€æ•°æ®åœ¨å±•ç¤ºå‰è¿›è¡Œä¸‹è½½æ›´æ–°ã€å®šåˆ¶é€šçŸ¥ UI, å¹¶ä¸”ç»Ÿä¸€äº†é€šçŸ¥ç±»å‹ï¼Œå…·æœ‰æ—¶é—´é—´éš”é€šçŸ¥ã€åœ°ç†ä½ç½®é€šçŸ¥å’Œæ—¥å†é€šçŸ¥.</p>
</li>
</ul>
<p>è¯¥ç³»åˆ—åšå®¢å…±åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†:</p>
<ul>
<li>iOS APNs: è¿œç¨‹æ¨é€(æœ¬ç¯‡)</li>
<li><a href="http://www.veryitman.com/2017/08/06/iOS-APNs-%E6%9C%AC%E5%9C%B0%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: æœ¬åœ°æ¨é€</a></li>
<li><a href="http://www.veryitman.com/2017/08/07/iOS-APNs-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/" target="_blank" rel="noopener">iOS APNs: å¤„ç†æ•°æ®</a></li>
<li><a href="http://www.veryitman.com/2018/02/06/iOS-APNs-%E9%9D%99%E9%BB%98%E6%8E%A8%E9%80%81/" target="_blank" rel="noopener">iOS APNs: é™é»˜æ¨é€</a></li>
<li><a href="http://www.veryitman.com/2018/02/08/iOS-APNs-Background-Fetch/" target="_blank" rel="noopener">iOS APNs: Background Fetch</a></li>
</ul>
<p>å¦‚æœéœ€è¦å®Œæ•´æºç çš„, å¯ä»¥é€šè¿‡é‚®ä»¶è”ç³»æˆ‘(veritman@126.com), åç»­å®Œæˆåä¼šä¸Šä¼ åˆ° github.</p>
<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å…ˆçœ‹å®˜æ–¹çš„æµç¨‹å›¾, å¦‚ä¸‹æ‰€ç¤º:</p>
<p><img src="/upload/images/2017/08/05/1.jpg" alt="1"></p>
<p>è¯¥æµç¨‹å›¾, ä¸»è¦è¯´æ˜çš„æ˜¯è‡ªå·± ä¸šåŠ¡æœåŠ¡å™¨(Provider) æ¨é€æ¶ˆæ¯åˆ°ç”¨æˆ·(Client APP) çš„æµç¨‹.</p>
<p>æ³¨æ„: è¿™é‡Œè¯´çš„ä»¥åŠæœ¬æ–‡åé¢è¯´çš„ ä¸šåŠ¡æœåŠ¡å™¨, ç»Ÿä¸€æŒ‡çš„æ˜¯å¯ä»¥å‘ APNs å‘é€æ¨é€æ¶ˆæ¯çš„æœåŠ¡å™¨.</p>
<p>ä¸‹é¢è¿™å¼ å›¾æ˜¯æ¯”è¾ƒå®Œæ•´çš„ä¸€å¼ æµç¨‹å›¾, è‡ªå·±ç”»çš„, å‡‘åˆçœ‹å§!</p>
<p><img src="/upload/images/2017/08/05/2.jpg" alt="1"></p>
<p>å¤§æ¦‚æµç¨‹, æˆ‘è¯¦ç»†è¯´ä¸€ä¸‹.</p>
<p>1.iOS è®¾å¤‡å¯åŠ¨åè¿æ¥ç½‘ç»œ, ä¼šä¸è‹¹æœæœåŠ¡å™¨å»ºç«‹ä¸€ä¸ªå®‰å…¨çš„é•¿è¿æ¥.<br>è¿™ä¸ªæ˜¯ç³»ç»Ÿç»´æŠ¤çš„, è¿™ä¹Ÿæ˜¯æ¨é€çš„å…³é”®.<br>2.ç”¨æˆ·æ‰“å¼€ app, æˆæƒäº†æ¨é€é€šçŸ¥çš„æƒé™.<br>3.æˆæƒæˆåŠŸå, APNs ä¼šå°† deviceToken è¿”å›ç»™ iOS ç»ˆç«¯.<br>4.ç»ˆç«¯å°†è¯¥ deviceToken è¿”å›ç»™æŒ‡å®šçš„ APP.<br>5.APP æ‹¿åˆ° deviceToken ä¸Šä¼ ç»™æˆ‘ä»¬è‡ªå·±çš„ä¸šåŠ¡æœåŠ¡å™¨.<br>6.ä¸šåŠ¡æœåŠ¡å™¨å‘ APNs å‘é€æ¨é€è¯·æ±‚, å¸¦ä¸Š deviceToken.<br>7.APNs æ¨é€å†…å®¹åˆ°æŒ‡å®šçš„ iOS ç»ˆç«¯.<br>8.iOS ç»ˆç«¯å°†å†…å®¹æ¨é€ç»™ç”¨æˆ·.</p>
<p>å…³äº deviceToken åé¢ä¼šè®².</p>
<h2 id="å…³äº-deviceToken"><a href="#å…³äº-deviceToken" class="headerlink" title="å…³äº deviceToken"></a>å…³äº deviceToken</h2><p>è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ deviceToken.</p>
<blockquote>
<p>deviceToken æ˜¯ NSData ç±»å‹çš„æ•°æ®, æ˜¯è‹¹æœæœåŠ¡å™¨æ ¹æ® è®¾å¤‡,è¯ä¹¦ç­‰ä¿¡æ¯å’Œä¸€å®šç®—æ³•ç”Ÿæˆçš„.<br>éœ€è¦å°†è¿™ä¸ª deviceToken ä¼ é€ç»™æˆ‘ä»¬çš„æœåŠ¡å™¨ç«¯, è¿™æ ·ä¸€ä¸ªç”¨æˆ·å¯¹è±¡å°±ç»‘å®šäº†ä¸€ä¸ª deviceToken.<br>å½“éœ€è¦ç»™ç”¨æˆ·æ¨é€æ¶ˆæ¯, é€šè¿‡è‡ªå·±çš„ä¸šåŠ¡æœåŠ¡å™¨, æ‰¾ç”¨æˆ·å¯¹åº”çš„ deviceToken å’Œè¦å‘é€çš„æ¨é€å†…å®¹, å‘é€åˆ°è‹¹æœçš„ APNs, ç„¶å APNs å°†æ¶ˆæ¯æ¨é€åˆ°è¯¥ deviceToken å¯¹åº”çš„æ‰‹æœºä¸Š.</p>
</blockquote>
<p>å…³äº deviceToken æ˜¯å¦å¯å˜çš„é—®é¢˜</p>
<p>ç½‘ä¸Šæœ‰äº›äººè¯´, deviceToken æ˜¯å¯å˜çš„, æœ‰äº›äººè¯´, deviceToken æ˜¯ä¸å¯å˜çš„, æˆ‘ä¹Ÿä¸çŸ¥é“ä»–ä»¬åˆ°åº•æœ‰æ²¡æœ‰å®è·µè¿‡, ä»Šå¤©æˆ‘è¦å‘Šè¯‰å¤§å®¶çš„æ˜¯, deviceToken æ˜¯å¯å˜çš„.</p>
<p>å¦‚å¸è½½é‡è£… app, deviceToken ä¼šå˜. æˆ‘çš„è®¾å¤‡ iphone6, iOS10.3.</p>
<p>ä¸‹é¢æ˜¯æˆ‘å®éªŒçš„æ•°æ®:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ç¬¬ä¸€æ¬¡å®‰è£…è¿è¡Œå¾—åˆ°çš„ deviceToken</div><div class="line"></div><div class="line">&lt;4e0f2928 5be0700c=&quot;&quot; 296bf7f1=&quot;&quot; 3b0837e4=&quot;&quot; bc9da6d1=&quot;&quot; 9fdb672e=&quot;&quot; f87446be=&quot;&quot; 1c098431=&quot;&quot;&gt;</div><div class="line">å¸è½½å, ç¬¬ä¸€æ¬¡å®‰è£…è¿è¡Œå¾—åˆ°çš„ deviceToken</div></pre></td></tr></table></figure>
<p>è¿™è¯´æ˜, deviceToken æ˜¯å¯å˜çš„.</p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>ä¸Šé¢åŸºæœ¬éƒ½æ˜¯ä¸€äº›ç†è®ºçŸ¥è¯†, ä¸‹é¢ç»“åˆä»£ç , å…·ä½“å®ç°.</p>
<h3 id="å·¥ç¨‹é…ç½®"><a href="#å·¥ç¨‹é…ç½®" class="headerlink" title="å·¥ç¨‹é…ç½®"></a>å·¥ç¨‹é…ç½®</h3><p>åœ¨å†™ä»£ç ä¹‹å‰, éœ€è¦é…ç½®ä¸€ä¸‹å·¥ç¨‹.å…³äºå¦‚ä½•åˆ›å»ºå¸¦æœ‰ push åŠŸèƒ½çš„è‹¹æœè¯ä¹¦çš„æ“ä½œ, å¤§å®¶è‡ªè¡Œå»ç½‘ä¸Šå­¦ä¹ , è¿™é‡Œä¸èµ˜è¿°.</p>
<p>ä¸è¿‡è¿™é‡Œè¦æé†’ä¸€ç‚¹, åˆ›å»ºçš„è¯ä¹¦ä¸€å®šè¦å’Œè‡ªå·±é¡¹ç›®çš„ appid ä¿æŒä¸€è‡´, å¦åˆ™æ— æ³•æ¨é€.</p>
<p>è¿™ä¸ª Demo å·¥ç¨‹çš„åå­—æ˜¯ MZPush.</p>
<p>å®‰è£…å¥½è¯ä¹¦, æ‰“å¼€å·¥ç¨‹, å¹¶èƒ½è®©å·¥ç¨‹è¯†åˆ«åˆ°.</p>
<p>åˆ‡æ¢åˆ° Target, ç‚¹å‡» Capabilities é€‰é¡¹.</p>
<p>æ­¥éª¤1: é…ç½® Push, æ‰“å¼€å¼€å…³å³å¯.</p>
<p><img src="/upload/images/2017/08/05/3.jpg" alt="1"></p>
<p>é…ç½®åå°æ¨¡å¼, æ‰“å¼€å¼€å…³, é€‰ä¸­Remote notifications.</p>
<p><img src="/upload/images/2017/08/05/4.jpg" alt="1"></p>
<p>ä¸è¿‡è¿™ä¸€æ­¥, ä¸æ˜¯å¿…é¡»çš„, å¦‚æœä½ ä¸é…ç½®, å·¥ç¨‹ä¼šæœ‰è­¦å‘Š.æˆ‘å»ºè®®æ˜¯é€‰ä¸Š, åœ¨åé¢çš„åšæ–‡ä¸­, å†ä»”ç»†è¯´è¯´è¿™ä¸ªä¸œè¥¿çš„å¥½å¤„.</p>
<p>è­¦å‘Šä¿¡æ¯å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">You&apos;ve implemented -[&lt;UIApplicationDelegate&gt; application:didReceiveRemoteNotification:fetchCompletionHandler:], </div><div class="line">but you still need to add &quot;remote-notification&quot; to the list of your supported UIBackgroundModes in your Info.plist.</div></pre></td></tr></table></figure>
<p>æ­¥éª¤2: é…ç½®å®Œè¿™ä¸€æ­¥å,åœ¨ Info.plist ä¸­å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€é¡¹å†…å®¹:</p>
<p><img src="/upload/images/2017/08/05/5.jpg" alt="1"></p>
<p>æ­¥éª¤3: é…ç½®å·¥ç¨‹æœ€å°å…¼å®¹ç‰ˆæœ¬</p>
<p><img src="/upload/images/2017/08/05/6.jpg" alt="1"></p>
<p>å› ä¸ºæˆ‘è¦å…¼å®¹ iOS7, æ‰€ä»¥åœ¨ Xcode8 ä¸­, è‡ªå·±æ‰‹åŠ¨æ”¹ä¸ºäº† 7.0.</p>
<p>æ­¥éª¤4: å…³é—­ Bitcode(å¯é€‰æ“ä½œ)</p>
<p><img src="/upload/images/2017/08/05/7.jpg" alt="1"></p>
<p>æ­¥éª¤5: é…ç½®æ”¯æŒ HTTP(å¯é€‰æ“ä½œ)</p>
<p>åœ¨ Info.plist ä¸­, æ·»åŠ å¦‚ä¸‹:</p>
<p><img src="/upload/images/2017/08/05/8.jpg" alt="1"></p>
<h3 id="ç”¨æˆ·æˆæƒ"><a href="#ç”¨æˆ·æˆæƒ" class="headerlink" title="ç”¨æˆ·æˆæƒ"></a>ç”¨æˆ·æˆæƒ</h3><p>è¯¢é—®ç”¨æˆ·æˆæƒçš„å®ç°</p>
<p>è¯¥å®ç°å…¼å®¹äº† iOS7.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">+ (void)applyPushPermission &#123;</div><div class="line">    </div><div class="line">    UIApplication *application = [UIApplication sharedApplication];</div><div class="line">    </div><div class="line">    if (MZSysVersion &lt;= 7.0) &#123;</div><div class="line">        UIRemoteNotificationType nType = UIRemoteNotificationTypeAlert|UIRemoteNotificationTypeBadge|UIRemoteNotificationTypeSound;</div><div class="line">        [application registerForRemoteNotificationTypes:nType];</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        UIUserNotificationType nType =  UIUserNotificationTypeBadge|UIUserNotificationTypeSound|UIUserNotificationTypeAlert;</div><div class="line">        UIUserNotificationSettings *nSettings = [UIUserNotificationSettings settingsForTypes:nType categories:nil];</div><div class="line">        [application registerUserNotificationSettings:nSettings];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…³äºç”¨æˆ·æˆæƒ, åˆ†å‡ ç§æƒ…å†µæ¥çœ‹å¾….</p>
<p>æƒ…æ™¯ä¸€. ç”¨æˆ·ä¸å…è®¸ APP æ¨é€, å³ä¸æˆæƒ.</p>
<p>Appdelegate ä»£ç†è°ƒç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didRegisterUserNotificationSettings:(UIUserNotificationSettings *)notificationSettings &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App push. notificationSettings: %@&quot;, notificationSettings);</div><div class="line">    </div><div class="line">    [application registerForRemoteNotifications];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error</div></pre></td></tr></table></figure>
<p>error ä¿¡æ¯å¤§æ¦‚å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Error Domain=NSCocoaErrorDomain Code=3000 &quot;æœªæ‰¾åˆ°åº”ç”¨ç¨‹åºçš„â€œaps-environmentâ€çš„æˆæƒå­—ç¬¦ä¸²&quot;</div><div class="line">UserInfo=&#123;NSLocalizedDescription=æœªæ‰¾åˆ°åº”ç”¨ç¨‹åºçš„â€œaps-environmentâ€çš„æˆæƒå­—ç¬¦ä¸²&#125;</div></pre></td></tr></table></figure>
<p>æƒ…æ™¯äºŒ. ç”¨æˆ·å…è®¸æˆæƒäº†, åˆåˆ†ä¸ºä¸¤ç§æƒ…å†µ</p>
<p>1.ä½¿ç”¨å…·æœ‰ push åŠŸèƒ½çš„è¯ä¹¦</p>
<p>ä¸€å®šè¦æœ‰å¸¦æœ‰ push åŠŸèƒ½çš„è¯ä¹¦.</p>
<p>ä»£ç†è°ƒç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didRegisterUserNotificationSettings:(UIUserNotificationSettings *)notificationSettings &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App push. notificationSettings: %@&quot;, notificationSettings);</div><div class="line">    </div><div class="line">    [application registerForRemoteNotifications];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•å¤§æ¦‚åœ¨ä¸Šé¢å›è°ƒ 1s åæ‰ä¼šè°ƒç”¨.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App push. deviceToken: %@&quot;, deviceToken);</div><div class="line">    </div><div class="line">    // æ ¼å¼åŒ–è¯¥æ•°æ®</div><div class="line">    NSString *deviceTokenStr = [NSString stringWithFormat:@&quot;%@&quot;, deviceToken];</div><div class="line">    deviceTokenStr = [deviceTokenStr stringByReplacingOccurrencesOfString:@&quot;&lt;&quot; withString:@&quot;&quot;];</div><div class="line">    deviceTokenStr = [deviceTokenStr stringByReplacingOccurrencesOfString:@&quot;&gt;&quot; withString:@&quot;&quot;];</div><div class="line">    deviceTokenStr = [deviceTokenStr stringByReplacingOccurrencesOfString:@&quot; &quot; withString:@&quot;&quot;];</div><div class="line">    MZLOG(@&quot;App push. deviceToken string: %@&quot;, deviceTokenStr);</div><div class="line">    </div><div class="line">    // å¯ä»¥ä¸Šä¼ è¯¥ token åˆ°è‡ªå·±çš„ä¸šåŠ¡æœåŠ¡å™¨</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ didRegisterForRemoteNotificationsWithDeviceToken æ–¹æ³•ä¸­å¯ä»¥å¾—åˆ° deviceToken ä¿¡æ¯:</p>
<p><img src="/upload/images/2017/08/05/9.jpg" alt="1"></p>
<p>æ³¨æ„: ä»£ç ä¸­å°† NSData çš„ deviceToken è½¬æ¢ä¸ºäº† NSString ç±»å‹çš„æ•°æ®ç±»å‹.</p>
<p>2.ä½¿ç”¨ä¸€èˆ¬çš„è¯ä¹¦, æ²¡æœ‰ push åŠŸèƒ½çš„è¯ä¹¦</p>
<p>è¿™ç§æƒ…å†µå’Œ <code>æƒ…æ™¯ä¸€</code> ä¸€æ ·.</p>
<h3 id="æ¨é€"><a href="#æ¨é€" class="headerlink" title="æ¨é€"></a>æ¨é€</h3><p>ä¸‡äº‹ä¿±å¤‡, åªæ¬ ä¸œé£äº†.</p>
<p>ä»Šå¤©æ²¡æœ‰å‡†å¤‡æ­å»ºä¸€ä¸ªè‡ªå·±çš„ä¸šåŠ¡æœåŠ¡å™¨å»æ¨é€, å¯ä»¥ä½¿ç”¨æ¨é€å·¥å…·æ¥æ›¿ä»£.</p>
<p>å®‰è£… <a href="https://github.com/noodlewerk/NWPusher" target="_blank" rel="noopener">NWPusher</a> è¿™ä¸ªå·¥å…·, å¯ä»¥è¿›è¡Œæ¨é€æµ‹è¯•.</p>
<p>å®‰è£…æˆåŠŸå, æ‰“å¼€è¿™ä¸ª Mac APP, å¡«å†™ç›¸å…³ä¿¡æ¯.</p>
<p>ç‚¹å‡» push å³å¯æ¨é€.</p>
<p><img src="/upload/images/2017/08/05/10.jpg" alt="1"></p>
<p>åœ¨ Appdelegate ä¸­çš„ä»£ç†å›è°ƒä¸­, å¯ä»¥æ‰“å°æ¨é€å†…å®¹.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App push. userInfo: %@&quot;, userInfo);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¨é€çš„å†…å®¹, å¦‚ä¸‹å›¾æ‰€ç¤º.</p>
<p><img src="/upload/images/2017/08/05/11.jpg" alt="1"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    aps =     &#123;</div><div class="line">        alert = &quot;Testing.. (6)&quot;;</div><div class="line">        badge = 1;</div><div class="line">        sound = default;</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p>1.<a href="https://onevcat.com/2016/08/notification/" target="_blank" rel="noopener">æ´»ä¹…è§çš„é‡æ„ - iOS 10 UserNotifications æ¡†æ¶è§£æ
</a></p>
<p>2.<a href="http://www.jianshu.com/p/ace1b422bad4" target="_blank" rel="noopener">å›½å†… 90%ä»¥ä¸Šçš„ iOS å¼€å‘è€…ï¼Œå¯¹ APNs çš„è®¤è¯†éƒ½æ˜¯é”™çš„
</a></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æ¨é€ APNs </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS åå°æ¨¡å¼]]></title>
      <url>/2017/07/30/iOS-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h2 id="åº”ç”¨çŠ¶æ€"><a href="#åº”ç”¨çŠ¶æ€" class="headerlink" title="åº”ç”¨çŠ¶æ€"></a>åº”ç”¨çŠ¶æ€</h2><p>æ¥è‡ªè‹¹æœå¼€å‘è€…æ–‡æ¡£ The App Life Cycle çš„å›¾.</p>
<p><img src="/upload/images/2017/07/30/Background1.jpg" alt="1"></p>
<p>ä¸‹é¢è¿™å¼ å›¾è¯´æ˜äº†åº”ç”¨ç¨‹åºçš„çŠ¶æ€, å¦‚ä¸‹æ‰€ç¤º:</p>
<p><img src="/upload/images/2017/07/30/Background2.jpg" alt="1"></p>
<p>å…·ä½“çš„è¯´ä¸€ä¸‹è¿™5ä¸­çŠ¶æ€:</p>
<p>1.Not running</p>
<blockquote>
<p>æœªè¿è¡Œ, ç¨‹åºæ²¡å¯åŠ¨æˆ–è€…è¢«ç³»ç»Ÿè¢«ç”¨æˆ·æ€æ­»</p>
</blockquote>
<p>2.Inactive</p>
<blockquote>
<p>æœªæ¿€æ´», ç¨‹åºåœ¨å‰å°è¿è¡Œï¼Œä¸è¿‡æ²¡æœ‰æ¥æ”¶åˆ°äº‹ä»¶.<br>åœ¨æ²¡æœ‰äº‹ä»¶å¤„ç†æƒ…å†µä¸‹ç¨‹åºé€šå¸¸åœç•™åœ¨è¿™ä¸ªçŠ¶æ€.</p>
</blockquote>
<p>3.Active</p>
<blockquote>
<p>æ¿€æ´», ç¨‹åºåœ¨å‰å°è¿è¡Œè€Œä¸”æ¥æ”¶åˆ°äº†äº‹ä»¶.<br>è¿™ä¹Ÿæ˜¯å‰å°çš„ä¸€ä¸ªæ­£å¸¸çš„æ¨¡å¼</p>
</blockquote>
<p>4.Backgroud</p>
<blockquote>
<p>åå°, ç¨‹åºåœ¨åå°è€Œä¸”èƒ½æ‰§è¡Œä»£ç ï¼Œå¤§å¤šæ•°ç¨‹åºè¿›å…¥è¿™ä¸ªçŠ¶æ€åä¼šåœ¨åœ¨è¿™ä¸ªçŠ¶æ€ä¸Šåœç•™ä¸€ä¼š.<br>æ—¶é—´åˆ°ä¹‹åä¼šè¿›å…¥æŒ‚èµ·çŠ¶æ€(Suspended). æœ‰çš„ç¨‹åºç»è¿‡ç‰¹æ®Šçš„è¯·æ±‚åå¯ä»¥é•¿æœŸå¤„äº Backgroud çŠ¶æ€.</p>
</blockquote>
<p>5.Suspended</p>
<blockquote>
<p>æŒ‚èµ·, ç¨‹åºåœ¨åå°ä¸èƒ½æ‰§è¡Œä»£ç .<br>ç³»ç»Ÿä¼šè‡ªåŠ¨æŠŠç¨‹åºå˜æˆè¿™ä¸ªçŠ¶æ€è€Œä¸”ä¸ä¼šå‘å‡ºé€šçŸ¥.<br>å½“æŒ‚èµ·æ—¶, ç¨‹åºè¿˜æ˜¯åœç•™åœ¨å†…å­˜ä¸­çš„, å½“ç³»ç»Ÿå†…å­˜ä½æ—¶, ç³»ç»Ÿå°±æŠŠæŒ‚èµ·çš„ç¨‹åºæ¸…é™¤æ‰, ä¸ºå‰å°ç¨‹åºæä¾›æ›´å¤šçš„å†…å­˜.</p>
</blockquote>
<p>å…³äº Backgroud çŠ¶æ€, æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è¯´çš„é‡ç‚¹éƒ¨åˆ†.</p>
<h2 id="å¤šä»»åŠ¡ä»‹ç»"><a href="#å¤šä»»åŠ¡ä»‹ç»" class="headerlink" title="å¤šä»»åŠ¡ä»‹ç»"></a>å¤šä»»åŠ¡ä»‹ç»</h2><p>iOS çš„å¤šä»»åŠ¡æ˜¯åœ¨ iOS4 çš„æ—¶å€™è¢«å¼•å…¥çš„ï¼Œåœ¨æ­¤ä¹‹å‰ iOS çš„ APP éƒ½æ˜¯æŒ‰ä¸‹ Home é”®å°±è¢«å¹²æ‰äº†.<br>iOS4 è™½ç„¶å¼•å…¥äº†åå°å’Œå¤šä»»åŠ¡ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ä¼ªå¤šä»»åŠ¡ï¼Œä¸€èˆ¬çš„ APP åå°å¹¶ä¸èƒ½æ‰§è¡Œè‡ªå·±çš„ä»£ç ï¼Œåªæœ‰å°‘æ•°å‡ ç±»æœåŠ¡åœ¨é€šè¿‡æ³¨å†Œåå¯ä»¥çœŸæ­£åœ¨åå°è¿è¡Œï¼Œå¹¶ä¸”åœ¨æäº¤åˆ° AppStore çš„æ—¶å€™ä¹Ÿä¼šè¢«ä¸¥æ ¼å®¡æ ¸æ˜¯å¦æœ‰è¶Šæƒè¡Œä¸ºï¼Œè¿™ç§é™åˆ¶ä¸»è¦æ˜¯å‡ºäºå¯¹äºè®¾å¤‡çš„ç»­èˆªå’Œå®‰å…¨ä¸¤æ–¹é¢è¿›è¡Œçš„è€ƒè™‘.ä¹‹åç»è¿‡iOS5 å’Œ iOS6 çš„é€æ¸å‘å±•ï¼Œåå°èƒ½è¿è¡Œçš„æœåŠ¡çš„ç§ç±»è™½ç„¶å‡ºç°äº†å¢åŠ ï¼Œä½†æ˜¯ iOS åå°çš„æœ¬è´¨å¹¶æ²¡æœ‰å˜åŒ–.<br>åœ¨iOS7ä¹‹å‰ï¼Œç³»ç»Ÿæ‰€æ¥å—çš„åº”ç”¨å¤šä»»åŠ¡å¯ä»¥å¤§è‡´åˆ†ä¸ºå‡ ç§ï¼š</p>
<ul>
<li>åå°å®ŒæˆæŸäº›èŠ±è´¹æ—¶é—´çš„ç‰¹å®šä»»åŠ¡.</li>
<li>åå°æ’­æ”¾éŸ³ä¹ç­‰.</li>
<li>ä½ç½®æœåŠ¡.</li>
<li>IPç”µè¯(VOIP).</li>
<li>Newsstand.</li>
</ul>
<p>iOS7 åå°ä»»åŠ¡ç”³è¯·çš„æœ€é•¿æ—¶é—´ 10åˆ†é’Ÿ.<br>iOS8+ åå°ä»»åŠ¡ç”³è¯·æœ€é•¿æ—¶é—´ 3åˆ†é’Ÿ.</p>
<h2 id="ç¤ºä¾‹-APP-é€€åˆ°åå°ä¼šè¢«æŒ‚èµ·"><a href="#ç¤ºä¾‹-APP-é€€åˆ°åå°ä¼šè¢«æŒ‚èµ·" class="headerlink" title="ç¤ºä¾‹: APP é€€åˆ°åå°ä¼šè¢«æŒ‚èµ·"></a>ç¤ºä¾‹: APP é€€åˆ°åå°ä¼šè¢«æŒ‚èµ·</h2><p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«çš„æ˜¯ä¸€èˆ¬åº”ç”¨å¦‚ä½•åœ¨åå°å»¶é•¿ç”Ÿå‘½å‘¨æœŸçš„çŸ¥è¯†, å…³äºå…¶ä»–ç‰¹æ®Šçš„ App å¦‚ä¸Šé¢æåˆ°çš„5ä¸­æƒ…å†µ, ä¸æ˜¯ä»Šå¤©è®¨è®ºçš„é‡ç‚¹.</p>
<p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­, ä¾‹å­å¾ˆç®€å•.</p>
<blockquote>
<p>è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹æ¦‚å¿µ, ç›´æ¥é”å±å’Œç‚¹å‡» Home é”®, éƒ½ä¼šå¯¼è‡´åº”ç”¨å¤„äºåå°æ¨¡å¼, è¿™é‡Œä¸ºäº†è¯´æ˜é—®é¢˜, ç»Ÿä¸€ç‚¹<br>å‡» Home ä½œä¸ºä»£åè¯.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [super viewDidLoad];    </div><div class="line">    </div><div class="line">    [[NSNotificationCenter defaultCenter] addObserver:self</div><div class="line">                                             selector:@selector(onDidEnterBackground:)</div><div class="line">                                                 name:UIApplicationDidEnterBackgroundNotification</div><div class="line">                                               object:nil];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)onDidEnterBackground:(NSNotification *)notification &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App Background. Enter onDidEnterBackground.&quot;);</div><div class="line">    </div><div class="line">    int delta = 1;</div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delta * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">        </div><div class="line">        MZLOG(@&quot;App Background. Enter onDidEnterBackground diapatch.&quot;);</div><div class="line">        </div><div class="line">        UILocalNotification *notification = [UILocalNotification new];</div><div class="line">        notification.fireDate = [NSDate dateWithTimeIntervalSinceNow:3];</div><div class="line">        notification.alertBody = @&quot;èµ°, å»highå§!&quot;;</div><div class="line">        notification.soundName = UILocalNotificationDefaultSoundName;</div><div class="line">        // å¯ä»¥è‡ªå®šä¹‰æ•°æ®</div><div class="line">        notification.userInfo = @&#123;@&quot;user_info_key&quot;: @&quot;user_info_value_json_str&quot;&#125;;</div><div class="line">        </div><div class="line">        [[UIApplication sharedApplication] scheduleLocalNotification:notification];</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>UIApplicationDidEnterBackgroundNotification</code> å¯ä»¥ç›‘å¬åˆ°ç”¨æˆ·å°† APP é€€åˆ°åå°.</p>
<p>å½“ APP é€€åˆ°åå°, ä¼šè°ƒç”¨ onDidEnterBackground è¿™ä¸ªæ–¹æ³•.</p>
<p>åœ¨ onDidEnterBackground è¿™ä¸ªæ–¹æ³•ä¸­, æˆ‘æ•…æ„å»¶æ—¶æ‰§è¡Œä»£ç , è¿™é‡Œä½¿ç”¨çš„æ˜¯ dispatch_after.</p>
<p>ç¼–è¯‘è¿è¡Œè¿™ä¸ªå·¥ç¨‹, è¿è¡ŒæˆåŠŸå, å¯ä»¥ç‚¹å‡» Home é”®å°†åº”ç”¨é€€åˆ°åå°.</p>
<p>å¯ä»¥åœ¨ Xcode çš„æ§åˆ¶å°çœ‹åˆ° App Background. Enter onDidEnterBackground. çš„æ‰“å°ä¿¡æ¯, ä½†æ˜¯è¿Ÿè¿Ÿä¸è§ dispatch_after é‡Œé¢çš„ä»£ç æ‰§è¡Œ.</p>
<p>è¿™é‡Œè¯´æ˜, APP é€€åˆ°åå°åè¢«ç³»ç»ŸæŒ‚èµ·äº†.</p>
<p>å¦å¤–ä¸€ä¸ªä¾‹å­å°±æ˜¯ä½¿ç”¨ NSTimer, åœ¨ APP é€€åˆ°åå°å, ä¹Ÿä¼šè¢«ç»ˆæ­¢.</p>
<p>å®Œæ•´ä¾‹å­, ä¸€ä¼šåœ¨æ–‡ç« åå°é™„å½•ç»™å‡º.</p>
<h2 id="é€šè¿‡åå°æ¨¡å¼å»¶é•¿-APP-è¿è¡Œ"><a href="#é€šè¿‡åå°æ¨¡å¼å»¶é•¿-APP-è¿è¡Œ" class="headerlink" title="é€šè¿‡åå°æ¨¡å¼å»¶é•¿ APP è¿è¡Œ"></a>é€šè¿‡åå°æ¨¡å¼å»¶é•¿ APP è¿è¡Œ</h2><p>ä¸Šé¢çš„ä¾‹å­å……åˆ†è¯´æ˜äº†, åœ¨æˆ‘ä»¬æ²¡æœ‰åšä»»ä½•å¤„ç†çš„æƒ…å†µä¸‹, iOS ç³»ç»Ÿåœ¨ APP é€€åˆ°åå°çš„æƒ…å†µä¸‹, ä¼šè¢«ç³»ç»ŸæŒ‚èµ·, ä»è€Œç»ˆæ­¢ APP çš„ä»£ç è¡Œä¸º.</p>
<p>ä¸‹é¢é€šè¿‡å®ä¾‹, æ¥å¼€å¯åå°ä»»åŠ¡, è®© APP å°½å¯èƒ½çš„å»¶é•¿å£°æ˜å‘¨æœŸ.</p>
<p>åœ¨å·¥ç¨‹çš„åŸºç¡€ä¸Š, æ–°å»ºä¸€ä¸ªæ–‡ä»¶ <code>MZBackgroundTask</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@interface MZBackgroundTask : NSObject</div><div class="line">+ (instancetype)sharedTask;</div><div class="line">- (void)startTask;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>å…·ä½“å®ç°, åªç»™å‡ºå…³é”®ä»£ç .</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line">- (void)startTask &#123;</div><div class="line">    </div><div class="line">    if (![self _checkSupportBackgroundTask]) &#123;</div><div class="line">        </div><div class="line">        MZLOG(@&quot;BackgroundTask. Current device don&apos;t support backgroundTask.&quot;);</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    UIApplication *application = [UIApplication sharedApplication];</div><div class="line">    </div><div class="line">    __block UIBackgroundTaskIdentifier taskId;</div><div class="line">    </div><div class="line">    /// ç”³è¯·åå°æ‰§è¡Œ</div><div class="line">    /// æ³¨æ„: åœ¨iOS7å’Œè¯¥ç‰ˆæœ¬å‰ï¼Œåå°å¯ä»¥ç”¨ä¸‹é¢çš„çš„æ–¹å¼åœ¨åå°å­˜æ´»5-10åˆ†é’Ÿï¼Œåœ¨iOS8åŠåï¼Œæœ€å¤šå­˜æ´»3åˆ†é’Ÿ</div><div class="line">    &#123;</div><div class="line">        taskId = [application beginBackgroundTaskWithName:NSStringFromClass([self class]) expirationHandler:^&#123;</div><div class="line">            </div><div class="line">            MZLOG(@&quot;BackgroundTask. BackgroundTask is Over. The remained time: %f&quot;, application.backgroundTimeRemaining);</div><div class="line">            </div><div class="line">            [application endBackgroundTask:taskId];</div><div class="line">            </div><div class="line">            taskId = UIBackgroundTaskInvalid;</div><div class="line">        &#125;];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if (UIBackgroundTaskInvalid == taskId) &#123;</div><div class="line">        </div><div class="line">        MZLOG(@&quot;BackgroundTask. Apply backgroundTask failed.&quot;);</div><div class="line">        </div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    /// å¯ä»¥ç›‘æ§åå°ä»»åŠ¡å‰©ä½™çš„æ—¶é—´, é’ˆå¯¹ä¸šåŠ¡å¯ä»¥å»å¤„ç†</div><div class="line">    &#123;</div><div class="line">        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">            </div><div class="line">            __block NSTimeInterval remainedTime;</div><div class="line">            </div><div class="line">            while (true) &#123;</div><div class="line">                </div><div class="line">                // å‰©ä½™å¯ä»¥åå°æ‰§è¡Œçš„æ—¶é—´</div><div class="line">                dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">                    </div><div class="line">                    // application.backgroundTimeRemaining å¿…é¡»åœ¨ä¸»çº¿ç¨‹è·å–</div><div class="line">                    remainedTime = application.backgroundTimeRemaining;</div><div class="line">                    </div><div class="line">                    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">                       </div><div class="line">                        MZLOG(@&quot;BackgroundTask. The remained time: %f&quot;, remainedTime);</div><div class="line">                        </div><div class="line">                        if (remainedTime &lt; 10) &#123;</div><div class="line">                            </div><div class="line">                            // å¯ä»¥å‘Šè¯‰å…¶ä»–ä¸šåŠ¡, åå°ç”³è¯·çš„æ—¶é—´å³å°†ç»“æŸäº†</div><div class="line">                        &#125;</div><div class="line">                        </div><div class="line">                        if (remainedTime &lt; 2) &#123;</div><div class="line">                            </div><div class="line">                            /// è¿™é‡Œå¯ä»¥åšä¸€äº›æ¸…é™¤å·¥ä½œ</div><div class="line">                            &#123;</div><div class="line">                                // clean up</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                            [application endBackgroundTask:taskId];</div><div class="line">                            </div><div class="line">                            taskId = UIBackgroundTaskInvalid;</div><div class="line">                            </div><div class="line">                            return;</div><div class="line">                        &#125;</div><div class="line">                        </div><div class="line">                        // ç¡çœ (å»¶æ—¶)1s</div><div class="line">                        [NSThread sleepForTimeInterval:1.f];</div><div class="line">                    &#125;);</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>startTask å¼€å¯åå°ä»»åŠ¡.</p>
<p>åœ¨ AppDelegate ä¸­, è°ƒç”¨è¿™ä¸ªæ–¹æ³•.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (void)applicationDidEnterBackground:(UIApplication *)application &#123;</div><div class="line">    </div><div class="line">    [[MZBackgroundTask sharedTask] startTask];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†æ¬¡è¿è¡Œå·¥ç¨‹, å¯ä»¥æ ¹æ®æ—¥å¿—çœ‹å‡º, ä¹‹å‰çš„ dispatch_after å’Œ timer å¯ä»¥è¿è¡Œäº†, å¹¶ä¸”å¯ä»¥è¿è¡Œ3åˆ†é’Ÿ(180s).</p>
<p>æ ¹æ® backgroundTimeRemaining è¿™ä¸ªå±æ€§, å¯ä»¥çœ‹å‡ºå…·ä½“çš„åå°å¯æ‰§è¡Œçš„å‰©ä½™æ—¶é—´.</p>
<p><img src="/upload/images/2017/07/30/Background3.jpg" alt="1"></p>
<p>æ³¨æ„: æˆ‘æµ‹è¯•çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯ iOS10 è®¾å¤‡.</p>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>é™¤äº†è‹¹æœè§„å®šçš„å‡ ç§ç±»å‹(å¦‚å®šä½, å½•éŸ³, VOIP ç­‰)çš„åº”ç”¨å¤–, å…¶ä»– APP æƒ³ç”³è¯·æ›´å¤šçš„åå°é©»ç•™æ—¶é—´, å°±éœ€è¦ä¸€äº› <code>æ—é—¨å·¦é“</code> çš„æ–¹æ³•äº†.</p>
<p>è‹¹æœå¯¹åå°æ“ä½œåšäº†è¿™ä¹ˆå¤šé™åˆ¶, ä¹Ÿæ˜¯ä»ç”¨æˆ·çš„è§’åº¦å‡ºå‘, å¦‚å®‰å…¨, çœç”µ, çœæµé‡ç­‰.</p>
<p>æ¯”å¦‚, åœ¨åå°æ’­æ”¾æ²¡æœ‰å£°éŸ³çš„éŸ³ä¹.</p>
<p>å†æ¯”å¦‚, ç”³è¯·å®šä½æœåŠ¡çš„æƒé™, è¿™æ ·ä¹Ÿå¯ä»¥ä¿æŒ APP åœ¨åå°ä¸è¢«æŒ‚èµ·.<br>ä½†æ˜¯, ä¾ç…§è‹¹æœä¸€è´¯çš„å®¡æ ¸åšæ³•æ¥çœ‹ï¼Œå¦‚æœå£°æ˜äº†éœ€è¦æŸé¡¹åå°æƒé™ï¼Œä½ å´æ²¡æœ‰ç›¸å…³å®ç°çš„è¯ï¼Œä¼šç›´æ¥è¢«æ‹’æ‰çš„.</p>
<p>è¿™äº›æ˜¯æŠ€æœ¯ä¸Šçš„å®ç°, æˆ‘æ²¡æœ‰æ¨èå¤§å®¶è¿™ä¹ˆå¹², ç°åœ¨è‹¹æœå®¡æ ¸æ¯”ä»¥å‰è¿˜è¦ä¸¥æ ¼, å¤§å®¶è¿˜æ˜¯æ‚ ç€ç‚¹å¹²å§.å¦‚æœä½ çš„ APP ä¸éœ€è¦ä¸Šæ¶åˆ° AppStore çš„è¯, å°±å°½æƒ…çš„æ”¾çºµå§â€¦</p>
<h2 id="æ¨èåšæ–‡"><a href="#æ¨èåšæ–‡" class="headerlink" title="æ¨èåšæ–‡"></a>æ¨èåšæ–‡</h2><p>1.<a href="http://www.jianshu.com/p/50ff7a3a0fcd" target="_blank" rel="noopener">iOSå®ç°æ— é™åå°backgroundçš„æ–¹æ³•</a></p>
<p>2.<a href="https://onevcat.com/2013/08/ios7-background-multitask/" target="_blank" rel="noopener">WWDC 2013 Sessionç¬”è®° - iOS7ä¸­çš„å¤šä»»åŠ¡</a></p>
<p>iOS åœ¨åå°çš„æ—¶å€™å¦‚æœä¸ä½¿ç”¨åå°æ¨¡å¼, socket ä¹Ÿä¼šè¢«ç³»ç»Ÿå…³é—­è¿æ¥, æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨çš„ IM åŠŸèƒ½.<br>ä½¿ç”¨åå°æ¨¡å¼å, å‘ç³»ç»Ÿç”³è¯·çš„æ—¶é—´(3åˆ†é’Ÿå†…), socket è¿˜æ˜¯æ²¡æœ‰è¢«å…³é—­çš„, é™¤éæ–­ç½‘æˆ–è€…è¢«è·¯ç”±å™¨ç»™æ–­å¼€äº†, åœ¨ç”³è¯·çš„è¿™æ®µæ—¶é—´å†…, socekt è¿˜æ˜¯å¯ä»¥ä½¿ç”¨çš„, å¦‚æœæƒ³æŒç»­çš„ä¿æŒ socket è¿æ¥, å°±éœ€è¦å»äº†è§£ä¸€ä¸‹ VOIP Socket ç›¸å…³çš„çŸ¥è¯†äº†, å®è·µè¿‡å, åˆ†äº«ç»™å¤§å®¶.</p>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>ä¸‹é¢æ˜¯å…·ä½“çš„å®ç°ä»£ç .</p>
<blockquote>
<p>ViewController.m</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">@interface ViewController ()</div><div class="line"></div><div class="line">@property (nonatomic, strong) NSTimer *timer;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">@implementation ViewController</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    </div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    [[NSNotificationCenter defaultCenter] addObserver:self</div><div class="line">                                             selector:@selector(onDidEnterBackground:)</div><div class="line">                                                 name:UIApplicationDidEnterBackgroundNotification</div><div class="line">                                               object:nil];</div><div class="line">    </div><div class="line">    // æ¯éš”ä¸€ç§’æ‰§è¡Œä¸€æ¬¡</div><div class="line">    _timer = [NSTimer scheduledTimerWithTimeInterval:1</div><div class="line">                                              target:self</div><div class="line">                                            selector:@selector(onTimerDidRun:)</div><div class="line">                                            userInfo:nil repeats:YES];</div><div class="line">    </div><div class="line">    [[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes];</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - Callback.</div><div class="line"></div><div class="line">- (void)onTimerDidRun:(id)sender &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App Background. Timer Running.&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)onDidEnterBackground:(NSNotification *)notification &#123;</div><div class="line">    </div><div class="line">    MZLOG(@&quot;App Background. Enter onDidEnterBackground.&quot;);</div><div class="line">    </div><div class="line">    int delta = 1;</div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delta * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">        </div><div class="line">        MZLOG(@&quot;App Background. Enter onDidEnterBackground diapatch.&quot;);</div><div class="line">        </div><div class="line">        UILocalNotification *notification = [UILocalNotification new];</div><div class="line">        notification.fireDate = [NSDate dateWithTimeIntervalSinceNow:3];</div><div class="line">        notification.alertBody = @&quot;èµ°, å»highå§!&quot;;</div><div class="line">        notification.soundName = UILocalNotificationDefaultSoundName;</div><div class="line">        // å¯ä»¥è‡ªå®šä¹‰æ•°æ®</div><div class="line">        notification.userInfo = @&#123;@&quot;user_info_key&quot;: @&quot;user_info_value_json_str&quot;&#125;;</div><div class="line">        </div><div class="line">        [[UIApplication sharedApplication] scheduleLocalNotification:notification];</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - SetupViews.</div><div class="line"></div><div class="line">- (void)_setupViews &#123;</div><div class="line">    </div><div class="line">    self.view.backgroundColor = [UIColor purpleColor];</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>MZBackgroundTask.m</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line">#import &quot;MZBackgroundTask.h&quot;</div><div class="line"></div><div class="line">@implementation MZBackgroundTask</div><div class="line"></div><div class="line">+ (instancetype)sharedTask &#123;</div><div class="line">    </div><div class="line">    static MZBackgroundTask *_task;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        _task = [[self alloc] init];</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    return _task;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)startTask &#123;</div><div class="line">    </div><div class="line">    if (![self _checkSupportBackgroundTask]) &#123;</div><div class="line">        </div><div class="line">        MZLOG(@&quot;BackgroundTask. Current device don&apos;t support backgroundTask.&quot;);</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    UIApplication *application = [UIApplication sharedApplication];</div><div class="line">    </div><div class="line">    __block UIBackgroundTaskIdentifier taskId;</div><div class="line">    </div><div class="line">    /// ç”³è¯·åå°æ‰§è¡Œ</div><div class="line">    /// æ³¨æ„: åœ¨iOS7å’Œè¯¥ç‰ˆæœ¬å‰ï¼Œåå°å¯ä»¥ç”¨ä¸‹é¢çš„çš„æ–¹å¼åœ¨åå°å­˜æ´»5-10åˆ†é’Ÿï¼Œåœ¨iOS8åŠåï¼Œæœ€å¤šå­˜æ´»3åˆ†é’Ÿ</div><div class="line">    &#123;</div><div class="line">        taskId = [application beginBackgroundTaskWithName:NSStringFromClass([self class]) expirationHandler:^&#123;</div><div class="line">            </div><div class="line">            MZLOG(@&quot;BackgroundTask. BackgroundTask is Over. The remained time: %f&quot;, application.backgroundTimeRemaining);</div><div class="line">            </div><div class="line">            [application endBackgroundTask:taskId];</div><div class="line">            </div><div class="line">            taskId = UIBackgroundTaskInvalid;</div><div class="line">        &#125;];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if (UIBackgroundTaskInvalid == taskId) &#123;</div><div class="line">        </div><div class="line">        MZLOG(@&quot;BackgroundTask. Apply backgroundTask failed.&quot;);</div><div class="line">        </div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    /// å¯ä»¥ç›‘æ§åå°ä»»åŠ¡å‰©ä½™çš„æ—¶é—´, é’ˆå¯¹ä¸šåŠ¡å¯ä»¥å»å¤„ç†</div><div class="line">    &#123;</div><div class="line">        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">            </div><div class="line">            __block NSTimeInterval remainedTime;</div><div class="line">            </div><div class="line">            while (true) &#123;</div><div class="line">                </div><div class="line">                // å‰©ä½™å¯ä»¥åå°æ‰§è¡Œçš„æ—¶é—´</div><div class="line">                dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">                    </div><div class="line">                    // application.backgroundTimeRemaining å¿…é¡»åœ¨ä¸»çº¿ç¨‹è·å–</div><div class="line">                    remainedTime = application.backgroundTimeRemaining;</div><div class="line">                    </div><div class="line">                    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">                       </div><div class="line">                        MZLOG(@&quot;BackgroundTask. The remained time: %f&quot;, remainedTime);</div><div class="line">                        </div><div class="line">                        if (remainedTime &lt; 10) &#123;</div><div class="line">                            </div><div class="line">                            // å¯ä»¥å‘Šè¯‰å…¶ä»–ä¸šåŠ¡, åå°ç”³è¯·çš„æ—¶é—´å³å°†ç»“æŸäº†</div><div class="line">                        &#125;</div><div class="line">                        </div><div class="line">                        if (remainedTime &lt; 2) &#123;</div><div class="line">                            </div><div class="line">                            /// è¿™é‡Œå¯ä»¥åšä¸€äº›æ¸…é™¤å·¥ä½œ</div><div class="line">                            &#123;</div><div class="line">                                // clean up</div><div class="line">                            &#125;</div><div class="line">                            </div><div class="line">                            [application endBackgroundTask:taskId];</div><div class="line">                            </div><div class="line">                            taskId = UIBackgroundTaskInvalid;</div><div class="line">                            </div><div class="line">                            return;</div><div class="line">                        &#125;</div><div class="line">                        </div><div class="line">                        // ç¡çœ (å»¶æ—¶)1s</div><div class="line">                        [NSThread sleepForTimeInterval:1.f];</div><div class="line">                    &#125;);</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - Private.</div><div class="line"></div><div class="line">/**</div><div class="line"> *  å½“å‰è®¾å¤‡æ˜¯å¦æ”¯æŒåå°ä»»åŠ¡.</div><div class="line"> *</div><div class="line"> *  @return YES, æ”¯æŒåå°ä»»åŠ¡. å¦åˆ™, ä¸æ”¯æŒåå°ä»»åŠ¡.</div><div class="line"> */</div><div class="line">- (BOOL)_checkSupportBackgroundTask &#123;</div><div class="line">    </div><div class="line">    SEL sel = @selector(isMultitaskingSupported);</div><div class="line">    BOOL supportBTask = [[UIDevice currentDevice] respondsToSelector:sel];</div><div class="line">    </div><div class="line">    return supportBTask;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> åå°æ¨¡å¼ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨ Charles]]></title>
      <url>/2017/07/23/%E4%BD%BF%E7%94%A8-Charles/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>Charles æ˜¯ Mac ä¸Šé¢æ¯”è¾ƒå¥½ç”¨çš„æŠ“åŒ…å·¥å…·.</p>
<p>åœ¨ä½¿ç”¨å¾®ä¿¡ç™»å½• SDK çš„æ—¶å€™, æˆ‘æƒ³çœ‹çœ‹å¾®ä¿¡è¯·æ±‚çš„å†…å®¹, ä»¥åŠå…¶æˆæƒè¿‡ç¨‹, å‘ç°åªè¦è¿æ¥ Charles, è·³è½¬åˆ°å¾®ä¿¡ä¹‹åæ— æ³•æ‰“å¼€å¾®ä¿¡çš„æˆæƒç™»å½•é¡µé¢, æç¤ºç½‘ç»œä¸å¯ç”¨.</p>
<p>ç»è¿‡ç ”ç©¶, æ˜¯éœ€è¦ä½¿ç”¨ Charles é…ç½® HTTPS, é…ç½®å®Œæˆå, å°±å¯ä»¥éšå¿ƒæ‰€æ¬²äº†.</p>
<p>æ‰€ä»¥, ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ Charles ä½¿ç”¨çš„ä¸¤ä¸ªç‚¹:</p>
<ul>
<li>Charles çš„ HTTPS é…ç½®.</li>
<li>ä½¿ç”¨ Charles æ¨¡æ‹Ÿ(æ…¢)ç½‘ç»œ.</li>
</ul>
<h2 id="å·¥å…·å’Œç³»ç»Ÿ"><a href="#å·¥å…·å’Œç³»ç»Ÿ" class="headerlink" title="å·¥å…·å’Œç³»ç»Ÿ"></a>å·¥å…·å’Œç³»ç»Ÿ</h2><ul>
<li>iPhone: iOS 10.3.</li>
<li>Mac OS: 10.12.5.</li>
<li>Charles: 4.0.2.</li>
</ul>
<h2 id="æŠ“å–-HTTPS-è¯·æ±‚"><a href="#æŠ“å–-HTTPS-è¯·æ±‚" class="headerlink" title="æŠ“å– HTTPS è¯·æ±‚"></a>æŠ“å– HTTPS è¯·æ±‚</h2><p><strong>1.Mac å®‰è£…è¯ä¹¦</strong></p>
<blockquote>
<p>æ‰“å¼€ Charles, åœ¨ Help é€‰é¡¹ä¸­é€‰æ‹© SSL Proxying, å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
</blockquote>
<p><img src="/upload/images/2017/07/23/1.jpg" alt="1"></p>
<p><strong>2.Mac ä¿¡ä»»è¯ä¹¦</strong></p>
<blockquote>
<p>æ‰“å¼€ Keychain Access (é’¥åŒ™ä¸²), æ‰¾åˆ°åˆšæ‰å®‰è£…çš„è¯ä¹¦, ä¿¡ä»»è¯ä¹¦, å¦‚å›¾:</p>
</blockquote>
<p><img src="/upload/images/2017/07/23/2.jpg" alt="1"></p>
<p><strong>3.ç»™ iPhone å®‰è£…è¯ä¹¦</strong></p>
<blockquote>
<p>æ‰“å¼€ Charles, åœ¨ Help é€‰é¡¹ä¸­é€‰æ‹© SSL Proxying, æ“ä½œå¦‚å›¾:</p>
</blockquote>
<p><img src="/upload/images/2017/07/23/3.jpg" alt="1"></p>
<p>åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­, å¯ä»¥çœ‹åˆ° <code>chls.pro/ssl</code></p>
<p><img src="/upload/images/2017/07/23/4.jpg" alt="1"></p>
<p>æ‰‹æœºè®¾ç½®ä»£ç†, è¿æ¥ Charles</p>
<blockquote>
<p>ä¸€å®šè¦è®°ä½: æ‰‹æœºä¸€å®šè¦è®¾ç½®ä»£ç†, å¦åˆ™å®‰è£…è¯ä¹¦ä¼šå¤±è´¥.</p>
</blockquote>
<p>æ‰“å¼€æ‰‹æœºçš„ Safari æµè§ˆå™¨, è¾“å…¥ <code>chls.pro/ssl</code> è¿™ä¸ªåœ°å€.</p>
<p><img src="/upload/images/2017/07/23/5.jpg" alt="1"></p>
<p>è®¾ç½®ä¿¡ä»»è¯ä¹¦, å¦‚ä¸‹å›¾:</p>
<p><img src="/upload/images/2017/07/23/6.jpg" alt="1"></p>
<p><img src="/upload/images/2017/07/23/7.jpg" alt="1"></p>
<h2 id="æ¨¡æ‹Ÿä»»æ„ç½‘ç»œ"><a href="#æ¨¡æ‹Ÿä»»æ„ç½‘ç»œ" class="headerlink" title="æ¨¡æ‹Ÿä»»æ„ç½‘ç»œ"></a>æ¨¡æ‹Ÿä»»æ„ç½‘ç»œ</h2><p>Charles ç»™æˆ‘ä»¬æä¾›äº†å¯ä»¥æ¨¡æ‹Ÿä»»ä½•ç½‘é€Ÿçš„ç½‘ç»œç¯å¢ƒçš„æ¡ä»¶.</p>
<p><img src="/upload/images/2017/07/23/8.jpg" alt="1"></p>
<p>æ‰“å¼€ Throttle Settings, ç„¶å Enable Throttling</p>
<p><img src="/upload/images/2017/07/23/9.jpg" alt="1"></p>
<p>å¯ä»¥çœ‹åˆ°å¾ˆå¤šç±»å‹çš„ç½‘ç»œä¾›ä½ é€‰æ‹©.</p>
<p>Add Preset å¯ä»¥è‡ªå·±è‡ªå®šä¹‰ä¸€ä¸ªç½‘ç»œç¯å¢ƒ.</p>
<p>è¿™ä¸ªåŠŸèƒ½éå¸¸å®ç”¨, å¯ä»¥è®©æˆ‘ä»¬æ¨¡æ‹Ÿæ…¢ç½‘ç»œç¯å¢ƒ, æ›´å¥½åœ°è°ƒè¯•è‡ªå·±çš„ç¨‹åº.</p>
<h2 id="é‡åˆ°éº»çƒ¦"><a href="#é‡åˆ°éº»çƒ¦" class="headerlink" title="é‡åˆ°éº»çƒ¦"></a>é‡åˆ°éº»çƒ¦</h2><p>1.æŠ“å– HTTPS çš„è¯·æ±‚å‡ºç°é”™è¯¯</p>
<p>é”™è¯¯æ—¥å¿—å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SSLHandshake: Received fatal alert: unknown_ca</div><div class="line">Charles Proxy will even offer a helpful suggestion:</div><div class="line">You may need to configure your browser or application to trust the Charles Root Certificate. See SSL Proxying in the Help menu.</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2017/07/23/10.jpg" alt="1"></p>
<p>è¿™ç§é”™è¯¯ä¸€èˆ¬æ˜¯å‡ºç°åœ¨ iOS10 ä¸Šé¢.</p>
<p>è¯·åœ¨å…³äºæœ¬æœºé‡Œé¢å†è®¾ç½®ä¸€æ¬¡ è¯ä¹¦ä¿¡ä»»è®¾ç½®, å³å¯.</p>
<p><img src="/upload/images/2017/07/23/11.jpg" alt="1"></p>
<p>2.ç³»ç»Ÿå‡çº§å, è®¾ç½®çš„ HTTPS æŠ“åŒ…å¤±æ•ˆ</p>
<p>æŒ‰ç…§ä¸Šè¿°æ–¹æ³•, é‡æ–°è®¾ç½®ä¸€æ¬¡å³å¯.</p>
]]></content>
      
        <categories>
            
            <category> Tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Charles MacOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Cocos2d-js: åœ¨ iOS ä¸Šè¿è¡Œ]]></title>
      <url>/2017/07/23/Cocos2d-js-%E5%9C%A8-iOS-%E4%B8%8A%E8%BF%90%E8%A1%8C/</url>
      <content type="html"><![CDATA[<p>åœ¨æˆ‘çš„åšæ–‡ <a href="http://www.veryitman.com/2017/05/14/2017-05-14-Cocos2d-js-%E9%A6%96%E6%AC%A1%E5%9C%A8-Mac-%E4%B8%8A%E9%9D%A2%E8%BF%90%E8%A1%8C/" target="_blank" rel="noopener">Cocos2d-js: é¦–æ¬¡åœ¨ Mac ä¸Šé¢è¿è¡Œ</a> è¿™ç¯‡æ–‡ç« ä¸­, ä»‹ç»äº† Cocos2d ç›¸å…³çš„çŸ¥è¯†, å¹¶ä¸”ä½¿ç”¨Cocos2dx åˆ›å»ºäº†ä¸€ä¸ª JS çš„ç®€å•æ¸¸æˆé¡¹ç›®.</p>
<p>ä»Šå¤©è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹, å¦‚ä½•åœ¨ ios è®¾å¤‡ä¸Šé¢è¿è¡Œä¸€ä¸ª JS æ¸¸æˆé¡¹ç›®.</p>
<p>è¯¥æ¸¸æˆé¡¹ç›®(è´ªåƒè›‡)æ¥è‡ªç½‘ç»œèµ„æº, åªä¾›æ¼”ç¤ºä½¿ç”¨, ä¸æä¾›ä»»ä½•å…³äºæ¸¸æˆçš„èµ„æº.</p>
<h2 id="å½“åˆçš„æƒ³å½“ç„¶"><a href="#å½“åˆçš„æƒ³å½“ç„¶" class="headerlink" title="å½“åˆçš„æƒ³å½“ç„¶"></a>å½“åˆçš„æƒ³å½“ç„¶</h2><p>åœ¨ Mac ä¸Šé¢ so easy çš„ç¼–è¯‘å¹¶è¿è¡Œäº† JS æ¸¸æˆ, æˆ‘æƒ³åœ¨ iOS è®¾å¤‡ä¸Šåº”è¯¥ä¹Ÿå¾ˆç®€å•çš„å°±å¯ä»¥è¿è¡Œèµ·æ¥, ä½†æ˜¯æˆ‘å‘ç°æˆ‘ç®€å•ä¸åŠ æ€è€ƒçš„æƒ³æ³•, æ˜¯è¡Œä¸é€šçš„.</p>
<p>åšæ–‡ <a href="http://www.veryitman.com/2017/05/14/2017-05-14-Cocos2d-js-%E9%A6%96%E6%AC%A1%E5%9C%A8-Mac-%E4%B8%8A%E9%9D%A2%E8%BF%90%E8%A1%8C/" target="_blank" rel="noopener">Cocos2d-js: é¦–æ¬¡åœ¨ Mac ä¸Šé¢è¿è¡Œ</a> åœ¨ FireFox æµè§ˆå™¨ä¸Šé¢å¯ä»¥ç›´æ¥è¿è¡Œ <code>index.html</code>, ä½†æ˜¯åœ¨ Chrome æµè§ˆå™¨ä¸Šé¢å°±æ²¡é‚£ä¹ˆé¡ºåˆ©.</p>
<p>æƒ³åˆ°è¿™é‡Œ, æˆ‘å°±å—åˆ°äº†å¯å‘, è«é iOS è®¾å¤‡ä¸Šé¢éœ€è¦è‡ªå·±æ­å»ºä¸€å¥— Web Server?</p>
<h2 id="æ­å»º-Web-Server"><a href="#æ­å»º-Web-Server" class="headerlink" title="æ­å»º Web Server"></a>æ­å»º Web Server</h2><p>æ—¢ç„¶æƒ³åˆ°äº†è¿™ä¸€æ­¥, æ¥ä¸‹æ¥å°±æ˜¯æ‰¾æ–¹æ¡ˆå®æ–½äº†.</p>
<p><a href="https://github.com/robbiehanson/CocoaHTTPServer" target="_blank" rel="noopener">CocoaHTTPServer</a> è¿™ä¸ªå¯ä»¥æ»¡è¶³æˆ‘çš„éœ€æ±‚, äºæ˜¯, æˆ‘å°±ç›´æ¥æ‹¿æ¥ä½¿ç”¨äº†.</p>
<p>é¡¹ç›®ä¸­, æˆ‘ä½¿ç”¨äº† Cocoapods æ¥ç®¡ç†ç¬¬ä¸‰æ–¹åº“.åœ¨ podfile ä¸­ç›´æ¥æ·»åŠ ä¸‹é¢çš„ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod &apos;CocoaHTTPServer&apos;, &apos;~&gt; 2.3&apos;</div></pre></td></tr></table></figure>
<p>ç„¶å pod install å³å¯.</p>
<p>1.åœ¨ ViewController ä¸­å¯¼å…¥å¤´æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#import &lt;HTTPServer.h&gt;</div><div class="line">ViewController å£°æ˜éƒ¨åˆ†</div><div class="line"></div><div class="line">@interface ViewController () &lt;WKNavigationDelegate&gt;</div><div class="line">@property (nonatomic, strong) WKWebView *webView;</div><div class="line">@property (nonatomic, strong) HTTPServer *localHttpServer;</div><div class="line">@property (nonatomic, strong) WKWebViewConfiguration *wbConfig;</div><div class="line">//ç”¨äºè°ƒè¯•çš„ UILabel</div><div class="line">@property (nonatomic, strong) IBOutlet UILabel *loadingLb;</div><div class="line">@property (nonatomic, assign) BOOL startServerSuccess;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>2.é…ç½® Web Server</p>
<p>æ ¸å¿ƒå®ç°å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"> - (void)_configLocalHttpServer</div><div class="line">&#123;</div><div class="line">    NSString *webPath = [[NSBundle mainBundle] pathForResource:@&quot;crazySnake&quot; ofType:nil];</div><div class="line">    _localHttpServer = [[HTTPServer alloc] init];</div><div class="line">    [_localHttpServer setType:@&quot;_http.tcp&quot;];</div><div class="line">    </div><div class="line">    NSFileManager *fileManager = [[NSFileManager alloc] init];</div><div class="line">    NSLog(@&quot;%@&quot;, webPath);</div><div class="line">    </div><div class="line">    if (![fileManager fileExistsAtPath:webPath]) &#123;</div><div class="line">        NSLog(@&quot;File path error!&quot;);</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        NSString *webLocalPath = webPath;</div><div class="line">        [_localHttpServer setDocumentRoot:webLocalPath];</div><div class="line">        NSLog(@&quot;webLocalPath:%@&quot;, webLocalPath);</div><div class="line">        [self _startWebServer];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">- (void)_startWebServer</div><div class="line">&#123;</div><div class="line">    self.loadingLb.hidden = NO;</div><div class="line">    </div><div class="line">    NSError *error;</div><div class="line">    if ([_localHttpServer start:&amp;error]) &#123;</div><div class="line">        NSLog(@&quot;Started HTTP Server on port %hu&quot;, [_localHttpServer listeningPort]);</div><div class="line">        self.port = [NSString stringWithFormat:@&quot;%d&quot;, [_localHttpServer listeningPort]];</div><div class="line">        </div><div class="line">        self.loadingLb.text = @&quot;Start Server Successfully.&quot;;</div><div class="line">        </div><div class="line">        _startServerSuccess = YES;</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        NSLog(@&quot;Error starting HTTP Server: %@&quot;, error);</div><div class="line">        </div><div class="line">        self.loadingLb.text = @&quot;Start Server failed.&quot;;</div><div class="line">        </div><div class="line">        _startServerSuccess = NO;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>_configLocalHttpServer</code> æ˜¯é…ç½® HTTPServer çš„æ–¹æ³•, <code>_startWebServer</code> æ˜¯å¼€å¯ Web Server çš„æ–¹æ³•.</p>
<p>è¿™æ ·è°ƒç”¨ <code>_configLocalHttpServer</code> å°±å¯ä»¥å¼€å¯åœ¨è®¾å¤‡ä¸Šé¢å¼€å¯ä¸€ä¸ª Web Server äº†.</p>
<h2 id="Xcode-å¯¼å…¥-JS-æ¸¸æˆé¡¹ç›®"><a href="#Xcode-å¯¼å…¥-JS-æ¸¸æˆé¡¹ç›®" class="headerlink" title="Xcode å¯¼å…¥ JS æ¸¸æˆé¡¹ç›®"></a>Xcode å¯¼å…¥ JS æ¸¸æˆé¡¹ç›®</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹æˆ‘çš„å·¥ç¨‹å’Œèµ„æºç›®å½•ç»“æ„, å¦‚å›¾:</p>
<p><img src="/upload/images/2017/07/23/2_1.jpg" alt="1"></p>
<p>ä»”ç»†çœ‹ä¸€ä¸‹, <code>crazySnake</code> è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯è“è‰²çš„, ä¸æ˜¯é»„è‰²çš„.</p>
<p>è¿™é‡Œç‰¹åˆ«æ³¨æ„, å¯¼å…¥è¿™ä¸ª crazySnake æ–‡ä»¶å¤¹çš„æ—¶å€™, Options ä¸€å®šè¦é€‰æ‹© <code>Create folder reference</code>.</p>
<p>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåš?</p>
<p>ç»†å¿ƒçš„æœ‹å‹å¯ä»¥å‘ç°, ä½¿ç”¨ <code>Create folder reference</code>å¯¼å…¥çš„æ–‡ä»¶å¤¹, åœ¨é¡¹ç›®æ‰“åŒ…ç”Ÿæˆçš„ archive çš„æ–‡ä»¶ä¸­(è‡ªå·±å¯ä»¥è§£å‹çœ‹)æ˜¯å¯ä»¥çœ‹åˆ° crazySnake è¿™ä¸ªæ–‡ä»¶å¤¹çš„, å¦‚æœä¸æ˜¯è¿™ç§æ–¹å¼, è€Œæ˜¯ä½¿ç”¨ Create groups æ–¹å¼(åœ¨ Xcode ä¸­æ˜¾ç¤ºé»„è‰²), åœ¨ archive ä¸­æ˜¯çœ‹ä¸åˆ° crazySnake è¿™ä¸ªæ–‡ä»¶å¤¹çš„, è€Œæ˜¯å°†é‡Œé¢çš„æ–‡ä»¶æ‰“æ•£æ”¾åœ¨ archive çš„æ ¹ç›®å½•ä¸‹é¢äº†.</p>
<blockquote>
<p>æ€»ä¹‹, ä¸€å¥è¯, <code>Create folder reference</code> æ–¹å¼å¯¼å…¥çš„æ–‡ä»¶å¤¹åœ¨æ‰“åŒ…åè¿˜æ˜¯åŸæ¥çš„æ–‡ä»¶å¤¹, ä¸ä¼šå°†æ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶æ‰“æ•£.</p>
</blockquote>
<p>è¯•æƒ³ä¸€ä¸‹, å¦‚æœå¤šåŠ å…¥å‡ ä¸ªè¿™æ ·çš„ç›®å½•, éƒ½æ‰“æ•£åœ¨æ ¹ç›®å½•ä¸‹é¢, æˆ‘ä»¬å°±ä¸å¥½ç®¡ç†è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶äº†.</p>
<h2 id="é…ç½®-WKWebView"><a href="#é…ç½®-WKWebView" class="headerlink" title="é…ç½® WKWebView"></a>é…ç½® WKWebView</h2><blockquote>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨äº† WKWebView è€Œä¸æ˜¯ UIWebView ä½œä¸ºåŠ è½½ HTML çš„å®¹å™¨.<br>å½“ç„¶, ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ UIWebView.</p>
</blockquote>
<p>ä¸»è¦çš„æ ¸å¿ƒä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    self.navigationController.navigationBarHidden = YES;</div><div class="line">    </div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">        self.loadingLb.text = @&quot;Config server...&quot;;</div><div class="line">        [self _configLocalHttpServer];</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    /// å¢åŠ çš„è°ƒå¼æ–¹æ³•: å¯ä»¥é‡æ–°å¯åŠ¨ web server.</div><div class="line">    &#123;</div><div class="line">        SEL sel = @selector(_configLocalHttpServer);</div><div class="line">        UITapGestureRecognizer *gesture = [[UITapGestureRecognizer alloc] initWithTarget:self</div><div class="line">                                                                                  action:sel];</div><div class="line">        [self.loadingLb addGestureRecognizer:gesture];</div><div class="line">        self.loadingLb.userInteractionEnabled = YES;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">- (void)viewDidAppear:(BOOL)animated</div><div class="line">&#123;</div><div class="line">    [super viewDidAppear:animated];</div><div class="line">    </div><div class="line">    // é…ç½® WKWebView</div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">        </div><div class="line">        _wbConfig = [[WKWebViewConfiguration alloc] init];</div><div class="line">        self.wbConfig.userContentController = [[WKUserContentController alloc] init];</div><div class="line">        </div><div class="line">        _webView = [[WKWebView alloc] initWithFrame:self.view.bounds configuration:self.wbConfig];</div><div class="line">        </div><div class="line">        _webView.frame = self.view.bounds;</div><div class="line">        _webView.scrollView.showsHorizontalScrollIndicator = NO;</div><div class="line">        _webView.scrollView.showsVerticalScrollIndicator   = NO;</div><div class="line">        </div><div class="line">        [self.view addSubview:self.webView];</div><div class="line">        self.webView.frame = self.view.bounds;</div><div class="line">        self.webView.navigationDelegate = self;</div><div class="line">        </div><div class="line">        if (self.startServerSuccess) &#123;</div><div class="line">            self.loadingLb.hidden = YES;</div><div class="line">            </div><div class="line">            NSString *gameUrl = [[NSBundle mainBundle] pathForResource:@&quot;index&quot;</div><div class="line">                                                                ofType:@&quot;html&quot;</div><div class="line">                                                           inDirectory:@&quot;crazySnake&quot;];</div><div class="line">            NSURL *url = [NSURL fileURLWithPath:gameUrl];</div><div class="line">            </div><div class="line">            url = [NSURL URLWithString:[NSString stringWithFormat:@&quot;http://127.0.0.1:%@/index.html&quot;, self.port]];</div><div class="line">            [self.webView loadRequest:[NSURLRequest requestWithURL:url]];</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»£ç å¾ˆç®€å•, å°±æ˜¯ä½¿ç”¨ WKWebView åŠ è½½ä¸€ä¸ª HTML æ–‡ä»¶å¹¶å¯åŠ¨ Web Server.</p>
<h2 id="è¿è¡Œé¡¹ç›®"><a href="#è¿è¡Œé¡¹ç›®" class="headerlink" title="è¿è¡Œé¡¹ç›®"></a>è¿è¡Œé¡¹ç›®</h2><p>æ¥ä¸‹æ¥, å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»äº†â€¦</p>
<p>ä¸Šé¢é…ç½®äº† Web Server å’Œ åŠ è½½ html çš„ WKWebView, ç°åœ¨å¯ä»¥ç›´æ¥è¿è¡Œé¡¹ç›®çœ‹æ•ˆæœäº†.</p>
<p>æ— è®ºä½ æ˜¯åœ¨æ¨¡æ‹Ÿå™¨è¿˜æ˜¯åœ¨çœŸæœºä¸Šé¢éƒ½å¯ä»¥è¿è¡Œè¿™ä¸ª JS æ¸¸æˆé¡¹ç›®äº†.</p>
<p><img src="/upload/images/2017/07/23/2_2.jpg" alt="1"></p>
<h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>ä¸Šé¢çš„ä¾‹å­æœ¬äººäº²è‡ªå®è·µè¿‡çš„, ç»™å¤§å®¶æä¾›äº†ä¸€ä¸ªå®ç°æ€è·¯, ç®—æ˜¯æŠ›ç –å¼•ç‰.</p>
<p>å¦‚æœæƒ³åšå¥½è¿™ä¸ªæ¨¡å¼, è¿˜éœ€è¦å¾ˆå¤šå·¥ä½œè¦åš, è¿™é‡Œåˆ—å‡ºæ¥ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹.</p>
<blockquote>
<p>1.æ¸¸æˆèµ„æºåŒ…ç®¡ç†å’Œä¸‹è½½.<br>2.æ¸¸æˆä¸­éœ€è¦å’Œ Native çš„äº¤äº’é€»è¾‘.<br>3.æ•°æ®åŠ å¯†.<br>4.ç§»åŠ¨ç«¯æ¸¸æˆæœ¬èº«çš„åŠ è½½ä¼˜åŒ–.</p>
</blockquote>
<p>å¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹æ¡ˆå’Œæƒ³æ³•, æˆ‘å¾ˆä¹æ„é‚®ä»¶ (veryitman@126.com) ä¸ä½ æ²Ÿé€š, éå¸¸æ„Ÿè°¢!</p>
<p>ä»£ç ç¤ºä¾‹æˆ‘æ”¾åœ¨äº† GitHub, ç‚¹å‡» <a href="https://github.com/veryitman/MZMWPlay" target="_blank" rel="noopener">MZMWPlay</a> å‰å¾€ä¸‹è½½ä½“éªŒ.</p>
]]></content>
      
        <categories>
            
            <category> Game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> cocos Cocos2d-js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android: Chrome è°ƒè¯• WEB é¡µé¢]]></title>
      <url>/2017/06/01/Android-Chrome-%E8%B0%83%E8%AF%95-WEB-%E9%A1%B5%E9%9D%A2/</url>
      <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>åœ¨ Mac OS ä¸Šé¢é€šè¿‡ Safari è°ƒè¯• iOS è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨çš„ WEB é¡µé¢, æ¯”è¾ƒæ–¹ä¾¿.</p>
<p>å…³äºå…·ä½“å¦‚ä½•ä½¿ç”¨ Safari æ¥è°ƒè¯• iOS è®¾å¤‡, å¯ä»¥å‚è€ƒ [Safari çš„å¼€å‘è€…æ¨¡å¼] è¿™ç¯‡æ–‡ç« .</p>
<p>è‡ªä»è¸ä¸Šå¼€å‘çš„é“è·¯, ç”µè„‘ä¸Šå°±å®‰è£…äº† Chrome æµè§ˆå™¨, å¹¶ä¸”ä¸€ç›´ä¿æŒç€æ›´æ–°, Chrome ä»¥å…¶ç®€å•è®¾è®¡å’Œé«˜æ•ˆçš„ç”¨æ³•å¸å¼•äº†å¤§æ‰¹å¼€å‘è€….</p>
<p>ä½¿ç”¨ Chrome è°ƒè¯• Android è®¾å¤‡çš„ WEB é¡µé¢, æ˜“å¦‚åæŒ.</p>
<h2 id="Chrome-è°ƒè¯•æ¡ä»¶"><a href="#Chrome-è°ƒè¯•æ¡ä»¶" class="headerlink" title="Chrome è°ƒè¯•æ¡ä»¶"></a>Chrome è°ƒè¯•æ¡ä»¶</h2><p>ä½¿ç”¨è¿™é¡¹æŠ€èƒ½çš„æ¡ä»¶å¦‚ä¸‹:</p>
<blockquote>
<p>1.Android è®¾å¤‡ç³»ç»Ÿæœ€ä½ä¸º4.4, ä¹Ÿå°±æ˜¯ android-19</p>
<p>2.Chrome æœ€å¥½ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„, ä»¥å‰çš„ç‰ˆæœ¬ä¸æ”¯æŒ, æœ€ä½å…¼å®¹ç‰ˆæœ¬ç›®å‰å°šä¸æ¸…æ¥š.</p>
<p>3.é…ç½® Android WebView, ä½¿å…¶æ”¯æŒ Debug å’Œä½¿èƒ½ JavaScript åŠŸèƒ½.</p>
<p>4.è®¾å¤‡å’Œ PC é€šè¿‡ USB è¿æ¥æ­£å¸¸, ä¸”æ”¯æŒ USB è°ƒè¯•çš„.</p>
</blockquote>
<p>æˆ‘ç›®å‰ä½¿ç”¨çš„è®¾å¤‡å’Œ Chrome ç‰ˆæœ¬ä¿¡æ¯å¦‚ä¸‹:</p>
<blockquote>
<p>Android è®¾å¤‡: 5.1.1ç‰ˆæœ¬<br>Chrome: Version 58.0.3029.110 (64-bit)</p>
</blockquote>
<p>æˆ‘ä»¬åœ¨åœ°å€æ ä¸­è¾“å…¥:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrome://inspect</div></pre></td></tr></table></figure>
<p>å°±å¯ä»¥æ‰“å¼€è®¾å¤‡åˆ—è¡¨ç•Œé¢.<br><img src="/upload/images/2017/06/01/14962450324558.jpg" alt="1"></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘çš„ Android è®¾å¤‡å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†.</p>
<p>ä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜è¯¥è°ƒè¯•å·¥å…·çš„ä½¿ç”¨.</p>
<h2 id="ç®€å•çš„-Android-å·¥ç¨‹ç¤ºä¾‹"><a href="#ç®€å•çš„-Android-å·¥ç¨‹ç¤ºä¾‹" class="headerlink" title="ç®€å•çš„ Android å·¥ç¨‹ç¤ºä¾‹"></a>ç®€å•çš„ Android å·¥ç¨‹ç¤ºä¾‹</h2><p>è¯¥å·¥ç¨‹åªæœ‰ä¸€ä¸ª Activity, ä½¿ç”¨ WebView åŠ è½½æœ¬åœ° HTML æ–‡ä»¶.</p>
<h4 id="1-åˆ›å»º-assets-ç›®å½•"><a href="#1-åˆ›å»º-assets-ç›®å½•" class="headerlink" title="1. åˆ›å»º assets ç›®å½•"></a>1. åˆ›å»º assets ç›®å½•</h4><p>å·¥ç¨‹åˆ‡æ¢åˆ° Project Files è§†å›¾<br><img src="/upload/images/2017/06/01/14962453176556.jpg" alt="1"></p>
<p>è¿™æ ·å°±å¯ä»¥åœ¨ src/main ç›®å½•ä¸‹æ–°å»ºäº† assets æ–‡ä»¶å¤¹äº†.</p>
<h4 id="2-åˆ›å»º-HTML-æ–‡ä»¶"><a href="#2-åˆ›å»º-HTML-æ–‡ä»¶" class="headerlink" title="2. åˆ›å»º HTML æ–‡ä»¶"></a>2. åˆ›å»º HTML æ–‡ä»¶</h4><blockquote>
<p>è¯¥ HTML æ–‡ä»¶, å‘½åä¸º local.html, æ”¾åœ¨ assets ç›®å½•ä¸‹é¢.</p>
</blockquote>
<p>local.html æºæ–‡ä»¶:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;button onclick=&quot;myFunction()&quot;&gt;Click me&lt;/button&gt;</div><div class="line">&lt;p id=&quot;demo&quot;&gt;&lt;/p&gt;</div><div class="line">&lt;p&gt;A function is triggered when the button is clicked.&lt;/p&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    function myFunction() &#123;</div><div class="line">        console.log(&apos;js console.&apos;);</div><div class="line">    &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<h4 id="3-åœ¨-Activity-ä¸­é…ç½®-WebView"><a href="#3-åœ¨-Activity-ä¸­é…ç½®-WebView" class="headerlink" title="3.åœ¨ Activity ä¸­é…ç½® WebView."></a>3.åœ¨ Activity ä¸­é…ç½® WebView.</h4><p>Activity.java æºæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">public class MZWebPage extends AppCompatActivity &#123;</div><div class="line">    private WebView webView;</div><div class="line">    @Override</div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_mzweb_page);</div><div class="line">        webView = (WebView) this.findViewById(R.id.ui_web_view);</div><div class="line">        // è®¾ç½® WebView çš„ Debug ä¸ºå¯ç”¨çŠ¶æ€</div><div class="line">        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</div><div class="line">            WebView.setWebContentsDebuggingEnabled(true);</div><div class="line">        &#125;</div><div class="line">        WebSettings settings = webView.getSettings();</div><div class="line">        </div><div class="line">        // è®¾ç½® JavaScript å¯ä»¥ä½¿ç”¨, å¦åˆ™åœ¨ HTML ä¸­æ— æ³•è°ƒç”¨ JavaScript ä»£ç </div><div class="line">        settings.setJavaScriptEnabled(true);</div><div class="line">        // æœ¬åœ°æ–‡ä»¶</div><div class="line">        String url = &quot;file:///android_asset/local.html&quot;;</div><div class="line">        webView.loadUrl(url);</div><div class="line">        webView.setWebViewClient(new WebViewClient() &#123;</div><div class="line">            @Override</div><div class="line">            public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) &#123;</div><div class="line">                return super.shouldOverrideUrlLoading(view, request);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        // è®¾ç½®æ¸²æŸ“è§†å›¾</div><div class="line">        webView.setWebChromeClient(new WebChromeClient());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯¹åº”çš„ xml å¸ƒå±€æ–‡ä»¶:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;LinearLayout</div><div class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</div><div class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</div><div class="line">    android:layout_width=&quot;match_parent&quot;</div><div class="line">    android:layout_height=&quot;match_parent&quot;</div><div class="line">    tools:context=&quot;demo.droidsdk.near.idreamsky.com.nearsdk.MZWebPage&quot;&gt;</div><div class="line">    &lt;WebView</div><div class="line">        android:layout_width=&quot;match_parent&quot;</div><div class="line">        android:layout_height=&quot;match_parent&quot;</div><div class="line">        android:id=&quot;@+id/ui_web_view&quot;&gt;</div><div class="line">    &lt;/WebView&gt;</div><div class="line">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure>
<h4 id="4-è¿è¡Œç¨‹åº"><a href="#4-è¿è¡Œç¨‹åº" class="headerlink" title="4. è¿è¡Œç¨‹åº"></a>4. è¿è¡Œç¨‹åº</h4><p>åœ¨ Chrome ä¸­è¾“å…¥ chrome://inspect æ‰“å¼€, å¯ä»¥çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„ local.html.<br><img src="/upload/images/2017/06/01/14962458882973.jpg" alt="1"></p>
<p>ç‚¹å‡» <code>inspect</code>, è¿›å…¥è°ƒè¯•ç•Œé¢.</p>
<p>åœ¨è°ƒè¯•ç•Œé¢, ç‚¹å‡»é¡µé¢çš„ Click me, æŒ‰é’®, å¯¹åº”çš„ä¼šæœ‰ log è¾“å‡º.<br><img src="/upload/images/2017/06/01/14962459967493.jpg" alt="1"></p>
<h4 id="5-è°ƒè¯•å‡ºé”™çš„-HTML"><a href="#5-è°ƒè¯•å‡ºé”™çš„-HTML" class="headerlink" title="5.è°ƒè¯•å‡ºé”™çš„ HTML"></a>5.è°ƒè¯•å‡ºé”™çš„ HTML</h4><p>ä¿®æ”¹ä¸€ä¸‹ local.html æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;button onclick=&quot;myFunction()&quot;&gt;Click me&lt;/button&gt;</div><div class="line">&lt;p id=&quot;demo&quot;&gt;&lt;/p&gt;</div><div class="line">&lt;p&gt;A function is triggered when the button is clicked.&lt;/p&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    function myFunction() &#123;</div><div class="line">        console.log(&apos;js console.&apos; + var_error);</div><div class="line">    &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¯ä»¥çœ‹å‡º <code>var_error</code> æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡.</p>
<p>é‡æ–°è¿è¡Œ, ç‚¹å‡» Click me, å¯ä»¥çœ‹åˆ°å³ä¾§çš„ error:<br><img src="/upload/images/2017/06/01/14962461463698.jpg" alt="1"></p>
<p>å…³äº Chrome å¼€å‘è€…å·¥å…·çš„æ›´å¤šä½¿ç”¨, å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ <a href="https://developers.google.com/web/tools/chrome-devtools/?hl=zh-cn" target="_blank" rel="noopener">Chrome å¼€å‘è€…å·¥å…·</a>.</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Chrome Web Debug </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¿æŒä½ çš„å¥½ä¹ æƒ¯]]></title>
      <url>/2017/05/29/%E4%BF%9D%E6%8C%81%E4%BD%A0%E7%9A%84%E5%A5%BD%E4%B9%A0%E6%83%AF/</url>
      <content type="html"><![CDATA[<p><img src="/upload/images/2017/05/29/1.jpeg" alt="1"></p>
<p>æ˜å¤©å°±æ˜¯ä¼ ç»Ÿçš„ç«¯åˆèŠ‚äº†, æå‰ç¥å¤§å®¶ç«¯åˆå®‰åº·!</p>
<p>ä»Šå¤©è€å©†è®©æˆ‘å¸®å¿™æŠŠç²½å¶å­æ´—æ´—, è¯´è¦åŒ…ç²½å­, æˆ‘å¬è¯åœ°æŠŠåˆšä¹°æ¥çš„ç²½å¶å­æ´—äº†ä¸ªå¹²å‡€, é‚£éƒ½æ˜¯å¸¦æœ‰ç»¿è‰²çš„å¶å­, ç”Ÿæœºå‹ƒå‹ƒ, è®©æˆ‘ä»æŒ‡å°–ä¸­æ„Ÿåˆ°æ— æ¯”çš„æ¸©é¦¨å’Œæ— å°½çš„å¸Œæœ›.</p>
<p>å°çš„æ—¶å€™, æˆ‘å¾ˆäº«å—å¦ˆå¦ˆä¸ºæˆ‘ä»¬åŒ…ç²½å­çš„è¿‡ç¨‹, è¯´å®è¯, æˆ‘ä¸æ˜¯å¾ˆå–œæ¬¢åƒç²½å­, ä½†æ˜¯ç‰¹åˆ«å–œæ¬¢ç²½å­é”…é‡Œé¢çš„ç…®é¸¡è›‹, ç‰¹åˆ«ç¾å‘³.</p>
<p>è€å®¶çš„ç²½å­æ²¡æœ‰ä»€ä¹ˆç‰¹è‰², å°±æ˜¯ç®€ç®€å•å•çš„ç³¯ç±³è¢«åŒ…åœ¨å¶å­ä¸­, ç„¶åæ”¾åœ¨é”…é‡Œæ…¢æ…¢çš„ç…®, ç†Ÿäº†ä¹‹å, è˜¸ç‚¹ç™½ç³–å°±å¯ä»¥åƒäº†.</p>
<p>åˆ°äº†å—æ–¹ä¹‹å, æˆ‘æ‰å‘ç°ä¸–ç•Œä¸ŠåŸæ¥æœ‰å„ç§å„æ ·çš„ç²½å­, çº¢æ£çš„, ç»¿è±†çš„, çŒªè‚‰é¦…çš„, é¸¡è‚‰é¦…çš„â€¦ç­‰ç­‰!</p>
<p>è¿™äº›éƒ½æ˜¯å¶å‘çš„å›å¿†, å’Œä»Šå¤©çš„æ¨æ–‡æ²¡æœ‰å…³ç³», ä¸ä¿¡, ä½ æ¥ç€å¾€ä¸‹çœ‹.</p>
<h2 id="å…»æˆé˜…è¯»çš„ä¹ æƒ¯"><a href="#å…»æˆé˜…è¯»çš„ä¹ æƒ¯" class="headerlink" title="å…»æˆé˜…è¯»çš„ä¹ æƒ¯"></a>å…»æˆé˜…è¯»çš„ä¹ æƒ¯</h2><p>æˆ‘ä¸æ˜¯ä¸€ä¸ªèªæ˜çš„å­©å­, ç›´åˆ°å°å­¦ä¸‰å¹´çº§, æˆ‘æ‰çœŸæ­£çš„å¼€å§‹æ˜ç™½å­¦ä¹ åˆ°åº•æ˜¯æ€ä¹ˆä¸€å›äº‹, ç”¨è€å®¶äººçš„è¯è¯´ç®—æ˜¯å¼€çªäº†.</p>
<p>åæ¥æˆ‘å¾ˆé¡ºåˆ©çš„ä¸Šäº†åˆä¸­, å®¶é‡Œçš„å¤§éƒ¨åˆ†æ”¶å…¥è¦é åº„å®¶, ä¸€å¹´å››å­£èƒ½å¤Ÿé£è°ƒé›¨é¡ºçš„è¯, ä¹Ÿèƒ½è¿‡ä¸ªä¸é”™çš„å¹´, è‡³å°‘èƒ½æŠŠå­¦è´¹ç»™äº¤ä¸Š.</p>
<p>åˆä¸­äºŒå¹´çº§çš„æ—¶å€™, æˆ‘è¾å­¦äº†, ä¹Ÿè®¸æ˜¯å‘½è¿çš„å®‰æ’å§, å½“æ—¶è‡ªå·±ä¹Ÿæ²¡æœ‰å¤šæƒ³, æ¯…ç„¶å†³å®šä¸‹å­¦å»å¯»æ‰¾å¦ä¸€ç§äººç”Ÿ.</p>
<p>äºæ˜¯, æˆ‘é€‰æ‹©äº†ç†å‘è¿™ä¸ªè¡Œä¸š. å’Œå¸ˆå‚…åœ¨é£é£é›¨é›¨ä¸­åº¦è¿‡äº†ä¸€å¹´å¤šçš„æ—¶é—´, åœ¨å½“æ—¶çš„å†œæ‘, ä¸ä¸Šå­¦æœ‰é—¨æ‰‹è‰ºä¹Ÿç®—æ˜¯å¯¹è‡ªå·±å’Œçˆ¶æ¯æœ‰ä¸ªäº¤ä»£.</p>
<p>æˆ‘çš„å†…å¿ƒä»ç„¶æ¸´æœ›å»ä¸Šå­¦, è™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦å»ä¸Šå­¦ä¹Ÿä¸çŸ¥é“ä¸Šå­¦åèƒ½å¹²ä»€ä¹ˆ, ä½†æ˜¯å¿ƒé‡Œé¢æ€»æ˜¯è§‰å¾—è‡ªå·±ä¸èƒ½æ”¾å¼ƒå­¦ä¸š.åœ¨ç†å‘çš„ä¸€å¹´å¤šæ—¶é—´é‡Œ, æˆ‘æ²¡æœ‰æ”¾å¼ƒè¿‡å­¦ä¹ .<br>å†¥å†¥ä¹‹ä¸­è‡ªæœ‰å®‰æ’, å¦ˆå¦ˆæœ‰æ¬¡é—®æˆ‘: â€œè¿˜æƒ³å»ä¸Šå­¦ä¸?â€, æˆ‘æƒ³éƒ½æ²¡æƒ³å°±æƒ…ä¸è‡ªç¦çš„ç‚¹å¤´äº†, å¦ˆå¦ˆåˆè¯´:â€æˆ‘å°±çŸ¥é“ä½ æ²¡æœ‰æ”¾å¼ƒ, å»ç»§ç»­ä¸Šå­¦å§, ä¸è¦ç•™ä¸‹é—æ†¾!â€.å½“æ—¶çš„æˆ‘ç”­ææœ‰å¤šé«˜å…´äº†.</p>
<p>å†æ¬¡å›åˆ°æ ¡å›­çš„æˆ‘æ¯”ä»¥å‰æ›´åŠ åŠªåŠ›å’Œæ‹¼å‘½äº†, æ›´åŠ æ‡‚å¾—å¦‚ä½•çæƒœè¿™æ¥ä¹‹ä¸æ˜“çš„å­¦ä¹ æœºä¼šäº†.</p>
<p>ç›´åˆ°å¤§å­¦æ¯•ä¸š, å‚åŠ å·¥ä½œä»¥åŠæœ‰äº†å­©å­å, æˆ‘ä¹Ÿèƒ½ä¿æŒè‡ªæˆ‘å­¦ä¹ å’Œè‡ªæˆ‘æ¿€åŠ±çš„çŠ¶æ€, ä¿æŒå¥½çš„é˜…è¯»ä¹ æƒ¯, è®©æˆ‘å—ç›Šç»ˆèº«.</p>
<p>æœ‰æ¬¡å­©å­æ—©æ™¨èµ·åºŠå¿™å®Œå, å°±å¼€å§‹ååœ¨é‚£é‡Œçœ‹ä¹¦, æœ‰å¥½å‡ æ¬¡æ™šä¸Š, æˆ‘ä¹Ÿå‘ç°ä»–æ´—å®Œæ¾¡å, ååœ¨é‚£é‡Œçœ‹ä¹¦, æˆ–è€…æ˜¯åšæ‰‹å·¥, æˆ–æ˜¯ç”»ç”».</p>
<p>æˆ‘æ„Ÿåˆ°å¾ˆå¥½å¥‡, å†³å®šæ‰¾ä¸ªæœºä¼šé—®é—®ä»–.</p>
<p>æœ‰ä¸€ä¸ªå‘¨æœ«çš„ä¸Šåˆ, æ—©é¤è¿‡å, æˆ‘å°±æŠŠä»–æ‹‰åˆ°èº«è¾¹, å’Œä»–ä¸€èµ·çœ‹å„¿ç«¥è¯»ç‰©, é—®ä»–:â€å®è´, ä½ ä¸ºä»€ä¹ˆå–œæ¬¢çœ‹ä¹¦å‘¢?â€, ä»–è¯´:â€çˆ¸çˆ¸, æ˜¯ä½ å½±å“äº†æˆ‘, ä½ å–œæ¬¢çœ‹ä¹¦, æˆ‘ä¹Ÿå–œæ¬¢çœ‹ä¹¦.â€, çœ‹ç€ä»–ä¸€å‰¯å¤©çœŸçš„æ ·å­, æˆ‘çœŸçš„ä¸æ•¢ç›¸ä¿¡å‡ å²çš„å­©å­èƒ½è¯´å‡ºè¿™æ ·çš„è¯, ä½†æˆ‘å†…å¿ƒæ„Ÿåˆ°æ— æ¯”çš„æ¬£æ…°.åŸæ¥å¥½çš„ä¹ æƒ¯ä¼šä¼ æŸ“ç»™è‡ªå·±èº«è¾¹çš„äºº, å¹¶ä¸”èƒ½è®©ä½ æ„Ÿåˆ°è‡ªè±ª.</p>
<h2 id="åšæŒå†™åšå®¢"><a href="#åšæŒå†™åšå®¢" class="headerlink" title="åšæŒå†™åšå®¢"></a>åšæŒå†™åšå®¢</h2><p>å†™åšå®¢æˆ–è€…æ˜¯ç”Ÿæ´»æ—¥è®°, ç¡®å®å¾ˆâ€æµªè´¹â€æ—¶é—´, ç”šè‡³ä¼šå ç”¨ä½ ä»»ä½•ä¼‘æ¯çš„æ—¶é—´, å†™åšå®¢å¶å°”ä¹Ÿä¼šè®©ä½ æŠ“è€³æŒ è…®, æ„Ÿå¹:â€ä¹¦åˆ°ç”¨æ—¶æ–¹æ¨å°‘â€!</p>
<p>æ‰€ä»¥, è¯», å†™ä¸èƒ½åˆ†å®¶, æ›´åº”è¯¥æ˜¯å°†äºŒè€…ç´§å¯†çš„è”åˆåœ¨ä¸€èµ·.<br>å¤šé˜…è¯»å¤šå†™, æ‰ä¼šè®©ä½ æ›´åŠ çš„é€šé€, å½“ç„¶äº†, æˆ‘åªæ˜¯å–œæ¬¢å†™, å†™çš„è´¨é‡ä¹Ÿå¾ˆä¸€èˆ¬, åªæ˜¯ä¸ºäº†æ»¡è¶³å†…å¿ƒçš„é‚£ä¸€ç‚¹ç‚¹å¯¹çŸ¥è¯†çš„æ¸´æœ›.</p>
<p>å†™çš„å¤šäº†, ä½ å°±æ›´åŠ æ„¿æ„å»æ€è€ƒäº†, æ€è€ƒå¤šäº†, å¾ˆå¤šäº‹æƒ…ä½ å°±çœ‹å¼€äº†, å¯¹ä½ çš„ç”Ÿæ´»å’Œå·¥ä½œéƒ½æœ‰å¥½å¤„.</p>
<p>ä»09å¹´åˆ°ç°åœ¨æˆ‘ä¸€ç›´åšæŒå†™åšå®¢, åˆšå¼€å§‹ä¹Ÿæ˜¯æ— ä»ä¸‹ç¬”, ä¸çŸ¥é“è‡ªå·±åˆ°åº•è¯¥å†™ä¸€å†™ä»€ä¹ˆä¸œè¥¿, å†™äº†ä¹‹å, æ˜¯ä¸æ˜¯åˆ«äººçœ‹äº†ä¼šå˜²ç¬‘æˆ‘, è¯¸å¦‚æ­¤ç±»çš„æ‹…å¿ƒå¤ªå¤šå¤ªå¤š, åæ¥æˆ‘ä¹Ÿæƒ³æ˜ç™½äº†, ä½ å†™çš„å†å¥½ä¹Ÿæœ‰äººæ¯”ä½ å†™å¾—å¥½, ä¹Ÿä¼šæœ‰äººè¯´ä½ å†™çš„ä¸å¥½.é‚£æˆ‘ä½•å¿…å»è®¡è¾ƒè¿™ä¹ˆäº›ä¸ªäº‹å„¿äº†, åªç®¡åŠ¨æ‰‹å†™å§!</p>
<p>ç„¶å, å°±åœ¨åšå®¢ç½‘ç«™ä¸Šé¢è€•è€˜, æŠ€æœ¯çš„, åæ§½çš„, ç”Ÿæ´»çš„æˆ‘éƒ½å–œæ¬¢å†™, ä¸ç®¡ä½ å–œä¸å–œæ¬¢çœ‹, å®ƒéƒ½åœ¨é‚£é‡Œ, å“ˆå“ˆ!</p>
<p>æˆ‘æŠŠåšå®¢å½“åšè‡ªå·±çš„æœ‹å‹, å¿ƒæƒ…å¥½äº¦æˆ–æ˜¯ä¸å¥½çš„æ—¶å€™, æˆ‘éƒ½ä¼šå‘ä»–å€¾è¯‰, å¸Œæœ›è‡ªå·±å†™ä¸‹çš„ä¸œè¥¿æˆ–å¤šæˆ–å°‘èƒ½å¸®åŠ©ä¸€äº›äºº, è¿™ä¹Ÿè®¸æ˜¯æˆ‘åšæŒå†™åšå®¢çš„æœ€å¤§åŠ¨åŠ›äº†.</p>
<p>å¦‚æœä½ ä¹Ÿå–œæ¬¢å†™åšå®¢æˆ–è€…æ˜¯å‡†å¤‡å†™åšå®¢, å°±å¼€å§‹åŠ¨æ‰‹å†™å§, ä¸è¦å†çŠ¹è±«äº†.</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>è¿™ä¸ªä¸–ç•Œä¸Š, æ²¡å¤šå°‘äººå–œæ¬¢å¬åˆ«äººå•°å—¦, å³ä½¿å¬äº†ä½ çš„å•°å—¦, ä¹Ÿä¸ä¸€å®šä¼šä»˜å‡ºå®è·µ, å³ä½¿ä½ æ˜¯é•¿è€…æˆ–è€…æ˜¯æ™ºè€…, å†µä¸”æˆ‘åªæ˜¯ä¸€ä»‹å¹³æ°‘.</p>
<p>ä½†æ˜¯æˆ‘è¿˜æ˜¯è¦å•°å—¦ä¸€å¥:â€ä¿æŒæŒç»­å­¦ä¹ çš„ä¹ æƒ¯, ä¼šæ¶ˆè€—ä½ çš„å‹¤å¥‹, ä½†ä¼šè®©ä½ å—ç›Šç»ˆç”Ÿâ€, ä¿¡ä¸ä¿¡ç”±ä½ !</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æ€è€ƒ ç”Ÿæ´» </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Safari çš„å¼€å‘è€…æ¨¡å¼]]></title>
      <url>/2017/05/15/Safari-%E7%9A%84%E5%BC%80%E5%8F%91%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h2 id="è®¾ç½®-Safari"><a href="#è®¾ç½®-Safari" class="headerlink" title="è®¾ç½® Safari"></a>è®¾ç½® Safari</h2><p>1.æ‰“å¼€ Safari çš„ Preference<br><img src="/upload/images/2017/05/15/14948249631231.jpg" alt="1"></p>
<p>2.åˆ‡æ¢åˆ° Advanced é€‰é¡¹<br><img src="/upload/images/2017/05/15/14948250437147.jpg" alt="1"></p>
<p>å°† <code>Show Develop menu in menu bar</code> é€‰ä¸­.</p>
<p>å¯ä»¥çœ‹åˆ° Safari å¤šäº† Develop é€‰é¡¹<br><img src="/upload/images/2017/05/15/14948254198174.jpg" alt="1"></p>
<h2 id="è®¾ç½®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨"><a href="#è®¾ç½®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨" class="headerlink" title="è®¾ç½®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨"></a>è®¾ç½®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨</h2><h3 id="åœ¨-iphoneæˆ–è€…æ¨¡æ‹Ÿå™¨-ä¸­è®¾ç½®-Safari"><a href="#åœ¨-iphoneæˆ–è€…æ¨¡æ‹Ÿå™¨-ä¸­è®¾ç½®-Safari" class="headerlink" title="åœ¨ iphoneæˆ–è€…æ¨¡æ‹Ÿå™¨ ä¸­è®¾ç½® Safari"></a>åœ¨ iphoneæˆ–è€…æ¨¡æ‹Ÿå™¨ ä¸­è®¾ç½® Safari</h3><h4 id="æ‰“å¼€-Safari-çš„é«˜çº§é€‰é¡¹"><a href="#æ‰“å¼€-Safari-çš„é«˜çº§é€‰é¡¹" class="headerlink" title="æ‰“å¼€ Safari çš„é«˜çº§é€‰é¡¹"></a>æ‰“å¼€ Safari çš„é«˜çº§é€‰é¡¹</h4><p><img src="/upload/images/2017/05/15/14948252328005.jpg" alt="1"></p>
<h4 id="æ‰“å¼€-Web-æ£€æŸ¥å™¨"><a href="#æ‰“å¼€-Web-æ£€æŸ¥å™¨" class="headerlink" title="æ‰“å¼€ Web æ£€æŸ¥å™¨"></a>æ‰“å¼€ Web æ£€æŸ¥å™¨</h4><p><img src="/upload/images/2017/05/15/14948252717169.jpg" alt="1"></p>
<p>ä¸Šé¢è®¾ç½®å®Œæ¯•å, è¿è¡Œä½ çš„ç¨‹åº, åœ¨ Safari çš„ Develop ä¸­å¯ä»¥çœ‹åˆ°å¯¹åº”è®¾å¤‡, ä»è€Œå¯ä»¥è°ƒè¯• HTML é¡µé¢äº†.<br><img src="/upload/images/2017/05/15/14948259031169.jpg" alt="1"></p>
<p>åœ¨è°ƒè¯•çª—å£ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰æ­£åœ¨åŠ è½½ç½‘é¡µçš„å„ç§ä¿¡æ¯ï¼Œå¦‚æºç ã€è¯·æ±‚å¤´ã€å›¾ç‰‡ã€åŠ è½½çš„èµ„æºä¸è„šæœ¬ã€æ§åˆ¶å°è¾“å‡ºç­‰.</p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹ç½‘é¡µçš„ CSS æ ·å¼å’Œå¸ƒå±€ç­‰è¿›è¡Œä¿®æ”¹ï¼Œè€Œä¸ç”¨é‡æ–°è¿è¡Œ App.<br><img src="/upload/images/2017/05/15/14948635711574.jpg" alt="1"></p>
<p>ä½¿ç”¨ Safari çš„å¼€å‘è€…æ¨¡å¼, å¯ä»¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•å‰ç«¯é¡µé¢, è§£å†³ä¸€äº›é—®é¢˜, æ¯”è¾ƒæ–¹ä¾¿.</p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS Safari </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS: è‡ªå®šä¹‰ UIWebView å’Œ WKWebView çš„ UserAgent]]></title>
      <url>/2017/05/14/iOS-%E8%87%AA%E5%AE%9A%E4%B9%89-UIWebView-%E5%92%8C-WKWebView-%E7%9A%84-UserAgent/</url>
      <content type="html"><![CDATA[<h2 id="å¯¼è¨€"><a href="#å¯¼è¨€" class="headerlink" title="å¯¼è¨€"></a>å¯¼è¨€</h2><p>åœ¨ iOS8, è‹¹æœæ¨å‡ºäº† WKWebView, ç›®çš„å¾ˆæ˜æ˜¾: å–ä»£ UIWebView.</p>
<p>éšç€æ—¶é—´çš„æ¨ç§», è¶Šæ¥è¶Šå¤šçš„åº”ç”¨å¼€å§‹æœ€ä½ç‰ˆæœ¬æ”¯æŒä¸º iOS8, å¤§å®¶ä¹Ÿçº·çº·çš„å¼€å§‹ä½¿ç”¨ WKWebView ç»„ä»¶.</p>
<p>åœ¨ iOS10.x ç‰ˆæœ¬ä¸Š, UIWebView çš„è¡¨ç°ä¸å°½å¦‚äººæ„, åœ¨æˆ‘ä»¬çš„åå°æ—¥å¿—å’Œç”¨æˆ·åé¦ˆ, å­˜åœ¨å¾ˆå¤šè«åå…¶å¦™çš„ crash ä»¥åŠå¡é¡¿ç°è±¡, å†…å­˜é£™å‡ç­‰é—®é¢˜. é’ˆå¯¹ä¸åŒçš„ JS æ¸¸æˆå¼•æ“, UIWebView è¡¨ç°ä¹Ÿä¸å¤Ÿå¥½, æ‰€ä»¥æ˜¯æ—¶å€™ä½¿ç”¨ WKWebView äº†.</p>
<p>ä½†æ˜¯è¯åˆè¯´å›æ¥, å¦‚æœä½ æœ€ä½ç‰ˆæœ¬æ”¯æŒ iOS8, ä¹Ÿä¸èƒ½å®Œå…¨æ”¾å¼ƒ UIWebView, WKWebView æœ‰ä¸€éƒ¨åˆ† API åªæœ‰ iOS9+ æ‰æœ‰, å¦‚æœä½ çš„åº”ç”¨åœ¨ iOS8 è¿è¡Œè€Œä½¿ç”¨ iOS9 çš„ API, è‚¯å®šä¼š crash.</p>
<p>ä¾‹å¦‚:</p>
<blockquote>
<p>1.æ¸…é™¤ç¼“å­˜.<br>2.è®¾ç½® user-agent.</p>
</blockquote>
<p>ä»Šå¤©è¦è¯´çš„æ˜¯å…³äºè®¾ç½®è‡ªå®šä¹‰ UIWebView å’Œ WKWebView çš„ UserAgent é—®é¢˜.</p>
<h2 id="WKWebView-UserAgent"><a href="#WKWebView-UserAgent" class="headerlink" title="WKWebView UserAgent"></a>WKWebView UserAgent</h2><h4 id="é»˜è®¤çš„-UserAgent"><a href="#é»˜è®¤çš„-UserAgent" class="headerlink" title="é»˜è®¤çš„ UserAgent"></a>é»˜è®¤çš„ UserAgent</h4><p>ä½¿ç”¨ä¸‹é¢çš„ä»£ç , å¯ä»¥è¾“å‡º WKWebView çš„é»˜è®¤ UserAgent.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidload </div><div class="line">&#123;</div><div class="line">    [self.wkWebView evaluateJavaScript:@&quot;navigator.appName&quot; completionHandler:^(id __nullable appName, NSError * __nullable error) &#123;</div><div class="line">        NSLog(@&quot;navigator.appName: %@&quot;, appName);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    [self.wkWebView evaluateJavaScript:@&quot;navigator.userAgent&quot; completionHandler:^(id __nullable userAgent, NSError * __nullable error) &#123;</div><div class="line">    	NSLog(@&quot;navigator.userAgent: %@&quot;, userAgent);</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>navigator.appName æ— è®ºåœ¨ iOS8, iOS9 è¿˜æ˜¯ iOS10, è¾“å‡ºç»“æœéƒ½æ˜¯ä¸€è‡´çš„.</p>
<p>navigator.userAgent åœ¨ä¸åŒçš„ iOS ç³»ç»Ÿä¸Šé¢è¾“å‡ºç»“æœç•¥æœ‰ä¸åŒ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// iOS 8.3</div><div class="line">// Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70</div><div class="line">// iOS 9.0</div><div class="line">// Mozilla/5.0 (iPhone; CPU iPhone OS 9_0 like Mac OS X) AppleWebKit/601.1.32 (KHTML, like Gecko) Mobile/13A4254v</div><div class="line">// iOS 10.x</div><div class="line">//Mozilla/5.0 (iPhone; CPU iPhone OS 10_3 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E269</div></pre></td></tr></table></figure>
<h4 id="è‡ªå®šä¹‰-UserAgent"><a href="#è‡ªå®šä¹‰-UserAgent" class="headerlink" title="è‡ªå®šä¹‰ UserAgent"></a>è‡ªå®šä¹‰ UserAgent</h4><p>ä¿®æ”¹é»˜è®¤çš„ UserAgent, éœ€è¦ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">self.wkWebView.customUserAgent = @&quot;CustomUserAgent&quot;</div></pre></td></tr></table></figure>
<p>è¿™æ ·, å°±æ”¹å˜äº†å…¶é»˜è®¤çš„ UserAgent å€¼äº†.</p>
<p>ç‰¹åˆ«éœ€è¦æ³¨æ„: customUserAgent æ˜¯ iOS9 ä¹‹åæ‰æœ‰çš„å­—æ®µ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/*! @abstract The custom user agent string or nil if no custom user agent string has been set.</div><div class="line">*/</div><div class="line">@property (nullable, nonatomic, copy) NSString *customUserAgent API_AVAILABLE(macosx(10.11), ios(9.0));</div></pre></td></tr></table></figure>
<p>æ‰€ä»¥åœ¨ iOS8.x, å¦‚æœä½ æƒ³æ”¹å˜ UserAgent, è¿˜æ˜¯è¦ä½¿ç”¨ UIWebView.</p>
<h2 id="HTML-ä½¿ç”¨-UserAgent"><a href="#HTML-ä½¿ç”¨-UserAgent" class="headerlink" title="HTML ä½¿ç”¨ UserAgent"></a>HTML ä½¿ç”¨ UserAgent</h2><p>HTML ä¸­å¯ä»¥æ ¹æ®è‡ªå®šä¹‰çš„ UserAgent, åšå‡ºä¸åŒçš„è¡Œä¸º, å¦‚è‡ªå®šçš„ UserAgent å¯ä»¥åŒ…æ‹¬åº”ç”¨çš„ç‰ˆæœ¬å·, HTML å¯ä»¥æ ¹æ®ä¸åŒçš„ç‰ˆæœ¬æ¥åšç‰ˆæœ¬åŒºåˆ†ç­‰é€»è¾‘.</p>
<p>åœ¨ HTML ä¸­, å¯ä»¥ä½¿ç”¨ JS æ¥è·å– UserAgent çš„å€¼.</p>
<p>Demo.html</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot; xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;utf-8&quot; /&gt;</div><div class="line">        &lt;title&gt;user-agent&lt;/title&gt;</div><div class="line">        &lt;script type=&quot;text/javascript&quot;&gt;</div><div class="line">            function getUserAgent() &#123;</div><div class="line">                var ug = navigator.userAgent;</div><div class="line">                document.getElementById(&quot;mySpan&quot;).innerHTML = ug;</div><div class="line">            &#125;</div><div class="line">        &lt;/script&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;h1&gt;æ˜¾ç¤º user-agent&lt;/h1&gt;</div><div class="line">        &lt;p&gt;&lt;span style=&quot;font-size:30px&quot; id=&quot;mySpan&quot;&gt;..&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;&lt;input type=&quot;button&quot; value=&quot;ç‚¹å‡»æ˜¾ç¤º user-agent&quot; onclick=&quot;getUserAgent()&quot;  class=&quot;button&quot;/&gt;&lt;/p&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    </div><div class="line">    &lt;style&gt;</div><div class="line">        .button &#123;</div><div class="line">            background-color: #4C0950;</div><div class="line">            border: none;</div><div class="line">            color: white;</div><div class="line">            padding: 15px 32px;</div><div class="line">            text-align: center;</div><div class="line">            text-decoration: none;</div><div class="line">            display: inline-block;</div><div class="line">            font-size: 40px;</div><div class="line">            margin: 20px 200px 100px 300px;</div><div class="line">            cursor: pointer;</div><div class="line">            border-radius: 15;</div><div class="line">        &#125;</div><div class="line">    &lt;/style&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ WKWebView åŠ è½½è¯¥ Demo.html æ–‡ä»¶, æ•ˆæœå›¾å¦‚ä¸‹:<br><img src="/upload/images/2017/05/14/webView.jpg" alt="1"></p>
<h2 id="UIWebView-UserAgent"><a href="#UIWebView-UserAgent" class="headerlink" title="UIWebView UserAgent"></a>UIWebView UserAgent</h2><h4 id="é»˜è®¤çš„-UserAgent-1"><a href="#é»˜è®¤çš„-UserAgent-1" class="headerlink" title="é»˜è®¤çš„ UserAgent"></a>é»˜è®¤çš„ UserAgent</h4><p>ä½¿ç”¨ä¸‹é¢çš„ä»£ç , å¯ä»¥è¾“å‡º UIWebView çš„é»˜è®¤ UserAgent.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">NSString *appName = [self.webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.appName&quot;];</div><div class="line">NSLog(@&quot;navigator.appName: %@&quot;, appName);</div><div class="line">    </div><div class="line">NSString *userAgent = [self.webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.userAgent&quot;];</div><div class="line">NSLog(@&quot;navigator.userAgent %@&quot;, userAgent);</div></pre></td></tr></table></figure>
<p>æ‰“å°è¾“å‡ºç»“æœå’Œ WKWebView çš„ç»“æœä¸€è‡´.</p>
<h4 id="è®¾ç½®è‡ªå®šçš„-UserAgent"><a href="#è®¾ç½®è‡ªå®šçš„-UserAgent" class="headerlink" title="è®¾ç½®è‡ªå®šçš„ UserAgent"></a>è®¾ç½®è‡ªå®šçš„ UserAgent</h4><p>è®¾ç½®ä¸€ä¸ª key ä¸º @â€UserAgentâ€ çš„æœ¬åœ°å­˜å‚¨å³å¯.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[[NSUserDefaults standardUserDefaults] registerDefaults:@&#123;@&quot;UserAgent&quot;:@&quot;CustomUserAgent-UIWebView&quot;&#125;];</div><div class="line">    </div><div class="line">NSString *appName = [self.webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.appName&quot;];</div><div class="line">NSLog(@&quot;navigator.appName: %@&quot;, appName);</div><div class="line">    </div><div class="line">NSString *userAgent = [self.webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.userAgent&quot;];</div><div class="line">NSLog(@&quot;navigator.userAgent %@&quot;, userAgent);</div></pre></td></tr></table></figure>
<p>è¿™æ ·å°±æ”¹å˜äº† UIWebView çš„é»˜è®¤ UserAgent äº†.</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>åº”ç”¨æœ€ä½ç‰ˆæœ¬æ”¯æŒ iOS7/8 çš„å¼€å‘è€…ä»¬, å¯ä»¥è€ƒè™‘ UIWebView å’Œ WKWebView å¹¶å­˜çš„å¼€å‘æ¨¡å¼. iOS9åŠä»¥ä¸Šçš„å¼€å‘è€…ä½ ä»¬, å¯ä»¥å®Œå…¨æ”¾å¼ƒ UIWebView, å¤§èƒ†çš„æ‹¥æŠ± WKWebView äº†.</p>
<p>ç§»æ¤ UIWebView åˆ° WKWebView çš„æˆæœ¬ä¸ç®—å¤§.<br>å¦‚æœä½ ç°åœ¨æœ‰æ—¶é—´, å¯ä»¥å¼€å§‹ç€æ‰‹åšè¿™äº›äº‹äº†.å‰ç«¯å’Œå®¢æˆ·ç«¯éœ€è¦è€ƒè™‘ä¹‹å‰äº¤äº’é‚£éƒ¨åˆ†çš„é€»è¾‘, å³ JS è°ƒç”¨ Native æˆ–è€… Native è°ƒç”¨ JS çš„éœ€è¦åšäº›è°ƒæ•´, å› ä¸º WKWebView çš„è°ƒç”¨æ–¹å¼å’Œ UIWebView ä¸ä¸€æ ·äº†, å‰ç«¯é¡µé¢è¦è€ƒè™‘ç‰ˆæœ¬å…¼å®¹æ€§.</p>
<p>æ–°çš„ WKWebView è™½ç„¶å­˜åœ¨ä¸€äº›å‘, ä½†æ˜¯ä½¿ç”¨å®ƒäº¦æ˜¯å¤§åŠ¿æ‰€è¶‹, æ­£æ‰€è°“ å­˜åœ¨å³åˆç†, ä½ æ²¡æœ‰ç†ç”±æ‹’ç»å®ƒ.</p>
<p>åç»­, æˆ‘ä¼šå†™ä¸€å†™åœ¨ WKWebView ä¸Šé¢é‡åˆ°çš„ä¸€äº›é—®é¢˜, åˆ†äº«ç»™å¤§å®¶.</p>
<p>ä¹‹å‰æˆ‘ä¹Ÿå†™è¿‡ä¸€ç¯‡æ–‡ç« , æ˜¯å…³äº UIWebView ç¼“å­˜çš„, ä¸å¦¨, ä½ ä¹Ÿç…ç… [iOS: èŠèŠ UIWebView ç¼“å­˜].</p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> UIWebView WKWebView UserAgent </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Cocos2d-js: é¦–æ¬¡åœ¨ Mac ä¸Šé¢è¿è¡Œ]]></title>
      <url>/2017/05/14/Cocos2d-js-%E9%A6%96%E6%AC%A1%E5%9C%A8-Mac-%E4%B8%8A%E9%9D%A2%E8%BF%90%E8%A1%8C/</url>
      <content type="html"><![CDATA[<h2 id="Cocos2d-js-ä»‹ç»"><a href="#Cocos2d-js-ä»‹ç»" class="headerlink" title="Cocos2d-js ä»‹ç»"></a>Cocos2d-js ä»‹ç»</h2><p>å¦‚æœä½ æ˜¯åˆšæ¥è§¦ Cocos2d-js å¼€å‘çš„äºº, ä¸€å®šä¼šè¢« Cocos2d-js å’Œ Cocos2d-HTML5 ä»¥åŠ Cocos2d-x æå¾—æ™•å¤´è½¬å‘.</p>
<p>ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹ Cocos2d-js çš„å‰ä¸–ä»Šç”Ÿ.</p>
<p>ç›®å‰ Cocos2d-x æ”¯æŒä½¿ç”¨ C++ã€Luaã€Javascript è¯­è¨€æ¥è¿›è¡Œå¼€å‘ï¼Œä¸”å†…ç½® JavaScript å¼•æ“ï¼Œé€šè¿‡ C++ è§£æ Javascript å»æ‰§è¡Œ.</p>
<p>Cocos2d-HTML5 æ˜¯ä½¿ç”¨ JavaScript è¿›è¡Œå¼€å‘ï¼Œæœ€ç»ˆè¿è¡Œåœ¨æµè§ˆå™¨é‡Œçš„.</p>
<p>v3.0 åï¼ŒCocos2d-HTML5 å’Œ Cocos2d-x JSBinding è¢«åˆåˆ°äº†ä¸€èµ·ï¼Œç§°ä½œ Cocos2d-JS.</p>
<p>ä¸ Cocos2d-HTML5 ä¸åŒçš„æ˜¯ï¼ŒCocos2d-js å¼€å‘çš„ç¨‹åºä¸ä»…èƒ½è¿è¡Œåœ¨æµè§ˆå™¨é‡Œï¼Œè¿˜èƒ½ç¼–è¯‘è¿è¡Œåœ¨ Mac OSX, Windows, iOS, Android å¹³å°ä¸Š.</p>
<p>ä» Cocos2d-x v3.7 ç‰ˆæœ¬ä¹‹å, js ç‰ˆæœ¬è¢«åˆå¹¶åˆ° Cocos2d-x ä¸­äº†.</p>
<p>å…·ä½“å¯ä»¥çœ‹ <a href="https://github.com/cocos2d/cocos2d-x/blob/cocos2d-x-3.7/docs/RELEASE_NOTES.md" target="_blank" rel="noopener">Release Note</a> è¿™ä¸ªè¯´æ˜.</p>
<p>è¿™ä¸ªç‰ˆæœ¬çš„å‘å¸ƒæ—¥æœŸæ˜¯åœ¨2015å¹´7æœˆ21.</p>
<p>åŸæ¥çš„ Cocos2d-js ç‰ˆæœ¬åœ¨ [GitHub] ä¸Šé¢å·²ç»åœæ­¢æ›´æ–°äº†.</p>
<p>è¯´æ˜å¦‚ä¸‹:</p>
<blockquote>
<p>2/27/2016 - This repository is no longer active.<br>Cocos2d-JS was merged with Cocos2d-x starting at version 3.7.</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡º, Cocos2d-js åŸæ¥ç‹¬ç«‹çš„é¡¹ç›®è¢«åˆå¹¶åˆ°äº† Cocos2d-x ä¸­äº†.</p>
<p>ç°åœ¨ä½¿ç”¨ Cocos2d-x ä¸ä»…å¯ä»¥åˆ›å»º cpp é¡¹ç›®å’Œ lua é¡¹ç›®, ä¹Ÿå¯ä»¥åˆ›å»º js é¡¹ç›®äº†.</p>
<p>å®˜æ–¹æœ‰è¯´æ˜çš„:</p>
<blockquote>
<p>Cocos2d-JS is Cocos2d-x engineâ€™s JavaScript version that includes Cocos2d-html5 and Cocos2d-x JavaScript Bindings.</p>
</blockquote>
<p>è‡³äºä»€ä¹ˆæ˜¯ Cocos2d-x JavaScript Bindings, å¤§å®¶è‡ªè¡Œ google, è¿™é‡Œä¸èµ˜è¿°.</p>
<p>å…³ç³»å›¾å¤§æ¦‚å¦‚ä¸‹:<br><img src="/upload/images/2017/05/14/3.png" alt="1"></p>
<p>Cocos2d-x æ¡†æ¶å›¾<br><img src="/upload/images/2017/05/14/4.jpg" alt="1"></p>
<h2 id="æ­å»º-Cocos2d-js-å¼€å‘ç¯å¢ƒ"><a href="#æ­å»º-Cocos2d-js-å¼€å‘ç¯å¢ƒ" class="headerlink" title="æ­å»º Cocos2d-js å¼€å‘ç¯å¢ƒ"></a>æ­å»º Cocos2d-js å¼€å‘ç¯å¢ƒ</h2><h4 id="1-ä¸‹è½½-Cocos2d-x"><a href="#1-ä¸‹è½½-Cocos2d-x" class="headerlink" title="1.ä¸‹è½½ Cocos2d-x"></a>1.ä¸‹è½½ Cocos2d-x</h4><p>å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½æœ€æ–°çš„ Release åŒ…, ç‚¹å‡» ä¸‹è½½åœ°å€, æˆ‘ä¸‹è½½çš„æœ€æ–°åŒ…æ˜¯ cocos2d-x-3.15.</p>
<p>ä¸‹è½½è§£å‹å³å¯, è¿™é‡Œæˆ‘æŠŠ cocos2d-x-3.15 ä¿®æ”¹ä¸º cocos2d-x.</p>
<h4 id="è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="è®¾ç½®ç¯å¢ƒå˜é‡"></a>è®¾ç½®ç¯å¢ƒå˜é‡</h4><p>åœ¨ cocos2d-x ç›®å½•, æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python setup.py</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œå®Œæ¯•å, å¯ä»¥çœ‹åˆ° â€˜~/.bash_profile` çš„å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Add environment variable COCOS_CONSOLE_ROOT for cocos2d-x</div><div class="line">export COCOS_CONSOLE_ROOT=/Users/mark/workspace/mzProjs/c2dx/cocos2d-x/tools/cocos2d-console/bin</div><div class="line">export PATH=$COCOS_CONSOLE_ROOT:$PATH</div><div class="line"># Add environment variable COCOS_TEMPLATES_ROOT for cocos2d-x</div><div class="line">export COCOS_TEMPLATES_ROOT=/Users/mark/workspace/mzProjs/c2dx/cocos2d-x/templates</div><div class="line">export PATH=$COCOS_TEMPLATES_ROOT:$PATH</div></pre></td></tr></table></figure>
<p>è¿™é‡Œ, æ²¡æœ‰çœ‹åˆ°æˆ‘çš„ <code>ANT_ROOT</code> è·¯å¾„, å…¶å®è¯¥è„šæœ¬æ™ºèƒ½çš„æ‰¾åˆ° <code>/usr/local/Cellar/ant/1.9.7/bin</code>, ä½†æ˜¯æˆ‘ä¸æƒ³ä½¿ç”¨è¿™ä¸ª ant, æƒ³ä½¿ç”¨è‡ªå·±ä¸‹è½½çš„ ant, ä¿®æ”¹è¯¥æ–‡ä»¶å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># Add environment variable COCOS_CONSOLE_ROOT for cocos2d-x</div><div class="line">export COCOS_CONSOLE_ROOT=/Users/mark/workspace/mzProjs/c2dx/cocos2d-x/tools/cocos2d-console/bin</div><div class="line">export PATH=$COCOS_CONSOLE_ROOT:$PATH</div><div class="line"># Add environment variable ANT_ROOT for cocos2d-x</div><div class="line">export ANT_ROOT=/Users/mark/developer/apache/apache-ant-1.10.1/bin</div><div class="line">export PATH=$ANT_ROOT:$PATH</div><div class="line"># Add environment variable COCOS_TEMPLATES_ROOT for cocos2d-x</div><div class="line">export COCOS_TEMPLATES_ROOT=/Users/mark/workspace/mzProjs/c2dx/cocos2d-x/templates</div><div class="line">export PATH=$COCOS_TEMPLATES_ROOT:$PATH</div></pre></td></tr></table></figure>
<p>æœ€åæ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source ~/.bash_profile</div></pre></td></tr></table></figure>
<p>ä½¿ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ.</p>
<h4 id="åˆ›å»º-js-å·¥ç¨‹"><a href="#åˆ›å»º-js-å·¥ç¨‹" class="headerlink" title="åˆ›å»º js å·¥ç¨‹"></a>åˆ›å»º js å·¥ç¨‹</h4><p>cd åˆ°ä»»æ„ç›®å½•, æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cocos new HelloJs -l js -d .</div></pre></td></tr></table></figure>
<blockquote>
<p>new HelloJs è¡¨ç¤ºå·¥ç¨‹åå­—ä¸º HelloJs<br>-l js è¡¨ç¤ºåˆ›å»º js å·¥ç¨‹.<br>-d . è¡¨ç¤ºåœ¨å½“å‰è·¯å¾„åˆ›å»ºè¯¥å·¥ç¨‹</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°ä¸‹é¢åˆ›å»ºå·¥ç¨‹çš„è¿‡ç¨‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Copy template into /Users/mark/workspace/mzProjs/c2dx/works/HelloJs</div><div class="line">Copying directory from cocos root directory...</div><div class="line">Copying files from template directory...</div><div class="line">Copying Cocos2d-x files...</div><div class="line">Rename project name from &apos;HelloJavascript&apos; to &apos;HelloJs&apos;</div><div class="line">Replace the project name from &apos;HelloJavascript&apos; to &apos;HelloJs&apos;</div><div class="line">Replace the project package name from &apos;org.cocos2dx.hellojavascript&apos; to &apos;org.cocos2dx.HelloJs&apos;</div><div class="line">Replace the Mac bundle id from &apos;org.cocos2dx.hellojavascript&apos; to &apos;org.cocos2dx.HelloJs&apos;</div><div class="line">Replace the iOS bundle id from &apos;org.cocos2dx.hellojavascript&apos; to &apos;org.cocos2dx.HelloJs&apos;</div></pre></td></tr></table></figure>
<p>å·¥ç¨‹ç›®å½•:<br><img src="/upload/images/2017/05/14/1.jpg" alt="1"></p>
<h4 id="å·¥ç¨‹å‘å¸ƒ"><a href="#å·¥ç¨‹å‘å¸ƒ" class="headerlink" title="å·¥ç¨‹å‘å¸ƒ"></a>å·¥ç¨‹å‘å¸ƒ</h4><p>å°†ä¸Šé¢çš„å·¥ç¨‹ç¼–è¯‘å‘å¸ƒ.</p>
<p>ç¼–è¯‘å‘å¸ƒ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cocos compile -p web -m release</div></pre></td></tr></table></figure>
<blockquote>
<p>-p web è¡¨ç¤ºç¼–è¯‘ web å¹³å°.<br>-m release è¡¨ç¤ºç¼–è¯‘ä¸º release æ¨¡å¼.</p>
</blockquote>
<p>ç¼–è¯‘è¾“å‡º:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Building mode: release</div><div class="line">running: &apos;/Users/mark/developer/apache/apache-ant-1.10.1/bin/ant -f /Users/mark/workspace/mzProjs/c2dx/works/HelloJs/publish/html5/build.xml&apos;</div><div class="line">Buildfile: /Users/mark/workspace/mzProjs/c2dx/works/HelloJs/publish/html5/build.xml</div><div class="line">compile:</div><div class="line">   [jscomp] Compiling 156 file(s) with 42 extern(s)</div><div class="line">   [jscomp] 0 error(s), 0 warning(s)</div><div class="line">BUILD SUCCESSFUL</div><div class="line">Total time: 8 seconds</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ åœ¨è¿™ä¸€æ­¥ç¼–è¯‘æŠ¥é”™, æˆ–è€…æ‰§è¡Œä¸ä¸‹å», ä¸€èˆ¬éƒ½æ˜¯æ²¡æœ‰åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®å¥½ ant.</p>
<p>ç¼–ç¨‹æˆåŠŸå, ä¼šå¤šå‡º publish ç›®å½•:<br><img src="/upload/images/2017/05/14/2.jpg" alt="1"></p>
<h4 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h4><p>æ‰§è¡Œ cocos run å‘½ä»¤æ¥åœ¨ç³»ç»Ÿé»˜è®¤çš„æµè§ˆå™¨ä¸Šé¢è¿è¡Œ.</p>
<p>cd åˆ°å·¥ç¨‹ç›®å½•, æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cocos run -p web -s . --port 9009</div></pre></td></tr></table></figure>
<p>è¿™æ ·ä¼šå¸®æˆ‘ä»¬åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ª webServer æ¥è¿è¡Œç¤ºä¾‹, ç›´æ¥æ‰“å¼€äº†é»˜è®¤ä½¿ç”¨çš„æµè§ˆå™¨.</p>
<blockquote>
<p>-s: è¡¨ç¤ºå½“å‰éœ€è¦æ‰§è¡Œçš„æºç è·¯å¾„<br>â€“port: æŒ‡å®šç«¯å£, å¦‚æœä¸æŒ‡å®šç«¯å£, é»˜è®¤åœ¨ 8000 ç«¯å£æ‰§è¡Œ.</p>
</blockquote>
<p>æ›´å¤š cocos run å‘½ä»¤å¯ä»¥, ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥çœ‹å¸®åŠ©:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cocos run --help</div></pre></td></tr></table></figure>
<h2 id="æœ¬åœ°è¿è¡Œ-index-html-çš„é—®é¢˜"><a href="#æœ¬åœ°è¿è¡Œ-index-html-çš„é—®é¢˜" class="headerlink" title="æœ¬åœ°è¿è¡Œ index.html çš„é—®é¢˜"></a>æœ¬åœ°è¿è¡Œ index.html çš„é—®é¢˜</h2><p>ä½ å¯ä»¥ç”¨ç«ç‹æµè§ˆå™¨(FireFox)æ‰“å¼€æœ¬åœ°å·¥ç¨‹ç›®å½•ä¸­çš„ index.html, å³å¯çœ‹åˆ°è¿è¡Œæ•ˆæœäº†.<br>FireFox åº”è¯¥æ˜¯åœ¨æœ¬åœ°å¯åŠ¨äº†ä¸€ä¸ª WebServer æ¥è¿è¡Œ.</p>
<p>åœ¨ chrome ä¸­ç›´æ¥è¿è¡Œ index.html, æ— æ³•çœ‹åˆ°æœ€ç»ˆæ•ˆæœ, ä¸€ç›´å¡åœ¨ loading ç•Œé¢.</p>
<p>æ‰“å¼€ inspect, å¯ä»¥çœ‹åˆ°æŠ¥é”™ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">XMLHttpRequest cannot load file:/xx/publish/html5/project.json.</div><div class="line">Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension, https.</div></pre></td></tr></table></figure>
<p>ç½‘ä¸Šæœ‰äººè®¨è®ºè¿‡è¿‡é—®é¢˜, è¯´æ˜¯ chrome è·¨åŸŸä¸æ”¯æŒ file åè®®ï¼Œé‚£ä¹ˆå³ä½¿ä½ å…è®¸ chrome è·¨åŸŸæ”¯æŒ, ç›´æ¥è¿è¡Œæœ¬åœ°çš„ index.html è¿˜æ˜¯æŠ¥é”™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">game.min.js:54 Uncaught TypeError: Cannot read property &apos;modules&apos; of null</div></pre></td></tr></table></figure>
<p>åœ¨ MacOS ä¸Šé¢å…è®¸ chrome è·¨åŸŸè®¿é—®æ–‡ä»¶çš„æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open /Applications/Google\ Chrome.app --args --allow-file-access-from-files</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡º, åœ¨è¿™æ–¹é¢, FireFox åšçš„æ¯” chrome å¥½.</p>
<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><blockquote>
<p>æ›´æ–°æ—¶é—´ 2017-10-15</p>
</blockquote>
<p>åœ¨å¾®ä¿¡å…¬ä¼—å·ä¸Šé¢çœ‹åˆ° <a href="https://mp.weixin.qq.com/s?__biz=MjM5ODAxNTM2NA==&amp;mid=2659646056&amp;idx=1&amp;sn=239871c3775ae12af5edf9ac2381b0b2" target="_blank" rel="noopener">ä¸€æ‹›æ•™ä½ è¾¨åˆ« Cocosã€Cocos2dã€Cocos2d-x</a> è¿™ç¯‡æ–‡ç« , å¤§å®¶å¯ä»¥çœ‹çœ‹, å¯¹ cocos ä¼šæœ‰æ›´åŠ æ·±å…¥çš„äº†è§£.</p>
]]></content>
      
        <categories>
            
            <category> Game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> cocos cocos2d-js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å°å°ç¯®çƒé˜Ÿ]]></title>
      <url>/2017/04/29/%E5%B0%8F%E5%B0%8F%E7%AF%AE%E7%90%83%E9%98%9F/</url>
      <content type="html"><![CDATA[<p><img src="/upload/images/2017/04/29/hua.jpeg" alt="1"></p>
<p>ç¯®çƒ, æˆ‘æœ€å–œæ¬¢çš„ä¸€é¡¹ä½“è‚²è¿åŠ¨, å¤§å­¦çš„ä¸šä½™æ—¶é—´åŸºæœ¬éƒ½â€æ³¡â€åœ¨çƒåœº, å‹æ ¹ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ç´¯.</p>
<p>æ¯•ä¸šåçš„ç¬¬ä¸€ä»½å·¥ä½œ, åšçš„æ¯”è¾ƒå¼€å¿ƒ, å¤§å®¶å¹´é¾„ç›¸ä»¿, å…´è¶£ç›¸æŠ•.</p>
<p>å°å°çš„å›¢é˜Ÿ, æ²¡æœ‰ä»»ä½•çº·äº‰, å¤§å®¶äº’ç›¸å­¦ä¹ , æ°›å›´åŠå…¶èæ´½.</p>
<p>æ¯ä¸ªå‘¨äº”æˆ‘ä»¬å‡ ä¸ªäººéƒ½ä¼šæå‰ä¸‹ç­å»æ‰“ä¸€åœºç¯®çƒ, å®Œäº‹å, ä¸€èµ·å–ç‚¹å°é…’, é‚£æ—¥å­ç”­ææœ‰å¤šä»–NNDçš„æƒ¬æ„.</p>
<p>å…¬å¸è§£æ•£å, å¤§å®¶å„å¥”ä¸œè¥¿, äº‹è¿‡å¢ƒè¿, å„æœ‰å„çš„å·¥ä½œå’Œç”Ÿæ´», èšåœ¨ä¸€èµ·çš„æ—¥å­ä¹Ÿæ˜¯å°‘ä¹‹åˆå°‘, ä»¥å‰çš„æ—¥å­åªèƒ½æ€€å¿µäº†.</p>
<p>äººæ€»éœ€è¦ä¸€äº›éå·¥ä½œä¹‹å¤–çš„å…´è¶£, æ•´å¤©å›´ç»•ç€å·¥ä½œ, æ—©æ™šéƒ½ä¼šç–¯æ‰.</p>
<p>æœ‰äº›äººå–œæ¬¢æ³¡æ³¡å›¾ä¹¦é¦†, æœ‰äº›äººå–œæ¬¢æ‰“æ‰“æ¸¸æˆ, æœ‰äº›äººå–œæ¬¢è·‘è·‘æ­¥, æœ‰äº›äººå–œæ¬¢å”±å”±æ­Œâ€¦</p>
<p>ä¸ç®¡æ€ä¹ˆæ ·, ä½ éœ€è¦æŸç§çˆ±å¥½, æ¥æ¶¦è‰²ä¸€ä¸‹ä½ çš„ç”Ÿæ´», æˆ‘é€‰æ‹©äº†ç¯®çƒè¿åŠ¨.</p>
<p>ä¸‹é¢, æ¥è¯´è¯´ç¯®çƒé˜Ÿä¸­å…¸å‹çš„å‡ ç§äºº, å¤§å®¶ç»“åˆè‡ªå·±çš„å·¥ä½œå’Œç”Ÿæ´», æ€è€ƒä¸€ä¸‹å§~</p>
<h2 id="å•æ‰“ç‹¬æ–—"><a href="#å•æ‰“ç‹¬æ–—" class="headerlink" title="å•æ‰“ç‹¬æ–—"></a>å•æ‰“ç‹¬æ–—</h2><p>ç¯®çƒè¿åŠ¨æ˜¯ä¸€é¡¹é›†ä½“è¿åŠ¨, éœ€è¦æ¯ä¸ªäººå‘æŒ¥è‡ªå·±åº”æœ‰çš„æ°´å¹³, æ‰èƒ½å‘æŒ¥å›¢é˜Ÿçš„åŠ›é‡.</p>
<p>æœ‰äº›äººå–œæ¬¢å•æ‰“ç‹¬æ–—, å®Œå…¨ä¸è€ƒè™‘å›¢é˜Ÿä¸­å…¶ä»–æˆå‘˜çš„æ„Ÿå—, åªè¦çƒåˆ°äº†ä»–æ‰‹ä¸­, å…¶ä»–äººåªèƒ½çœ‹ä»–çš„è¡¨æ¼”, ä»»å‡­ä½ å–Šç ´å—“å­, ä»–ä¹Ÿä¸ä¼šç†ä½ .</p>
<p>è¿™ç§äºº, å…¶å®æ˜¯æœ‰ä¸€å®šèƒ½åŠ›çš„äºº, ä¸ç„¶ä¹Ÿä¸ä¼šä¹Ÿä¸å¯èƒ½è¿™ä¹ˆåš, åªæ˜¯ä»–ä»¬è§‰å¾—å‡­ä¸€å·±ä¹‹åŠ›å°±å¯ä»¥è®©å¤§å®¶é«˜æ­£æ— å¿§äº†, è‡ªå·±æ²¡æœ‰æ€è€ƒè¿‡è¿™æ ·åšæ˜¯ä¸æ˜¯æœ€åˆé€‚çš„.</p>
<p>ä¹…è€Œä¹…ä¹‹, å¤§å®¶çœ‹ç€ä»–çš„â€è¡¨æ¼”â€, å†ä¹Ÿä¸æƒ³å‘æŒ¥äº†, å•æ‰“ç‹¬æ–—çš„äººæ…¢æ…¢çš„ä¹Ÿç´¯äº†, æœ€åå¤§å®¶éƒ½èº«å¿ƒç–²æƒ«, çƒé˜Ÿè¢«å¯¹æ–¹è½»è€Œæ˜“ä¸¾åœ°æ‰“è´¥.</p>
<h2 id="â€œæŒ‡æŒ¥å®˜â€"><a href="#â€œæŒ‡æŒ¥å®˜â€" class="headerlink" title="â€œæŒ‡æŒ¥å®˜â€"></a>â€œæŒ‡æŒ¥å®˜â€</h2><p>çƒé˜Ÿä¸­æœ‰ä¸€ç§äºº, è‡ªå·±ä¸åŠªåŠ›, æ€»æ˜¯å–œæ¬¢é¢æŒ‡æ°”ä½¿, ç»å¸¸å¬åˆ°ä»–ä»¬è¯´è¿™æ ·çš„è¯:</p>
<blockquote>
<p>ä½ å¿«ç‚¹è·‘å‘€, ç§¯æç‚¹â€¦<br>æ­»æ­»åœ°é˜²ç€ä»–, ä¸è¦è®©ä»–è¿›æ”», å¿«â€¦<br>ä½ ä¼ çƒç»™æˆ‘å‘€, è®©ä½ åˆ«ç€æ€¥, å¥½äº†å§, è¾“äº†å§â€¦<br>è¾“äº†, éƒ½æ€ªä½ â€¦</p>
</blockquote>
<p>å¬åˆ°è¿™äº›è¯, å†å¥½è„¾æ°”çš„äººä¼°è®¡éƒ½éš¾ä»¥æ¥å—, è„¾æ°”ä¸å¥½çš„ç›´æ¥å¼€å§‹æ‰“ä»–äº†å§!</p>
<p>è¿™ç§äººæœ€ä¸å—å¾…è§, ä¹Ÿæœ€é­äººå”¾éª‚, è¿™ç§äººåœ¨å®é™…å·¥ä½œä¸­, å¯èƒ½æ˜¯ä½ çš„é¢†å¯¼.</p>
<h2 id="å·æ‡’çš„"><a href="#å·æ‡’çš„" class="headerlink" title="å·æ‡’çš„"></a>å·æ‡’çš„</h2><p>ç¯®çƒè¿åŠ¨çš„ç¡®å¾ˆæ¶ˆè€—ä½“åŠ›, å¦‚æœåœ¨ä¸‡ç®­é½å‘çš„æ—¶åˆ», æœ‰äººæ•…æ„æ‰é“¾å­, é‚£å°†æ˜¯åŠŸäºä¸€ç¯‘.</p>
<p>å¤§å®¶åœ¨æ‰“çƒçš„æ—¶å€™, éƒ½åœ¨ä¸ºâ€è£èª‰â€è€Œæˆ˜, ä½†æ˜¯ååæœ‰äººä¼šä½¿ç‚¹å°å¿ƒçœ¼, èƒ½å°‘è·‘ä¸€æ­¥å°±å°‘è·‘ä¸€æ­¥, èƒ½æ”¾å¯¹æ–¹èµ°å°±æ”¾å¯¹æ–¹èµ°, ç»å¯¹ä¸ä¼¤å®³å¯¹æ–¹ä¸€æ¯›ä¸€çº¿. æ˜æ˜å¯ä»¥ç¨å¾®åŠªåŠ›ä¸€ä¸‹, å°±å¯ä»¥æ‹¿åˆ°ç¯®æ¿, ååè®©å¯¹æ–¹æ¯”è‡ªå·±è¿˜çŸ®å°çš„è½»è€Œæ˜“ä¸¾çš„æ‹¿èµ°äº†ç¯®æ¿.</p>
<p>è¦çŸ¥é“æ¯”è‡ªå·±çŸ®å°çš„é‚£ä¸ªäºº, åªæ˜¯åŠªåŠ›çš„è·³äº†ä¸€ä¸‹.</p>
<p>çƒåœºä¸Šè™½ç„¶ä¸æ˜¯è®©ä½ æ‹¼ä¸ªä½ æ­»æˆ‘æ´», ä¸è¦æ±‚ä½ å…¨åŠ›ä»¥èµ´, ä½†æ˜¯å°½åŠ›è€Œä¸ºæ€»æ˜¯è¦æœ‰çš„, è¿™æ˜¯ä¸€ç§æ€åº¦.</p>
<p>åœ¨å®é™…å·¥ä½œä¸­, è¿™ç§â€é˜Ÿå‹â€æ¯”æ¯”çš†æ˜¯, ä½†æ˜¯ä¸ä¸€å®šé­äººæ¨, æœ‰äº›è¿˜æ˜¯å¾ˆæ‹›äººå–œæ¬¢çš„, æ¯•ç«Ÿä»–ä»¬æ²¡æœ‰æŠ¢ä½ çš„åŠŸåŠ³, å¤„å¤„è®©ç€ä½ , æ²¡æœ‰ä»–ä»¬çš„è¿™äº›æ‰€è°“çš„ä»˜å‡º, å“ªèƒ½è¡¬æ‰˜å‡ºä½ çš„å…‰èŠ’.</p>
<h2 id="é¼“åŠ±ä½ çš„"><a href="#é¼“åŠ±ä½ çš„" class="headerlink" title="é¼“åŠ±ä½ çš„"></a>é¼“åŠ±ä½ çš„</h2><p>ä¸Šé¢è¯´çš„éƒ½æ˜¯ä¸€äº›â€è´Ÿèƒ½é‡â€, å¤§å®¶ä¸€ç¬‘è€Œè¿‡å§.ä¸‹é¢è¯´ç‚¹æ­£èƒ½é‡çš„.</p>
<p>åœ¨çƒé˜Ÿä¸­, è¿˜æœ‰ä¸€ç§è¿™æ ·çš„äºº, ä»–ä¼šå¯Ÿè¨€è§‚è‰², è§‰å¾—ä½ ç´¯äº†, å°±å‘Šè¯‰å¤§å®¶: â€œæˆ‘ä»¬åº”è¯¥èŠ‚å¥æ…¢ä¸€ç‚¹, ç¼“å†²ä¸€ä¸‹.â€,</p>
<p>å½“ä½ æ‰‹æ„Ÿä¸å¥½çš„æ—¶å€™, ä»–ä¼šå‘Šè¯‰ä½ , æ²¡äº‹, å¤šæ¥å‡ æ¬¡å°±å¥½äº†, ä¸è¦æœ‰å‹åŠ›.</p>
<p>å½“ä½ é˜²å®ˆé‡åˆ°å›°éš¾æ—¶, ä»–ä¼šé»˜é»˜çš„ç»™ä½ è¡¥é˜², ç»™ä½ æ¥åŠ›, æœ€å¤§ç¨‹åº¦çš„ç»™ä½ ä¿¡å¿ƒ.</p>
<p>å½“å¤§å®¶å£«æ°”ä¸é«˜çš„æ—¶å€™, ä»–ä¼šç«™å‡ºæ¥æŠ•å‡ ä¸ªæ¼‚äº®çš„çƒ, æŠ‘æˆ–ç»™å¯¹æ–¹ä¸€ä¸ªå®Œç¾çš„ç›–å¸½, å¹¶ä¸”é¼“åŠ±å¤§å®¶ä¸è¦æ”¾å¼ƒ, ç»™å¤§å®¶ä¿¡å¿ƒ, åšå¤§å®¶åšå›ºçš„åç›¾.</p>
<p>è¿™ç§äººé™¤äº†è‡ªå·±æœ‰ä¸€å®šçš„èƒ½åŠ›å¤–, è¿˜èƒ½é¡¾å…¨å¤§å±€, å¹¶ä¸”å¯ä»¥å¸®åŠ©é˜Ÿå‹, å¸®åŠ©å›¢é˜Ÿæ¸¡è¿‡éš¾å…³, ç¡®å®éš¾å¾—.</p>
<h2 id="æ¸´æœ›è¿›æ­¥çš„"><a href="#æ¸´æœ›è¿›æ­¥çš„" class="headerlink" title="æ¸´æœ›è¿›æ­¥çš„"></a>æ¸´æœ›è¿›æ­¥çš„</h2><p>çƒé˜Ÿä¸­, å­˜åœ¨ä¸€äº›æ–°äºº, æˆ–è€…æ˜¯æ¸´æœ›è‡ªå·±èƒ½æŠ•å‡ºæ¼‚äº®å¼§çº¿çƒçš„äºº, ä»–ä»¬æ¯”ä¸ä¸Šé‚£äº›èµ„å†è€ä¸”ç»éªŒä¸°å¯Œçš„å‰è¾ˆ, ä½†æ˜¯ä»–ä»¬å†…å¿ƒæœ‰ä¸€ä»½ä¿¡å¿µ: â€œæˆ‘è¦å˜å¼º!â€.</p>
<p>è¿™ç§äºº, è·Ÿä½ è®¨è®ºçƒæŠ€, è™šå¿ƒå‘ä½ å­¦ä¹ ä¸€åˆ‡å¯ä»¥æé«˜çƒæŠ€çš„æ–¹æ³•, å³ä½¿åœ¨è§‚ä¼—å¸­ä¸Š, ä»–ä»¬ä¹Ÿèƒ½èšç²¾ä¼šç¥çš„è§‚çœ‹, è‡ªå·±é¢†æ‚Ÿå…¶ä¸­çš„å¥¥å¦™. åªè¦ä½ çº¦ä»–å‡ºæ¥æ‰“çƒ, ä»–éƒ½åœ¨ç¬¬ä¸€æ—¶é—´å‡ºç°åœ¨çƒåœº, å› ä¸ºä»–ä¸æƒ³æ”¾å¼ƒå­¦ä¹ çš„æœºä¼š.</p>
<p>ä¹…è€Œä¹…ä¹‹, è¿™äº›äººä¼šå˜å¾—è¶Šæ¥è¶Šå‰å®³, é€šè¿‡ä¸æ–­çš„å­¦ä¹ å’Œæ‘¸ç´¢, æœ‰äº†ä¸€å¥—è‡ªå·±çš„æ‰“æ³•, æ­¥ä¼ç¨³å¥, å†ä¹Ÿä¸æ˜¯é‚£ç§æ¥çƒä¸ç¨³, ä¼ çƒé¢‘é¢‘å¤±è¯¯çš„â€æ¯›å¤´å°å­â€äº†.</p>
<p>è¿™ç§äºº, å€¼å¾—æˆ‘ä»¬å»æŒ–æ˜å’Œé¼“åŠ±, å¦‚æœä½ æ­£å¥½æ˜¯é‚£ä¸ªèµ„å†è€ä¸”ç»éªŒä¸°å¯Œçš„å‰è¾ˆ, å°±ä¼ æˆâ€çœŸç»â€ç»™ä»–ä»¬å§.<br>å¯¹äºä½ æ¥è¯´, æœ‰äººæ„¿æ„è·Ÿä½ å­¦ä¹ , è·Ÿä½ åˆ†äº«, ä¹Ÿæ˜¯ç¾äº‹ä¸€æ¡©.</p>
<p>ä½•ä¹è€Œä¸ä¸ºå‘¢?</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä¸ç®¡ä½ é‡åˆ°ä»€ä¹ˆæ ·çš„é˜Ÿå‹, å¦‚æœä½ æ„¿æ„, è¯·èƒ¸æ€€å®‡å®™(å½“ç„¶ä¸æ˜¯ å­™è¿åŸ é‚£ç§å•Š).</p>
<p>ä¸‡äº‹ä¸‡ç‰©çš†æœ‰è”ç³», æ„¿ä½ èƒ½å¶å°”æ”¾ä¸‹æ‰‹ä¸­çš„å·¥ä½œ, å»é€‰æ‹©å’Œçˆ±ä¸Šå¦ä¸€ç§ä¹è¶£.</p>
<p>äº”ä¸€æ”¾å‡äº†, ç¥å¤§å®¶èŠ‚æ—¥å¿«ä¹!</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç”Ÿæ´» æ€è€ƒ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS: åº”ç”¨å†…æ‰“å¼€ AppStore]]></title>
      <url>/2017/04/15/iOS-%E5%BA%94%E7%94%A8%E5%86%85%E6%89%93%E5%BC%80-AppStore/</url>
      <content type="html"><![CDATA[<h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>æˆ‘ä»¬çš„ App éœ€è¦åœ¨ AppStore ä¸Šé¢æ‰“å¼€æŸä¸ª App æˆ–è€…æ¸¸æˆ, ç›®çš„æœ€å¸¸è§çš„æœ‰:</p>
<blockquote>
<p>1.è¯„åˆ†è¯„è®º.<br>2.æ¨èä¸‹è½½(App æˆ–è€…æ¸¸æˆ).</p>
</blockquote>
<p>å¾ˆå¤šå¼€å‘è€…çŸ¥é“æ‰“å¼€ AppStore åªéœ€è¦ä¸€å¥ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;itunes app url&quot;]];</div></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¾ˆç®€å•çš„æ‰“å¼€ AppStore äº†, ä½†æ˜¯äº§å“ç»ç†é—®äº†, èƒ½åœ¨æˆ‘ä»¬åº”ç”¨å†…æ‰“å¼€ AppStore å—?</p>
<p>ä½ å½“æ—¶æ‡µé€¼äº†å—?</p>
<p>ä¸è¦æ‡µé€¼, ä»¥ååªè¦é‡åˆ°ç±»ä¼¼è¿™ç§é—®é¢˜, ä½ å°±é—®äº§å“ç»ç†å“ªä¸ª APP è¿™æ ·åšäº†?<br>ç„¶å, ä»–å°±ç»™ä½ çœ‹åˆ«äººå®¶çš„æ•ˆæœ, ä½ å°±ç†ç›´æ°”å£®åœ°è¯´: â€œåˆ«äººå¯ä»¥åšåˆ°çš„, æˆ‘ä»¬ä¹Ÿå¯ä»¥åšåˆ°!â€.</p>
<p>åº”ç”¨å†…æ‰“å¼€ AppStore ä¹Ÿå¾ˆç®€å•.<br>åœ¨ iOS6ä¹‹å, è‹¹æœå·²ç»ç»™æˆ‘ä»¬æä¾›äº† <a href="https://developer.apple.com/reference/storekit/skstoreproductviewcontroller#//apple_ref/doc/c_ref/SKStoreProductViewController" target="_blank" rel="noopener">SKStoreProductViewController</a>, å¤§å®¶çœ‹ä¸€ä¸‹æ–‡æ¡£, ä½ å°±ç¬‘äº†.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SKStoreProductViewController</div><div class="line">/* View controller to display iTunes Store product information */</div></pre></td></tr></table></figure>
<h2 id="åº”ç”¨å†…æ‰“å¼€-AppStore"><a href="#åº”ç”¨å†…æ‰“å¼€-AppStore" class="headerlink" title="åº”ç”¨å†…æ‰“å¼€ AppStore"></a>åº”ç”¨å†…æ‰“å¼€ AppStore</h2><p>è¿™é‡Œæˆ‘ä»¥åœ¨åº”ç”¨å†…æ‰“å¼€ <code>å¾®ä¿¡</code> ä¸ºä¾‹å­.</p>
<p>æ•ˆæœå›¾å¦‚ä¸‹:<br><img src="/upload/images/2017/04/15/eff_appstore_1.png" alt="1"></p>
<p>ä»æ•ˆæœå›¾å¯ä»¥çœ‹å‡º, ç”¨æˆ·åœ¨è‡ªå·±çš„åº”ç”¨å†…æ‰“å¼€ AppStore å, ä¸ä»…å¯ä»¥ä¸‹è½½æˆ–è€…æ‰“å¼€å¾®ä¿¡, è¿˜å¯ä»¥ç›´æ¥è¯„è®ºè¯„åˆ†, ç®€ç›´çˆ½(ä¹Ÿéš¾æ€ªäº§å“ç»ç†è¿™ä¹ˆå¹²).</p>
<p>é‚£æˆ‘ä»¬è¯´ä¸€ä¸‹å¦‚ä½•å®ç°ä¸Šé¢çš„æ•ˆæœ.</p>
<p>å®ç°æ–¹æ¡ˆå’Œæ­¥éª¤</p>
<p>1.åŒ…å«å¤´æ–‡ä»¶ <code>#import &lt;StoreKit/StoreKit.h&gt;</code></p>
<p>2.å®ç° <code>SKStoreProductViewControllerDelegate</code></p>
<p>å…·ä½“ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">- (void)openAppFromAppStore:(NSString *)appid</div><div class="line">&#123;</div><div class="line">    if (nil == appid || appid.length &lt;= 0) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // åŠ ä¸ª loading</div><div class="line">    </div><div class="line">    SKStoreProductViewController *store = [[SKStoreProductViewController alloc] init];</div><div class="line">        </div><div class="line">        store.delegate = self;</div><div class="line">        </div><div class="line">        NSDictionary&lt;NSString *, id&gt; *parameters = @&#123;SKStoreProductParameterITunesItemIdentifier: appid&#125;;</div><div class="line">    </div><div class="line">        [store loadProductWithParameters:parameters completionBlock:^(BOOL result, NSError *error) &#123;</div><div class="line">        </div><div class="line">            // ç»“æŸ loading</div><div class="line">            </div><div class="line">            if (error) &#123;</div><div class="line">                </div><div class="line">                NSLog(@&quot;error %@ with userInfo %@&quot;, error, [error userInfo]);</div><div class="line">                </div><div class="line">                // æç¤ºç”¨æˆ·å‘ç”Ÿäº†é”™è¯¯</div><div class="line">                </div><div class="line">                // æˆ–è€…é€šè¿‡ URL æ‰“å¼€ AppStore App.</div><div class="line">                </div><div class="line">                // NSString *url = @&quot;https://itunes.apple.com/in/app/wechat/id414478124?mt=8&quot;;</div><div class="line">                </div><div class="line">                //[[UIApplication sharedApplication] openURL:[NSURL URLWithString:url]];</div><div class="line">            &#125;</div><div class="line">            else &#123;</div><div class="line">                </div><div class="line">                [self presentViewController:store animated:YES completion:^&#123;</div><div class="line">                &#125;];</div><div class="line">            &#125;</div><div class="line">        &#125;];</div><div class="line">&#125;</div><div class="line">/// ç”¨æˆ·ç‚¹å‡»å–æ¶ˆä¼šæ‰§è¡Œè¯¥æ–¹æ³•</div><div class="line">- (void)productViewControllerDidFinish:(SKStoreProductViewController *)viewController</div><div class="line">&#123;</div><div class="line">    [viewController dismissViewControllerAnimated:YES completion:^&#123;</div><div class="line">        </div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è°ƒç”¨(@â€414478124â€ æ˜¯ å¾®ä¿¡ çš„)æ–¹å¼:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[self openAppFromAppStore:@&quot;414478124&quot;];</div></pre></td></tr></table></figure>
<h2 id="ä¿®æ”¹-AppStore-çš„å¯¼èˆªæ "><a href="#ä¿®æ”¹-AppStore-çš„å¯¼èˆªæ " class="headerlink" title="ä¿®æ”¹ AppStore çš„å¯¼èˆªæ "></a>ä¿®æ”¹ AppStore çš„å¯¼èˆªæ </h2><p>äº§å“ç»ç†è¯´, æ—¢ç„¶ä½ å·²ç»å®ç°äº†ä¸Šé¢çš„åŠŸèƒ½, çœ‹çœ‹èƒ½ä¸èƒ½æŠŠ AppStore çš„å¯¼èˆªæ æ”¹ä¸€ä¸ªç‰›é€¼çš„é¢œè‰², å°±åƒä¸Šé¢çš„å¤§çº¢è‰².</p>
<p>~</p>
<p>å¯ä»¥, å¹²!</p>
<p>ç›´æ¥ä¸Šä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">- (void)openAppFromAppStore:(NSString *)appid</div><div class="line">&#123;</div><div class="line">    if (nil == appid || appid.length &lt;= 0) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // åŠ ä¸ª loading</div><div class="line">    </div><div class="line">    // å¯¼èˆªæ ä¸Šé¢çš„æ–‡å­—å’Œå›¾ç‰‡é¢œè‰²å˜äº†</div><div class="line">    [[UINavigationBar appearance] setTintColor:[UIColor greenColor]];</div><div class="line">    </div><div class="line">    // å¯¼èˆªæ çš„å¤§çº¢è‰²å‡ºæ¥äº†</div><div class="line">    [[UINavigationBar appearance] setBarTintColor:[UIColor redColor]];</div><div class="line">    </div><div class="line">    [UINavigationBar appearanceWhenContainedIn:[SKStoreProductViewController class], nil];</div><div class="line">    </div><div class="line">    SKStoreProductViewController *store = [[SKStoreProductViewController alloc] init];</div><div class="line">        </div><div class="line">        store.delegate = self;</div><div class="line">        </div><div class="line">        NSDictionary&lt;NSString *, id&gt; *parameters = @&#123;SKStoreProductParameterITunesItemIdentifier: appid&#125;;</div><div class="line">    </div><div class="line">        [store loadProductWithParameters:parameters completionBlock:^(BOOL result, NSError *error) &#123;</div><div class="line">            </div><div class="line">            // ç»“æŸ loading</div><div class="line">            </div><div class="line">            if (error) &#123;</div><div class="line">                </div><div class="line">                NSLog(@&quot;error %@ with userInfo %@&quot;, error, [error userInfo]);</div><div class="line">                </div><div class="line">                // æç¤ºç”¨æˆ·å‘ç”Ÿäº†é”™è¯¯</div><div class="line">                </div><div class="line">                // æˆ–è€…é€šè¿‡ URL æ‰“å¼€ AppStore App.</div><div class="line">            &#125;</div><div class="line">            else &#123;</div><div class="line">                </div><div class="line">                [self presentViewController:store animated:YES completion:^&#123;</div><div class="line">                &#125;];</div><div class="line">            &#125;</div><div class="line">        &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>1.æ‰“å¼€ <code>SKStoreProductViewController</code> ç›®å‰åªèƒ½ä½¿ç”¨ <code>present</code> æ–¹å¼, ä¸å¯ä»¥ä½¿ç”¨ <code>push</code> çš„æ–¹å¼.</p>
<p>å¦åˆ™ä¼šæŠ¥é”™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//Terminating app due to uncaught exception &apos;SKUnsupportedPresentationException&apos;,</div><div class="line">//reason: &apos;SKStoreProductViewController must be used in a modal view controller&apos;</div></pre></td></tr></table></figure>
<p>2.åŠ å…¥ loading</p>
<p>åœ¨åº”ç”¨å†…æ‰“å¼€ AppStore, ä¸ºäº†ä¸è®©ç”¨æˆ·å‚»ç­‰(ç½‘ç»œä¸å¥½çš„æ—¶å€™, æ‰“å¼€å¾ˆæ…¢), å¯ä»¥åŠ å…¥ loading, ç¼“è§£ä¸€ä¸‹ç”¨æˆ·æ€¥èºçš„å¿ƒæƒ….</p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> AppStore iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ‰¾åˆä¼™äºº, ä¸æ˜“]]></title>
      <url>/2017/03/26/%E6%89%BE%E5%90%88%E4%BC%99%E4%BA%BA-%E4%B8%8D%E6%98%93/</url>
      <content type="html"><![CDATA[<p>æ—©åœ¨é«˜ä¸­æ—¶æœŸ, è¯»è¿‡ &lt;ä¸‰è¨€&gt; ä¸­çš„ &lt;è­¦ä¸–é€šè¨€&gt;, ç¬¬ä¸€ç« å†™çš„æ˜¯ <code>ä¿ä¼¯ç‰™æ‘”ç´è°¢çŸ¥éŸ³</code>, è®²çš„æ˜¯é’Ÿå­æœŸå’Œä¿ä¼¯ç‰™çš„æ•…äº‹.</p>
<p>è¯»å®Œä¹‹å, æ•´ä¸ªäººéƒ½è§‰å¾—éš¾å—, å¿ƒç†æœ‰è¯´ä¸å‡ºçš„æ»‹å‘³, çœ¼æ³ªç«Ÿå¤ºçœ¶è€Œå‡º.</p>
<p>æµä¼ çš„è¿™é¦–è¯—, å¯ä»¥æ„Ÿå—ä¸‹.</p>
<blockquote>
<p>æ‘”ç¢ç‘¶ç´å‡¤å°¾å¯’ï¼Œå­æœŸä¸åœ¨å¯¹è°å¼¹ï¼<br>æ˜¥é£æ»¡é¢çš†æœ‹å‹ï¼Œæ¬²è§…çŸ¥éŸ³éš¾ä¸Šéš¾ã€‚<br>åŠ¿åˆ©äº¤æ€€åŠ¿åˆ©å¿ƒï¼Œæ–¯æ–‡è°å¤å¿µçŸ¥éŸ³ï¼<br>ä¼¯ç‰™ä¸ä½œé’ŸæœŸé€ï¼Œåƒå¤ä»¤äººè¯´ç ´ç´ã€‚</p>
</blockquote>
<p>è‡ªå·±å·¥ä½œä¹‹å, å¯¹ <code>æ¬²è§…çŸ¥éŸ³éš¾ä¸Šéš¾</code> è¿™å¥è¯å°¤ä¸ºèµåŒ.</p>
<p>å¹´å°‘è½»ç‹‚çš„ä½ , è—ç€è¦æ”¹å˜ä¸–ç•Œçš„å¿ƒ, æ®‹é…·çš„ç°å®ä¼šæŠ¹å»ä½ å‡¸èµ·çš„æ£±è§’, å²æœˆå’Œç¯å¢ƒä¼šè®©ä½ å˜å¾—è¶Šå‘ä¸å®‰.</p>
<p>ä¸å®‰çš„ä¸–ç•Œ, è®©ä½ èŒ«ç„¶.</p>
<p>äºæ˜¯, ç‚¹ä¸Šä¸€æ”¯çƒŸ, å›é¡¾æŠ˜è…¾çš„äººç”Ÿ, ç¬‘å¹: åˆ«äººç¬‘æˆ‘å¤ªç–¯ç™«, æˆ‘ç¬‘ä»–äººçœ‹ä¸ç©¿.</p>
<p>å¯æƒœ, æˆ‘ä»¬ä¸æ˜¯å”å¯…, æ²¡æœ‰è¿™ä»½æ´’è„±å’Œå¥”æ”¾, æ¯•ç«Ÿæ—¶ä»£ä¹Ÿå¤§ç›¸å¾„åº­.</p>
<p>~ å¥½äº†, å›åˆ°ç°å®ä¸­æ¥.</p>
<p>åˆšæ¯•ä¸š, ä½ ä¼šæŠŠä¸»è¦ç²¾åŠ›æ”¾åœ¨å¦‚ä½•æŠŠå·¥ä½œåšå¥½, ç»´æŒè‡ªå·±çš„ç”Ÿè®¡ä¸Šé¢, å¦‚æœèƒ½è·Ÿèº«è¾¹çš„å¤§ç‰›å­¦åˆ°ä¸€äº›ä¸“ä¸šçŸ¥è¯†, å†è‹¦å†ç´¯, ä½ éƒ½æ˜¯å¼€å¿ƒçš„.</p>
<p>æ¸æ¸åœ°, ä½ å‘ç°çŸ¥è¯†(ä¸“ä¸šçš„å’Œéä¸“ä¸šçš„çŸ¥è¯†)çœŸæ˜¯è¦æ´»åˆ°è€å­¦åˆ°è€, æ°¸æ— æ­¢å¢ƒ, æ— æ³•åƒæ­¦ä¾ ç‰‡é‡Œé¢æ¼”å¾—é‚£æ ·ç§»èŠ±æ¥æœ¨, æ–—è½¬æ˜Ÿç§». å‘œå‘¼, è„šè¸å®åœ°çš„åšå¥½æœ¬èŒå·¥ä½œ, é¡ºä¾¿èƒ½æ‹“å±•ä¸€ä¸‹è‡ªå·±çš„äº¤é™…åœˆ, æ‰©å¤§è‡ªå·±çš„çŸ¥è¯†é¢, è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„.</p>
<p>å„è¡Œå„ä¸šéƒ½æœ‰éå¸¸çªå‡ºçš„äººæ‰, å¾ˆå¤šæ—¶å€™, æˆ‘ä»¬åªèƒ½æœ›æ´‹å…´å¹.</p>
<p>å¦‚æœä½ èƒ½é‡åˆ°ä¸€ä¸ªè‚¯ä¸ä½ åˆ†äº«å’Œäº¤æµ, æˆ–è€…æ˜¯æ„¿æ„å°†è‡ªå·±çš„å®è·µåˆ†äº«ç»™ä½ çš„äºº, é‚£ä½ ç®—æ˜¯ä¸Šè¾ˆå­ç§¯äº†å¤§å¾·äº†. é˜¿å¼¥é™€ä½›!</p>
<p>æˆ‘æŠŠè¿™æ ·çš„äººç§°ä¹‹ä¸º <code>æ©äºº</code>, ä¹Ÿç®—æ˜¯ <code>çŸ¥éŸ³</code>.</p>
<p>ä»¥å‰, å¾ˆå¤šæœ‹å‹ä¼šé—®å¦‚æœå°†æ¥è‡ªå·±å¼€å…¬å¸, æ˜¯å¦æ„¿æ„æ¥å—ç°åœ¨çš„è‡ªå·±, æˆ‘çš„å›ç­”æ˜¯ä¸€å®šæ¥å—. å¦‚æœè¿˜æœ‰äººé—®è¿™ä¸ªé—®é¢˜, æˆ‘ä¼šå¦å¤–å†è¿½åŠ ä¸€ä¸ªé—®é¢˜:</p>
<blockquote>
<p>å¦‚æœä½ å¼€å…¬å¸, ä½ æ˜¯å¦æ„¿æ„æ¥å—å’Œä½ ç°åœ¨ä¸€èµ·å·¥ä½œçš„åŒäº‹?æˆ–è€…è¯´ä½ æ˜¯å¦æ„¿æ„è®©ä»–æˆä¸ºä½ çš„åˆä¼™äºº?</p>
</blockquote>
<p>è¿™äº›é—®é¢˜, çœ‹ä¼¼ç©ç¬‘, å®åˆ™å¾ˆç°å®å¾ˆæ®‹é…·, ä¸€æ—¦ä½ å†³å®šè¦å»åšæˆæŸä»¶äº‹æƒ…, ç«‹å¿—è¦å®ç°è‡ªå·±çš„æŠ±è´Ÿå’Œç†æƒ³çš„æ—¶å€™, ä½ çš„ç«‹åœºä¼šå’Œå…¶ä»–äººåƒå·®å¤–åˆ«.é¦–å…ˆè¦è€ƒè™‘çš„æ˜¯è¦å’Œè°ä¸€èµ·å…±è°‹äº‹, æ‰èƒ½çœŸæ­£çš„å¸®åˆ°è‡ªå·±, å¹¶ä¸”ä¹Ÿèƒ½å¸®åˆ°åˆ«äºº.å› ä¸ºé€‰æ‹©æ˜¯åŒå‘çš„, èƒ½æ‰¾åˆ°å’Œä½ ä¸€æ‹å³åˆçš„äºº, ä¹Ÿç¡®å®ä¸æ˜“.ä½†æ„¿ä»»ä½•ä¸€ä¸ªæ¸´æœ›æˆåŠŸå¹¶ä»˜å‡ºè¡ŒåŠ¨çš„äºº, èƒ½æ‰¾åˆ°è‡ªå·±çš„åˆä¼™äºº, æ‰¾åˆ°è‡ªå·±çš„çŸ¥éŸ³.</p>
<p>çœŸæ­£çš„æˆåŠŸè€…, ä¸æ˜¯æ²‰æµ¸åœ¨å¤šå°‘äººè®©ä½ æˆåŠŸçš„å–œæ‚¦ä¸­, è€Œæ˜¯ä½ è®©å¤šå°‘äººå’Œä½ ä¸€èµ·åˆ†äº«äº†æˆåŠŸçš„å–œæ‚¦çš„äºº.</p>
<p>è¯´åˆ°è¿™é‡Œ, æœ¬äººåªæ˜¯æƒ³è¯´æ˜ç™½ä¸€ä¸ªé“ç†, é€ç»™å³å°†æˆ–è€…å·²ç»åœ¨èŒåœºå¥‹æ–—çš„äºº:</p>
<blockquote>
<p>è¸è¸å®å®çš„åšäº‹å¹¶æ²¡æœ‰é”™, ä½†æ˜¯æ‰¾åˆ°å€¼å¾— â€œæ‰˜ä»˜ç»ˆèº«â€ çš„äººç¡®å®ä¸æ˜“, ä½ ç°åœ¨èƒ½åšçš„åªæœ‰ç”¨çŸ¥è¯†æ¥æ­¦è£…è‡ªå·±, è®©è‡ªå·±å˜å¼º.</p>
</blockquote>
<p>åœ¨èŒåœºä¸­, ä½ ä¼šé‡åˆ°å¾ˆå¤šè®©ä½ ä¸çˆ½çš„äººæˆ–è€…äº‹. è®°ä½, è¦åšåˆ° <code>å¯¹äº‹ä¸å¯¹äºº</code>, ä¸è¦å¤ªå§”å±ˆè‡ªå·±, å¤§ä¸ˆå¤«èƒ½å±ˆèƒ½ä¼¸, è¯¥å‡ºæ‰‹æ—¶å°±å‡ºæ‰‹, æ²¡æœ‰ä»€ä¹ˆå¤§ä¸äº†.</p>
<p>å¦‚æœçœŸçš„è§‰å¾—æœ‰äº›äººæˆ–è€…æœ‰äº›äº‹ä¸å€¼å¾—ä½ æµªè´¹æ—¶é—´, å°±ç¦»å®ƒä»¬è¿œç‚¹. æƒ¹ä¸èµ·ä½†å¯ä»¥èº²å¾—èµ·, ä½ è¯´å‘¢?</p>
<p>é…Œä¸€å£¶å°é…’, è€å¤«èŠå‘å°‘å¹´ç‹‚!</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æ€è€ƒ ç”Ÿæ´» åˆä¼™äºº </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è®©è‡ªå·±å˜å¼º]]></title>
      <url>/2017/03/10/%E8%AE%A9%E8%87%AA%E5%B7%B1%E5%8F%98%E5%BC%BA/</url>
      <content type="html"><![CDATA[<p>å½“ä½ è¯»åˆ°è¿™ç¯‡æ–‡ç« çš„æ—¶å€™, æˆ‘å…¶å®è¿˜ä¸çŸ¥é“ã€æ€ä¹ˆè®©è‡ªå·±å˜å¼ºã€.<br>å…·ä½“è¯´, å°±æ˜¯æ²¡æœ‰ä¸€å¥—è®©ä½ æˆ–è€…è®©ä»–å˜å¼ºçš„æ­¦æ—ç§˜ç±.</p>
<p>åªèƒ½ç»“åˆè‡ªå·±ç»å†çš„äº‹, åˆ†äº«ç»™å¤§å®¶, å¸Œæœ›èƒ½æ„ŸåŒèº«å—!</p>
<p>è¿™å‡ å¤©åŠ ç­åŠ åœ°æœ‰ç‚¹çŒ›, æµ‘ç„¶ä¸çŸ¥å‘¨æœ«è½®å›äº†.<br>å¿ƒç†æ€»æ˜¯åœ¨å¿µå¨, å¥½ä¹…æ²¡æœ‰åœ¨å…¬ä¼—å·æ¶‚é¸¦äº†, æ‰‹ç—’ç—’äº†.<br>è¶ä»Šæ™šå›æ¥æ—©(22:30å›åˆ°å®¶), å°±åŠ¨ç¬”äº†.</p>
<p>ã€è®©è‡ªå·±å˜å¼ºã€, è¿™å¥è¯è¯´ç€å¾ˆç®€å•, ä½†ä¸æ˜¯ä»»ä½•äººéƒ½èƒ½æ„è¯†åˆ°è¿™å‡ ä¸ªå­—å¸¦æ¥çš„åŠ›é‡.</p>
<p>åœ¨ã€Œæ˜æœé‚£äº›äº‹å„¿ã€ä¸­æœ‰è¿™ä¹ˆä¸€æ®µ:</p>
<blockquote>
<p>æˆ‘ä»¬ç»å¸¸ä¼šäº§ç”Ÿä¸€ä¸ªç–‘é—®ï¼Œé‚£å°±æ˜¯æ€æ ·æ‰èƒ½è·å¾—å…¶ä»–å›½å®¶åŠå…¶äººæ°‘çš„å°Šé‡ï¼Œåœ¨ä¸–ç•Œä¸Šé£å…‰è‡ªè±ªä¸€æŠŠï¼Œå…¶å®ç­”æ¡ˆå¾ˆç®€å•â€”â€”å›½å®¶å¼ºå¤§ã€‚</p>
</blockquote>
<p>çœ‹åˆ°è¿™é‡Œ, æ„Ÿè§¦é¢‡æ·±.</p>
<h2 id="åœ¨å›¢é˜Ÿä¸­æˆé•¿"><a href="#åœ¨å›¢é˜Ÿä¸­æˆé•¿" class="headerlink" title="åœ¨å›¢é˜Ÿä¸­æˆé•¿"></a>åœ¨å›¢é˜Ÿä¸­æˆé•¿</h2><p>å›¢é˜Ÿæˆé•¿çš„ä¸»è§‚æ¡ä»¶æ˜¯å›¢é˜Ÿçš„æˆå‘˜è¦æˆé•¿, ä¸ç„¶å›¢é˜Ÿå“ªé‡Œæ¥çš„æˆé•¿.</p>
<p>å¦‚æœä½ æ˜¯ä½œä¸ºä¸€ä¸ªå›¢é˜Ÿæˆ–è€…å°ç»„çš„è´Ÿè´£äºº, ä¼šé¢ä¸´å„ç§å„æ ·çš„é—®é¢˜, æ¯”å¦‚éœ€è¦è·Ÿå›¢é˜Ÿä»¥å¤–çš„éƒ¨é—¨è°ˆåˆä½œ, éœ€è¦è·Ÿè€æ¿æ±‡æŠ¥å·¥ä½œ, è¿˜è¦å¤„ç†å†…éƒ¨çš„é—®é¢˜ç­‰ç­‰è¯¸å¦‚æ­¤ç±»!</p>
<p>æˆ‘è§‰å¾—å®‰é‚¦éœ€å®‰å†…, ä¹Ÿå°±æ˜¯è¯´è¦å…ˆæå®šå›¢é˜Ÿå†…éƒ¨çš„å„ç§äº‹ç‰©, äººæ˜¯æ¯”è¾ƒå¤æ‚çš„æ„Ÿæƒ…åŠ¨ç‰©, ä½ ä¸å¥½ä¹Ÿä¸èƒ½æ§åˆ¶åˆ«äººçš„æƒ…ç»ª. æ‰€ä»¥, éœ€è¦å¯¹äº‹ä¸å¯¹äºº!ä½ ä¸èƒ½è¯´, ä½ çœ‹ä»–é•¿å¾—ä¸å¥½çœ‹, å°±çŸ¥é“å·¥ä½œåšä¸å¥½ç±»ä¼¼çš„è¯.</p>
<p>è¿™æ ·ä¸€è¯´, åŸºæœ¬ä¸¤ä¸ªäººå°±ç»“ä¸‹äº†æ¢å­.è¿Ÿæ—©ä¼šçˆ†å‘.</p>
<p>é¦–å…ˆ, è¦ç»™å›¢é˜Ÿæˆå‘˜å¸Œæœ›, è®©å¤§å®¶éƒ½è®¤è¯†åˆ°æœ‰ç»Ÿä¸€çš„ç›®æ ‡.</p>
<p>å…¶æ¬¡, è®©æ¯ä¸ªäººç»™å‡ºå·¥ä½œå’Œå®è¡Œè®¡åˆ’, åˆ¶å®šè‡ªå·±çš„è€ƒæ ¸ç›®æ ‡.å¯¹åšå‡ºçªå‡ºè´¡çŒ®çš„æˆå‘˜å¥–åŠ±, æ¯ä¸ªäººéƒ½éœ€è¦å¾—åˆ°å°Šé‡, è€Œå¥–åŠ±æ˜¯æœ€å¤§çš„å°Šé‡.</p>
<p>æœ€å, åŠ å¼ºä¸å›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„æ²Ÿé€š, äº’ç›¸å¸®åŠ©, è®©å¤§å®¶èƒ½å¤Ÿç›¸äº’ä¿¡ä»»å’Œé¼“åŠ±, è‰¯å¥½æœ‰æ•ˆçš„æ²Ÿé€š, äº‹åŠåŠŸå€.</p>
<p>ä½œä¸ºå›¢é˜Ÿè´Ÿè´£äºº, è‚¯å®šå¸Œæœ›æ‰‹ä¸‹çš„äººå„ä¸ªéªå‹‡å–„æˆ˜, ç™¾æˆ˜ç™¾èƒœ, ä½†æ˜¯ç°å®ä¸­å¾ˆéš¾åšåˆ°, å…¶å®ä¹Ÿæ²¡æœ‰å¿…è¦.<br>è¥¿æ¸¸è®°å‘Šè¯‰æˆ‘ä»¬, å”åƒ§å¸¦é¢†çš„å›¢é˜Ÿæ‰æ˜¯æœ€å¥½çš„å›¢é˜Ÿ.</p>
<h2 id="å°‘åŸ‹æ€¨å¤šç»™äºˆå¸®åŠ©"><a href="#å°‘åŸ‹æ€¨å¤šç»™äºˆå¸®åŠ©" class="headerlink" title="å°‘åŸ‹æ€¨å¤šç»™äºˆå¸®åŠ©"></a>å°‘åŸ‹æ€¨å¤šç»™äºˆå¸®åŠ©</h2><p>æ¯ä¸ªäººç”Ÿæ´»å’Œå·¥ä½œçš„ç¯å¢ƒä¸ä¸€æ ·, åœ¨ä¸åŒçš„åœ°ç‚¹ä¸åŒçš„æ—¶é—´é¢å¯¹ä¸åŒçš„äº‹æƒ…, éƒ½ä¼šæœ‰ä¸åŒçš„çœ‹æ³•.</p>
<p>ä¸–ç•Œä¸Šä»»ä½•ä¸€ç§é€‰æ‹©, éƒ½æ˜¯å‘½ä¸­æ³¨å®šçš„, æ²¡æœ‰äººèƒ½å¼ºè¿«ä½ å»åšå‡ºä»»ä½•é”™è¯¯çš„é€‰æ‹©, é™¤äº†ä½ è‡ªå·±.</p>
<p>åœ¨è‡ªå·±æ‰€å¤„çš„ç¯å¢ƒä¸­, è¦ä¹ˆä½ èƒ½æ”¹å˜ç¯å¢ƒä½¿å…¶æ¥é€‚åº”è‡ªå·±, è¦ä¹ˆå°±ç¦»å¼€è¿™ä¸ªè‡ªå·±ä¸é€‚åº”çš„ç¯å¢ƒ, ä¸è¦å»æŠ±æ€¨.</p>
<p>å”‰å£°å¹æ°”, ä¸ä»…ä»…å½±å“è‡ªå·±çš„å·¥ä½œæ•ˆç‡å’Œç”Ÿæ´»è´¨é‡, è¿˜ä¼šå½±å“åˆ°åˆ«äºº.<br>æˆå¤©åœ¨æŠ±æ€¨, è§‰å¾—è°è°éƒ½ä¸è¡Œ, è‡ªå·±æ‰æ˜¯æœ€ç‰›é€¼çš„, æ—¥è¡Œè§ä¹…, ä½ å°±æ˜¯é‚£ä¸ªå……æ»¡è´Ÿèƒ½é‡çš„äºº, å½“åˆ«äººè§‰æ‚Ÿåˆ°çš„æ—¶å€™, å°±ä¼šç¦»ä½ è€Œå», å²‚ä¸å’ç”±è‡ªå–?!æˆ‘æƒ³è¿™ä¹Ÿæ˜¯å¾®ä¿¡æœ‹å‹åœˆåªæœ‰ç‚¹èµæ²¡æœ‰éç‚¹èµçš„åŸå› å§!</p>
<p>å¦‚æœè§‰å¾—è‡ªå·±çš„åŒäº‹æˆ–è€…æœ‹å‹æœ‰æ‰€æ¬ ç¼º, å°±æƒ³åŠæ³•å»å¸®åŠ©ä»–, é¼“åŠ±ä»–, æŠŠä½ è®¤ä¸ºä¸€äº›å¥½çš„æ–¹å¼å’Œæ–¹æ³•ä¼ æˆç»™ä»–. è¯´ä¸å®šå“ªå¤©å› ä¸ºä½ çš„ä¸€å¥è¯æˆ–è€…ä¸€ä¸ªæ–¹æ³•, ä»–å°±èµ°ä¸Šäººç”Ÿå·…å³°äº†, å“ˆå“ˆ!</p>
<p>ä»ç°åœ¨å¼€å§‹, å¿˜è®°åŸ‹æ€¨, ç»™äºˆåˆ«äººæ›´å¤šçš„å¸®åŠ©å’Œé¼“åŠ±.</p>
<h2 id="åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›"><a href="#åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›" class="headerlink" title="åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›"></a>åŸ¹å…»è‡ªå·±çš„ä¸“æ³¨åŠ›</h2><p>ä¸“æ³¨åŠ›, æ˜¯ä¸€ä¸ªå¾ˆç¥å¥‡çš„ä¸œè¥¿.</p>
<p>å¦‚æœä¸€ä¸ªäººæ²¡æœ‰ä¸“æ³¨åŠ›, å¾ˆéš¾å†æœ‰æ‰€çªç ´, æ®è¯´ç‰›é¡¿æ˜¯åœ¨åšæ¢¦çš„æ—¶å€™, å‘æ˜äº†å¾ˆå¤šæŠ˜ç£¨å¹¿å¤§é’å°‘å¹´çš„ç‰›é¡¿å®šå¾‹çš„.</p>
<p>æ¯ä¸ªäººåœ¨è‡ªå·±çš„è¡Œä¸šä¸Š, å¤šå°‘éƒ½æœ‰çŸ­æ¿. æœ‰çŸ­æ¿æ˜¯æƒ…æœ‰å¯åŸçš„, ä½†æ˜¯é¦–å…ˆä½ å¾—è®¤è¯†åˆ°è‡ªå·±çš„çŸ­æ¿, ç„¶åå†æŒ‡å®šè®¡åˆ’å»çªç ´ä»–.</p>
<blockquote>
<p>è¦æƒ³è¿›æ­¥, å¿…é¡»é¢å¯¹è‡ªå·±çš„ä¸è¶³.</p>
</blockquote>
<p>æ¯”å¦‚, å·¥ä½œä¸Šéœ€è¦ä½ å­¦ä¼šæŸç§æŠ€æœ¯, å¦‚æœåœ¨æŸä¸ªæ—¶é—´ç‚¹, ä½ æ²¡æœ‰å­¦ä¼š, å¯èƒ½å°±ä¼šä¸¢æ‰é¥­ç¢—, ä½ å°±ä¼šä¸é¡¾ä¸€åˆ‡çš„å»å­¦ä¹ , ç›´åˆ°å­¦ä¼šä¼šç”¨ä¸ºæ­¢. è¿™ä¸ªè¿‡ç¨‹, ä½ å°±æ˜¯åœ¨ä¸“æ³¨è¿™ä»¶äº‹æƒ…, å›å¤´æƒ³æƒ³å’¬å’¬ç‰™, è¿˜æ˜¯å¯ä»¥åŠåˆ°çš„, æ²¡æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„.</p>
<p>æ¯å¤©ç»™è‡ªå·±ä¸€ç‚¹æ—¶é—´, ä¸“æ³¨å»åšä¸€ä»¶äº‹æƒ…, åšæŒä¸‹æ¥, ä½ ä¼šå‘ç°, å­¦ä¹ å’Œè¿›æ­¥å°±æ˜¯ feel feel å€å„¿çˆ½.</p>
<h2 id="æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯"><a href="#æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯" class="headerlink" title="æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯:"></a>æœ€ååˆ†äº«ç»™å¤§å®¶ä¸€å¥è¯:</h2><blockquote>
<p>ä¸èƒ½æ”¹å˜åˆ«äººçš„æ—¶å€™, è¯•ç€æ”¹å˜ä¸€ä¸‹è‡ªå·±æˆ–è®¸å°±èƒ½æŠŠäº‹æƒ…å˜é€šäº†.</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éšç¬” ç”Ÿæ´» åæ€ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Tomcat8 é…ç½® HTTPS]]></title>
      <url>/2017/02/15/Tomcat8-%E9%85%8D%E7%BD%AE-HTTPS/</url>
      <content type="html"><![CDATA[<p>åšå®¢ [Tomcat8 åŸŸåé…ç½®] ä»‹ç»äº†å¦‚ä½•åœ¨æœ¬åœ°é…ç½® Tomcat8 çš„åŸŸåä»¥åŠé€šè¿‡åŸŸåæ¥è®¿é—®å¯¹åº”çš„èµ„æº.</p>
<p>ä»Šå¤©ç»§ç»­è·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•é…ç½® Tomcat8 çš„ HTTPS (å•å‘è®¤è¯), æœ¬ç¯‡åšå®¢çš„ä¸»è¦å†…å®¹å¦‚ä¸‹:</p>
<blockquote>
<p>1.é…ç½® Tomcat çš„ HTTPS.<br>2.é€šè¿‡ HTTPS + ip çš„æ–¹å¼æ¥è®¿é—®èµ„æº.<br>3.é€šè¿‡ HTTPS + åŸŸå çš„æ–¹å¼æ¥è®¿é—®èµ„æº.</p>
</blockquote>
<h2 id="é…ç½®è¦æ±‚"><a href="#é…ç½®è¦æ±‚" class="headerlink" title="é…ç½®è¦æ±‚"></a>é…ç½®è¦æ±‚</h2><p>1.å®‰è£…äº† JDK, å¹¶é…ç½®äº†å…¶ç›¸å…³çš„ç¯å¢ƒå˜é‡.å¯å‚è€ƒ Mac é…ç½® JDK1.8.</p>
<p>2.å®‰è£…äº† Tomcat8, å¹¶é…ç½®äº†å…¶ç›¸å…³çš„ç¯å¢ƒå˜é‡.å¯å‚è€ƒ Mac é…ç½® Tomcat8.</p>
<h2 id="ç”Ÿæˆè¯ä¹¦"><a href="#ç”Ÿæˆè¯ä¹¦" class="headerlink" title="ç”Ÿæˆè¯ä¹¦"></a>ç”Ÿæˆè¯ä¹¦</h2><blockquote>
<p>è·å–è¯ä¹¦å¯ä»¥å»è´­ä¹°, è¿™é‡Œæ˜¯åœ¨æœ¬åœ°æœºå™¨æ­å»º, ä½¿ç”¨ JDK è‡ªå¸¦çš„å·¥å…· keytool ç”Ÿæˆå³å¯.</p>
</blockquote>
<p>æ‰“å¼€ mac ç»ˆç«¯, æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">keytool -v -genkey -alias tomcat -keyalg RSA -keystore ~/Desktop/tomcat.keystore</div></pre></td></tr></table></figure>
<p>ç´§æ¥ç€, ä¼šå‡ºç°ä¸€äº›è®©ä½ è¾“å…¥ä¿¡æ¯çš„äº¤äº’ä¿¡æ¯, ç¬¬ä¸€ä¸ªæ˜¯è®©ä½ è¾“å…¥ å¯†é’¥åº“å¯†ç (å£ä»¤), æˆ‘è¾“å…¥çš„æ˜¯ 1234567, å…¶ä»–ä¿¡æ¯å¯ä»¥ä»»æ„è¾“å…¥å†…å®¹, åœ¨æœ€åä¸€æ­¥, é—®ä½ ç”Ÿæˆçš„ å¯†é’¥å£ä»¤ å’Œ å¯†é’¥åº“çš„å£ä»¤ æ˜¯å¦ç›¸åŒ, å¦‚æœç›¸åŒå°±ç›´æ¥å›è½¦, æˆ‘è¿™é‡Œæ˜¯ç›´æ¥å›è½¦çš„, å³å¯†ç ç›¸åŒ, éƒ½æ˜¯ 1234567.</p>
<p>è¿™æ ·å°±ç”Ÿæˆäº†æ‰€è°“çš„è¯ä¹¦.</p>
<h2 id="é…ç½®-HTTPS"><a href="#é…ç½®-HTTPS" class="headerlink" title="é…ç½® HTTPS"></a>é…ç½® HTTPS</h2><blockquote>
<p>é€šè¿‡ä¿®æ”¹ server.xml æ¥é…ç½®.</p>
</blockquote>
<p>å°† tomcat.keystore æ–‡ä»¶å¤åˆ¶åˆ° Tomcat çš„ conf ç›®å½•.</p>
<p>ä¿®æ”¹ server.xml æ–‡ä»¶, å¢åŠ ä¸€ä¸ª Connector, å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;Connector port=&quot;8443&quot; protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;  </div><div class="line">           maxThreads=&quot;150&quot; SSLEnabled=&quot;true&quot; scheme=&quot;https&quot; secure=&quot;true&quot;  </div><div class="line">           clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; keystoreFile=&quot;conf/tomcat.keystore&quot; keystorePass=&quot;1234567&quot;/&gt;</div></pre></td></tr></table></figure>
<p>æ³¨æ„, keystoreFile æ˜¯è¯ä¹¦æ–‡ä»¶, keystorePass æ˜¯å¯†ç , è¿™é‡Œé…ç½®ä¸€å®šè¦æ­£ç¡®.</p>
<h2 id="é…ç½®-HTTPS-IP"><a href="#é…ç½®-HTTPS-IP" class="headerlink" title="é…ç½® HTTPS + IP"></a>é…ç½® HTTPS + IP</h2><p>é…ç½®ä¸€ä¸ªè™šæ‹Ÿä¸»æœº, ä¿®æ”¹ server.xml æ–‡ä»¶, å¢åŠ  Host:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;Host name=&quot;192.168.1.103&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</div><div class="line">    &lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</div><div class="line">    &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</div><div class="line">&lt;/Host&gt;</div></pre></td></tr></table></figure>
<p>é…ç½® name=â€192.168.1.103â€ æ˜¯ä½ æœ¬æœºçš„ ip åœ°å€.</p>
<p>è¿™ä¸ªåœ¨åšå®¢ [iOS: èŠèŠ UIWebView ç¼“å­˜] ä¸­æœ‰è¯¦ç»†çš„ä»‹ç», è¿™é‡Œä¸å†èµ˜è¿°.</p>
<p>å¯åŠ¨ Tomcat, è¿›è¡Œæµ‹è¯•.</p>
<p>è¿™é‡Œéœ€è¦åˆ° Tomcat çš„ bin ç›®å½•ä¸‹, æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo startup.sh</div></pre></td></tr></table></figure>
<p>å¯åŠ¨æˆåŠŸå, æ‰“å¼€æµè§ˆå™¨, è¾“å…¥: <a href="https://192.168.1.103:8443/test.html" target="_blank" rel="noopener">https://192.168.1.103:8443/test.html</a>, è¿™ä¸ªæ—¶å€™, ä¼šå¼¹å‡ºå¦‚ä¸‹çš„è­¦å‘Š(æç¤ºä¸å®‰å…¨):<br><img src="/upload/images/2017/02/15/1.png" alt="1"></p>
<p>ç›´æ¥ç‚¹å‡» Advanced åå†ç‚¹å‡» Proceed to 192.168.1.103:8443(unsafe) å¤„ç†å³å¯çœ‹åˆ°é¡µé¢å†…å®¹.</p>
<h2 id="é…ç½®-HTTPS-åŸŸå"><a href="#é…ç½®-HTTPS-åŸŸå" class="headerlink" title="é…ç½® HTTPS + åŸŸå"></a>é…ç½® HTTPS + åŸŸå</h2><p>ä¿®æ”¹ server.xml, å¢åŠ  Connector:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;Connector port=&quot;8443&quot; protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;  </div><div class="line">          maxThreads=&quot;150&quot; SSLEnabled=&quot;true&quot; scheme=&quot;https&quot; secure=&quot;true&quot;  </div><div class="line">          clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; keystoreFile=&quot;conf/tomcat.keystore&quot; keystorePass=&quot;1234567&quot;/&gt;</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ server.xml, å¢åŠ  Host:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;Host name=&quot;www.mark.com&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</div><div class="line">    &lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</div><div class="line">    &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</div><div class="line">&lt;/Host&gt;</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ /etc/host æ–‡ä»¶, å¢åŠ :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">127.0.0.1 www.mark.com</div></pre></td></tr></table></figure>
<p>å¯åŠ¨ Tomcat, åœ¨ bin ç›®å½•, æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shutdown.sh</div><div class="line">sudo startup.sh</div></pre></td></tr></table></figure>
<p>å¯åŠ¨æˆåŠŸå, æ‰“å¼€æµè§ˆå™¨, è¾“å…¥ <a href="https://www.mark.com:8443/test.html" target="_blank" rel="noopener">https://www.mark.com:8443/test.html</a>, å¦‚æœå¼¹å‡ºè­¦å‘Š, å¯ä»¥åƒå¦‚ä¸Šå¤„ç†æ¥æ˜¾ç¤ºé¡µé¢å†…å®¹.</p>
<p>å¦‚æœä½ è¿™é‡Œé…ç½®å¤±è´¥äº†, è¯·ä¿®æ”¹ä¸€ä¸‹ç«¯å£å·, å¦‚å°† 8443 æ”¹ä¸º 8433.<br>é‡å¯ Tomcat åœ¨è¯•ä¸€ä¸‹.</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>Apache å®˜æ–¹æ–‡æ¡£: <a href="https://tomcat.apache.org/tomcat-8.0-doc/ssl-howto.html" target="_blank" rel="noopener">ssl-howto</a></p>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Tomcat Java Apache </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Tomcat8 åŸŸåé…ç½®]]></title>
      <url>/2017/02/13/Tomcat8-%E5%9F%9F%E5%90%8D%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<p>åšå®¢ [Mac é…ç½® Tomcat8] ä»‹ç»äº†åœ¨ Mac ä¸‹å®‰è£…å’Œå¯åŠ¨ Tomcat.</p>
<p>æ¥ä¸‹æ¥ä»‹ç», å¦‚ä½•åœ¨æœ¬åœ°é…ç½® Tomcat8 çš„åŸŸå.</p>
<p>ç½‘ä¸Šæœ‰å¾ˆå¤šå…³äº Tomcat å¦‚ä½•é…ç½®å•åŸŸåæˆ–è€…å¤šåŸŸåçš„æ–‡ç« , å¾ˆå¤šéƒ½æ˜¯ç¿»è¯‘æˆ–è€…å¤åˆ¶åˆ«äººçš„, æ ¹æœ¬æ²¡æœ‰å®è·µè¿‡, å®³äººä¸æµ…!</p>
<p>ç»“åˆè‡ªå·±çš„å®è·µ, æŠŠé…ç½®çš„æ•´ä¸ªè¿‡ç¨‹åˆ†äº«ç»™å¤§å®¶, å¸Œæœ›èƒ½å¸®åˆ°ä½ .</p>
<p>ä¸‹é¢è¿›å…¥æ­£é¢˜.</p>
<h2 id="ä¿®æ”¹ç«¯å£"><a href="#ä¿®æ”¹ç«¯å£" class="headerlink" title="ä¿®æ”¹ç«¯å£"></a>ä¿®æ”¹ç«¯å£</h2><p>åœ¨ Tomcat çš„å®‰è£…(å…¶å®æ˜¯è§£å‹çš„)ç›®å½• /conf ä¸‹æœ‰ server.xml æ–‡ä»¶.</p>
<p>å°†ä¸‹é¢å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;</div><div class="line">              connectionTimeout=&quot;20000&quot;</div><div class="line">              redirectPort=&quot;8443&quot; /&gt;</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¸º:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;Connector port=&quot;80&quot; protocol=&quot;HTTP/1.1&quot;</div><div class="line">              connectionTimeout=&quot;20000&quot;</div><div class="line">              redirectPort=&quot;8443&quot; /&gt;</div></pre></td></tr></table></figure>
<h2 id="æ·»åŠ -web-é¡¹ç›®"><a href="#æ·»åŠ -web-é¡¹ç›®" class="headerlink" title="æ·»åŠ  web é¡¹ç›®"></a>æ·»åŠ  web é¡¹ç›®</h2><blockquote>
<p>è¿™ä¸€æ­¥ä¸»è¦æ˜¯ä¸ºäº†åé¢æµ‹è¯•.</p>
</blockquote>
<p>å¾ˆç®€å•, åœ¨ Tomcat çš„å®‰è£…ç›®å½• webapps ä¸‹é¢æ–°å»º test æ–‡ä»¶å¤¹, é‡Œé¢åˆ›å»ºä¸€ä¸ª html æ–‡ä»¶å³å¯.<br>è¿™é‡Œå°†å…¶å‘½åä¸º test.html.</p>
<p>test.html å†…å®¹è§åé¢çš„é™„å½•å³å¯.</p>
<h2 id="é…ç½®åŸŸå"><a href="#é…ç½®åŸŸå" class="headerlink" title="é…ç½®åŸŸå"></a>é…ç½®åŸŸå</h2><blockquote>
<p>å¢åŠ è™šæ‹Ÿä¸»æœºé…ç½®.è¿˜éœ€è¦ä¿®æ”¹ server.xml æ–‡ä»¶.</p>
</blockquote>
<p>åœ¨ server.xml æ–‡ä»¶ä¸­, åœ¨æ ‡ç­¾ <engine> å’Œ</engine> ä¹‹é—´å¢åŠ ä¸‹é¢çš„å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;Host name=&quot;www.mark.com&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</div><div class="line">    &lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</div><div class="line">    &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</div><div class="line">&lt;/Host&gt;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­, www.mark.com æ˜¯æˆ‘è‡ªå·±ä»»æ„å–çš„ä¸€ä¸ªåŸŸå, docBase=â€testâ€ æ˜¯æŒ‡å‘ä¸Šé¢æ–°å»ºçš„ test ç›®å½•.</p>
<h2 id="é…ç½®åŸŸåè§£æ"><a href="#é…ç½®åŸŸåè§£æ" class="headerlink" title="é…ç½®åŸŸåè§£æ"></a>é…ç½®åŸŸåè§£æ</h2><p>ç”±äºéƒ¨ç½²åœ¨æœ¬åœ°, éœ€è¦ä¿®æ”¹ host.</p>
<p>ä¿®æ”¹ /etc/host æ–‡ä»¶, éœ€è¦ sudo æƒé™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/host</div></pre></td></tr></table></figure>
<p>å¢åŠ å¦‚ä¸‹å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">127.0.0.1 www.mark.com</div></pre></td></tr></table></figure>
<h2 id="éªŒè¯é…ç½®"><a href="#éªŒè¯é…ç½®" class="headerlink" title="éªŒè¯é…ç½®"></a>éªŒè¯é…ç½®</h2><blockquote>
<p>è¿™ä¸€æ­¥, éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ.</p>
</blockquote>
<p>å¯åŠ¨ Tomcat, è¿™é‡Œçš„æ“ä½œæ¯”è¾ƒç‰¹æ®Š, éœ€è¦ sudo æƒé™æ¥å¯åŠ¨ Tomcat, å¦åˆ™ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">org.apache.coyote.AbstractProtocol.init Failed to initialize end point associated with ProtocolHandler [&quot;http-nio-80&quot;]</div><div class="line"> java.net.SocketException: Permission denied</div></pre></td></tr></table></figure>
<p>å› ä¸º, åªæœ‰ root ç”¨æˆ·æ‰å¯ä»¥ä½¿ç”¨ 1024 ä»¥ä¸‹çš„ç«¯å£å·.</p>
<p>æ­£ç¡®å§¿åŠ¿:</p>
<p>cd è¿›å…¥ Tomcat çš„ bin ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd ~/Tomcat/bin</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo startup.sh</div></pre></td></tr></table></figure>
<p>æˆåŠŸå, æ‰“å¼€æµè§ˆå™¨, è¾“å…¥ <a href="http://www.mark.com/test.html" target="_blank" rel="noopener">http://www.mark.com/test.html</a>, å³å¯çœ‹åˆ°é¡µé¢å†…å®¹.</p>
<h2 id="é…ç½®å¦ä¸€ä¸ªåŸŸå"><a href="#é…ç½®å¦ä¸€ä¸ªåŸŸå" class="headerlink" title="é…ç½®å¦ä¸€ä¸ªåŸŸå"></a>é…ç½®å¦ä¸€ä¸ªåŸŸå</h2><p>å¯ä»¥é…ç½®å¦å¤–çš„ä¸€ä¸ªåŸŸå, æ¯”å¦‚ www.ithome.com, å³å¤šå¢åŠ ä¸€ä¸ªè™šæ‹Ÿä¸»æœºé…ç½®.</p>
<p>åœ¨ server.xml å¢åŠ :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;Host name=&quot;www.ithome.com&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</div><div class="line">    &lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</div><div class="line">    &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</div><div class="line">&lt;/Host&gt;</div></pre></td></tr></table></figure>
<p>é…ç½® DNS, åŒç†ä¿®æ”¹ etc/host æ–‡ä»¶:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">127.0.0.1 www.ithome.com</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡º, åœ¨æµè§ˆå™¨è¾“å…¥ <a href="http://www.ithome.com/test.html" target="_blank" rel="noopener">http://www.ithome.com/test.html</a> å’Œ <a href="http://www.mark.com/test.html" target="_blank" rel="noopener">http://www.mark.com/test.html</a> æ•ˆæœæ˜¯ä¸€æ ·çš„.</p>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>test.html æ–‡ä»¶å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">&lt;p&gt;</div><div class="line">&lt;em&gt;Sample&lt;/em&gt; text&lt;/p&gt;</div><div class="line">&lt;p&gt;</div><div class="line">Now I input another line, with fancy&lt;u&gt;&lt;strong&gt;&lt;em&gt;styles&lt;/em&gt;&lt;/strong&gt;</div><div class="line">&lt;/u&gt;.&lt;/p&gt;</div><div class="line">&lt;p&gt;</div><div class="line">&lt;em&gt;Sample&lt;/em&gt; text&lt;/p&gt;</div><div class="line">&lt;p&gt;</div><div class="line">Now I input another line, with fancy &lt;u&gt;&lt;strong&gt;&lt;em&gt;styles&lt;/em&gt;&lt;/strong&gt;</div><div class="line">&lt;/u&gt;.&lt;/p&gt;</div><div class="line">&lt;p&gt;</div><div class="line">    mark.zhang is an itman.</div><div class="line">&lt;/p&gt;</div><div class="line">&lt;style&gt;</div><div class="line">.button &#123;</div><div class="line">    background-color: #4CAF50;</div><div class="line">    border: none;</div><div class="line">    color: white;</div><div class="line">    padding: 15px 32px;</div><div class="line">    text-align: center;</div><div class="line">    text-decoration: none;</div><div class="line">    display: inline-block;</div><div class="line">    font-size: 86px;</div><div class="line">    margin: 50px 200px 100px 300px;</div><div class="line">    cursor: pointer;</div><div class="line">    border-radius: 15;</div><div class="line">&#125;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;p&gt;</div><div class="line">   &lt;button type=&quot;button&quot; onclick=&quot;myFunction()&quot; class=&quot;button&quot;&gt;Try it&lt;/button&gt;</div><div class="line">&lt;/p&gt;</div><div class="line">&lt;script&gt;</div><div class="line">   function myFunction() &#123;</div><div class="line">       alert(&quot;Blog: www.veryitman.com&quot;);</div><div class="line">   &#125;;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Tomcat Java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ATS: HTTPS è®¤è¯]]></title>
      <url>/2017/02/08/ATS-HTTPS-%E8%AE%A4%E8%AF%81/</url>
      <content type="html"><![CDATA[<p>åœ¨ <a href="http://www.veryitman.com/2017/02/06/ATS-HTTP-HTTPS-%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/" target="_blank" rel="noopener">ATS: HTTP/HTTPS åè®®ä»‹ç»</a> ä¸­ä»‹ç»äº†ä¸€äº›å…³äº HTTP/HTTPS çš„æ¦‚å¿µä»¥åŠç›¸å…³çš„åŸºæœ¬çŸ¥è¯†.</p>
<p>ä»Šå¤©æ¥èŠèŠå…³äº HTTPS çš„è®¤è¯æ–¹å¼å’Œè¿‡ç¨‹.</p>
<p>è¯´ HTTPS è®¤è¯å‰, å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µ.</p>
<h2 id="å…³äºåŠ å¯†çš„å‡ ä¸ªæ¦‚å¿µ"><a href="#å…³äºåŠ å¯†çš„å‡ ä¸ªæ¦‚å¿µ" class="headerlink" title="å…³äºåŠ å¯†çš„å‡ ä¸ªæ¦‚å¿µ"></a>å…³äºåŠ å¯†çš„å‡ ä¸ªæ¦‚å¿µ</h2><h4 id="1-SSL-åè®®åŠ å¯†æ–¹å¼"><a href="#1-SSL-åè®®åŠ å¯†æ–¹å¼" class="headerlink" title="1. SSL åè®®åŠ å¯†æ–¹å¼"></a>1. SSL åè®®åŠ å¯†æ–¹å¼</h4><blockquote>
<p>SSL æ—¢ç”¨äº†å¯¹ç§°åŠ å¯†, ä¹Ÿç”¨äº†éå¯¹ç§°åŠ å¯†(å…¬é’¥åŠ å¯†).</p>
</blockquote>
<p>åœ¨å»ºç«‹ä¼ è¾“é“¾è·¯æ—¶, SSL é¦–å…ˆå¯¹å¯¹ç§°åŠ å¯†çš„å¯†é’¥ä½¿ç”¨å…¬é’¥è¿›è¡Œéå¯¹ç§°åŠ å¯†, é“¾è·¯å»ºç«‹å¥½ä¹‹åï¼ŒSSL å¯¹ä¼ è¾“å†…å®¹ä½¿ç”¨å¯¹ç§°åŠ å¯†.</p>
<p>ä¸‹é¢æ˜¯ä¸¤ç§åŠ å¯†æ–¹å¼çš„å¯¹æ¯”:</p>
<p>1.å¯¹ç§°åŠ å¯†</p>
<blockquote>
<p>å¯¹ç§°åŠ å¯†é‡‡ç”¨äº†å¯¹ç§°å¯†ç ç¼–ç æŠ€æœ¯ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ–‡ä»¶åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå³åŠ å¯†å¯†é’¥ä¹Ÿå¯ä»¥ç”¨ä½œè§£å¯†å¯†é’¥ï¼Œè¿™ç§æ–¹æ³•åœ¨å¯†ç å­¦ä¸­å«åš <code>å¯¹ç§°åŠ å¯†ç®—æ³•</code>ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•ä½¿ç”¨èµ·æ¥ç®€å•å¿«æ·ï¼Œå¯†é’¥è¾ƒçŸ­ï¼Œä¸”ç ´è¯‘å›°éš¾ï¼Œé™¤äº†æ•°æ®åŠ å¯†æ ‡å‡†ï¼ˆDESï¼‰ï¼Œå¦ä¸€ä¸ªå¯¹ç§°å¯†é’¥åŠ å¯†ç³»ç»Ÿæ˜¯å›½é™…æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆIDEAï¼‰ï¼Œå®ƒæ¯” DES çš„åŠ å¯†æ€§å¥½ï¼Œè€Œä¸”å¯¹è®¡ç®—æœºåŠŸèƒ½è¦æ±‚ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé«˜.<br>IDEA åŠ å¯†æ ‡å‡†ç”± PGPï¼ˆPretty Good Privacyï¼‰ç³»ç»Ÿä½¿ç”¨.</p>
</blockquote>
<p>è¯¥åŠ å¯†æ–¹å¼, é€Ÿåº¦å¿«, å¯åŠ å¯†å†…å®¹è¾ƒå¤§, ç”¨æ¥åŠ å¯†ä¼šè¯è¿‡ç¨‹ä¸­çš„æ¶ˆæ¯.</p>
<p>2.å…¬é’¥åŠ å¯†(éå¯¹ç§°åŠ å¯†)</p>
<blockquote>
<p>1976å¹´ï¼Œç¾å›½å­¦è€… Dime å’Œ Henman ä¸ºè§£å†³ä¿¡æ¯å…¬å¼€ä¼ é€å’Œå¯†é’¥ç®¡ç†é—®é¢˜ï¼Œæå‡ºä¸€ç§æ–°çš„å¯†é’¥äº¤æ¢åè®®ï¼Œå…è®¸åœ¨ä¸å®‰å…¨çš„åª’ä½“ä¸Šçš„é€šè®¯åŒæ–¹äº¤æ¢ä¿¡æ¯ï¼Œå®‰å…¨åœ°è¾¾æˆä¸€è‡´çš„å¯†é’¥ï¼Œè¿™å°±æ˜¯â€œå…¬å¼€å¯†é’¥ç³»ç»Ÿâ€.<br>ç›¸å¯¹äº <code>å¯¹ç§°åŠ å¯†ç®—æ³•</code> è¿™ç§æ–¹æ³•ä¹Ÿå«åš <code>éå¯¹ç§°åŠ å¯†ç®—æ³•</code>.<br>ä¸å¯¹ç§°åŠ å¯†ç®—æ³•ä¸åŒï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼šå…¬å¼€å¯†é’¥ï¼ˆpublickeyï¼‰å’Œç§æœ‰å¯†é’¥ï¼ˆprivatekeyï¼‰. å…¬å¼€å¯†é’¥ä¸ç§æœ‰å¯†é’¥æ˜¯ä¸€å¯¹ï¼Œå¦‚æœç”¨å…¬å¼€å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œåªæœ‰ç”¨å¯¹åº”çš„ç§æœ‰å¯†é’¥æ‰èƒ½è§£å¯†ï¼›å¦‚æœç”¨ç§æœ‰å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œé‚£ä¹ˆåªæœ‰ç”¨å¯¹åº”çš„å…¬å¼€å¯†é’¥æ‰èƒ½è§£å¯†.<br>å› ä¸ºåŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯†é’¥ï¼Œæ‰€ä»¥è¿™ç§ç®—æ³•å«ä½œéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚</p>
</blockquote>
<p>è¯¥åŠ å¯†æ–¹å¼, é€Ÿåº¦è¾ƒæ…¢, èƒ½æä¾›æ›´å¥½çš„èº«ä»½è®¤è¯æŠ€æœ¯, ç”¨æ¥åŠ å¯†å¯¹ç§°åŠ å¯†çš„å¯†é’¥.</p>
<h4 id="2-æ•°å­—è¯ä¹¦"><a href="#2-æ•°å­—è¯ä¹¦" class="headerlink" title="2. æ•°å­—è¯ä¹¦"></a>2. æ•°å­—è¯ä¹¦</h4><p>ä¸€ç§æ–‡ä»¶çš„åç§°ï¼Œå¥½æ¯”ä¸€ä¸ªæœºæ„æˆ–äººçš„ç­¾åï¼Œèƒ½å¤Ÿè¯æ˜è¿™ä¸ªæœºæ„æˆ–äººçš„çœŸå®æ€§. å…¶ä¸­åŒ…å«çš„ä¿¡æ¯ï¼Œç”¨äºå®ç°ä¸Šè¿°åŠŸèƒ½.</p>
<h4 id="3-åŠ å¯†å’Œè®¤è¯"><a href="#3-åŠ å¯†å’Œè®¤è¯" class="headerlink" title="3. åŠ å¯†å’Œè®¤è¯"></a>3. åŠ å¯†å’Œè®¤è¯</h4><p>åŠ å¯†æ˜¯æŒ‡é€šä¿¡åŒæ–¹ä¸ºäº†é˜²æ­¢é“­æ„Ÿä¿¡æ¯åœ¨ä¿¡é“ä¸Šè¢«ç¬¬ä¸‰æ–¹çªƒå¬è€Œæ³„æ¼ï¼Œå°†æ˜æ–‡é€šè¿‡åŠ å¯†å˜æˆå¯†æ–‡ï¼Œå¦‚æœç¬¬ä¸‰æ–¹æ— æ³•è§£å¯†çš„è¯ï¼Œå°±ç®—è·å¾—å¯†æ–‡ä¹Ÿæ— èƒ½ä¸ºåŠ›.</p>
<p>è®¤è¯æ˜¯æŒ‡é€šä¿¡åŒæ–¹ä¸ºäº†ç¡®è®¤å¯¹æ–¹æ˜¯å€¼å¾—ä¿¡ä»»çš„æ¶ˆæ¯å‘é€æˆ–æ¥å—æ–¹ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å‡èº«ä»½çš„éæ³•è€…ï¼Œé‡‡å–çš„ç¡®è®¤èº«ä»½çš„æ–¹å¼.</p>
<p>åªæœ‰åŒæ—¶è¿›è¡Œäº†åŠ å¯†å’Œè®¤è¯æ‰èƒ½ä¿è¯é€šä¿¡çš„å®‰å…¨ï¼Œå› æ­¤åœ¨ SSL é€šä¿¡åè®®ä¸­è¿™ä¸¤è€…(åŠ å¯†å’Œè®¤è¯)éƒ½è¢«ä½¿ç”¨.</p>
<p>åŠ å¯†ä¸€èˆ¬ä½¿ç”¨ <code>å¯¹ç§°åŠ å¯†ç®—æ³•</code> å’Œ <code>ä¸å¯¹ç§°åŠ å¯†ç®—æ³•</code>ï¼Œä¸å¯¹ç§°åŠ å¯†æœ€å¸¸è§çš„ç®—æ³•å°±æ˜¯ RSA.</p>
<h4 id="4-æ¶ˆæ¯æ‘˜è¦"><a href="#4-æ¶ˆæ¯æ‘˜è¦" class="headerlink" title="4. æ¶ˆæ¯æ‘˜è¦"></a>4. æ¶ˆæ¯æ‘˜è¦</h4><p>è¿™ä¸ªæŠ€æœ¯ä¸»è¦æ˜¯ä¸ºäº†é¿å…æ¶ˆæ¯è¢«ç¯¡æ”¹.</p>
<p>æ¶ˆæ¯æ‘˜è¦æ˜¯æŠŠä¸€æ®µä¿¡æ¯, é€šè¿‡æŸç§ç®—æ³•, å¾—å‡ºä¸€ä¸²å­—ç¬¦ä¸².<br>è¿™ä¸ªå­—ç¬¦ä¸²å°±æ˜¯æ¶ˆæ¯çš„æ‘˜è¦ï¼Œå¦‚æœæ¶ˆæ¯è¢«ç¯¡æ”¹(å‘ç”Ÿäº†å˜åŒ–), é‚£ä¹ˆæ‘˜è¦ä¹Ÿä¸€å®šä¼šå‘ç”Ÿå˜åŒ–(å¦‚æœ2ä¸ªä¸åŒçš„æ¶ˆæ¯ç”Ÿæˆçš„æ‘˜è¦æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆè¿™å°±å«å‘ç”Ÿäº†ç¢°æ’).</p>
<p>æ¶ˆæ¯æ‘˜è¦çš„ç®—æ³•ä¸»è¦æœ‰ MD5 å’Œ SHAï¼Œåœ¨è¯ä¹¦é¢†åŸŸï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨ SHA(å®‰å…¨å“ˆå¸Œç®—æ³•).</p>
<p>æ•°å­—è¯ä¹¦ã€åŠ å¯†å’Œè®¤è¯ã€æ¶ˆæ¯æ‘˜è¦ä¸‰ä¸ªæŠ€æœ¯ç»“åˆèµ·æ¥ï¼Œå°±æ˜¯åœ¨ HTTPS ä¸­å¹¿æ³›åº”ç”¨çš„è¯ä¹¦(certificate), è¯ä¹¦æœ¬èº«æºå¸¦äº†åŠ å¯†/è§£å¯†çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥æ ‡è¯†è‡ªå·±çš„èº«ä»½ï¼Œä¹Ÿè‡ªå¸¦æ¶ˆæ¯æ‘˜è¦.</p>
<h2 id="HTTPS-è®¤è¯æ–¹å¼"><a href="#HTTPS-è®¤è¯æ–¹å¼" class="headerlink" title="HTTPS è®¤è¯æ–¹å¼"></a>HTTPS è®¤è¯æ–¹å¼</h2><p>åˆ†ä¸ºå•å‘å’ŒåŒå‘è®¤è¯.</p>
<h3 id="å•å‘è®¤è¯"><a href="#å•å‘è®¤è¯" class="headerlink" title="å•å‘è®¤è¯"></a>å•å‘è®¤è¯</h3><blockquote>
<p>å•å‘è®¤è¯è¾ƒç®€å•, åªéœ€è¦æœåŠ¡ç«¯æ ¡éªŒæœåŠ¡ç«¯çš„è¯ä¹¦çš„åˆæ³•æ€§.</p>
</blockquote>
<p>è¯¥è®¤è¯è¿‡ç¨‹ä½¿ç”¨ä¸‹é¢çš„æµç¨‹å›¾æ¥è¡¨ç¤º:<br><img src="/upload/images/2017/02/08/HTTPS_Single.png" alt="1"></p>
<h3 id="åŒå‘è®¤è¯"><a href="#åŒå‘è®¤è¯" class="headerlink" title="åŒå‘è®¤è¯"></a>åŒå‘è®¤è¯</h3><p>åŒå‘è®¤è¯å’Œå•å‘è®¤è¯åŸç†åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯éœ€è¦åŒæ–¹éƒ½æ ¡éªŒå¯¹æ–¹çš„è¯ä¹¦çš„åˆæ³•æ€§.</p>
<p>è¯¥è®¤è¯è¿‡ç¨‹ä½¿ç”¨ä¸‹é¢çš„æµç¨‹å›¾æ¥è¡¨ç¤º:<br><img src="/upload/images/2017/02/08/HTTPS_Double.png" alt="1"></p>
<h3 id="éšæœºæ•°çš„äº§ç”Ÿ"><a href="#éšæœºæ•°çš„äº§ç”Ÿ" class="headerlink" title="éšæœºæ•°çš„äº§ç”Ÿ"></a>éšæœºæ•°çš„äº§ç”Ÿ</h3><p>ä¸ç®¡æ˜¯å•å‘è®¤è¯, è¿˜æ˜¯åŒå‘è®¤è¯, éƒ½æœ‰éšæœºæ•°çš„äº§ç”Ÿå’Œå‘é€.</p>
<p>ä¸‹å›¾æ˜¯éšæœºæ•°çš„äº§ç”Ÿæµç¨‹å›¾:<br><img src="/upload/images/2017/02/08/HTTPS_Random.png" alt="1"></p>
<p>ç”Ÿæˆå¯¹è¯å¯†é’¥, ä¸€å…±éœ€è¦ä¸‰ä¸ªéšæœºæ•°.</p>
<h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><strong>æ¨èåœ¨çº¿æµç¨‹å›¾å·¥å…·</strong>:</p>
<p><a href="http://www.veryitman.com/2017/02/08/www.processon.com" target="_blank" rel="noopener">ProcessOn</a>.</p>
<p><strong>æ¨èåšæ–‡</strong>:</p>
<p>1.<a href="http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html" target="_blank" rel="noopener">å›¾è§£SSL/TLSåè®®</a></p>
<p>2.<a href="http://www.ruanyifeng.com/blog/2011/02/seven_myths_about_https.html" target="_blank" rel="noopener">HTTPSçš„ä¸ƒä¸ªè¯¯è§£(è¯‘æ–‡)</a></p>
<p>3.<a href="http://blog.sina.com.cn/s/blog_56d8ea900100bzpr.html" target="_blank" rel="noopener">å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ä»‹ç»å’ŒåŒºåˆ«</a></p>
<p>æœ¬æ–‡ä¸­å‚è€ƒäº†ä¸Šé¢æ–‡ç« çš„éƒ¨åˆ†å†…å®¹, æ„Ÿè°¢è¿™äº›ä½œè€….</p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTTP HTTPS TLS SSL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ATS: HTTP/HTTPS åè®®ä»‹ç»]]></title>
      <url>/2017/02/06/ATS-HTTP-HTTPS-%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/</url>
      <content type="html"><![CDATA[<p>è‹¹æœåœ¨2017å¹´è¦æ±‚ App å¿…é¡»æ”¯æŒ HTTPS, ä¸è¿‡, è¿™ä¸ªè¦æ±‚, æœ€ååˆè¢«è‹¹æœè‡ªå·±å»¶æœŸäº†.</p>
<p>æˆ‘åªèƒ½è¯´, è‹¹æœçš„å¼€å‘å“¥å“¥ä»¬çœŸä¼šç©â€¦</p>
<p>è¯¥ç³»åˆ—åšå®¢ä»‹ç» iOS ä¸Šé¢çš„ ATS ä»¥åŠç›¸å…³çš„ HTTPS çŸ¥è¯†, åˆ†ä¸ºä¸‰ç¯‡æ¥åˆ†äº«.</p>
<p>æœ¬ç¯‡æ˜¯ç¬¬ä¸€ç¯‡.</p>
<p>ç¬¬äºŒç¯‡: <a href="http://www.veryitman.com/2017/02/08/ATS-HTTPS-%E8%AE%A4%E8%AF%81/" target="_blank" rel="noopener">ATS: HTTPS è®¤è¯</a></p>
<p>ä»Šå¤©å…ˆç®€å•äº†è§£ä¸€ä¸‹ HTTPS ä»¥åŠç›¸å…³çš„çŸ¥è¯†.</p>
<h2 id="ç›¸å…³åè¯"><a href="#ç›¸å…³åè¯" class="headerlink" title="ç›¸å…³åè¯"></a>ç›¸å…³åè¯</h2><p>å…ˆäº†è§£ä¸€ä¸‹ç›¸å…³çš„å¸¸ç”¨åè¯.</p>
<h4 id="1-HTTP"><a href="#1-HTTP" class="headerlink" title="1.HTTP"></a>1.HTTP</h4><p>HyperText Transfer Protocol, è¶…æ–‡æœ¬ä¼ è¾“åè®®.</p>
<h4 id="2-HTTPS"><a href="#2-HTTPS" class="headerlink" title="2.HTTPS"></a>2.HTTPS</h4><p>Hyper Text Transfer Protocol over Secure Socket Layer, å®‰å…¨çš„è¶…æ–‡æœ¬ä¼ è¾“åè®®.</p>
<h4 id="3-SSL"><a href="#3-SSL" class="headerlink" title="3.SSL"></a>3.SSL</h4><p>Secure Socket Layer, å®‰å…¨å¥—æ¥å­—å±‚.</p>
<h4 id="4-TLS"><a href="#4-TLS" class="headerlink" title="4.TLS"></a>4.TLS</h4><p>Transport Layer Security, ä¼ è¾“å±‚å®‰å…¨.å…¶å‰èº«å°±æ˜¯ SSL.</p>
<h4 id="5-ATS"><a href="#5-ATS" class="headerlink" title="5.ATS"></a>5.ATS</h4><p>App Transport Security, åº”ç”¨ä¼ è¾“å®‰å…¨.</p>
<h2 id="åè®®ä»‹ç»"><a href="#åè®®ä»‹ç»" class="headerlink" title="åè®®ä»‹ç»"></a>åè®®ä»‹ç»</h2><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><p>HyperText Transfer Protocol, è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œæ˜¯äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿æ³›çš„ä¸€ç§åè®®ï¼Œæ‰€æœ‰ WWW æ–‡ä»¶å¿…é¡»éµå¾ªçš„æ ‡å‡†.</p>
<p>HTTP åè®®ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„, ä¹Ÿå°±æ˜¯æ˜æ–‡çš„, å› æ­¤ä½¿ç”¨ HTTP åè®®ä¼ è¾“éšç§ä¿¡æ¯éå¸¸ä¸å®‰å…¨.</p>
<p>é»˜è®¤ä½¿ç”¨ TCP ç«¯å£ä¸º 80.</p>
<h3 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h3><p>å®‰å…¨çš„è¶…æ–‡æœ¬ä¼ è¾“åè®®, <code>Hyper Text Transfer Protocol over Secure Socket Layer</code>, ç½‘æ™¯å…¬å¼è®¾è®¡äº† SSL(Secure Socket Layer) åè®®ç”¨äºå¯¹ HTTP åè®®ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä¿è¯ä¼šè¯è¿‡ç¨‹ä¸­çš„å®‰å…¨æ€§.</p>
<p>é»˜è®¤ä½¿ç”¨ TCP ç«¯å£ä¸º 443.</p>
<h3 id="æ‹†åˆ†-HTTPS"><a href="#æ‹†åˆ†-HTTPS" class="headerlink" title="æ‹†åˆ† HTTPS"></a>æ‹†åˆ† HTTPS</h3><h4 id="SSL-åè®®åŠ å¯†æ–¹å¼"><a href="#SSL-åè®®åŠ å¯†æ–¹å¼" class="headerlink" title="SSL åè®®åŠ å¯†æ–¹å¼"></a>SSL åè®®åŠ å¯†æ–¹å¼</h4><p>SSL åè®®å³ç”¨åˆ°äº†å¯¹ç§°åŠ å¯†ä¹Ÿç”¨åˆ°äº†éå¯¹ç§°åŠ å¯†(å…¬é’¥åŠ å¯†)ï¼Œåœ¨å»ºç«‹ä¼ è¾“é“¾è·¯æ—¶ï¼ŒSSL é¦–å…ˆå¯¹å¯¹ç§°åŠ å¯†çš„å¯†é’¥ä½¿ç”¨å…¬é’¥è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œé“¾è·¯å»ºç«‹å¥½ä¹‹åï¼ŒSSL å¯¹ä¼ è¾“å†…å®¹ä½¿ç”¨å¯¹ç§°åŠ å¯†.</p>
<blockquote>
<p>1.å¯¹ç§°åŠ å¯†<br>é€Ÿåº¦é«˜ï¼Œå¯åŠ å¯†å†…å®¹è¾ƒå¤§ï¼Œç”¨æ¥åŠ å¯†ä¼šè¯è¿‡ç¨‹ä¸­çš„æ¶ˆæ¯.</p>
<p>2.å…¬é’¥åŠ å¯†<br>åŠ å¯†é€Ÿåº¦è¾ƒæ…¢ï¼Œä½†èƒ½æä¾›æ›´å¥½çš„èº«ä»½è®¤è¯æŠ€æœ¯ï¼Œç”¨æ¥åŠ å¯†å¯¹ç§°åŠ å¯†çš„å¯†é’¥.</p>
</blockquote>
<h4 id="HTTP-SSL"><a href="#HTTP-SSL" class="headerlink" title="HTTP+SSL"></a>HTTP+SSL</h4><p>HTTPS, å¯ä»¥çœ‹åšæ˜¯ HTTP+SSL, æ‰€ä»¥é‡ç‚¹åœ¨ SSL ä¸Šé¢.</p>
<h4 id="HTTPS-1"><a href="#HTTPS-1" class="headerlink" title="HTTPS"></a>HTTPS</h4><p>åœ¨ HTTP (è¶…æ–‡æœ¬ä¼ è¾“åè®®)åŸºç¡€ä¸Šæå‡ºçš„ä¸€ç§å®‰å…¨çš„ HTTP åè®®ï¼Œå› æ­¤å¯ä»¥ç§°ä¸ºå®‰å…¨çš„è¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚</p>
<p>HTTP åè®®ç›´æ¥æ”¾ç½®åœ¨ TCP åè®®ä¹‹ä¸Šï¼Œè€Œ HTTPS æå‡ºåœ¨ HTTP å’Œ TCP ä¸­é—´åŠ ä¸Šä¸€å±‚åŠ å¯†å±‚.</p>
<p>ä»å‘é€ç«¯çœ‹ï¼Œè¿™ä¸€å±‚è´Ÿè´£æŠŠ HTTP çš„å†…å®¹åŠ å¯†åé€åˆ°ä¸‹å±‚çš„ TCPï¼Œä»æ¥æ”¶æ–¹çœ‹ï¼Œè¿™ä¸€å±‚è´Ÿè´£å°† TCP é€æ¥çš„æ•°æ®è§£å¯†è¿˜åŸæˆ HTTP çš„å†…å®¹.</p>
<h4 id="SSL-Secure-Socket-Layer"><a href="#SSL-Secure-Socket-Layer" class="headerlink" title="SSL(Secure Socket Layer)"></a>SSL(Secure Socket Layer)</h4><p>æ˜¯ Netscape å…¬å¸è®¾è®¡çš„ä¸»è¦ç”¨äº WEB çš„å®‰å…¨ä¼ è¾“åè®®.<br>å®ƒåœ¨ HTTPS åè®®æ ˆä¸­è´Ÿè´£å®ç°ä¸Šé¢æåˆ°çš„åŠ å¯†å±‚.</p>
<p>ä¸€ä¸ª HTTPS åè®®æ ˆå¤§è‡´æ˜¯è¿™æ ·çš„ï¼š<br><img src="/upload/images/2017/02/06/HTTP+SSL.png" alt="1"></p>
<h4 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h4><p>HTTPSï¼Œä¹Ÿç§°ä½œ HTTP over TLS.</p>
<p>TLS(ä¼ è¾“å±‚å®‰å…¨, Transport Layer Security) çš„å‰èº«æ˜¯ SSLï¼ŒTLS 1.0 é€šå¸¸è¢«æ ‡ç¤ºä¸º SSL 3.1ï¼ŒTLS 1.1 ä¸º SSL 3.2ï¼ŒTLS 1.2 ä¸º SSL 3.3.</p>
<blockquote>
<p>è‹¹æœ ATS(App Transport Security), è¦æ±‚æ”¯æŒ HTTPS çš„ TLS ç‰ˆæœ¬æœ€ä½ä¸º V1.2.</p>
</blockquote>
<p>ä¸‹å›¾æè¿°äº†åœ¨ TCP/IP åè®®æ ˆä¸­ TLS(å„å­åè®®ï¼‰å’Œ HTTP çš„å…³ç³»:<br><img src="/upload/images/2017/02/06/tcp-ip-model.png" alt="1"></p>
<p>å…¶ä¸­ Handshake protocolï¼ŒChange Ciper Spec protocol å’Œ Alert protocol ç»„æˆäº† SSL Handshaking Protocols.</p>
<p>SSL å’Œ TLS çš„å‘å±•å†å²:</p>
<blockquote>
<p>1994å¹´ï¼ŒNetScape å…¬å¸è®¾è®¡äº† SSL åè®®ï¼ˆSecure Sockets Layerï¼‰çš„ 1.0 ç‰ˆï¼Œä½†æ˜¯æœªå‘å¸ƒ.</p>
<p>1995å¹´ï¼ŒNetScape å…¬å¸å‘å¸ƒ SSL 2.0 ç‰ˆï¼Œå¾ˆå¿«å‘ç°æœ‰ä¸¥é‡æ¼æ´.</p>
<p>1996å¹´ï¼ŒSSL 3.0 ç‰ˆé—®ä¸–ï¼Œå¾—åˆ°å¤§è§„æ¨¡åº”ç”¨.</p>
<p>1999å¹´ï¼Œäº’è”ç½‘æ ‡å‡†åŒ–ç»„ç»‡ ISOC æ¥æ›¿ NetScape å…¬å¸ï¼Œå‘å¸ƒäº† SSL çš„å‡çº§ç‰ˆ TLS 1.0 ç‰ˆ.</p>
<p>2006å¹´å’Œ2008å¹´ï¼ŒTLS è¿›è¡Œäº†ä¸¤æ¬¡å‡çº§ï¼Œåˆ†åˆ«ä¸º TLS 1.1 ç‰ˆå’Œ TLS 1.2 ç‰ˆ.æœ€æ–°çš„å˜åŠ¨æ˜¯2011å¹´ TLS 1.2 çš„ä¿®è®¢ç‰ˆ.</p>
<p>TLS 1.3 æ”¹åŠ¨ä¼šæ¯”è¾ƒå¤§ï¼Œç›®å‰è¿˜åœ¨è‰æ¡ˆé˜¶æ®µ.</p>
</blockquote>
<h2 id="HTTP-å’Œ-HTTPS-åŒºåˆ«"><a href="#HTTP-å’Œ-HTTPS-åŒºåˆ«" class="headerlink" title="HTTP å’Œ HTTPS åŒºåˆ«"></a>HTTP å’Œ HTTPS åŒºåˆ«</h2><p>HTTPS å’Œ HTTP çš„åŒºåˆ«ä¸»è¦ä¸ºä»¥ä¸‹å››ç‚¹:</p>
<blockquote>
<ol>
<li><p>HTTPS åè®®éœ€è¦åˆ° CA ç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦å¾ˆå°‘ï¼Œéœ€è¦äº¤è´¹.</p>
</li>
<li><p>HTTP æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¿¡æ¯æ˜¯æ˜æ–‡ä¼ è¾“ï¼ŒHTTPS åˆ™æ˜¯å…·æœ‰å®‰å…¨æ€§çš„ SLL/TLS åŠ å¯†ä¼ è¾“åè®®(éå¯¹ç§°åŠ å¯†).</p>
</li>
<li><p>HTTP å’Œ HTTPS ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443.</p>
</li>
<li><p>HTTP çš„è¿æ¥å¾ˆç®€å•ï¼Œæ˜¯æ— çŠ¶æ€çš„ï¼›<br>HTTPS åè®®æ˜¯ç”± SSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®å®‰å…¨.</p>
</li>
</ol>
</blockquote>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ATS HTTP HTTPS SSL TLS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RN: Yarn]]></title>
      <url>/2017/02/05/RN-Yarn/</url>
      <content type="html"><![CDATA[<p>React Native æ­£å¼ç‰ˆå·²ç»æ›´æ–°åˆ° 0.41.1 äº†.</p>
<p>æœ€è¿‘ä½¿ç”¨ <code>react-native-cli</code> æ¥åˆ›å»º React Native å·¥ç¨‹, æç¤ºå¦‚ä¸‹ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">This will walk you through creating a new React Native project in /Users/mark/workspace/mzProjs/ReactNative/LatestRN</div><div class="line">Installing react-native...</div><div class="line">Consider installing yarn to make this faster: https://yarnpkg.com</div></pre></td></tr></table></figure>
<p>å…¶å® Yarn ä¹Ÿä¸€ç›´åœ¨æ›´æ–°, æœ€æ–°ç‰ˆæœ¬ v0.20.0.</p>
<p>å®˜ç½‘å¯¹åº”çš„æœ‰ä¸­æ–‡ç‰ˆæœ¬å’Œä¸­æ–‡æ–‡æ¡£, å¯ä»¥ <a href="http://yarnpkg.top/" target="_blank" rel="noopener">ç‚¹æ­¤è¿›å…¥</a>.</p>
<h2 id="Yarn-ç®€ä»‹"><a href="#Yarn-ç®€ä»‹" class="headerlink" title="Yarn ç®€ä»‹"></a>Yarn ç®€ä»‹</h2><p>ä¸€å¥è¯ä»‹ç»:</p>
<blockquote>
<p>A new package manager for JavaScript</p>
</blockquote>
<p>Yarn æ˜¯ä¸€ä¸ªä¾èµ–ç®¡ç†å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿç®¡ç†ä½ çš„ä»£ç ï¼Œå¹¶ä¸å…¨ä¸–ç•Œçš„å¼€å‘è€…åˆ†äº«ä½ çš„ä»£ç .</p>
<p>Yarn æ˜¯é«˜æ•ˆã€å®‰å…¨å’Œå¯é .</p>
<blockquote>
<p>1.é«˜æ•ˆ: ä½¿ç”¨äº†ç¼“å­˜, å¯ä»¥å¾ˆå¿«çš„è·å–å·²ç» download çš„åŒ….<br>2.å®‰å…¨: åœ¨ä»£ç è¢«æ‰§è¡Œä¹‹å‰ï¼Œä¼šä½¿ç”¨CheckSumç®—æ³•éªŒè¯æ¯ä¸€ä¸ªä¾èµ–åŒ…çš„å®Œæ•´æ€§.<br>3.å¯é : åœ¨ä¸åŒå¹³å°(windows/mac/linux)åªè¦æ˜¯åŒä¸€ä»½é…ç½®æ–‡ä»¶, æ‰§è¡Œç»“æœæ˜¯ä¸€æ ·çš„.</p>
</blockquote>
<p>è¿˜æœ‰å¾ˆå¤šç‰¹æ€§:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Offline Mode</div><div class="line">If you&apos;ve installed a package before, you can install it again without any internet connection.</div><div class="line">Deterministic</div><div class="line">The same dependencies will be installed the same exact way across every machine regardless of install order.</div><div class="line">Network Performance</div><div class="line">Yarn efficiently queues up requests and avoids request waterfalls in order to maximize network utilization.</div><div class="line">Same Packages</div><div class="line">Install any package from npm and keep your package workflow the same.</div><div class="line">Network Resilience</div><div class="line">A single request failing won&apos;t cause an install to fail. Requests are retried upon failure.</div><div class="line">Flat Mode</div><div class="line">Resolve mismatching versions of dependencies to a single version to avoid creating duplicates.</div></pre></td></tr></table></figure>
<p>Yarn èƒ½å¤Ÿè®©ä½ ä½¿ç”¨å…¶ä»–å¼€å‘è€…å¼€å‘çš„ä»£ç ï¼Œè®©ä½ æ›´å®¹æ˜“çš„å¼€å‘è½¯ä»¶.</p>
<p>ä»£ç æ˜¯é€šè¿‡ä¾èµ–åŒ… (æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºç»„ä»¶). åœ¨æ¯ä¸€ä¸ªä¾èµ–ä¸­ä¼šå®šä¹‰ä¸€ä¸ª package.json æ–‡ä»¶ï¼Œç”¨æ¥æè¿°è¿™ä¸ªä¾èµ–åŒ…ä¸­æ‰€æœ‰è¦è¢«åˆ†äº«çš„ä»£ç .</p>
<p>Yarn æ˜¯å¼€æºçš„, ç‚¹å‡» <a href="http://yarnpkg.top/" target="_blank" rel="noopener">Github</a> äº†è§£æ›´å¤š.</p>
<p>å¯¹æ¯” npm å’Œ yarn, å¯ä»¥é˜…è¯»æ–‡ç« :<br><a href="https://www.sitepoint.com/yarn-vs-npm/" target="_blank" rel="noopener">Yarn vs npm: Everything You Need to Know</a></p>
<p>ä¸­æ–‡ç‰ˆ:<br><a href="https://gold.xitu.io/entry/580de578bf22ec0058330692" target="_blank" rel="noopener">è¯‘ Yarn vs npm: ä½ éœ€è¦çŸ¥é“çš„ä¸€åˆ‡</a></p>
<h2 id="å®‰è£…-Yarn"><a href="#å®‰è£…-Yarn" class="headerlink" title="å®‰è£… Yarn"></a>å®‰è£… Yarn</h2><p>å…·ä½“å®‰è£…çš„æ•™ç¨‹, å¯ä»¥å‚è€ƒå®˜ç½‘çš„ <a href="http://yarnpkg.top/Installation.html" target="_blank" rel="noopener">å®‰è£…æ•™ç¨‹</a>.</p>
<p>åœ¨ MacOS ä¸Šé¢ä½¿ç”¨ Homebrew å®‰è£…å¾ˆæ–¹ä¾¿, ä¸¤ä¸ªå‘½ä»¤å³å¯å®Œæˆ.</p>
<p>ä¸‹é¢å…·ä½“è¯´è¯´æ“ä½œæ­¥éª¤.</p>
<p>å¼ºçƒˆå¼€å‘åŒäº‹è´­ä¹°ä¸€ä¸ª VPN, è¿™ä¸ªå¹´å¤´æ²¡æœ‰ VPN, æ—¥å­ä¸å¥½è¿‡.</p>
<p>1.æ›´æ–° brew</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew update --verbose</div></pre></td></tr></table></figure>
<p>æœ€ååŠ ä¸Šå‚æ•° <code>--verbose</code>, ä¸ç„¶ç­‰å¾…çš„è¿‡ç¨‹å¾ˆç…ç†¬, æ²¡æœ‰ä»»ä½•æç¤ºä¿¡æ¯.</p>
<p>2.å®‰è£… yarn</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install yarn</div></pre></td></tr></table></figure>
<p>åœ¨å®‰è£…è¿‡ç¨‹ä¸­, å¦‚æœæç¤ºå¦‚ä¸‹ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Please note by default only English locale support is provided. If you need</div><div class="line">full locale support you should either rebuild with full icu:</div><div class="line">  `brew reinstall node --with-full-icu`</div><div class="line">or add full icu data at runtime following:</div><div class="line">  https://github.com/nodejs/node/wiki/Intl#using-and-customizing-the-small-icu-build</div></pre></td></tr></table></figure>
<p>å¯ä»¥é‡æ–°å®‰è£…å·²ç»å®‰è£…çš„ node, æ‰§è¡Œå‘½ä»¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew reinstall node --with-full-icu</div></pre></td></tr></table></figure>
<p>åœ¨æ‰§è¡Œä¸Šé¢å®‰è£…å‘½ä»¤çš„æ—¶å€™, å¦‚æœå¡ä½ä¸åŠ¨æˆ–è€…å¾ˆä¹…, Ctrl+C ç»ˆæ­¢å½“å‰çš„æ“ä½œ, é‡æ–°æ“ä½œä¸€éå³å¯.</p>
<p>å®‰è£…æˆåŠŸå, å¯ä»¥æŸ¥çœ‹å®‰è£…çš„ç‰ˆæœ¬ä¿¡æ¯, æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn --verbose</div></pre></td></tr></table></figure>
<p>ä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">yarn install v0.20.0</div><div class="line">verbose Performing &quot;GET&quot; request to &quot;https://yarnpkg.com/latest-version&quot;.</div><div class="line">[1/4] ğŸ”  Resolving packages...</div><div class="line">success Already up-to-date.</div><div class="line">âœ¨  Done in 0.29s.</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ brew å®‰è£… Yarn å, ä¸éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡.</p>
<h2 id="Yarn-ä¸-React-Native"><a href="#Yarn-ä¸-React-Native" class="headerlink" title="Yarn ä¸ React Native"></a>Yarn ä¸ React Native</h2><p>åœ¨ <code>React Native 0.37</code> ç‰ˆæœ¬ä¸­å·²ç»åŠ å…¥äº†å¯¹ Yarn çš„æ”¯æŒ.</p>
<p>å¯ä»¥åœ¨ React Native çš„å®˜æ–¹çš„è¿™ç¯‡ <a href="https://facebook.github.io/react-native/blog/2016/11/08/introducing-button-yarn-and-a-public-roadmap.html" target="_blank" rel="noopener">Blog</a> æ‰¾åˆ°æ›´å¤šä¿¡æ¯.</p>
<p>ç”¨ Yarn åˆ›å»º React Native å·¥ç¨‹</p>
<p>æ—¢ç„¶ RN å·²ç»æ”¯æŒäº† Yarn, é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ Yarn æ¥ç®¡ç†å’Œåˆ›å»º RN å·¥ç¨‹äº†.</p>
<p>ä½¿ç”¨ Yarn, å¿…é¡»æ»¡è¶³å‡ ä¸ªæ¡ä»¶:</p>
<blockquote>
<p>1.react-native-cli çš„ç‰ˆæœ¬ä¸èƒ½å°äº 1.2.0 ç‰ˆæœ¬.<br>2.React Natvie å¿…é¡»æ˜¯ 0.37 åŠä»¥ä¸Šçš„ç‰ˆæœ¬.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native init MZLatestRN</div></pre></td></tr></table></figure>
<p>å½“ä½ å®‰è£…å¥½ Yarn å, æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤å¯ä»¥å‡ºç°æç¤ºä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">This will walk you through creating a new React Native project in ~/workspace/Projs/ReactNative/MZLatestRN</div><div class="line">Using yarn v0.20.0</div><div class="line">Installing react-native...</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡º, RN ä¼šä½¿ç”¨ Yarn æ¥åˆ›å»ºå·¥ç¨‹.</p>
<p>å…¶ä¸­, <code>~/workspace/Projs/ReactNative</code> æ˜¯æˆ‘æœ¬åœ°çš„å·¥ä½œç›®å½•. <code>MZLatestRN</code> æ˜¯è¦åˆ›å»ºçš„ RN å·¥ç¨‹åç§°.</p>
<p>å¦‚æœä½ çš„ç½‘ç»œå¥½çš„è¯, å¤§æ¦‚1åˆ†é’Ÿå°±å¯ä»¥åˆ›å»ºæˆåŠŸ.</p>
<p>å·¥ç¨‹ç›®å½•:<br><img src="/upload/images/2017/02/05/1.png" alt="1"></p>
<p>å¯ä»¥çœ‹å‡ºå¤šäº† <code>yarn.lock</code> æ–‡ä»¶.</p>
<p>Yarn è¿˜åœ¨èŒå£®æˆé•¿, å¸Œæœ›å®ƒè¶Šæ¥è¶Šå¥½, æ›´å¤šçš„ä½¿ç”¨å’Œå·¥ä½œåŸç†å¯ä»¥å‚è€ƒ <a href="https://yarnpkg.com/docs" target="_blank" rel="noopener">å®˜æ–¹ Doc</a>, ä»‹ç»çš„å¾ˆè¯¦ç»†.</p>
]]></content>
      
        <categories>
            
            <category> ReactNative </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ReactNative iOS Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å®‰è£… PHP é‡åˆ°çš„é—®é¢˜]]></title>
      <url>/2017/02/02/%E5%AE%89%E8%A3%85-PHP-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åœ¨åšå®¢ <a href="http://www.veryitman.com/2017/02/02/PHP-%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" target="_blank" rel="noopener">PHP å¼€å‘å‡†å¤‡</a> ä»‹ç»äº†å®‰è£…å¹¶éƒ¨ç½² PHP ç¨‹åºåˆ° Nginx.</p>
<p>ä»Šå¤©åˆ†äº«åœ¨å®‰è£…ä¸­é‡åˆ°çš„é—®é¢˜å’Œå…¶ä»–å·¥å…·çš„å®‰è£…, ä»¥åŠå¸¸ç”¨çš„æ“ä½œ, åŒ…æ‹¬ MySQL, Nginx ç­‰.</p>
<h2 id="pecl-å®‰è£…"><a href="#pecl-å®‰è£…" class="headerlink" title="pecl å®‰è£…"></a>pecl å®‰è£…</h2><blockquote>
<p>PEAR æ˜¯ PHP æ‰©å±•ä¸åº”ç”¨åº“(PHP Extension and Application Repository) çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸€ä¸ª PHP æ‰©å±•åŠåº”ç”¨çš„ä¸€ä¸ªä»£ç ä»“åº“ï¼Œç®€å•åœ°è¯´ï¼ŒPEAR å°±æ˜¯ PHP çš„ CPAN.</p>
<p>PECL (PHP Extension Community Library)ï¼ŒPHP çš„æ‰©å±•åº“ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—å·²çŸ¥çš„æ‰©å±•åº“ï¼Œç”± C++ ç­‰å…¶ä»–è¯­è¨€ç¼–å†™è€Œæˆï¼Œä»¥ .so å½¢å¼å‡ºç°ï¼Œ.so ä¸ºå…±äº«åº“, æ˜¯ shared object, ç”¨äºåŠ¨æ€è¿æ¥çš„, å’Œ dll å·®ä¸å¤šï¼Œä¸ºæ¯” PEAR æ›´å¿«ï¼Œä½†æ˜¯ä¸ PEAR ä¸åŒçš„æ˜¯ï¼ŒPECL éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé…ç½®å¹¶è¢«æ³¨å†Œåˆ°ä¸»æœºä¸­.</p>
<p>æœ€ç›´æ¥çš„è¡¨è¿°: PEAR æ˜¯ PHP çš„ä¸Šå±‚æ‰©å±•ï¼ŒPECL æ˜¯ PHP çš„åº•å±‚æ‰©å±•.</p>
</blockquote>
<p>ä¸‹é¢è¯´å¦‚ä½•å®‰è£… pecl å’Œ pear.</p>
<p>1.ä¸‹è½½ pear</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -O http://pear.php.net/go-pear.phar</div></pre></td></tr></table></figure>
<p>2.å®‰è£… pear</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo php -d detect_unicode=0 go-pear.phar</div></pre></td></tr></table></figure>
<p>3.æ‰§è¡Œä»¥ä¸Šå‘½ä»¤åä¼šè¿›è¡Œå®‰è£…è¿‡ç¨‹ï¼Œä¼šæœ‰ä¸€äº›é…ç½®é€‰é¡¹</p>
<p>è¾“å…¥1ï¼Œå›è½¦ï¼Œé…ç½® pear è·¯å¾„ä¸ºï¼š<code>/usr/local/pear</code><br>è¾“å…¥4ï¼Œå›è½¦ï¼Œé…ç½®å‘½ä»¤è·¯å¾„ä¸ºï¼š<code>/usr/local/bin</code></p>
<p>4.å›è½¦ä¸¤æ¬¡ï¼Œå…¶ä»–è®©å…¶é»˜è®¤ï¼Œå®‰è£…å®Œæˆ.</p>
<p>5.å¯ä»¥é€šè¿‡å‘½ä»¤æ£€æŸ¥ pear æ˜¯å¦å®‰è£…æˆåŠŸ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pear version</div></pre></td></tr></table></figure>
<p>æˆ–è€…æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pecl version</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">PEAR Version: 1.10.1</div><div class="line">PHP Version: 5.6.27</div><div class="line">Zend Engine Version: 2.6.0</div></pre></td></tr></table></figure>
<h2 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h2><h4 id="MySQL-æ“ä½œ"><a href="#MySQL-æ“ä½œ" class="headerlink" title="MySQL æ“ä½œ"></a>MySQL æ“ä½œ</h4><p>åŸºæœ¬æ“ä½œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mysql.server start #å¯åŠ¨</div><div class="line">mysql.server stop  #åœæ­¢</div><div class="line">mysql -u root -p   #ç”¨ user å’Œ pwd è¿æ¥</div><div class="line">php-fpm ç›¸å…³æ“ä½œ</div></pre></td></tr></table></figure>
<p>1.è¿è¡Œ php-fpm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo php-fpm -D</div></pre></td></tr></table></figure>
<p>2.å…³é—­ php-fpm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo killall php-fpm</div></pre></td></tr></table></figure>
<p>3.æŸ¥çœ‹ php-fpm è¿è¡ŒçŠ¶æ€</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo lsof -Pni4 | grep LISTEN | grep php</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ° (fpm é»˜è®¤åœ¨ 9000 ç«¯å£)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">php-fpm  84200   root  8u  IPv4 0x91959c43a1ea5abd  0t0  TCP 127.0.0.1:9000 (LISTEN)</div><div class="line">php-fpm  84201   _www  0u  IPv4 0x91959c43a1ea5abd  0t0  TCP 127.0.0.1:9000 (LISTEN)</div><div class="line">php-fpm  84202   _www  0u  IPv4 0x91959c43a1ea5abd  0t0  TCP 127.0.0.1:9000 (LISTEN)</div><div class="line">php-fpm  84203   _www  0u  IPv4 0x91959c43a1ea5abd  0t0  TCP 127.0.0.1:9000 (LISTEN)</div></pre></td></tr></table></figure>
<p>4.php-fpm å¼€æœºå¯åŠ¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ln -sfv /usr/local/opt/php56/*.plist ~/Library/LaunchAgents</div><div class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.php56.plist</div></pre></td></tr></table></figure>
<h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>1.æµ‹è¯•é…ç½®æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nginx -t</div></pre></td></tr></table></figure>
<p>2.å¯åŠ¨ nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nginx</div></pre></td></tr></table></figure>
<p>3.é‡æ–°åŠ è½½é…ç½®|é‡å¯|åœæ­¢|é€€å‡º nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nginx -s reload|reopen|stop|quit</div></pre></td></tr></table></figure>
<p>4.å¼€æœºå¯åŠ¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ln -sfv /usr/local/opt/nginx/*.plist ~/Library/LaunchAgents</div><div class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist</div></pre></td></tr></table></figure>
<p>5.nginx ç›‘å¬ 80 ç«¯å£ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo chown root:wheel /usr/local/Cellar/nginx/1.6.0_1/bin/nginx</div><div class="line">sudo chmod u+s /usr/local/Cellar/nginx/1.6.0_1/bin/nginx</div></pre></td></tr></table></figure>
<h2 id="å¸¸ç”¨ç›®å½•"><a href="#å¸¸ç”¨ç›®å½•" class="headerlink" title="å¸¸ç”¨ç›®å½•"></a>å¸¸ç”¨ç›®å½•</h2><p>å› ä¸ºä½¿ç”¨äº† Homebrew å®‰è£…çš„ PHP, é…ç½®æ–‡ä»¶çš„ç›®å½•ä¸æ˜¯å¸¸è§„çš„ /etc</p>
<p>è¿™é‡Œæœ‰å‡ ä¸ªç›®å½•éœ€è¦çŸ¥é“, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/private/etc</div><div class="line">/usr/local/etc/php/5.6</div><div class="line">/usr/local/var/www</div></pre></td></tr></table></figure>
<h2 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h2><p>1.æ‰§è¡Œ sudo php-fpm -D æŠ¥ php56-intl/intl.so åŠ è½½é—®é¢˜</p>
<p>warning çš„å†…å®¹å¤§è‡´å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">NOTICE: PHP message: PHP Warning:  PHP Startup: Unable to load dynamic library &apos;/usr/local/opt/php56-intl/intl.so&apos; - dlopen(/usr/local/opt/php56-intl/intl.so, 9): image not found in Unknown on line 0</div><div class="line">&lt;br /&gt;</div><div class="line">&lt;b&gt;Warning&lt;/b&gt;:  PHP Startup: Unable to load dynamic library &apos;/usr/local/opt/php56-intl/intl.so&apos; - dlopen(/usr/local/opt/php56-intl/intl.so, 9): image not found in &lt;b&gt;Unknown&lt;/b&gt; on line &lt;b&gt;0&lt;/b&gt;&lt;br /&gt;</div><div class="line">Unknown(0) : Warning - PHP Startup: Unable to load dynamic library &apos;/usr/local/opt/php56-intl/intl.so&apos; - dlopen(/usr/local/opt/php56-intl/intl.so, 9): image not found</div><div class="line">[31-Dec-2016 22:40:38] NOTICE: PHP message: PHP Warning:  PHP Startup: mcrypt: Unable to initialize module</div><div class="line">Module compiled with build ID=API20131226,NTS</div><div class="line">PHP    compiled with build ID=API20131226,NTS,debug</div><div class="line">These options need to match</div><div class="line"> in Unknown on line 0</div></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ¡ˆ: æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤, å³å¯è§£å†³.æ–¹æ¡ˆæ¥æº <a href="https://github.com/Homebrew/homebrew-php/issues/2544" target="_blank" rel="noopener">Github</a>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew reinstall --build-from-source php56-intl</div></pre></td></tr></table></figure>
<p>2.æ‰§è¡Œ sudo php-fpm -D æŠ¥ PHP Startup: mcrypt: Unable to initialize module</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">31-Dec-2016 22:56:51] NOTICE: PHP message: PHP Warning:  PHP Startup: mcrypt: Unable to initialize module</div><div class="line">Module compiled with build ID=API20131226,NTS</div><div class="line">PHP    compiled with build ID=API20131226,NTS,debug</div><div class="line">These options need to match</div><div class="line"> in Unknown on line 0</div><div class="line">&lt;br /&gt;</div><div class="line">&lt;b&gt;Warning&lt;/b&gt;:  PHP Startup: mcrypt: Unable to initialize module</div><div class="line">Module compiled with build ID=API20131226,NTS</div><div class="line">PHP    compiled with build ID=API20131226,NTS,debug</div><div class="line">These options need to match</div><div class="line"> in &lt;b&gt;Unknown&lt;/b&gt; on line &lt;b&gt;0&lt;/b&gt;&lt;br /&gt;</div><div class="line">Unknown(0) : Warning - PHP Startup: mcrypt: Unable to initialize module</div><div class="line">Module compiled with build ID=API20131226,NTS</div><div class="line">PHP    compiled with build ID=API20131226,NTS,debug</div><div class="line">These options need to match</div></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ¡ˆ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew reinstall --build-from-source php56-intl</div></pre></td></tr></table></figure>
<p>3.è¿æ¥ mysql</p>
<p>ä½¿ç”¨ <code>mysql -u root -p</code> è¿æ¥ mysql, æç¤º Canâ€™t connect to local MySQL server through socket â€˜/tmp/mysql.sock é”™è¯¯.</p>
<p>è§£å†³æ–¹æ¡ˆ: å¯åŠ¨ mysql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql.server start</div></pre></td></tr></table></figure>
<p>é‡æ–°è¿æ¥å³å¯.</p>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> PHP MySql nginx php-fpm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[PHP å¼€å‘å‡†å¤‡]]></title>
      <url>/2017/02/02/PHP-%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/</url>
      <content type="html"><![CDATA[<p><strong>æ³¨æ„</strong>ï¼šè¿™ç¯‡æ–‡ç« æ˜¯åŸºäº Homebrew å®‰è£… php5.6 ä»¥åŠ nginx å’Œ mysql çš„ä»‹ç»ï¼Œå®‰è£…é«˜ç‰ˆæœ¬çš„ php è¯·ç»•è¡Œã€‚</p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>äº²è‡ªå®è·µåœ¨ MacOS ä¸Šé¢å®‰è£… PHP5.6+MySQL+Nginx.</p>
<p>å°†è‡ªå·±é‡åˆ°çš„é—®é¢˜å’Œå¯¹åº”çš„è§£å†³æ–¹æ¡ˆ, åˆ†äº«å‡ºæ¥, å¸Œæœ›èƒ½å¸®åˆ°ä½ .</p>
<p>MacOS ä¸Šé¢æ­å»º PHP å¼€å‘ç¯å¢ƒ, ä½¿ç”¨ Homebrew æ¥å®‰è£…å¯¹åº”çš„å¼€å‘å¥—ä»¶, å°±æ›´åŠ ç®€å•äº†.</p>
<p>è¿™ç¯‡åšå®¢çš„ç›®çš„å°±æ˜¯å®‰è£… PHP å¼€å‘ç¯å¢ƒ, å¹¶å°†ç¬¬ä¸€ä¸ª PHP ç¨‹åºéƒ¨ç½²åœ¨ Nginx ä¸Šé¢.</p>
<p>å¦‚æœåœ¨å®‰è£…å’Œä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜, å¯ä»¥æŸ¥çœ‹è¿™ç¯‡åšå®¢: <a href="http://www.veryitman.com/2017/02/02/%E5%AE%89%E8%A3%85-PHP-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">Mac PHP å®‰è£…é‡åˆ°çš„é—®é¢˜</a>.</p>
<p>ä¸‹é¢å¼€å§‹ä»‹ç»å…·ä½“çš„å®‰è£…æ­¥éª¤.</p>
<h2 id="ä¸€-å®‰è£…-Homebrew"><a href="#ä¸€-å®‰è£…-Homebrew" class="headerlink" title="ä¸€. å®‰è£… Homebrew"></a>ä¸€. å®‰è£… Homebrew</h2><p>è¿™ä¸ªå¤§å®¶å¯ä»¥è‡ªè¡Œè®¿é—® <a href="http://brew.sh/" target="_blank" rel="noopener">Homebrew</a> äº†è§£, è¿™é‡Œä¸å†æ¶‰åŠå…·ä½“çš„å®‰è£…è¿‡ç¨‹å’Œæ–¹æ³•.</p>
<h2 id="äºŒ-å®‰è£…-php56"><a href="#äºŒ-å®‰è£…-php56" class="headerlink" title="äºŒ. å®‰è£… php56"></a>äºŒ. å®‰è£… php56</h2><blockquote>
<p>1.åŠ å…¥å®˜æ–¹æº</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">brew tap homebrew/dupes</div><div class="line">brew tap homebrew/versions</div><div class="line">brew tap homebrew/php</div></pre></td></tr></table></figure>
<blockquote>
<p>2.å®‰è£… PHP</p>
</blockquote>
<p>é»˜è®¤å®‰è£…ä¼šè¿è¡Œåœ¨ Apache ä¸‹.<br>è€Œæˆ‘ä»¬è¦ä½¿å®ƒè¿è¡Œåœ¨ PHP-fpm ä¸‹ï¼Œæ‰€ä»¥è¦å¢åŠ å‚æ•°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">--with-fpm --without-apache</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹æ‰€æœ‰å®‰è£…å‚æ•°å¯ä»¥è¾“å…¥:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew option php56</div></pre></td></tr></table></figure>
<p>è¿›è¡ŒæŸ¥çœ‹ï¼Œå‚è€ƒå®‰è£…æŒ‡ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">brew install php56 \</div><div class="line">--without-snmp \</div><div class="line">--without-apache \</div><div class="line">--with-debug \</div><div class="line">--with-fpm \</div><div class="line">--with-intl \</div><div class="line">--with-homebrew-curl \</div><div class="line">--with-homebrew-libxslt \</div><div class="line">--with-homebrew-openssl \</div><div class="line">--with-imap \</div><div class="line">--with-mysql \</div><div class="line">--with-tidy</div></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨äº†ä¸‹é¢çš„é€‰é¡¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">with-homebrew-curl</div></pre></td></tr></table></figure>
<p>æˆ‘è¯•è¿‡ä¸å¸¦æ­¤é€‰é¡¹, å®‰è£… PHP56 ä¼šå¤±è´¥, æ‰¾ä¸åˆ° curl.</p>
<p>å®‰è£…æˆåŠŸå, å¯ä»¥æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">php -v</div><div class="line">php-fpm -v</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶çœ‹åˆ°æ˜¯çš„ç³»ç»Ÿè‡ªå¸¦çš„ç‰ˆæœ¬.</p>
<p>ä¸‹é¢ä¸€æ­¥æ˜¯å¢åŠ ç¯å¢ƒå˜é‡, å®Œæˆååœ¨çœ‹ç‰ˆæœ¬ä¿¡æ¯, å³å¯.</p>
<blockquote>
<p>3.é…ç½® PHP ç¯å¢ƒå˜é‡</p>
</blockquote>
<p>é…ç½®ç¯å¢ƒå˜é‡çš„ç›®çš„æ˜¯è¦ä½¿ç”¨ brew å®‰è£…çš„ PHP å’Œ PHP-fpm, ä¸ä½¿ç”¨ MacOS è‡ªå¸¦çš„ PHP ç‰ˆæœ¬.</p>
<p><code>/usr/local/sbin/</code> ä¸‹é¢æ˜¯æˆ‘ä»¬ brew å®‰è£…çš„ PHP, å…¶å®ä»–æ˜¯ä¸€ä¸ªè½¯è¿æ¥æŒ‡å‘:<br><code>/usr/local/Cellar/php56/5.6.27_4/sbin</code></p>
<p><code>/usr/local/bin/</code> ä¸‹é¢ä¹Ÿæ˜¯ brew å®‰è£…çš„ PHP, æŒ‡å‘:<br><code>/usr/local/Cellar/php56/5.6.27_4/bin</code></p>
<p>vim ~/.bash_profile å¢åŠ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export PATH=&quot;/usr/local/sbin:$PATH&quot;</div></pre></td></tr></table></figure>
<p>ä½¿å…¶ç«‹å³ç”Ÿæ•ˆ, æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source ~/.bash_profile</div></pre></td></tr></table></figure>
<p>æˆ–è€…é‡å¯ç»ˆç«¯.</p>
<p>å¦‚æœæƒ³çœ‹ç³»ç»Ÿçš„ PHP ç‰ˆæœ¬å¯ä»¥è¿™æ ·:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/php -v</div></pre></td></tr></table></figure>
<blockquote>
<p>4.é…ç½® php-fpm</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo cp /private/etc/php-fpm.conf.default /private/etc/php-fpm.conf</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /private/etc/php-fpm.conf</div></pre></td></tr></table></figure>
<p>æ‰¾åˆ° error_log é¡¹ï¼Œæ·»åŠ ä¸‹é¢é…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">error_log = /usr/local/var/log/php-fpm.log</div><div class="line">pid = /usr/local/var/run/php-fpm.pid</div></pre></td></tr></table></figure>
<p>å¦åˆ™ä¼šæŠ¥:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FPM initialization failed</div></pre></td></tr></table></figure>
<h2 id="ä¸‰-å®‰è£…-nginx"><a href="#ä¸‰-å®‰è£…-nginx" class="headerlink" title="ä¸‰. å®‰è£… nginx"></a>ä¸‰. å®‰è£… nginx</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install nginx</div></pre></td></tr></table></figure>
<p>åˆ›å»ºæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mkdir -p /usr/local/var/logs/nginx</div><div class="line">mkdir -p /usr/local/etc/nginx/sites-available</div><div class="line">mkdir -p /usr/local/etc/nginx/sites-enabled</div><div class="line">mkdir -p /usr/local/etc/nginx/conf.d</div><div class="line">mkdir -p /usr/local/etc/nginx/ssl</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">sudo mkdir -p /var/www</div><div class="line">sudo chown :staff /var/www</div><div class="line">sudo chmod 775 /var/www</div><div class="line">vi /var/www/info.php</div><div class="line">vi /var/www/index.html</div><div class="line">vi /var/www/403.html</div><div class="line">vi /var/www/404.html</div></pre></td></tr></table></figure>
<p>æ”¹å˜ nginx.conf é…ç½®æ–‡ä»¶</p>
<p>è¯¥é…ç½®æ–‡ä»¶åœ¨ <code>/usr/local/etc/nginx/nginx.conf</code> ä¸‹é¢.</p>
<p>æˆ‘çš„é…ç½®:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">worker_processes  1;</div><div class="line"> </div><div class="line">error_log  /usr/local/etc/nginx/logs/error.log debug;</div><div class="line">pid        /usr/local/var/run/nginx.pid;</div><div class="line"> </div><div class="line">events &#123;</div><div class="line">    worker_connections  256;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">http &#123;</div><div class="line">    include             mime.types;</div><div class="line">    default_type        application/octet-stream;</div><div class="line"> </div><div class="line">    log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</div><div class="line">                      &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</div><div class="line">                      &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</div><div class="line"> </div><div class="line">    access_log  /usr/local/etc/nginx/logs/access.log  main;</div><div class="line"> </div><div class="line">    sendfile            on;</div><div class="line"> </div><div class="line">    keepalive_timeout   65;</div><div class="line"> </div><div class="line">    index index.html index.php;</div><div class="line"> </div><div class="line">    include /usr/local/etc/nginx/sites-enabled/*; </div><div class="line">    include /usr/local/etc/nginx/conf.d/*;</div><div class="line">     server &#123;</div><div class="line">        listen       8080;</div><div class="line">        server_name  localhost;</div><div class="line">        #charset koi8-r;</div><div class="line">        #access_log  logs/host.access.log  main;</div><div class="line">        location / &#123;</div><div class="line">            root   ~/projs/phpdev/nginx/nginx_sites/; #webçš„æ ¹ç›®å½•</div><div class="line">            index  index.php index.html index.htm; #åŠ index.php</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">location / &#123;</div><div class="line">    root   ~/projs/phpdev/nginx/nginx_sites/; #webçš„æ ¹ç›®å½•</div><div class="line">    index  index.php index.html index.htm; #åŠ index.php</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é…ç½®äº†æˆ‘çš„ web ç›®å½•å’Œæ”¯æŒçš„æ–‡ä»¶.</p>
<h2 id="å››-è¿è¡Œ-PHP"><a href="#å››-è¿è¡Œ-PHP" class="headerlink" title="å››. è¿è¡Œ PHP"></a>å››. è¿è¡Œ PHP</h2><p>åˆ›å»º index.php</p>
<p>å¯åŠ¨ PHP-fpm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo php-fpm</div></pre></td></tr></table></figure>
<p>æˆ–è€…ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼æ¥å¯åŠ¨ PHP-fpm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo php-fpm -D</div></pre></td></tr></table></figure>
<p>å¯åŠ¨ Nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nginx</div></pre></td></tr></table></figure>
<p>ç¼–è¾‘ index.php</p>
<p>åœ¨ web ç›®å½•(æˆ‘é…ç½®çš„) <code>/Users/mark/workspace/mzProjs/phpdev/nginx/nginx_sites/</code> æ–°å»ºæ–‡ä»¶ <code>index.php</code>.</p>
<p>index.php é‡Œé¢å¯ä»¥ç¼–å†™ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;!-- lang: php --&gt;</div><div class="line">&lt;!-- ~/nginx_sites/index.php --&gt;</div><div class="line">&lt;?php</div><div class="line">    echo &quot;Hello PHP&quot;;</div><div class="line">    echo &quot;&lt;/br&gt;&quot;;</div><div class="line">    </div><div class="line">    echo &quot;å­¦ä¹  php&quot;;</div><div class="line">    echo &quot;&lt;/br&gt;&quot;;</div><div class="line">    echo phpinfo();</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>æ‰“å¼€æµè§ˆå™¨, ä½ ä¼šçœ‹åˆ°ä¸‹é¢çš„é¡µé¢:<br><img src="/upload/images/2017/02/02/php1.png" alt="1"></p>
<p>ä¹Ÿå¯ä»¥åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºå…¶ä»– php æ–‡ä»¶, å¦‚ mark.php æ–‡ä»¶.</p>
<p>æµè§ˆå™¨ä¸­è¾“å…¥:<br><a href="http://localhost:8080/mark.php" target="_blank" rel="noopener">http://localhost:8080/mark.php</a> å¯ä»¥æ‰§è¡Œç›¸å¯¹åº”çš„æ–‡ä»¶.</p>
<p>è¿™é‡Œçš„ <code>mark.php</code> æ˜¯è‡ªå·±æ–°å»ºçš„ php æ–‡ä»¶.</p>
<h2 id="äº”-å®‰è£…-MySQL"><a href="#äº”-å®‰è£…-MySQL" class="headerlink" title="äº”. å®‰è£… MySQL"></a>äº”. å®‰è£… MySQL</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install mysql</div></pre></td></tr></table></figure>
<p>ç­‰å¾…å®‰è£…æˆåŠŸåï¼Œç›´æ¥å¯åŠ¨å’Œè¿æ¥æ•°æ®åº“ã€‚</p>
<ul>
<li>å¯åŠ¨ mysql</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql.server start</div></pre></td></tr></table></figure>
<ul>
<li>è¿æ¥ mysql</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root -p</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> PHP MySql nginx php-fpm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è¿‡å¹´å›å®¶è¿™å‡ å¤©]]></title>
      <url>/2017/01/31/%E8%BF%87%E5%B9%B4%E5%9B%9E%E5%AE%B6%E8%BF%99%E5%87%A0%E5%A4%A9/</url>
      <content type="html"><![CDATA[<p>ä»æ”¾å‡å›å®¶åˆ°ç°åœ¨å·²ç»ä¸€ä¸ªå¤šæ˜ŸæœŸäº†, æ„Ÿè§¦é¢‡å¤š.</p>
<p>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ„Ÿè§¦:</p>
<blockquote>
<p>1.å¥åº·æœ€é‡è¦.<br>2.åšæŒåšå¥½ä¸€ä»¶äº‹æƒ….<br>3.æ„Ÿæ©.</p>
</blockquote>
<p><img src="/upload/images/2017/01/31/1.jpeg" alt="1"></p>
<h2 id="å¥åº·"><a href="#å¥åº·" class="headerlink" title="å¥åº·"></a>å¥åº·</h2><p>å‰ä¸¤å¹´å›å®¶, è¿˜èƒ½è§ç€å¾ˆå¤šé•¿è¾ˆ, äº’ç›¸å˜˜å¯’é—®æš–, å®¶é•¿é‡ŒçŸ­çš„é—²èŠ, å¦‚ä»Šæœ‰äº›å·²ç¦»æˆ‘è¿œå».</p>
<p>æ— æƒ…çš„ç–¾ç—…å¤ºèµ°äº†å°šæœªèŠ±ç”²çš„ä»–ä»¬, è®©äººä¸ç¦æ„Ÿå¹ç”Ÿå‘½çš„è„†å¼±.</p>
<p>æˆ‘å°çš„æ—¶å€™, å¾ˆå–œæ¬¢å’Œé•¿è¾ˆä»¬èŠå¤©.</p>
<p>ä¸»è¦æ˜¯ä»–ä»¬è®², æˆ‘åšä¸€ä¸ªå°å°çš„å¬ä¼—, è§‰å¾—ä»–ä»¬æ‡‚å¾—ç‰¹åˆ«å¤š, ä»å¤©æ–‡åˆ°åœ°é‡Œ, ä»æ–‡å­¦åˆ°è‰ºæœ¯, è®²çš„æœ‰å£°æœ‰è‰².<br>æ¯é€¢å¤å­£, æˆ‘éƒ½ä¼šæ¬ç€å°æ¿å‡³, åœ¨å±‹å‰çš„è€æ ‘ä¸‹, çº ç¼ ä»–ä»¬, é€¼ç€åš·ç€è®©ä»–ä»¬ç»™æˆ‘è®²æ•…äº‹, ç”­ææœ‰å¤šé«˜å…´.</p>
<p>å¦‚ä»Š, è€æ ‘çŠ¹åœ¨, ä»–ä»¬å·²ä¸åœ¨äººä¸–.ç¹ç‰©æ€äºº.</p>
<p>å†œæ‘å¤§éƒ¨åˆ†äºº, ä¸å¤ªå…³æ³¨è‡ªå·±çš„å¥åº·, å”¯ä¸€è¡¡é‡è‡ªå·±èº«ä½“çŠ¶å†µçš„æ ‡å‡†å°±æ˜¯ <code>ç±³é¥­é¦’å¤´èƒ½åƒå¤šå°‘</code>.</p>
<p>å¾ˆå¤šäºº, æ˜æ˜å·²ç»æ„Ÿè§‰åˆ°èº«ä½“ä¸é€‚, ä¹Ÿä¸æ„¿æ„å»åŒ»é™¢åšæ£€æŸ¥, å°±è¿™æ ·æ—¥ç§¯æœˆç´¯æˆç–¾.<br>ç­‰å®åœ¨å¿å—ä¸äº†æ‰å»åŒ»é™¢æ£€æŸ¥, ä¸ºæ—¶å·²æ™š.</p>
<p>å¹³æ—¶ä¸æ³¨æ„è‡ªå·±çš„èº«ä½“, èº«ä½“æ—©æ™šéƒ½ä¼šè®©ä½ æ³¨æ„.</p>
<p>æ— è®ºå¹³æ—¶å·¥ä½œå†å¿™, ä¹Ÿè¦åšæŒé”»ç‚¼, æ²¡æœ‰å¥åº·çš„ä½“é­„, å…¶ä»–çš„éƒ½æ˜¯æ‰¯æ·¡.</p>
<h2 id="åšæŒ"><a href="#åšæŒ" class="headerlink" title="åšæŒ"></a>åšæŒ</h2><p>å†œæ‘è¿™å‡ å¹´é¼“åŠ±å¹´è½»äººåœ¨å®¶åˆ›ä¸š, æå…»æ®–. æœ‰å¾ˆå¤šäººæ”¾å¼ƒäº†æ‰“å·¥, å›å®¶æ‹¿ç€è¡¥è´´å¼€å§‹æœ‰æ¨¡æœ‰æ ·çš„åˆ›ä¸š.</p>
<p>å‰å‡ å¹´å›è€å®¶, çœ‹åˆ°å„ç§æå…»æ®–çš„, æœ‰å…»é¸¡å…»é¸­å…»é¹…çš„, æœ‰å…»ç¾Šå…»çŒªå…»ç‰›çš„, å¦‚é›¨åæ˜¥ç¬‹, éåœ°å¼€èŠ±.</p>
<p>ä½†æ˜¯ä»Šå¹´å›å®¶, çœ‹åˆ°å¾ˆå¤šè’å‡‰çš„æˆ¿å­, æ— äººé—®æ´¥.</p>
<p>æˆ‘é—®è¿‡å‡ ä¸ªå°ä¼™å­(ä¹‹å‰åœ¨å®¶æå…»æ®–çš„äºº, æœ€åæ”¾å¼ƒäº†çš„).ä»–ä»¬è·Ÿæˆ‘è¯´çš„åŸºæœ¬éƒ½ä¸€æ ·, å¤ªç´¯äº†, æ”¶ç›Šæ…¢!<br>æå…»æ®–, çš„ç¡®å¾ˆç´¯, ä¹Ÿå¾ˆæ¯ç‡¥æ— å‘³, æ¯å¤©å’Œè¿™äº›ä¸ä¼šè¯´è¯çš„åŠ¨ç‰©ä»¬å¾…åœ¨ä¸€èµ·, å–‚å®ƒä»¬åƒå–, ç®¡ä»–ä»¬æ¸©é¥±, å®åœ¨ä¹å‘³.</p>
<p>å¦å¤–æœ‰ä¸¤ä¸ªå¹´è½»äºº, ä»å¼€å§‹å…»æ®–åˆ°ç°åœ¨å·²ç»åšæŒäº”å…­å¹´äº†, æå¾—é£ç”Ÿæ°´èµ·, å®¶é‡Œç›–èµ·äº†æ¥¼æˆ¿, å–äº†å·§åª³å¦‡, ç”Ÿäº†èƒ–å°å­, ä¸€å®¶äººå…¶ä¹èè.<br>ä»–ä»¬è·Ÿæˆ‘è¯´çš„åŸºæœ¬ä¸€æ ·, åªè¦åšæŒ, å°±æœ‰æ”¶è·!</p>
<p>è¿™ä¸¤ä¸ªåšæŒä¸‹æ¥çš„å¹´è½»äºº, ä»–ä»¬ç›¸ä¿¡è‡ªå·±èƒ½å¤ŸæŠŠè¿™ä»½äº‹ä¸šåšå¥½, ä»–ä»¬æŠŠåˆ«äººçœ¼ä¸­çš„è„æ´»ç´¯æ´»å½“åšä¸€ç§å¿«ä¹, ä¸€ç§äº«å—!</p>
<p>åˆšå¼€å§‹, å¾ˆè‰°éš¾, ä»–ä»¬ä¹Ÿæƒ³è¿‡æ”¾å¼ƒ, ä½†æ˜¯åˆèˆä¸å¾—è¿™å‡ å¹´çš„ä»˜å‡º, äºæ˜¯å°±åšæŒä¸‹æ¥äº†, å¹¶ä¸”æ”¶è·äº†ä¸å°‘æ„æƒ³ä¸åˆ°çš„çŸ¥è¯†, ä¸ç®¡æ˜¯ç‰©è´¨ä¸Šè¿˜æ˜¯ç²¾ç¥ä¸Šéƒ½å¾—åˆ°äº†æ»¡è¶³.</p>
<p>ä¸–ä¸Š, æ²¡æœ‰ä¸€å¸†é£é¡ºçš„äº‹ä¸š.</p>
<p>åªè¦è‡ªå·±å–œæ¬¢, æ„Ÿå…´è¶£çš„è¡Œä¸š, å°±å€¼å¾—ä½ å»åšæŒ.<br>å¦‚æœä½ ä»å†…å¿ƒéƒ½ä¸æ„Ÿå…´è¶£, è¶æ—©æ”¾å¼ƒ, å› ä¸ºä½ å¾ˆéš¾åšæŒä¸‹æ¥.</p>
<p>æƒ³æŠ•æœºå–å·§çš„æˆå°±ä¸€ä»½äº‹ä¸š, åªæœ‰ç¥è¯æ•…äº‹é‡Œæœ‰å§!</p>
<p>ä¸ç»ä¸€ç•ªå¯’å½»éª¨, å“ªå¾—æ¢…èŠ±æ‰‘é¼»é¦™!</p>
<h2 id="æ„Ÿæ©"><a href="#æ„Ÿæ©" class="headerlink" title="æ„Ÿæ©"></a>æ„Ÿæ©</h2><p>å°çš„æ—¶å€™, å®¶é‡Œå¾ˆæ‹®æ®, æˆ‘èƒ½å¤ŸæŠŠå¤§å­¦å¿µå®Œ, ç®€ç›´å°±æ˜¯å¤©æ„.</p>
<p>çˆ¶æ¯æ°¸è¿œåªä¼šå¯¹æˆ‘è¯´ä¸€å¥è¯, åªè¦ä½ æƒ³ä¸Šå­¦, æˆ‘ä»¬å°±æ”¯æŒåˆ°åº•.</p>
<p>æˆ‘çŸ¥é“å®¶é‡Œçš„ç»æµæƒ…å†µ, æ‰€ä»¥åœ¨å­¦ä¹ ä¸Šä¹Ÿæ˜¯ä¸é—ä½™åŠ›, æ¯æ¬¡æ”¾å­¦é™¤äº†å¸®çˆ¸çˆ¸å¦ˆå¦ˆå¹²å†œæ´», å°±æ˜¯å®Œæˆå®¶åº­ä½œä¸š, ç»ƒå­—èƒŒä¹¦.</p>
<p>é‚£ä¸ªæ—¶å€™, ä¸çŸ¥é“å“ªæ¥çš„ç‹ åŠ², å³ä½¿æ˜¯å¯’å†¬è…Šæœˆ, ä¹Ÿè¦åšæŒå†™ä½œä¸š, å³ä½¿æ˜¯æ‰‹éƒ½å†»è‚¿äº†, ä¹Ÿè¦ç»ƒå­—.</p>
<p>å½“æˆ‘æ¥åˆ°é‡ç‚¹é«˜ä¸­é€šçŸ¥ä¹¦çš„é‚£å¤©, çˆ¶äº²é«˜å…´çš„åˆä¸æ‹¢å˜´, å¿ƒç†å……æ»¡äº†éª„å‚².</p>
<p>æˆ‘èƒ½æ„Ÿè§‰åˆ°â€¦â€¦</p>
<p>ç„¶è€Œè€ƒä¸Šé«˜ä¸­, æ¥ä¸‹æ¥å°±æ˜¯å‡‘é’±äº¤å­¦è´¹, éš”å£æœ‰ä¸ªä¼¯ä¼¯, ä»–è¯´å­¦è´¹ä¸å¤Ÿ, ç®—ä»–çš„.<br>é‚£ä¸ªæ—¶å€™, å¤§å®¶å®¶é‡Œéƒ½ä¸å®½è£•, èƒ½å€Ÿé’±ç»™ä½ çš„, ç®€ç›´å°±æ˜¯å¤§æ©äºº.<br>ä¸€ç›´åˆ°ç°åœ¨, æˆ‘éƒ½å¾ˆæ„Ÿæ¿€ä»–, æ¯å¹´è¿‡å¹´å›å®¶, æˆ‘éƒ½ä¼šç»™ä¼¯ä¼¯ä¹°ç‚¹ç¤¼ç‰©, ç»™ä¸ªçº¢åŒ…, é™ªä»–èŠèŠå¤©.ä»–è¿˜å¼€ç©ç¬‘çš„è¯´, å½“å¹´è‡ªå·±çš„æŠ•èµ„, ç®—æ˜¯æœ‰äº†å›æŠ¥äº†.</p>
<p>è¿™è¾ˆå­, æˆ‘ä»¬æœ€åº”è¯¥æ„Ÿè°¢çš„æ˜¯æˆ‘ä»¬è‡ªå·±çš„çˆ¶æ¯, å…»è‚²æˆ‘ä»¬æˆäºº, é€æˆ‘ä»¬è¯»ä¹¦ä¸Šå­¦. è¿‡å¹´å›å®¶, è¦å¤šé™ªé™ªä»–ä»¬, çæƒœå’Œä»–ä»¬åœ¨ä¸€èµ·çš„æ¯ä¸€åˆ».</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç”Ÿæ´» åæ€ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å­¦ä¹ æ‚è°ˆ]]></title>
      <url>/2017/01/27/%E5%AD%A6%E4%B9%A0%E6%9D%82%E8%B0%88/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯ä¸­å›½ä¼ ç»ŸèŠ‚æ—¥, å¤§å¹´ä¸‰å, ç¥å¤§å®¶æ–°å¹´å¿«ä¹, èº«ä½“å¥åº·, å¹¸ç¦ç¾æ»¡.</p>
<h2 id="å¼•å­"><a href="#å¼•å­" class="headerlink" title="å¼•å­"></a>å¼•å­</h2><p>æœ€è¿‘æ— è®ºæ˜¯æœ‹å‹è¿˜æ˜¯åŒäº‹æˆ–è€…åšå‹, éƒ½é—®è¿‡æˆ‘å…³äºå­¦ä¹ æ–¹é¢çš„äº‹æƒ….</p>
<p>æ¢è®¨çš„é—®é¢˜å¤§æ¦‚åˆ†ä¸ºå¦‚ä¸‹å‡ ç§:</p>
<p>æ€ä¹ˆæœ‰æ•ˆçš„å­¦ä¹ æ–°çŸ¥è¯†?<br>æ€ä¹ˆå¿«é€ŸæŒæ¡æ–°çŸ¥è¯†?<br>æ˜¯å¦æœ‰å¿…è¦æ¯å¤©å­¦ä¹ ?<br>å¦‚ä½•åšæŒå­¦ä¹ ?<br>è°ˆåˆ°å…³äºå­¦ä¹ çš„è¯é¢˜, æˆ‘ä¹Ÿä¸æ˜¯ä»€ä¹ˆä¸“å®¶, æ›´ä¸æ˜¯å¿ƒç†å’¨è¯¢å¸ˆ, åªæ˜¯è°ˆè°ˆä¸ªäººçš„ä¸€äº›çœ‹æ³•å’Œç»å†, å¸Œæœ›èƒ½ç»™å¤§å®¶å¸¦æ¥ä¸€ç‚¹ç‚¹çš„å¸®åŠ©.</p>
<p>ä¸è¦åªæ˜¯å˜´ä¸Šè¯´ <code>æˆ‘æ„Ÿå…´è¶£</code>, å¦‚æœæ²¡æœ‰é©±åŠ¨å’Œç›®æ ‡, å…´è¶£æ°¸è¿œéƒ½åªæ˜¯å…´è¶£.</p>
<h2 id="ä½ ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ"><a href="#ä½ ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ" class="headerlink" title="ä½ ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ"></a>ä½ ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ</h2><p>å­¦ä¹ çŸ¥è¯†ä¹‹å‰, é—®é—®è‡ªå·±ä¸ºä»€ä¹ˆè¦å­¦å®ƒ? å¤§éƒ¨åˆ†äººå­¦ä¹ æ–°ä¸œè¥¿éƒ½æ˜¯ä¸ºäº†å·¥ä½œæˆ–è€…ä¸ºäº†æ›´å¥½çš„å·¥ä½œæˆ–è€…ä¸ºäº†è½¬è¡Œæˆ–è€…å…¶ä»–ç›®çš„, ä¹Ÿæœ‰ä¸€éƒ¨åˆ†äººæ˜¯ä¸ºäº†å…´è¶£çˆ±å¥½.</p>
<p>è¿™é‡Œæˆ‘åªè°ˆä¸ºäº†å·¥ä½œè€Œå»å­¦ä¹ æ–°çŸ¥è¯†çš„å†…å®¹, å…¶ä»–æ–¹é¢çš„æˆ‘è‡ªå·±ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¿ƒå¾—ä½“ä¼š, ä¸èƒ½ä¹±è¯´.</p>
<p>æ—¢ç„¶ä¸ºäº†å·¥ä½œæˆ–è€…æ›´å¥½çš„å·¥ä½œæ¥å­¦ä¹ , é‚£ä¹ˆæˆ‘ä»¬å°±æ˜ç¡®äº†ç›®æ ‡, å¦‚æœä½ å·²ç»æœ‰äº†ç›®æ ‡, æ­å–œä½ , ä½ å³å°†æˆåŠŸäº†.</p>
<p>æœ‰ä¸€äº›äººè¯´, æˆ‘å­¦ä¹ å®ƒ, è¿™ä¸ªä¸œè¥¿ä¸ä¸€å®šå“ªå¤©å°±æœ‰ç”¨äº†, æˆ‘æ€•å°†æ¥å¤±ä¸š.<br>è¿™ä¸­æ‹…å¿ƒä¸æ˜¯åœ¨æäººå¿§å¤©, ç‰¹åˆ«æ˜¯åœ¨äº’è”ç½‘çš„æ—¶ä»£, å¦‚æœä¸å­¦ä¹ å¾ˆå®¹æ˜“å°±è½ä¼å•¦, å›æ‹…å¿ƒå®Œå…¨åœ¨ç†!</p>
<p>ä½†æ˜¯, å½“ä¸‹ä½ æœ€åº”è¯¥è€ƒè™‘çš„æ˜¯ç›®å‰æŒæ¡çš„æŠ€èƒ½æ˜¯å¦å·²ç»ç†Ÿç»ƒäº†, æ˜¯å¦æ˜¯èƒ½å¤Ÿç‹¬å½“ä¸€é¢äº†, å¦‚æœæ·±å­¦ä¸‹å»ä¼šä¸ä¼šæ›´æœ‰å‰é€”? å¦‚æœæ˜¯, è¯·ä½ æ·±å…¥å»å­¦ä¹ , ä¸è¦å¤ªæäººå¿§å¤©äº†!</p>
<p>åœ¨ç²¾é’»ä¸€é—¨å­¦é—®çš„æƒ…å†µä¸‹, å¯ä»¥æ‰©å¤§è‡ªå·±çš„çŸ¥è¯†é¢, è€Œä¸æ˜¯ <code>åƒç€ç¢—é‡Œçœ‹ç€é”…é‡Œ</code> çš„, è¦è„šè¸å®åœ°çš„å¤§æ­¥å‘å‰.</p>
<h2 id="åšæŒå­¦ä¹ "><a href="#åšæŒå­¦ä¹ " class="headerlink" title="åšæŒå­¦ä¹ "></a>åšæŒå­¦ä¹ </h2><p>ä¸Šé¢çš„æ‰¯æ·¡æœ‰ç‚¹å¤šå•Š.å›æ­£é¢˜.</p>
<p>æ—¢ç„¶ææ¸…æ¥šäº†ä¸ºä»€ä¹ˆå­¦ä¹ å®ƒ, æ¥ä¸‹æ¥å°±æ˜¯æå®šå®ƒ.</p>
<p>ä½ éœ€è¦æœ‰åšæŒå­¦ä¹ çš„æ€åº¦å’Œè¡ŒåŠ¨, ä¸ç„¶ä¸€åˆ‡éƒ½ä¼šæˆä¸ºäº‘çƒŸ. é‚£ä¹ˆå½“åˆå’¬ç‰™åˆ‡é½¿çš„æŠ±è´Ÿ, ç»“æœéƒ½æ˜¯å†²åŠ¨çš„æƒ©ç½š.</p>
<p>å­¦ä¹ æ–°çŸ¥è¯†çš„å‰æœŸæ˜¯å¾ˆç´¯çš„, ä½†æ˜¯åªè¦ä½ æ„å¿—è¶³å¤Ÿåšå®š, ä¸€å®šå¯ä»¥å…‹æœç§ç§å›°éš¾.</p>
<p>è®°å¾—å½“åˆæ¥æ‰‹ä¸€ä¸ªäºŒæ‰‹é¡¹ç›®, é¡¹ç›®ä¹Ÿæ˜¯è¶³å¤Ÿå¤æ‚, å¹¶ä¸”æœ‰å¾ˆå¤šå¼•æ“ä¹‹å‰éƒ½æ²¡æœ‰ç”¨è¿‡, ä¸Šé¢é¢†å¯¼é€¼å¾—æ¯”è¾ƒç´§, æ²¡åŠæ³•, åªèƒ½å°†å…¶æ‹¿ä¸‹, æ¯å¤©æ™šä¸ŠæŒ‘ç¯å¤œæˆ˜, åœ¨ log çš„æµ·æ´‹é‡Œé¨æ¸¸.</p>
<p>å¾ˆå¿«è‡ªå·±æŒæ¡äº†æ–°çš„çŸ¥è¯†, ç»“åˆé¡¹ç›®, ä¸æ–­çš„å»è°ƒè¯•å’Œæ€»ç»“, æœ€ç»ˆæŒ‰æœŸå®Œæˆéœ€æ±‚, å›è¿‡å¤´æƒ³æƒ³, æƒ³è¦åšæŒåšå¥½ä¸€ä»¶äº‹æƒ…, é™¤äº†è‡ªèº«çš„è‡ªæˆ‘çº¦æŸ, è¿˜éœ€è¦å¤–ç•Œç¯å¢ƒçš„ å€’é€¼.</p>
<p>å½“ä½ åšæŒä¸ä½çš„æ—¶å€™, é—®é—®è‡ªå·±, æ˜¯å¦å·²ç»åˆ°äº†æé™, å¦‚æœæ„Ÿåˆ°ç´¯äº†, é€‚å½“çš„æ”¾æ¾ä¸€ä¸‹, æ¯”å¦‚å‡ºå»è·‘ä¸ªæ­¥, æ‰“ä¸ªçƒæˆ–è€…æ‰¾æœ‹å‹å™å™æ—§.</p>
<p>é€‚å½“çš„ç»™è‡ªå·±ä¸€ç‚¹å‹åŠ›, äº‹åŠåŠŸå€.</p>
<h2 id="å­¦ä¹ çš„æ¸ é“"><a href="#å­¦ä¹ çš„æ¸ é“" class="headerlink" title="å­¦ä¹ çš„æ¸ é“"></a>å­¦ä¹ çš„æ¸ é“</h2><p>åˆšå¼€å§‹å­¦ä¹ æ–°çŸ¥è¯†, å¤§å®¶éƒ½æ¸´æœ›æœ‰ä¸€äº›å¤§ç‰›èƒ½å¤ŸæŒ‡å¯¼è‡ªå·±, æˆ–è€…èƒ½å¤Ÿä»å‰è¾ˆé‚£é‡Œè·å–ä¸€äº›æ­¦æ—ç§˜ç±, è¿™äº›éƒ½æ˜¯å­¦ä¹ çš„æ¸ é“.</p>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­, ä¼šé‡åˆ°å„ç§å„æ ·çš„å›°éš¾, æ¯”å¦‚åœ¨å­¦ä¹ ä¸€é—¨çŸ¥è¯†çš„æ—¶å€™, å‘ç°ç«Ÿç„¶è¿˜éœ€è¦å­¦ä¹ å¦ä¸€é—¨æ–°çŸ¥è¯†, çœŸæ˜¯æ—¥äº†ç‹—äº†!<br>åˆ°è¿™é‡Œ, å¯èƒ½æœ‰äº›äººå°±ä¼šæƒ…ä¸è‡ªç¦çš„é€‰æ‹©äº†æ”¾å¼ƒ, å˜´ä¸Šè¯´è¿˜åœ¨å­¦ä¹ , å…¶å®å¿ƒé‡Œå·²ç»ç–²å€¦.</p>
<p>è¿˜æœ‰ä¸€äº›åˆå­¦è€…, ä»–ä»¬æ²¡æœ‰ä»€ä¹ˆç»éªŒ, å¦‚æœä¸»åŠ¨æ€§å†å·®ç‚¹, åŠ¨è¾„é‡åˆ°é—®é¢˜å°±é—®, æ ¹æœ¬æ²¡æœ‰è¿‡æ€è€ƒ, å“ªæ€•æ˜¯ä¸€ç‚¹ç‚¹çš„æ€è€ƒéƒ½æ²¡æœ‰.å…¶å®ä»–ä»¬ä¸æ˜¯ä¸æƒ³æ, å°±æ€•æé”™äº†.ä»…ä»…æ˜¯å› ä¸ºæ€•, å°±æˆ›ç„¶è€Œæ­¢äº†!<br>è¿™ç§äºº, ç¡®å®å¯æƒœ, æ‰€ä»¥ä»–ä»¬éœ€è¦æ›´å¤šçš„æŒ‡å¯¼å’Œæ•™è‚².è¿™é‡Œæé†’å¤§å®¶, å­¦ä¹ çŸ¥è¯†, ä¸è¦æ€•çŠ¯é”™, å¤§èƒ†çš„å»è¯•é”™, åœ¨é”™è¯¯ä¸­æˆé•¿, è¿™æ ·ä½ æ‰èƒ½æœ‰æ‰€æ”¶è·.</p>
<p>è®°å¾—ä»¥å‰ä¸ºäº†å®‰è£… linux, æˆ‘æŠŠåŠå…¬å®¤çš„åŠå…¬ç”µè„‘éƒ½æ ¼å¼åŒ–äº†, ç»„é•¿å·®ç‚¹è¦å¼€é™¤æˆ‘äº†, ç°åœ¨æƒ³æƒ³è™½ç„¶æŒ¨äº†éª‚, ä½†æ˜¯æŒºå€¼å¾—.</p>
<p>ç°åœ¨äº’è”ç½‘å¾ˆå‘è¾¾, æƒ³å­¦ä¹ çš„ä¸œè¥¿åŸºæœ¬ç½‘ä¸Šéƒ½æœ‰, ä½ å¯ä»¥æ²¡æœ‰æ™ºå•†, æ²¡æœ‰æƒ…å•†, ä½†æ˜¯ä½ ä¸€å®šè¦æœ‰ <code>æœå•† (æœç´¢èƒ½åŠ›)</code>.<br>å½“ä½ è‡ªå·±ç»è¿‡æ€è€ƒ, æ— æ³•è§£å†³é—®é¢˜, å°±å»æœç´¢ç›¸å…³çš„çŸ¥è¯†, å¦‚æœæœç´¢ä¹Ÿå¤±è´¥äº†, å†å»è¯·æ•™åˆ«äºº, è¿™æ ·ä½ å°±å¯ä»¥ä»ä¸­æ”¶è·æ„å¤–çš„æƒŠå–œ.</p>
<p>æ‰€ä»¥, å­¦ä¹ æ¸ é“çš„é‡è¦æ¥æºä¹‹ä¸€å°±æ˜¯åœ¨äº’è”ç½‘æœç´¢, åŸ¹å…»è‡ªå·±çš„æœç´¢èƒ½åŠ›å¾ˆé‡è¦, æˆ‘å»ºè®®å¤§å®¶ä½¿ç”¨è°·æ­Œæµè§ˆå™¨, ç„¶åä½¿ç”¨ google çš„æœç´¢å¼•æ“, æ­å»ºä¸€å¥—ç¿»å¢™çš„ VPN, è¿™æ ·ä½ å¯ä»¥åœ¨çŸ¥è¯†çš„æµ·æ´‹é‡Œçˆ½ç¿».</p>
<p>å¦å¤–ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å­¦ä¹ æ¸ é“å°±æ˜¯ä½ è®¤ä¸ºçš„ç‰›äºº, å‘ä»–ä»¬å­¦ä¹ ç›¸å…³çš„å­¦ä¹ æ–¹æ³•, é—®ä»–ä»¬æ˜¯æ€ä¹ˆå­¦ä¹ çš„, ç„¶åç»“åˆè‡ªå·±çš„å®é™…æƒ…å†µåŠ ä»¥è¿ç”¨, è·Ÿä»–ä»¬å¤šäº¤æµ.</p>
<h2 id="å¯¹è‡ªå·±â€™ç‹ â€™ä¸€äº›"><a href="#å¯¹è‡ªå·±â€™ç‹ â€™ä¸€äº›" class="headerlink" title="å¯¹è‡ªå·±â€™ç‹ â€™ä¸€äº›"></a>å¯¹è‡ªå·±â€™ç‹ â€™ä¸€äº›</h2><p>æˆ‘ä¹‹å‰æœ‰ä¸ªåä¹ æƒ¯, å–œæ¬¢æ™šä¸Šèººåœ¨åºŠä¸Šçœ‹è§†é¢‘, è¿™äº›è§†é¢‘å¯èƒ½æ˜¯ä¼˜é…·æˆ–è€…è…¾è®¯è§†é¢‘å®¢æˆ·ç«¯çš„, ä¹Ÿæœ‰å¯èƒ½æ˜¯æ–°é—»ç±»çš„ app æ¥æºçš„è§†é¢‘.<br>è§†é¢‘åªè¦çœ‹èµ·æ¥, æ—¶é—´å°±ä¸å—æ§åˆ¶äº†.ç¬¬äºŒå¤©æ—©æ™¨èµ·åºŠä¹Ÿå¾ˆå›°éš¾.</p>
<p>æœ€åè‡ªå·±æŠŠè§†é¢‘ç±»å’Œæ–°é—»ç±» app å…¨éƒ¨å¸è½½æ‰äº†, ç„¶åæŠŠç›®æ ‡è½¬ç§»åˆ° stackoverflow å’Œ github ä¸Šé¢.<br>é‚£é‡Œæ‰æ˜¯ç¨‹åºå‘˜çš„ä¸–ç•Œ, åªæœ‰ä½ æƒ³ä¸åˆ°çš„, æ²¡æœ‰åšä¸åˆ°çš„.</p>
<p>ä¸ºäº†å­¦ä¹ æ–°çŸ¥è¯†, ä½ éœ€è¦å¯¹è‡ªå·±ç‹ ä¸€ç‚¹, æ¯å¤©æ‹¿ç‚¹æ—¶é—´å‡ºæ¥æ€»ç»“å’Œå­¦ä¹ , ä¸€ä¸ªæœˆä¸€ä¸ªå­£åº¦ä¸€å¹´ä¸‹æ¥, ä½ æ¯”åˆ«äººéƒ½è¿›æ­¥äº†å¾ˆå¤š.</p>
<p>å…»æˆä¸€ä¸ªå¥½ä¹ æƒ¯, ç»ˆç”Ÿå—ç›Š.</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> å­¦ä¹  ç”Ÿæ´» åæ€ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS: èŠèŠ UIWebView ç¼“å­˜]]></title>
      <url>/2017/01/15/iOS-%E8%81%8A%E8%81%8A-UIWebView-%E7%BC%93%E5%AD%98/</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨å¼€å‘é¡¹ç›®è¿‡ç¨‹ä¸­, ä¸€äº›è‹¥äº¤äº’çš„é¡µé¢ä¼šä½¿ç”¨ HTML å±•ç¤º.</p>
<p>åœ¨ iOS ä¸­, ä½¿ç”¨ UIWebView çš„é¢‘ç‡è¿˜æ˜¯æ¯”è¾ƒé«˜çš„.</p>
<p>ä»Šå¤©è·Ÿå¤§å®¶èŠèŠ UIWebView ç¼“å­˜ç›¸å…³çš„è¯é¢˜.</p>
<h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>æˆ‘ä»Šå¤©ä½¿ç”¨ Tomcat æ¥ä½œä¸º web å®¹å™¨, åœ¨æœ¬æœºæ­å»ºä¸€ä¸ª web æœåŠ¡å™¨, ç„¶åä½¿ç”¨ iPhone è®¿é—®è¯¥ web é¡µé¢, å±•ç¤ºå’Œæ¢³ç† UIWebview å…³äºç¼“å­˜çš„é—®é¢˜.</p>
<p>å¦‚æœä½ å¯¹ Tomcat è¿˜ä¸ç†Ÿæ‚‰, å¸Œæœ›ä½ å¯ä»¥å…ˆå»å¤§æ¦‚äº†è§£ä¸€ä¸‹, å¦‚ä½•åœ¨ Mac os ä¸Šé¢å®‰è£…å’Œä½¿ç”¨ Tomcat, å¯ä»¥å‚è€ƒæˆ‘çš„åšæ–‡: [Mac é…ç½® Tomcat8].</p>
<blockquote>
<p>Tomcat æ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç ã€è¿è¡Œ servlet å’Œ JSP Web åº”ç”¨è½¯ä»¶çš„åŸºäº Java çš„ Web åº”ç”¨è½¯ä»¶å®¹å™¨.<br>Tomcat Server æ˜¯æ ¹æ® servlet å’Œ JSP è§„èŒƒæ‰§è¡Œçš„ï¼Œå› æ­¤å¯ä»¥è¯´ Tomcat Server å®è¡Œäº† Apache-Jakarta è§„èŒƒï¼Œä¸”æ¯”ç»å¤§å¤šæ•°å•†ä¸šåº”ç”¨è½¯ä»¶æœåŠ¡å™¨è¦å¥½.<br>ä½†æ˜¯ Tomcat å¯¹é™æ€æ–‡ä»¶ã€é«˜å¹¶å‘çš„å¤„ç†æ¯”è¾ƒå¼±.</p>
</blockquote>
<p>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™, æˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬åˆ†åˆ«æ˜¯ <code>apache-tomcat-8.5.8</code>, <code>jdk1.8</code>.</p>
<h2 id="é…ç½®-Tomcat"><a href="#é…ç½®-Tomcat" class="headerlink" title="é…ç½® Tomcat"></a>é…ç½® Tomcat</h2><h3 id="ä¿®æ”¹-server-xml-æ–‡ä»¶"><a href="#ä¿®æ”¹-server-xml-æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹ server.xml æ–‡ä»¶"></a>ä¿®æ”¹ server.xml æ–‡ä»¶</h3><p>æ–‡ä»¶åœ¨ Tomcat çš„æ ¹ç›®å½•çš„ conf ç›®å½•ä¸‹, å¦‚æˆ‘çš„æ–‡ä»¶åœ¨è¿™ä¸ªç›®å½•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apache-tomcat-8.5.8/conf/server.xml</div></pre></td></tr></table></figure>
<p>å¢åŠ å¦‚ä¸‹å†…å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;Host name=&quot;&lt;your local ip&gt;&quot; debug=&quot;0&quot; appBase=&quot;&lt;base dir&gt;&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</div><div class="line">    &lt;Context path=&quot;&quot; docBase=&quot;&lt;html file path&gt;&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</div><div class="line">    &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</div><div class="line">&lt;/Host&gt;</div></pre></td></tr></table></figure>
<p>æ³¨æ„:<br>1.å°†ä¸Šè¿°å†…å®¹æ”¾åˆ° <code>&lt;/Host&gt;</code> å’Œ <code>&lt;/Engine&gt;</code> èŠ‚ç‚¹ä¸­é—´.<br>2.å°† <code>name=&quot;&lt;your local ip&gt;&quot;</code> ä¸­çš„ <your local="" ip=""> æ”¹ä¸ºä½ æœ¬æœºçš„ ip åœ°å€.<br>æŸ¥çœ‹æœ¬æœºçš„ ip åœ°å€æ–¹æ³•å¾ˆç®€å•:</your></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ifconfig | grep &quot;inet &quot; | grep -v 127.0.0.1</div></pre></td></tr></table></figure>
<p>3.å°† appBase=â€<base dir="">â€œ ä¸­çš„ <base dir=""> æ”¹ä¸ºä½ çš„ web ç›®å½•.<br>4.å°† docBase=â€<html file="" path="">â€œ ä¸­çš„ <html file="" path=""> æ”¹ä¸ºä½ çš„ html ç›®å½•.</html></html></p>
<p>æˆ‘çš„é…ç½®å¦‚ä¸‹(éƒ¨åˆ†):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">    &lt;Host name=&quot;localhost&quot;  appBase=&quot;webapps&quot;</div><div class="line">            unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;</div><div class="line">        &lt;!-- SingleSignOn valve, share authentication between web applications</div><div class="line">             Documentation at: /docs/config/valve.html --&gt;</div><div class="line">        &lt;!--</div><div class="line">        &lt;Valve className=&quot;org.apache.catalina.authenticator.SingleSignOn&quot; /&gt;</div><div class="line">        --&gt;</div><div class="line">        &lt;!-- Access log processes all example.</div><div class="line">             Documentation at: /docs/config/valve.html</div><div class="line">             Note: The pattern used is equivalent to using pattern=&quot;common&quot; --&gt;</div><div class="line">        &lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;</div><div class="line">               prefix=&quot;localhost_access_log&quot; suffix=&quot;.txt&quot;</div><div class="line">               pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;</div><div class="line">    &lt;/Host&gt;</div><div class="line">        &lt;!--mark é…ç½®é™æ€ç½‘é¡µ. [BEGIN] --&gt;</div><div class="line">        &lt;Host name=&quot;192.168.1.103&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot;  xmlNamespaceAware=&quot;false&quot;&gt;</div><div class="line">            &lt;Context path=&quot;&quot; docBase=&quot;test&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; crossContext=&quot;true&quot;/&gt;</div><div class="line">            &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot; directory=&quot;logs&quot; prefix=&quot;tot_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&gt;</div><div class="line">        &lt;/Host&gt;</div><div class="line">        &lt;!--mark é…ç½®é™æ€ç½‘é¡µ. [END] --&gt;</div><div class="line">    &lt;/Engine&gt;</div><div class="line">  &lt;/Service&gt;</div><div class="line">&lt;/Server&gt;</div></pre></td></tr></table></figure>
<p>æå®šä¸Šé¢çš„é…ç½®, æ¥ä¸‹æ¥å¯ä»¥é…ç½®ç›¸å…³ç›®å½•äº†.</p>
<p>åœ¨ Tomcat çš„æ ¹ç›®å½•æœ‰ä¸ªæ–‡ä»¶å¤¹ webapps, åœ¨ webapps ç›®å½•ä¸‹æ–°å»ºç›®å½• test å³å¯.</p>
<h2 id="æ„å»º-HTML-é¡µé¢"><a href="#æ„å»º-HTML-é¡µé¢" class="headerlink" title="æ„å»º HTML é¡µé¢"></a>æ„å»º HTML é¡µé¢</h2><p>åœ¨ test ç›®å½•, æ–°å»ºä¸€ä¸ª html æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">touch test.html</div></pre></td></tr></table></figure>
<p>æ–‡ä»¶å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"> &lt;p&gt;</div><div class="line">&lt;em&gt;Sample&lt;/em&gt; text&lt;/p&gt;</div><div class="line">&lt;p&gt;</div><div class="line">Now I input another line, with fancy&lt;u&gt;&lt;strong&gt;&lt;em&gt;styles&lt;/em&gt;&lt;/strong&gt;</div><div class="line">&lt;/u&gt;.&lt;/p&gt;</div><div class="line">&lt;p&gt;</div><div class="line">&lt;em&gt;Sample&lt;/em&gt; text&lt;/p&gt;</div><div class="line">&lt;p&gt;</div><div class="line">Now I input another line, with fancy &lt;u&gt;&lt;strong&gt;&lt;em&gt;styles&lt;/em&gt;&lt;/strong&gt;</div><div class="line">&lt;/u&gt;.&lt;/p&gt;</div><div class="line">&lt;p&gt;</div><div class="line">    mark.zhang is itman.</div><div class="line">&lt;/p&gt;</div><div class="line">&lt;style&gt;</div><div class="line">.button &#123;</div><div class="line">    background-color: #4CAF50;</div><div class="line">    border: none;</div><div class="line">    color: white;</div><div class="line">    padding: 15px 32px;</div><div class="line">    text-align: center;</div><div class="line">    text-decoration: none;</div><div class="line">    display: inline-block;</div><div class="line">    font-size: 86px;</div><div class="line">    margin: 50px 200px 100px 300px;</div><div class="line">    cursor: pointer;</div><div class="line">    border-radius: 15;</div><div class="line">&#125;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;p&gt;</div><div class="line">   &lt;button type=&quot;button&quot; onclick=&quot;myFunction()&quot; class=&quot;button&quot;&gt;Try it&lt;/button&gt;</div><div class="line">&lt;/p&gt;</div><div class="line">&lt;script&gt;</div><div class="line">   function myFunction() &#123;</div><div class="line">       alert(&quot;Blog: www.veryitman.com&quot;);</div><div class="line">   &#125;;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>æ­å»ºå®Œæˆå, å¯åŠ¨ Tomcat æœåŠ¡å™¨.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">startup.sh</div></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨é‡Œé¢é€šè¿‡ ip:port/test.html çš„æ–¹å¼æ¥è®¿é—®è¯¥é¡µé¢.</p>
<p>çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„æ•ˆæœå³è¡¨ç¤ºæ­å»ºæˆåŠŸ:</p>
<p><img src="/upload/images/2017/01/15/html.png" alt="1"></p>
<h2 id="å®¢æˆ·ç«¯è®¿é—®"><a href="#å®¢æˆ·ç«¯è®¿é—®" class="headerlink" title="å®¢æˆ·ç«¯è®¿é—®"></a>å®¢æˆ·ç«¯è®¿é—®</h2><p>å®¢æˆ·ç«¯è®¿é—®è¯¥é¡µé¢, ä½¿ç”¨ UIWebview æ¥è¯·æ±‚(HTTP åè®®)é¡µé¢å†…å®¹.</p>
<p>ä¸€èˆ¬è¯·æ±‚ä¼šä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ (instancetype)requestWithURL:(NSURL *)URL;</div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•çš„æè¿°å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Creates and returns a URL request for a specified URL with default cache policy and timeout value.</div><div class="line">The default cache policy is NSURLRequestUseProtocolCachePolicy and the default timeout interval is 60 seconds.</div></pre></td></tr></table></figure>
<p>å¤§æ¦‚æ„æ€æ˜¯ä½¿ç”¨çš„ç¼“å­˜ç­–ç•¥æ˜¯æ ¹æ®åè®®æ¥çš„, å³ NSURLRequestUseProtocolCachePolicy. è¶…æ—¶æ—¶é—´é»˜è®¤æ˜¯60s.</p>
<p>ä¹Ÿå°±æ˜¯è¯´ç±»ä¼¼å¦‚ä¸‹çš„è¯·æ±‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NSURLRequest *urlReq = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60.f];</div></pre></td></tr></table></figure>
<p>å¦‚æœåè®®æ”¯æŒç¼“å­˜çš„è¯, UIWebview è¯·æ±‚åˆ°çš„æ•°æ®å°±æ˜¯ç¼“å­˜æ•°æ®.è¯¥ç¼“å­˜æ˜¯éœ€è¦ WEB æœåŠ¡å™¨æ”¯æŒçš„.</p>
<p>è¿™é‡Œæˆ‘æ²¡æœ‰é…ç½® Tomcat çš„ç¼“å­˜.å¯ä»¥æŠ“åŒ…çœ‹ä¸‹:</p>
<p><img src="/upload/images/2017/01/15/rsp1.png" alt="2"></p>
<p>åç»­åšå®¢ä¼šåˆ†åˆ«ä¸ºå¤§å®¶ä»‹ç»åœ¨ Tomcat å’Œ Nginx é…ç½®ç¼“å­˜ä¸‹, å®¢æˆ·ç«¯ UIWebview è¯·æ±‚çš„ç›¸å…³é—®é¢˜.</p>
<p>å®¢æˆ·ç«¯æ˜¾ç¤ºé¡µé¢æ•ˆæœ:<br><img src="/upload/images/2017/01/15/c1.jpeg" alt="2"></p>
<p>ViewController ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line">#import &quot;ViewController.h&quot;</div><div class="line"></div><div class="line">static NSString * const H5Url = @&quot;http://192.168.1.104:8080/test.html&quot;;</div><div class="line"></div><div class="line">@interface ViewController () &lt;UIWebViewDelegate&gt;</div><div class="line"></div><div class="line">@property (nonatomic, strong) UIWebView *webView;</div><div class="line"></div><div class="line">@property (nonatomic, strong) UIButton *refBtn;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation ViewController</div><div class="line"></div><div class="line">- (void)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    _webView = [[UIWebView alloc] init];</div><div class="line">    CGSize boundsSize = self.view.bounds.size;</div><div class="line">    self.webView.frame = CGRectMake(0, 20, boundsSize.width, boundsSize.height);</div><div class="line">    self.webView.backgroundColor = [UIColor whiteColor];</div><div class="line">    self.webView.scrollView.showsHorizontalScrollIndicator = NO;</div><div class="line">    self.webView.scrollView.showsVerticalScrollIndicator   = NO;</div><div class="line">    self.webView.scalesPageToFit = YES;</div><div class="line">    self.webView.delegate = self;</div><div class="line">    [self.view addSubview:self.webView];</div><div class="line">    </div><div class="line">    UIButton *refreshBtn = [UIButton buttonWithType:UIButtonTypeCustom];</div><div class="line">    [self.view addSubview:refreshBtn];</div><div class="line">    [refreshBtn addTarget:self action:@selector(onRefreshWebView) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    refreshBtn.backgroundColor = [UIColor redColor];</div><div class="line">    refreshBtn.layer.masksToBounds = YES;</div><div class="line">    refreshBtn.layer.cornerRadius = 5.f;</div><div class="line">    refreshBtn.frame = CGRectMake(50, 250, 200, 50);</div><div class="line">    [refreshBtn setTitle:@&quot;åˆ·æ–°é¡µé¢&quot; forState:UIControlStateNormal];</div><div class="line">    _refBtn = refreshBtn;</div><div class="line">    </div><div class="line">    [self loadDataUsingCache];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error</div><div class="line">&#123;</div><div class="line">    NSLog(@&quot;didFailLoadWithError: %@&quot;, error);</div><div class="line">    </div><div class="line">    [self hideLoading];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request</div><div class="line"> navigationType:(UIWebViewNavigationType)navigationType</div><div class="line">&#123;</div><div class="line">    NSLog(@&quot;shouldStartLoadWithRequest: %@&quot;, request);</div><div class="line">    return YES;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)webViewDidStartLoad:(UIWebView *)webView</div><div class="line">&#123;</div><div class="line">    NSLog(@&quot;webViewDidStartLoad&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)webViewDidFinishLoad:(UIWebView *)webView</div><div class="line">&#123;</div><div class="line">    NSLog(@&quot;webViewDidFinishLoad&quot;);</div><div class="line">    </div><div class="line">    [self hideLoading];</div><div class="line">&#125;</div><div class="line"></div><div class="line">//åˆ·æ–°é¡µé¢.</div><div class="line">- (void)onRefreshWebView</div><div class="line">&#123;</div><div class="line">    // æ–¹å¼1: ä¸ä½¿ç”¨ç¼“å­˜è¯·æ±‚æ•°æ®</div><div class="line">    //[self loadDataNoUsingCache];</div><div class="line">    </div><div class="line">    // æ–¹å¼2: æ¸…é™¤ NSCache ç¼“å­˜, å†è¯·æ±‚æ•°æ®</div><div class="line">    [self clearAllCache];</div><div class="line">    [self loadDataUsingCache];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)loadDataUsingCache</div><div class="line">&#123;</div><div class="line">    [self showLoading];</div><div class="line">    </div><div class="line">    NSURL *url = [NSURL URLWithString:H5Url];</div><div class="line">    </div><div class="line">    NSURLRequest *urlReq = [NSURLRequest requestWithURL:url</div><div class="line">                                            cachePolicy:NSURLRequestReturnCacheDataDontLoad</div><div class="line">                                        timeoutInterval:10.f];</div><div class="line">    </div><div class="line">    [self.webView loadRequest:urlReq];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)loadDataWithProtocol</div><div class="line">&#123;</div><div class="line">    [self showLoading];</div><div class="line">    </div><div class="line">    NSURL *url = [NSURL URLWithString:H5Url];</div><div class="line">    </div><div class="line">    [NSURLRequest requestWithURL:url];</div><div class="line">    </div><div class="line">    NSURLRequest *urlReq = [NSURLRequest requestWithURL:url</div><div class="line">                                            cachePolicy:NSURLRequestUseProtocolCachePolicy</div><div class="line">                                        timeoutInterval:60.f];</div><div class="line">    </div><div class="line">    [self.webView loadRequest:urlReq];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)loadDataNoUsingCache</div><div class="line">&#123;</div><div class="line">    [self showLoading];</div><div class="line">    </div><div class="line">    NSURL *url = [NSURL URLWithString:H5Url];</div><div class="line">    NSURLRequest *urlReq = [NSURLRequest requestWithURL:url</div><div class="line">                                            cachePolicy:NSURLRequestReloadIgnoringCacheData</div><div class="line">                                        timeoutInterval:20.0];</div><div class="line">    [self.webView loadRequest:urlReq];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)clearAllCache</div><div class="line">&#123;</div><div class="line">    // remove cache rsp</div><div class="line">    [[NSURLCache sharedURLCache] removeAllCachedResponses];</div><div class="line">    </div><div class="line">    [[NSURLCache sharedURLCache] setDiskCapacity:0];</div><div class="line">    [[NSURLCache sharedURLCache] setMemoryCapacity:0];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)showLoading</div><div class="line">&#123;</div><div class="line">    [self.refBtn setTitle:@&quot;åˆ·æ–°ä¸­...&quot; forState:UIControlStateNormal];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)hideLoading</div><div class="line">&#123;</div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">        [self.refBtn setTitle:@&quot;åˆ·æ–°é¡µé¢&quot; forState:UIControlStateNormal];</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæ³¨æ„ä¸‹é¢çš„ ä¸‰ä¸ªæ–¹æ³• :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// ä½¿ç”¨ç¼“å­˜æ•°æ®, å¦‚æœæœ‰ç¼“å­˜çš„è¯</div><div class="line">// ä½¿ç”¨è¿™ä¸ªæ–¹æ³•, æ”¹å˜ HTML æˆ–è€… JS ä»£ç </div><div class="line">// é¡µé¢ä¸ä¼šæ‹‰å–æœ€æ–°æ•°æ®, è¿˜æ˜¯ä½¿ç”¨ä¹‹å‰è¯·æ±‚åˆ°çš„æ•°æ®.</div><div class="line">// é™¤éé‡æ–°åˆ·æ–°</div><div class="line">- (void)loadDataUsingCache;</div><div class="line">// ä½¿ç”¨åè®®ç¼“å­˜, éœ€è¦ web æœåŠ¡å™¨æ”¯æŒ.</div><div class="line">- (void)loadDataWithProtocol;</div><div class="line">// ä¸ä½¿ç”¨ç¼“å­˜, åŠ è½½æ•°æ®</div><div class="line">- (void)loadDataNoUsingCache;</div></pre></td></tr></table></figure>
<p>å¦å¤–, åˆ·æ–° UIWebview çš„æ–¹å¼å¦‚ä¸‹, æœ‰ ä¸¤ç§æ–¹å¼ æ¥åˆ·æ–°é¡µé¢:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> *  åˆ·æ–°é¡µé¢.</div><div class="line"> */</div><div class="line">- (void)onRefreshWebView</div><div class="line">&#123;</div><div class="line">    // æ–¹å¼1: ä¸ä½¿ç”¨ç¼“å­˜è¯·æ±‚æ•°æ®</div><div class="line">    //[self loadDataNoUsingCache];</div><div class="line">    </div><div class="line">    // æ–¹å¼2: æ¸…é™¤ NSCache ç¼“å­˜, å†è¯·æ±‚æ•°æ®</div><div class="line">    [self clearAllCache];</div><div class="line">    [self loadDataUsingCache];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ç§åˆ·æ–°æ–¹å¼, ä¼šé‡æ–°åŠ è½½æ•°æ®.<br>ä½†æ˜¯ä¸é€‚åˆå¤šå±‚çº§çš„ HTML é¡µé¢, æ¯”å¦‚ä½ çš„ HTML é¡µé¢æœ‰å¾ˆå¤šå±‚, æƒ³åˆ·æ–°å½“å‰é¡µé¢, å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// é‡æ–°åŠ è½½å½“å‰é¡µé¢</div><div class="line">[self.webView reload];</div></pre></td></tr></table></figure>
<h2 id="é™„åŠ "><a href="#é™„åŠ " class="headerlink" title="é™„åŠ "></a>é™„åŠ </h2><p>æŸ¥çœ‹æœ¬æœº IP çš„ shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">ifconfig | grep &quot;inet &quot; | grep -v 127.0.0.1</div></pre></td></tr></table></figure>
<p>åœæ­¢ Tomcat çš„è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shutdown.sh</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS UIWebView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[f8app]]></title>
      <url>/2017/01/01/f8app/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦æ¢è®¨çš„æ˜¯å¦‚ä½•ç¼–è¯‘å’Œè¿è¡Œ f8app.</p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p><code>f8app</code> æ˜¯ Facebook å¼€æºçš„, åŸºäº React Native å¼€å‘çš„ä¸€æ¬¾ App.</p>
<p>ä»£ç åŸºæœ¬éƒ½æ˜¯ js çš„, å¾ˆå°‘æœ‰åŸç”Ÿçš„ä»£ç .</p>
<p><code>f8app</code> æ˜¯å€Ÿé‰´å’Œå­¦ä¹  React Native çš„ä¸Šå¥½èµ„æ–™.</p>
<p>åŸæ–‡ä»‹ç»:</p>
<blockquote>
<p>This is the entire source code of the official F8 app of 2016, available on Google Play and the App Store.</p>
</blockquote>
<p>é¡¹ç›®å¼€æºåœ°å€: <a href="https://github.com/fbsamples/f8app" target="_blank" rel="noopener">Github</a></p>
<h2 id="ç¼–è¯‘è¿è¡Œ"><a href="#ç¼–è¯‘è¿è¡Œ" class="headerlink" title="ç¼–è¯‘è¿è¡Œ"></a>ç¼–è¯‘è¿è¡Œ</h2><h3 id="ç¯å¢ƒè¦æ±‚"><a href="#ç¯å¢ƒè¦æ±‚" class="headerlink" title="ç¯å¢ƒè¦æ±‚"></a>ç¯å¢ƒè¦æ±‚</h3><ul>
<li>å®‰è£…å’Œé…ç½®äº† React Native å¼€å‘ç¯å¢ƒ.</li>
<li>Xcode 7.3 +</li>
<li>CocoaPods (only for iOS) 1.0+</li>
<li>MongoDB (needed to run Parse Server locally)</li>
</ul>
<h3 id="æºç æ„å»º"><a href="#æºç æ„å»º" class="headerlink" title="æºç æ„å»º"></a>æºç æ„å»º</h3><p>ä¸‹è½½æºç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/fbsamples/f8app.git</div></pre></td></tr></table></figure>
<p>ä¸‹è½½å®Œæˆå, è¿›å…¥ä¸‹è½½çš„ f8app ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd f8app</div><div class="line">npm install</div></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯ iOS çš„è¯, éœ€è¦è¿›å…¥ iOS ç›®å½•æ‰§è¡Œ <code>pod install</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd ios</div><div class="line">pod install</div></pre></td></tr></table></figure>
<p>åœ¨é¡¹ç›® f8app ç›®å½•ä¸‹è¿è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm start</div></pre></td></tr></table></figure>
<p>æ‰“å¼€æµè§ˆå™¨è¾“å…¥åœ°å€ <a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a>, å¯ä»¥çœ‹åˆ° graphql çš„ç•Œé¢.</p>
<h3 id="å®‰è£…-MongoDB"><a href="#å®‰è£…-MongoDB" class="headerlink" title="å®‰è£… MongoDB"></a>å®‰è£… MongoDB</h3><p>ä½¿ç”¨ Homebrew æ¥å®‰è£….</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install mongodb</div></pre></td></tr></table></figure>
<h3 id="å¯¼å…¥æ•°æ®"><a href="#å¯¼å…¥æ•°æ®" class="headerlink" title="å¯¼å…¥æ•°æ®"></a>å¯¼å…¥æ•°æ®</h3><p>å¯¼å…¥ä¾‹å­æ•°æ®.</p>
<p>æ³¨æ„:<br>åœ¨æºç çš„è·¯å¾„å³ <code>~/yourpath/f8app</code> ä¸‹é¢æ‰§è¡Œ, ä¸‹é¢æ“ä½œæ²¡æœ‰ç‰¹æ®Šè¯´æ˜éƒ½æ˜¯åœ¨æºç æ ¹ç›®å½•ä¸‹é¢æ“ä½œ.<br>ä½ å¯ä»¥å¤šå¼€å‡ ä¸ªç»ˆç«¯ç«¯å£æ¥è¿›è¡Œæ“ä½œ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm run import-data</div></pre></td></tr></table></figure>
<p>å¯¼å…¥ä¾‹å­æ•°æ®, ä¼šæŠ¥ä¸‹é¢çš„ é”™è¯¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">error: Uncaught internal server error. &#123; [MongoError: connect ECONNREFUSED 127.0.0.1:27017]</div><div class="line">name: &apos;MongoError&apos;,</div><div class="line">message: &apos;connect ECONNREFUSED 127.0.0.1:27017&apos; &#125; Error: connect ECONNREFUSED 127.0.0.1:27017</div><div class="line">at Object.exports._errnoException (util.js:893:11)</div><div class="line">at exports._exceptionWithHostPort (util.js:916:20)</div><div class="line">at TCPConnectWrap.afterConnect as oncomplete</div></pre></td></tr></table></figure>
<p>éœ€è¦å®‰è£… <code>mongodb-runner</code></p>
<p>å®‰è£…æ–¹æ³•å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo npm install -g parse-server mongodb-runner</div></pre></td></tr></table></figure>
<p>è¿è¡Œ <code>mongodb-runner</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongodb-runner start</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæ‰§è¡Œå®Œæ¯•å, éœ€è¦ç­‰å¾…ä¸€ä¼š.</p>
<p>ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Starting a MongoDB deployment to test against...</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿è¡Œç»“æŸå, ä½ å¯ä»¥æŸ¥çœ‹ MongoDB æ˜¯å¦åœ¨è¿è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lsof -iTCP:27017 -sTCP:LISTEN</div></pre></td></tr></table></figure>
<p>ä¼šæ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">COMMAND   PID USER   FD   TYPE             DEVICE    SIZE/OFF  NODE  NAME</div><div class="line">mongod  86824 mark    7u  IPv4    0x91959c43a65644ed      0t0  TCP *:27017 (LISTEN)</div></pre></td></tr></table></figure>
<p>åœæ­¢ mongodb è¿è¡Œçš„æ–¹å¼å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongodb-runner stop</div></pre></td></tr></table></figure>
<h2 id="æŸ¥çœ‹æ•°æ®"><a href="#æŸ¥çœ‹æ•°æ®" class="headerlink" title="æŸ¥çœ‹æ•°æ®"></a>æŸ¥çœ‹æ•°æ®</h2><p><a href="http://localhost:8080/dashboard" target="_blank" rel="noopener">Parse Dashboard</a></p>
<p><a href="http://localhost:8080/graphql" target="_blank" rel="noopener">GraphiQL</a></p>
<h3 id="å¯åŠ¨-react-native"><a href="#å¯åŠ¨-react-native" class="headerlink" title="å¯åŠ¨ react-native"></a>å¯åŠ¨ react-native</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native start</div></pre></td></tr></table></figure>
<h3 id="è¿è¡Œ-f8app"><a href="#è¿è¡Œ-f8app" class="headerlink" title="è¿è¡Œ f8app"></a>è¿è¡Œ f8app</h3><p>Android:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">react-native run-android</div><div class="line">adb reverse tcp:8081 tcp:8081   # required to ensure the Android app can</div><div class="line">adb reverse tcp:8080 tcp:8080   # access the Packager and GraphQL server</div></pre></td></tr></table></figure>
<p>iOS:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native run-ios</div></pre></td></tr></table></figure>
<p>å¦‚æœå‡ºç°çº¢è‰²èƒŒæ™¯çš„ error æç¤º, å¯ä»¥ä¸ç®¡, ç›´æ¥ Dismiss å³å¯.</p>
<p>ç„¶åå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç•Œé¢:</p>
<p><img src="/upload/images/2017/01/01/f8app.jpg" alt="1"></p>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>1.åœ¨è¿è¡Œåå…³é—­ç™»å½•æŒ‰é’®, æŠ¥é”™: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">AppEventsLogger.logEvent</div></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ¡ˆ:</p>
<p>åœ¨ <code>/js/store/track.js</code> æ–‡ä»¶çš„ç¬¬ 43 è¡Œ, æ³¨é‡Šæ‰ log, å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">case &apos;SKIPPED_LOGIN&apos;:</div><div class="line">      //AppEventsLogger.logEvent(&apos;Skip login&apos;, 1);</div><div class="line">      break;</div></pre></td></tr></table></figure>
<p>åœ¨æ¨¡æ‹Ÿå™¨ä¸Šé¢é‡æ–° Reload å³å¯.</p>
]]></content>
      
        <categories>
            
            <category> ReactNative </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS Android JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å†è§ 2016]]></title>
      <url>/2016/12/31/%E5%86%8D%E8%A7%81-2016/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯2016å¹´çš„æœ€åä¸€å¤©ï¼Œæ­£å¥½èµ¶ä¸Šæ”¾å‡ï¼Œç»™è‡ªå·±çš„è¿™ä¸€å¹´åšä¸ªå°ç»“ã€‚</p>
<p>2016ï¼Œç»§ç»­åšé¡¹ç›®ï¼Œä½œä¸ºä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œä¸åœåœ°åœ¨å­¦ä¹ ã€‚</p>
<p>2016ï¼Œå­¦ä¹ åˆ°äº†å¾ˆå¤šå…³äºäº§å“å’Œè¿è¥ç›¸å…³çš„çŸ¥è¯†ã€‚çŸ¥é“äº† <code>å€’é€¼</code> çš„ä½œç”¨.</p>
<p>2016ï¼Œè¯»äº†20æœ¬éæŠ€æœ¯ç±»ä¹¦ç±ï¼Œå…»æˆäº†è¯»ä¹¦çš„ä¹ æƒ¯ï¼Œå¹¶æŠŠè¯»ä¹¦çš„å¥½å¤„è®²ç»™èº«è¾¹çš„äººå¬ã€‚</p>
<p>2016ï¼Œå¼€å§‹å‡è‚¥ï¼Œæ³¨æ„é”»ç‚¼èº«ä½“ï¼Œå‡ ä¹æ¯å‘¨éƒ½æœ‰ä¸€æ¬¡ä»å…¬å¸åˆ°å®¶çš„æ­¥è¡Œï¼Œä¸€æ¬¡ç¯®çƒæˆ–è€…è·‘æ­¥è¿åŠ¨ã€‚</p>
<p>2016ï¼Œè´­ä¹°äº†åŸŸåï¼Œå»ºç«‹äº†è‡ªå·±çš„ <a href="file:///Users/mark/Desktop/backups/public/2016/12/31/veryitman.com" target="_blank" rel="noopener">åšå®¢ç½‘ç«™</a>ã€‚</p>
<p>2016ï¼Œå„¿å­å¤§äº†ä¸€å²ï¼Œè‡ªå·±è€äº†ä¸€å²ï¼Œå®¶åº­ä¾æ—§å¹¸ç¦ç€ã€‚æ¸æ¸åœ°ç†è§£äº†åšçˆ¶äº²çš„è´£ä»»ã€‚</p>
<p>2016ï¼Œå¯¹è‡ªå·±å½±å“æœ€å¤§çš„å‡ å¥è¯ï¼Œåˆ†äº«ç»™å¤§å®¶:</p>
<p><strong>1. æŠ€æœ¯è¦ç»™äº§å“æä¾›æœ€å¤§çš„è‡ªç”±åº¦.</strong></p>
<p><strong>2. ä¸è¦è½»æ˜“çš„è¯´ NO.</strong></p>
<p><strong>3. è¦ä¸æ–­çš„è®©è‡ªå·±å€¼é’±, è€Œä¸æ˜¯ç®€å•çš„ä¸ºäº†é‡‘é’±è€Œè·³æ§½.</strong></p>
<p><strong>4. ä¸è¦æ€»æ˜¯æŠ±æ€¨ä½ çš„äº§å“è®¾è®¡æ˜¯ç‹—å±, å­¦ä¼šå’Œäº§å“æ²Ÿé€šæ›´ä¼˜çš„æ–¹æ¡ˆ.</strong></p>
<p><strong>5. å…³æ³¨ç»†èŠ‚, æŠŠäº§å“åšå¥½.</strong></p>
<p><strong>6. å¤šå…³æ³¨åˆ«äººçš„ä¼˜ç‚¹.</strong></p>
<p><strong>7. è®©å¯¹æ–¹æŠŠè¯è¯´å®Œ.</strong></p>
<p><strong>8. å¤šçœ‹ä¹¦, å¤šæ€è€ƒ.</strong></p>
<p>æ„Ÿè°¢æ‰€æœ‰é™ªä¼´å’Œæ”¯æŒæˆ‘çš„æœ‹å‹ï¼ŒåŒäº‹ï¼Œäº²äººï¼</p>
<p>ç¥æ„¿æ‰€æœ‰äºº2017å¹¸ç¦ã€å¥åº·ã€å¿«ä¹ï¼</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mac é…ç½® Tomcat8]]></title>
      <url>/2016/11/26/Mac-%E9%85%8D%E7%BD%AE-Tomcat8/</url>
      <content type="html"><![CDATA[<h2 id="Tomcat-ç®€ä»‹"><a href="#Tomcat-ç®€ä»‹" class="headerlink" title="Tomcat ç®€ä»‹"></a>Tomcat ç®€ä»‹</h2><p>Tomcat æ˜¯ä¸€ä¸ª Web æœåŠ¡å™¨.</p>
<blockquote>
<p>Web æœåŠ¡å™¨æ˜¯æŒ‡ä¸ºç‰¹å®šç»„ä»¶æä¾›æœåŠ¡çš„ä¸€ä¸ªæ ‡å‡†åŒ–çš„è¿è¡Œæ—¶çš„ç¯å¢ƒ.<br>å¯ä¸ºç»„ä»¶æä¾›äº‹åŠ¡å¤„ç†, æ•°æ®è®¿é—®, å®‰å…¨æ€§å’ŒæŒä¹…æ€§ç­‰æœåŠ¡.</p>
</blockquote>
<p>Tomcat æ˜¯å…è´¹ä¸”å¼€æºçš„, ä»–æ˜¯ Apache è½¯ä»¶åŸºé‡‘ä¼š Jakarta é¡¹ç›®ä¸­çš„å…¶ä¸­ä¸€ä¸ªå­é¡¹ç›®.ç”± Apache, Sun å’Œå…¶ä»–ä¸€äº›å…¬å¸åŠä¸ªäººå…±åŒå¼€å‘å®Œæˆ.</p>
<p>Tomcat ä¹Ÿæ˜¯ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ JSP æœåŠ¡å™¨.</p>
<blockquote>
<p>JSP æ˜¯ Java Server Pages çš„ç®€ç§°, æ˜¯åœ¨ä¼ ç»Ÿçš„ HTML æ–‡ä»¶ä¸­æ’å…¥ Java ç¨‹åºæ®µå’Œ JSP æ ‡è®°çš„ä¸€ç§åŠ¨æ€ç½‘é¡µæŠ€æœ¯.</p>
</blockquote>
<h2 id="ä¸‹è½½-Tomcat"><a href="#ä¸‹è½½-Tomcat" class="headerlink" title="ä¸‹è½½ Tomcat"></a>ä¸‹è½½ Tomcat</h2><p>å‰å¾€ <a href="http://tomcat.apache.org/download-80.cgi" target="_blank" rel="noopener">è¿™é‡Œ</a> å¯ä»¥ä¸‹è½½ Tomcat.</p>
<p>æˆ‘ç›®å‰å®‰è£…çš„æ˜¯ 8.5.8 ç‰ˆæœ¬çš„.</p>
<p><img src="/upload/images/2016/11/26/tomcat1.png" alt="1"></p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å…ˆå®‰è£… JDK, å®‰è£…æ•™ç¨‹å¯ä»¥å‚è€ƒ [Mac é…ç½® JDK1.8] è¿™ç¯‡æ–‡ç« .</p>
<p>è§£å‹ä¸‹è½½çš„ tar.gz å³å¯.</p>
<p>æœ€å¥½è§£å‹åˆ°è‡ªå·±çš„å·¥ä½œç›®å½•, å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~/workspace/developr/</div></pre></td></tr></table></figure>
<h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p>ç¼–è¾‘ <code>/etc/profile</code> æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/profile</div></pre></td></tr></table></figure>
<p>æ·»åŠ å¦‚ä¸‹å˜é‡:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">JRE_HOME=$JAVA_HOME</div><div class="line">TOMCAT_HOME=/Users/mark/developer/apache/apache-tomcat-8.5.8</div><div class="line">PATH=$JAVA_HOME/bin:$TOMCAT_HOME/bin:$PATH</div><div class="line">export JRE_HOME</div><div class="line">export PATH</div></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„ JAVA_HOME æ˜¯ [Mac é…ç½® JDK1.8] è¿™ç¯‡æ–‡ç« é‡Œé¢è®¾ç½®çš„ JDK çš„ç¯å¢ƒå˜é‡.</p>
<p>é…ç½®ç¯å¢ƒå˜é‡çš„ç›®çš„, å¯ä»¥è®©æˆ‘ä»¬æ–¹ä¾¿çš„ä½¿ç”¨ Tomcat çš„å‘½ä»¤.</p>
<h2 id="æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ"><a href="#æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ" class="headerlink" title="æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ"></a>æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ</h2><p>ä½¿ <code>/etc/profile</code> é…ç½®æ–‡ä»¶ç«‹å³ç”Ÿæ•ˆ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source /etc/profile</div></pre></td></tr></table></figure>
<p>å¦‚æœæ²¡æœ‰ç”Ÿæ•ˆ, é‡å¯ç»ˆç«¯å³å¯.</p>
<p>å¼€å¯ Tomcat æœåŠ¡, æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">startup.sh</div></pre></td></tr></table></figure>
<p>è¯¥å‘½ä»¤åœ¨ Tomcat çš„å®‰è£…ç›®å½•çš„ bin ç›®å½•ä¸‹é¢.</p>
<p>æ‰§è¡Œå, å¯ä»¥çœ‹åˆ°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Using CATALINA_BASE:   /Users/mark/developer/apache/apache-tomcat-8.5.8</div><div class="line">Using CATALINA_HOME:   /Users/mark/developer/apache/apache-tomcat-8.5.8</div><div class="line">Using CATALINA_TMPDIR: /Users/mark/developer/apache/apache-tomcat-8.5.8/temp</div><div class="line">Using JRE_HOME:        /Library/Java/JavaVirtualMachines/jdk1.8.0_112.jdk/Contents/Home</div><div class="line">Using CLASSPATH:       /Users/mark/developer/apache/apache-tomcat-8.5.8/bin/bootstrap.jar:/Users/mark/developer/apache/apache-tomcat-8.5.8/bin/tomcat-juli.jar</div><div class="line">Tomcat started.</div></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨é‡Œé¢æ‰“å¼€: <a href="http://localhost:8080/" target="_blank" rel="noopener">http://localhost:8080/</a></p>
<p>å³å¯çœ‹åˆ°ä¸€åªå¯çˆ±çš„ Tom çŒ«.</p>
<p>æ‰§è¡Œ <code>shutdown.sh</code> å¯ä»¥å…³é—­ Tomcat.</p>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Tomcat Java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mac å®‰è£…å’Œä½¿ç”¨ infer]]></title>
      <url>/2016/11/26/Mac-%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8-infer/</url>
      <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>infer æ˜¯ Facebook å¼€æºçš„ä¸€æ¬¾ä»£ç é™æ€æ£€æŸ¥å·¥å…·, æºç å¯ä»¥åœ¨ <a href="https://github.com/facebook/infer" target="_blank" rel="noopener">Github</a> ä¸Šé¢è·å–.</p>
<p>æ”¯æŒ Java/C/OC ç­‰è¯­è¨€, æ”¯æŒ Gradle, Buck, Maven, Xcodebuild, Make ç­‰.</p>
<p>æˆ‘ä¸€èˆ¬ç”¨æ¥åˆ†æ iOS å’Œ Android å·¥ç¨‹.</p>
<p>å¯ä»¥åœ¨ <a href="http://fbinfer.com/docs/getting-started.html" target="_blank" rel="noopener">è¿™é‡Œ</a> æŸ¥çœ‹ Start.</p>
<h2 id="å®‰è£…-infer"><a href="#å®‰è£…-infer" class="headerlink" title="å®‰è£… infer"></a>å®‰è£… infer</h2><p>åªè¦ä½ ç”¨ Homebrew, mac ä¸‹å®‰è£… infer å¾ˆç®€å•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">brew update</div><div class="line">brew install infer</div></pre></td></tr></table></figure>
<p>åœ¨æ—©æœŸç‰ˆæœ¬, infer ä¸æ”¯æŒ brew å®‰è£…. å®‰è£…èµ·æ¥å„ç§é—®é¢˜, ç°åœ¨ infer æ”¯æŒäº† brew å®‰è£…, å¾ˆæ–¹ä¾¿.</p>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„ infer ç‰ˆæœ¬æ˜¯ 0.9.4.</p>
<p>å®‰è£…æˆåŠŸå, å¯ä»¥æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">infer -version</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Infer version v0.9.4</div><div class="line">Copyright 2009 - present Facebook. All Rights Reserved.</div><div class="line">Mac:public mark$ infer --version</div><div class="line">Infer version v0.9.4</div><div class="line">Copyright 2009 - present Facebook. All Rights Reserved.</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸ªé—®é¢˜, æœ‰æ—¶å€™ brew æ— æ³•æ›´æ–°æœ€æ–°çš„ infer, æˆ‘ç›®å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯å…ˆå¸è½½ä¹‹å‰å®‰è£…çš„ infer, ç„¶åå†é‡æ–°å®‰è£….</p>
<p>å¸è½½ infer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew uninstall infer</div></pre></td></tr></table></figure>
<h2 id="å®‰è£…-xcpretty"><a href="#å®‰è£…-xcpretty" class="headerlink" title="å®‰è£… xcpretty"></a>å®‰è£… xcpretty</h2><p><a href="https://github.com/supermarin/xcpretty" target="_blank" rel="noopener">xcpretty</a> æ˜¯ä¸€æ¬¾æ ¼å¼åŒ– xcodebuild è¾“å‡ºç»“æœçš„å·¥å…·.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">â–¸ Building X/N [(Release)]</div><div class="line">â–¸ Check Dependencies</div><div class="line">â–¸ Copying Info.plist</div><div class="line">â–¸ Running script &apos;[CP] Check Pods Manifest.lock&apos;</div><div class="line">â–¸ Running script &apos;Replace PaySdk&apos;</div><div class="line">â–¸ Compiling User.m</div></pre></td></tr></table></figure>
<p>ä»0.9.4ç‰ˆæœ¬å, infer é»˜è®¤ä½¿ç”¨äº† xcpretty.</p>
<p>å¯ä»¥ä½¿ç”¨ gem å®‰è£… xcpretty å·¥å…·:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem install xcpretty</div></pre></td></tr></table></figure>
<p>å¦‚æœæ²¡æœ‰å®‰è£…æˆåŠŸ, æˆ–è€…æç¤ºæƒé™ä¸å¤Ÿ, é‚£å°±è¿™æ ·æŠ˜è…¾:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install xcpretty</div></pre></td></tr></table></figure>
<p>æƒ³äº†è§£æ›´å¤šå…³äº xcpretty çš„ä½¿ç”¨å¯ä»¥å» <a href="https://github.com/supermarin/xcpretty" target="_blank" rel="noopener">github</a>.</p>
<h2 id="ä½¿ç”¨-infer"><a href="#ä½¿ç”¨-infer" class="headerlink" title="ä½¿ç”¨ infer"></a>ä½¿ç”¨ infer</h2><h3 id="iOS-é¡¹ç›®ä½¿ç”¨-infer"><a href="#iOS-é¡¹ç›®ä½¿ç”¨-infer" class="headerlink" title="iOS é¡¹ç›®ä½¿ç”¨ infer"></a>iOS é¡¹ç›®ä½¿ç”¨ infer</h3><p>infer çš„æ–‡æ¡£å†™çš„ä¹Ÿè¾ƒå…¨é¢.</p>
<p>å¯ä»¥åœ¨ <a href="http://fbinfer.com/docs/infer-workflow.html" target="_blank" rel="noopener">è¿™é‡Œ</a> æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•.</p>
<p>1.åˆ†æ Cocoapods é¡¹ç›®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">infer -- xcodebuild -workspace N.xcworkspace -scheme NSchema</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ N.xcworkspace æ˜¯ä½ çš„ workspace åç§°, NSchema æ˜¯ä½ éœ€è¦æ£€æŸ¥çš„ Schema åç§°.</p>
<p>2.åˆ†æ .xcodeproj</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">infer -- xcodebuild -target targetName -configuration Debug -sdk iphonesimulator</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ targetName æ˜¯é¡¹ç›®çš„ target åç§°, å¿…é¡»æŒ‡å®š.</p>
<p>åˆ†ææˆåŠŸå, infer ä¼šæœ‰è¾“å‡ºæŠ¥å‘Š.</p>
<p>è¯¥æŠ¥å‘Šåœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸‹, åç§°æ˜¯ infer-out.</p>
<p>bug.txt æ˜¯ä»¥æ–‡æœ¬æ–¹å¼è¾“å‡ºçš„ issue æ–‡æ¡£.<br>å¦å¤–è¿˜æœ‰ csv æ ¼å¼çš„ issue æ–‡æ¡£.</p>
<h3 id="Android-Gradle-å·¥ç¨‹ä½¿ç”¨-infer"><a href="#Android-Gradle-å·¥ç¨‹ä½¿ç”¨-infer" class="headerlink" title="Android Gradle å·¥ç¨‹ä½¿ç”¨ infer"></a>Android Gradle å·¥ç¨‹ä½¿ç”¨ infer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gradle clean</div><div class="line">infer -- gradle build</div></pre></td></tr></table></figure>
<h2 id="å…¶ä»–ç”¨æ³•"><a href="#å…¶ä»–ç”¨æ³•" class="headerlink" title="å…¶ä»–ç”¨æ³•"></a>å…¶ä»–ç”¨æ³•</h2><p>infer è¿˜æœ‰å¾ˆå¤šé«˜çº§çš„ç”¨æ³•, æ¯”å¦‚å¯ä»¥å¢é‡æ£€æŸ¥.</p>
<p>å¢é‡æ£€æŸ¥çš„åŠŸèƒ½ä¾èµ–äºä½ çš„ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒ.</p>
<p>infer å¢é‡æ£€æŸ¥çš„é€‰é¡¹æ˜¯ â€“reactive.</p>
<blockquote>
<p>ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯ â€“incremental é€‰é¡¹.<br>è‡ªä» v0.8.0 ç‰ˆæœ¬åä½¿ç”¨äº† â€“reactive é€‰é¡¹.</p>
</blockquote>
<p>å¯ä»¥è¿™æ ·æ¥è¿›è¡Œå¢é‡æ£€æŸ¥:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">infer --reactive -- xcodebuild -workspace N.xcworkspace -scheme NSchema</div></pre></td></tr></table></figure>
<p>infer è¿˜æœ‰å¾ˆå¤šé«˜çº§ç”¨æ³•, å¯ä»¥åœ¨ <a href="http://fbinfer.com/docs/advanced-features.html" target="_blank" rel="noopener">Advanced usage</a> ä¸­å»æŸ¥é˜…å’Œä½¿ç”¨.</p>
<p>å†ä½¿ç”¨è¿‡ç¨‹ä¸­, éšç€ MacOS, Xcode çš„å‡çº§, infer ä¼šé¢ä¸´æ›´å¤šçš„æŒ‘æˆ˜, å¦‚æœé‡åˆ°é—®é¢˜, ç¬¬ä¸€æ—¶é—´å» <a href="https://github.com/facebook/infer" target="_blank" rel="noopener">GitHub</a>  ä¸Šé¢æ  issue.</p>
]]></content>
      
        <categories>
            
            <category> MacOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> MacOS infer </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mac é…ç½® JDK1.8]]></title>
      <url>/2016/11/26/Mac-%E9%85%8D%E7%BD%AE-JDK1-8/</url>
      <content type="html"><![CDATA[<h2 id="ä¸‹è½½-JDK"><a href="#ä¸‹è½½-JDK" class="headerlink" title="ä¸‹è½½ JDK"></a>ä¸‹è½½ JDK</h2><p>åœ¨ <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">è¿™é‡Œä¸‹è½½</a> jdk.</p>
<p>ä¸‹è½½ç‰ˆæœ¬æ˜¯ 1.8u112, ä¿¡æ¯å¦‚ä¸‹:</p>
<p><img src="/upload/images/2016/11/26/jdk1.png" alt="1"></p>
<h2 id="å®‰è£…-JDK"><a href="#å®‰è£…-JDK" class="headerlink" title="å®‰è£… JDK"></a>å®‰è£… JDK</h2><p>ä¸‹è½½å®Œæˆå, ç›´æ¥åŒå‡»å®‰è£…å³å¯.</p>
<h2 id="é…ç½®-Path"><a href="#é…ç½®-Path" class="headerlink" title="é…ç½® Path"></a>é…ç½® Path</h2><p>æˆåŠŸå®‰è£…å, ç›®å½•<br><code>/Library/Java/JavaVirtualMachines/jdk1.8.0_112.jdk/</code> å°±ä¼šå­˜åœ¨.</p>
<p>ç¼–è¾‘ <code>/etc/profile</code> æ–‡ä»¶:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/profile</div></pre></td></tr></table></figure>
<p>æ·»åŠ å¦‚ä¸‹ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_112.jdk/Contents/Home</div><div class="line">CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</div><div class="line">PATH=$JAVA_HOME/bin:$PATH</div><div class="line">export JAVA_HOME</div><div class="line">export CLASSPATH</div><div class="line">export PATH</div></pre></td></tr></table></figure>
<p>ä¿å­˜æ–‡ä»¶.</p>
<p>ä½¿è¿™ä¸ªæ–‡ä»¶ç«‹å³ç”Ÿæ•ˆ.å¯ä»¥ source ä¸€ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source /etc/profile</div></pre></td></tr></table></figure>
<h2 id="æ£€éªŒ"><a href="#æ£€éªŒ" class="headerlink" title="æ£€éªŒ"></a>æ£€éªŒ</h2><p>æ‰§è¡Œä¸‹é¢å‘½ä»¤æ¥æ£€éªŒ jdk æ˜¯å¦å®‰è£…æˆåŠŸ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -version</div></pre></td></tr></table></figure>
<p>è¾“å‡ºå¦‚ä¸‹ä¿¡æ¯, æ ‡ç¤ºé…ç½® JDK æˆåŠŸ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">java version â€œ1.8.0_112â€</div><div class="line">Java(TM) SE Runtime Environment (build 1.8.0_112-b16)</div><div class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.112-b16, mixed mode)</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> MacOS java jdk </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GameDevelopment: ä¸ Cocos2d çš„å†ç›¸é€¢]]></title>
      <url>/2016/11/12/GameDevelopment-%E4%B8%8E-Cocos2d-%E7%9A%84%E5%86%8D%E7%9B%B8%E9%80%A2/</url>
      <content type="html"><![CDATA[<h2 id="è®¤è¯†-Cocos2d"><a href="#è®¤è¯†-Cocos2d" class="headerlink" title="è®¤è¯† Cocos2d"></a>è®¤è¯† Cocos2d</h2><p>ç›¸ä¿¡å¾ˆå¤šäººå¬è¯´è¿‡ cocos2d-x è¿™ä¸ªå¼•æ“, ä½†å¬è¿‡ <a href="http://cocos2d-objc.org/" target="_blank" rel="noopener">cocos2d-objc</a> çš„äººåº”è¯¥ä¸å¤š.</p>
<p>cocos2d-objc æ˜¯ cocos ç³»åˆ—çš„ objective-c ç‰ˆæœ¬.<br>å¼€å‘è¯­è¨€æ˜¯ OC.åœ¨ iOS ä¸Šé¢ä½¿ç”¨è¯¥ç‰ˆæœ¬çš„å¼•æ“, åŸºæœ¬æ˜¯æ— ç¼è¿æ¥(å†™çš„æ²¡æœ‰ä»€ä¹ˆéšœç¢).</p>
<p>æ¬£èµä¸€ä¸‹ cocos2d-objc çš„ logo, å¦‚å›¾:<br><img src="/upload/images/2016/11/12/1.png" alt="1"></p>
<p>å¦‚æœä½ å¯¹ OC ç‰ˆæ„Ÿå…´è¶£, å¯ä»¥é€šè¿‡åšæ–‡ <a href="http://blog.csdn.net/veryitman/article/details/44993643" target="_blank" rel="noopener">coco2d-iphone: ç¯å¢ƒæ­å»º</a> å»äº†è§£.</p>
<p>cocos2d-x ç›®å‰æ”¯æŒ JavaScript, lua, c++ ç­‰ä¸»æµè¯­è¨€æ¥å¼€å‘.<br>cocos è¿˜åœ¨è¿…çŒ›å‘å±•ä¸­, ä¸æ–­çš„å®Œå–„å¼€å‘å·¥å…·, å¹¿å¤§æ¸¸æˆå¼€å‘è€…ä¾ç„¶çƒ­åŠ›è´¡çŒ®, ç¨‹åºçŒ¿ä»¬åœ¨æ¸¸æˆçš„æˆ˜åœºæŒ¥æ´’é’æ˜¥.</p>
<p>ç°åœ¨ cocos çš„å¼€å‘è€…ä¼šå¾—åˆ°æ›´å¤šçš„æ”¯æŒ.</p>
<p>ä¸‹é¢ç»™å¼ å›¾æ¥å±•ç¤º cocos å®¶æ—åŠå…¶å‘å±•:<br><img src="/upload/images/2016/11/12/2.png" alt="1"></p>
<h2 id="ç”±-libgdx-è½¬å‘-Cocos2d"><a href="#ç”±-libgdx-è½¬å‘-Cocos2d" class="headerlink" title="ç”± libgdx è½¬å‘ Cocos2d"></a>ç”± libgdx è½¬å‘ Cocos2d</h2><p>å‡ å¹´å‰, é‚£ä¸ªæ—¶å€™è¿˜åœ¨å¼€å‘æ£‹ç‰Œæ¸¸æˆ, å½“æ—¶è‡ªå·±ä¹Ÿæ˜¯åˆšåˆšæ¥è§¦æ¸¸æˆå¼€å‘è¿™ä¸ªã€Œé«˜é€¼æ ¼ã€çš„è¡Œä¸š, ä¹‹å‰è‡ªå·±æ˜¯ä¸ªçº¯ App å¼€å‘è€….</p>
<p>å†…å¿ƒè¿˜æ˜¯è›®æ¿€åŠ¨çš„, å¿ƒæƒ³å¯èƒ½è¦èµ°ä¸Šäººç”Ÿå·…å³°äº†â€¦</p>
<p>æ£‹ç‰Œæ¸¸æˆ, å½“æ—¶ä½¿ç”¨çš„æ˜¯ java çš„æ¸¸æˆå¼•æ“ <a href="https://libgdx.badlogicgames.com/" target="_blank" rel="noopener">libgdx</a> 0.X.X çš„ç‰ˆæœ¬, è¯¥å¼•æ“å’Œ Android åŸºæœ¬ä¹Ÿæ˜¯æ— ç¼è¿æ¥, Api è®¾è®¡çš„å¾ˆå¥½.</p>
<p>ç°åœ¨ libgdx ä¹Ÿå‘å±•åˆ°äº†1.6.x ç‰ˆæœ¬äº†, å·¥å…·ä¹Ÿå®Œå–„äº†å¾ˆå¤š.</p>
<p>è™½ç„¶ libgdx ä¹Ÿå¯ä»¥è·¨å¹³å°, ä½†æ˜¯æœ€ç»ˆæˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©äº† cocos2d-x æ¥ç§»æ¤è¯¥æ¸¸æˆ.å…¶ä¸­åŸå› æ˜¯å› ä¸º cocos2d-x å¤ªç«äº†, äººä¹Ÿå¥½æ‰¾.</p>
<p>æ”¹ä¸º cocos2d-x çš„ç‰ˆæœ¬ä¹‹å, æˆ‘å°±è¢«å®‰æ’åˆ°äº†å¦å¤–ä¸€ä¸ªé¡¹ç›®, ä¹Ÿæ˜¯ä¸€ä¸ªæ£‹ç‰Œæ¸¸æˆ, è¯¥æ¸¸æˆç°åœ¨åœ¨è…¾è®¯çš„å¾®ä¿¡æ¸¸æˆé‡Œé¢è¿è¥.</p>
<p>è¿™ä¸ªæ¸¸æˆæ˜¯ cocos2d-objc çš„å¼•æ“å†™çš„, è‡ªå·±ä¹Ÿä¸ä¼š objc, äºæ˜¯ç¡¬ç€å¤´çš®å­¦ä¹ , å¾ˆå¿«çš„å°±ä¸Šæ‰‹äº†è¿™ä¸ªé¡¹ç›®.å†™çš„ä¹Ÿæ˜¯é£ç”Ÿæ°´èµ·.</p>
<p>cocos2d-objc, ç°åœ¨ä¹Ÿæ”¯æŒè·¨å¹³å°, å¹¶ä¸”æœ‰ xcode çš„æ’ä»¶, å¯ä»¥åœ¨ xcode é‡Œé¢å†™ Android çš„ä»£ç , è°ƒè¯•å¼€å‘ç­‰.</p>
<p>å› ä¸ºæ¥è§¦ cocos2d, åé¢å°±ç›´æ¥å¼€æ iOS å¼€å‘äº†.</p>
<h2 id="å†æ¬¡ä½¿ç”¨-Cocos2d"><a href="#å†æ¬¡ä½¿ç”¨-Cocos2d" class="headerlink" title="å†æ¬¡ä½¿ç”¨ Cocos2d"></a>å†æ¬¡ä½¿ç”¨ Cocos2d</h2><p>äº’è”ç½‘ IT ä¸šçš„å‘å±•, åˆºæ¿€äº†å„ä¸ªè¡Œä¸šçš„å‘å±•, ä¹Ÿä¿ƒè¿›å’Œæ¿€å‘äº†æ–°ç”Ÿçš„æŠ€æœ¯, åœ¨è¿™ä¸ªè¡Œä¸š, æ¯ä¸ªäººéƒ½èƒ½ä½“ä¼š <code>æ´»åˆ°è€å­¦åˆ°è€</code> è¿™å¥è¯çš„å«ä¹‰.</p>
<p>è¿™ä¸¤å¹´, HTML5 çš„å‘å±•, è®©å¾ˆå¤šç¨‹åºå‘˜é‡æ–°è®¤è¯†äº† JavaScript çš„é‡è¦æ€§. ç‰¹åˆ«æ˜¯æœ€è¿‘ ReactNative çš„å‘å±•, jsPacth çš„å¼€æº, å¾®ä¿¡å°ç¨‹åºçš„æ¨å‡º, è®© JavaScript ç«å¾—ä¸è¦ä¸è¦çš„.</p>
<p>è¯´å®è¯, æ˜¯æ—¶å€™å¼€å§‹å­¦ä¹ å‰ç«¯ç›¸å…³çš„æŠ€æœ¯äº†, è‡³å°‘ä½ éœ€è¦å»äº†è§£.</p>
<p>cocos2d-js çš„å‘å±•, ç»™ HTML æ¸¸æˆå¼€å‘å¸¦æ¥äº†å¾ˆå¤šä¾¿åˆ©. æœ€è¿‘æˆ‘ä»¬éœ€è¦å¼€å‘ H5 çš„æ¸¸æˆ, ç›´æ¥æ‹¿èµ· coco2d-x(æ”¯æŒ JavaScript) å°±æ’¸èµ·.</p>
<p>å» <a href="https://github.com/cocos2d/cocos2d-x" target="_blank" rel="noopener">GitHub</a> ä¸Šé¢ç›´æ¥ clone æœ€æ–°ç‰ˆå°±å¯ä»¥, æŒ‰ç…§ README.md æ¥æ­å»ºç¯å¢ƒå°±å¥½äº†.</p>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>è¿™ç¯‡åšå®¢ä¹Ÿæ˜¯æœ‰æ„Ÿè€Œå‘, æ²¡æœ‰å®è´¨æ€§çš„å†…å®¹.</p>
<p>ä¸»è¦ç›®çš„æ˜¯æƒ³å‘Šè¯‰å¤§å®¶, æŠ€æœ¯çš„å‘å±•æ—¥æ–°æœˆå¼‚, æƒ³åœ¨è¿™é‡Œå¤§å±•æ‹³è„š, ä½ éœ€è¦ä¿æŒä¸€é¢—å¹´è½»çš„å¿ƒ, ä¸æ€•è‹¦, å‹‡å¾€ç›´å‰çš„ç²¾ç¥.</p>
<p>æˆ‘ä»¬éœ€è¦å­¦ä¹ çš„æŠ€æœ¯æœ‰å¾ˆå¤š, æˆ‘è®¤ä¸º, è¦æ ¹æ®é¡¹ç›®æœ¬èº«çš„å‘å±•æ¥é€‚åº¦çš„å­¦ä¹ , åˆ‡è®°ç›²ç›®çš„å­¦ä¹ , å­¦ä¹ ä¸€é—¨æ–°æŠ€æœ¯ä¹‹å, è¦åŠæ—¶çš„è¿ç”¨åœ¨é¡¹ç›®å½“ä¸­, å¹¶åˆ†äº«ç»™ä½ èº«è¾¹çš„äºº.</p>
<blockquote>
<p>ä¸æ‹’ç»ä¸æ’æ–¥æ–°æŠ€æœ¯, åšæŒå­¦ä¹ å’Œä¹äºåˆ†äº«, åº”è¯¥æ˜¯å¿…å¤‡çš„æŠ€èƒ½.</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Cocos2d Game </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mac install Cocoapods]]></title>
      <url>/2016/11/08/Mac-install-Cocoapods/</url>
      <content type="html"><![CDATA[<h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>è¿™ç¯‡åšå®¢åŸæœ¬è¢«æˆ‘å‘è¡¨åœ¨ <a href="http://blog.csdn.net/veryitman/article/details/50769069" target="_blank" rel="noopener">CSDN</a> .</p>
<p>é‚£é‡Œä¸å†æ›´æ–°, ç°åœ¨åœ¨è¿™é‡ŒåšæŒç»­æ›´æ–°.</p>
<h2 id="å¯¼å¼•"><a href="#å¯¼å¼•" class="headerlink" title="å¯¼å¼•"></a>å¯¼å¼•</h2><p>å¦‚æœä½ çš„ Mac OSX å‡çº§åˆ° 10.11.x+, å¹¶ä¸”éœ€è¦å®‰è£… Cocoapods, å¯ä»¥å‚è€ƒæœ¬åšå®¢.</p>
<h2 id="å®‰è£…-ruby"><a href="#å®‰è£…-ruby" class="headerlink" title="å®‰è£… ruby"></a>å®‰è£… ruby</h2><p>Mac ç³»ç»Ÿè‡ªå¸¦äº† ruby, ä½†æ˜¯å»ºè®®å¤§å®¶ä½¿ç”¨ Homebrew å®‰è£… ruby.</p>
<p>å› ä¸º Cocoapods å‡çº§éœ€è¦å¯¹åº”çš„ ruby ç‰ˆæœ¬ä¹Ÿè¦å‡çº§, ä½¿ç”¨ Homebrew æ¯”è¾ƒæ–¹ä¾¿.</p>
<p>å®‰è£… ruby:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install ruby</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å½“å‰å®‰è£…çš„ ruby ç‰ˆæœ¬:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby -v</div></pre></td></tr></table></figure>
<p>ä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-darwin15]</div></pre></td></tr></table></figure>
<p>gem æ˜¯ç®¡ç† Ruby åº“å’Œç¨‹åºçš„æ ‡å‡†åŒ….<br>å®‰è£…äº† ruby, è‡ªå¸¦äº† gem å·¥å…·.</p>
<p>å¯ä»¥ä½¿ç”¨ <code>gem -v</code> æŸ¥çœ‹ gem ç‰ˆæœ¬.</p>
<h2 id="å®‰è£…-Cocoapods"><a href="#å®‰è£…-Cocoapods" class="headerlink" title="å®‰è£… Cocoapods"></a>å®‰è£… Cocoapods</h2><p>1.ç§»é™¤åŸæ¥çš„æº, ä¸ç®¡ä»¥å‰æ˜¯å¦å®‰è£…è¿‡ Cocoapods.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem sources --remove http://ruby.taobao.org/</div></pre></td></tr></table></figure>
<p>2.é‡æ–°æ·»åŠ æº, æ³¨æ„æ˜¯ https.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem sources -a https://gems.ruby-china.org/</div></pre></td></tr></table></figure>
<p>ä¹‹å‰ <a href="https://ruby.taobao.org/" target="_blank" rel="noopener">taobao çš„æº</a> å¥½åƒå·²ç»ä¸è¡Œäº†.</p>
<p><strong>æ³¨æ„ï¼š</strong>æ·»åŠ æºä¹‹å‰åœ¨æµè§ˆå™¨æ‰“å¼€ <code>https://gems.ruby-china.org/</code> è¿™ä¸ªåœ°å€çœ‹ä¸€çœ‹æ˜¯å¦èƒ½è®¿é—®ï¼Œå¦‚æœä¸èƒ½è®¿é—®å°±ä¿®æ”¹ä¸€ä¸‹ä¸º <code>https://gems.ruby-china.com</code> è¿™ä¸ªåœ°å€ã€‚</p>
<p>3.æŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸ, è¯¥æ­¥éª¤å¯é€‰.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem sources -l</div></pre></td></tr></table></figure>
<p>å®‰è£…, ä½¿ç”¨ root æƒé™å®‰è£….</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install -n /usr/local/bin cocoapods</div></pre></td></tr></table></figure>
<p>è¿™ç§å®‰è£…æ–¹å¼, ä¼šå®‰è£…æœ€æ–°çš„ release ç‰ˆæœ¬.</p>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸¤ç§æ–¹å¼æ¥å®‰è£….</p>
<p>æŒ‡å®šç‰ˆæœ¬å®‰è£…:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install -n /usr/local/bin cocoapods -v 1.0.0</div></pre></td></tr></table></figure>
<p>å®‰è£…æœ€æ–°çš„ release beta ç‰ˆæœ¬:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install -n /usr/local/bin cocoapods --pre</div></pre></td></tr></table></figure>
<h2 id="å¸è½½-Cocoapods"><a href="#å¸è½½-Cocoapods" class="headerlink" title="å¸è½½ Cocoapods"></a>å¸è½½ Cocoapods</h2><p>å¸è½½ Cocoapods åªéœ€æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem uninstall cocoapods</div></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³åˆ é™¤æœ¬åœ°çš„ pod repo, å¯ä»¥è¿™æ ·:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rm -fr ~/.cocoapods/</div></pre></td></tr></table></figure>
<h2 id="å»ºç«‹æœ¬åœ°-repo"><a href="#å»ºç«‹æœ¬åœ°-repo" class="headerlink" title="å»ºç«‹æœ¬åœ° repo"></a>å»ºç«‹æœ¬åœ° repo</h2><p>å®‰è£…å®Œ Cocoapods å, éœ€è¦å»ºç«‹æœ¬åœ°çš„ repo.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod setup</div></pre></td></tr></table></figure>
<p>å³ä½¿ä½ ç°åœ¨ä¸æ‰§è¡Œ pod setup, åé¢è¿›è¡Œ pod install æˆ–è€… pod update çš„æ—¶å€™, ä¹Ÿä¼šè‡ªåŠ¨çš„è¿›è¡Œ pod setup.</p>
<p>æ‰§è¡Œ pod setup çš„ç›®çš„æ˜¯å°†æ‰€æœ‰ç¬¬ä¸‰æ–¹çš„ podspec ç´¢å¼•æ–‡ä»¶æ›´æ–°åˆ°æœ¬åœ°çš„ <code>~/.cocoapods/repos</code> ç›®å½•ä¸­.</p>
<h2 id="å®‰è£…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜"><a href="#å®‰è£…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å®‰è£…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜"></a>å®‰è£…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜</h2><p>é—®é¢˜1: å‘½ä»¤è¡Œæ‰§è¡Œ pod å‘ç”Ÿ: pod command not found, ä½†æ˜¯ sudo pod å´å¯ä»¥æ‰§è¡Œ.</p>
<p>è§£å†³æ–¹æ¡ˆå³å¦‚ä¸‹æ­¥éª¤:</p>
<p>[1].å¸è½½åŸæœ‰çš„ Cocoapods</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem uninstall cocoapods</div></pre></td></tr></table></figure>
<p>[2].é‡æ–°å®‰è£… Cocoapods</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install -n /usr/local/bin cocoapods</div></pre></td></tr></table></figure>
<p>[3].èµ‹äºˆ/usr/local/binç»™äºˆæ‰§è¡Œä¸è¯»å–æƒé™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod -R +rx /usr/local/bin/</div></pre></td></tr></table></figure>
<blockquote>
<p>å»ºè®®æœ€å¥½ä½¿ç”¨ä»£(fanq)ç†(qiang).</p>
</blockquote>
<p>é—®é¢˜2: æ›´æ–° gem è¿‡ç¨‹ä¸­, é‡åˆ°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Operation not permitted - /usr/bin/update_rubygems</div></pre></td></tr></table></figure>
<p>å¯ä»¥é€šè¿‡é€šè¿‡ brew å®‰è£… ruby è§£å†³.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install ruby</div></pre></td></tr></table></figure>
<p>é—®é¢˜3: pod setup å¤±è´¥</p>
<p>å¤±è´¥æç¤ºä¿¡æ¯ç±»ä¼¼:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Cloning into &apos;master&apos;...</div><div class="line">error: RPC failed; curl 56 SSLRead() return error -36</div><div class="line">fatal: The remote end hung up unexpectedly</div><div class="line">fatal: early EOF</div><div class="line">fatal: index-pack failed</div></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ¡ˆ: æ›´æ–° gem</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem update --system</div></pre></td></tr></table></figure>
<p>é—®é¢˜4: æ·»åŠ æº, æç¤ºå¦‚ä¸‹é—®é¢˜</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source https://gems.ruby-china.org/ already present in the cache</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªè¯´æ˜ä½ å·²ç»æ·»åŠ è¿‡è¯¥æº, å¯ä»¥ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem sources -l</div></pre></td></tr></table></figure>
<p>æ¥æŸ¥çœ‹å·²ç»æ·»åŠ çš„æº.</p>
<h2 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h2><p>1.æ›´æ–° gem</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem update --system</div></pre></td></tr></table></figure>
<p>2.pod repo update</p>
<p>æ›´æ–°æœ¬åœ°ä»“åº“.</p>
<p>3.pod search xxx</p>
<p>æœç´¢ cocoapods é¡¹ç›®.</p>
<p>4.pod list</p>
<p>åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„åº“.</p>
<p>5.pod install</p>
<p>æ ¹æ® podfile å’Œ podfile.lockæ¥å®‰è£…åº“.</p>
<p>é»˜è®¤ä¼šæ‰§è¡Œ pod repo update.</p>
<p>å¯ä»¥åŠ å…¥å‚æ•° <code>â€“no-repo-update</code> ä¸æ‰§è¡Œ pod repo update.</p>
<p>6.pod update</p>
<p>æ›´æ–°å·²å®‰è£…çš„åº“åˆ°æœ€æ–°ç‰ˆæœ¬, å¹¶ä¸”åˆ›å»ºæ–°çš„ Podfile.lock æ–‡ä»¶.</p>
<p>è¯¥å‘½ä»¤ä¹Ÿä¼šé»˜è®¤ä¼šæ‰§è¡Œ pod repo update.</p>
<p>å¯ä»¥åŠ å…¥å‚æ•° â€“no-repo-update ä¸æ‰§è¡Œ pod repo update.</p>
<h2 id="æ›´æ–°è®°å½•"><a href="#æ›´æ–°è®°å½•" class="headerlink" title="æ›´æ–°è®°å½•"></a>æ›´æ–°è®°å½•</h2><p>2017-01-04 æ›´æ–°</p>
<blockquote>
<p>å‡çº§ ruby åˆ° 2.4 ç‰ˆæœ¬å, cocoapods æ— æ³•ä½¿ç”¨äº†.</p>
</blockquote>
<p>å‡çº§çš„ ruby ç‰ˆæœ¬ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby 2.4.0p0 (2016-12-24 revision 57164) [x86_64-darwin15]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ä½¿ç”¨ä»»ä½• pod å‘½ä»¤éƒ½æŠ¥é”™:</div><div class="line"></div><div class="line">/usr/local/Cellar/ruby/2.4.0/lib/ruby/2.4.0/rubygems.rb:270:in `find_spec_for_exe&apos;: can&apos;t find gem cocoapods (&gt;= 0.a) (Gem::GemNotFoundException)</div><div class="line">from /usr/local/Cellar/ruby/2.4.0/lib/ruby/2.4.0/rubygems.rb:298:in `activate_bin_path&apos;</div><div class="line">from /usr/local/bin/pod:22:in `&lt;main&gt;&apos;</div></pre></td></tr></table></figure>
<p>æŸ¥æ‰¾å„ç§è§£å†³æ–¹æ¡ˆ, æœ€ç»ˆè¿˜æ˜¯æ²¡æœ‰è§£å†³.</p>
<p>ä½ å¯ä»¥åœ¨ <a href="https://cocoapods.org/app" target="_blank" rel="noopener">è¿™é‡Œ</a> ä¸‹è½½ Cocoapods çš„ Mac ç‰ˆæœ¬ App ä½¿ç”¨.</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> MacOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CocoaPods, iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Cocoapods é—®é¢˜é›†é”¦]]></title>
      <url>/2016/11/08/Cocoapods-%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6/</url>
      <content type="html"><![CDATA[<h2 id="æ‰¿è¯º"><a href="#æ‰¿è¯º" class="headerlink" title="æ‰¿è¯º"></a>æ‰¿è¯º</h2><p>æœ¬æ–‡ä¼šæŒç»­æ›´æ–°, åˆ†äº«åœ¨ä½¿ç”¨ cocoapods è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ.</p>
<p>æ¬¢è¿å¤§å®¶è¡¥å…….</p>
<h2 id="å®‰è£…é—®é¢˜"><a href="#å®‰è£…é—®é¢˜" class="headerlink" title="å®‰è£…é—®é¢˜"></a>å®‰è£…é—®é¢˜</h2><p>å¯ä»¥é˜…è¯»åšå®¢ <a href="http://www.veryitman.com/2016/11/08/2016-11-08-Mac-install-Cocoapods/" target="_blank" rel="noopener">Mac å®‰è£… Cocoapods</a>.</p>
<h2 id="pod-search-é—®é¢˜"><a href="#pod-search-é—®é¢˜" class="headerlink" title="pod search é—®é¢˜"></a>pod search é—®é¢˜</h2><blockquote>
<p>pod search æ— æ³•æœç´¢åˆ°æŒ‡å®šçš„é¡¹ç›®</p>
</blockquote>
<p>é—®é¢˜æè¿°: æ‰§è¡Œ pod search [Name], å‡ºç°ç±»ä¼¼ä¸‹é¢çš„æç¤º:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[!] Unable to find a pod with name, author, summary, or description matching `[Name]`</div></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ¡ˆ: åˆ é™¤ search_index.json æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rm ~/Library/Caches/CocoaPods/search_index.json</div></pre></td></tr></table></figure>
<p>ç„¶å, é‡æ–°æ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod search é¡¹ç›®åç§°</div></pre></td></tr></table></figure>
<p>å¦‚æœè¿™æ ·è¡Œä¸é€šçš„è¯, å¯ä»¥è¿™æ ·:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rm -rf ~/.cocoapods</div><div class="line">rm ~/Library/Caches/CocoaPods/search_index.json</div><div class="line">pod setup</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ çš„ç½‘ç»œä¸å¥½, éœ€è¦æ¼«é•¿çš„ç­‰å¾…â€¦</p>
<p>è¿™ä¸ªæ—¶å€™, å¯ä»¥å»æŠ½åŠç›’çƒŸäº†. Orzâ€¦</p>
<h2 id="pod-setup-é—®é¢˜"><a href="#pod-setup-é—®é¢˜" class="headerlink" title="pod setup é—®é¢˜"></a>pod setup é—®é¢˜</h2><blockquote>
<p>pod setup å¡æ­»</p>
</blockquote>
<p>é—®é¢˜æè¿°:</p>
<p>pod setup ä¼šåœ¨æœ¬åœ°å»ºç«‹ cocoapods ä»“åº“.</p>
<p>åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­, ä½ å¯ä»¥åœ¨ <code>~/.cocoapods/repos</code> ä½¿ç”¨<br><code>du -sh *</code> æ¥çœ‹ repos ç›®å½•çš„å¤§å°å˜åŒ–.</p>
<p>å¦‚æœè§‚å¯Ÿå¥½ä¹…, å¤§å°æ²¡æœ‰å˜åŒ–, æœ€ç»ˆä¼šå‡ºç°ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Cloning into &apos;master&apos;...</div><div class="line">error: RPC failed; curl 56 SSLRead() return error -36</div><div class="line">fatal: The remote end hung up unexpectedly</div><div class="line">fatal: early EOF</div><div class="line">fatal: index-pack failed</div></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹ï¼š</p>
<p>å…ˆæ›´æ–° gem</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem update --system</div></pre></td></tr></table></figure>
<p>å†é‡æ–°æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod setup</div></pre></td></tr></table></figure>
<h2 id="pod-install-é—®é¢˜"><a href="#pod-install-é—®é¢˜" class="headerlink" title="pod install é—®é¢˜"></a>pod install é—®é¢˜</h2><p>æ— æ³•ä½¿ç”¨ï¼ŒæŠ¥ç±»ä¼¼ä¸‹é¢çš„ä¸¤ç§é”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">can&apos;t find gem cocoapods (&gt;= 0.a) with executable pod (Gem::GemNotFoundException)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">While executing gem ... (TypeError) </div><div class="line">no implicit conversion of nil into String</div></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹ï¼š</p>
<p><strong>1. é‡æ–°å®‰è£… ruby</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew reinstall ruby</div></pre></td></tr></table></figure>
<p><strong>2. gem æ›´æ–°</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rm /usr/local/bin/update_rubygems</div><div class="line"></div><div class="line">sudo gem update --system</div></pre></td></tr></table></figure>
<p><strong>3. é‡æ–°å®‰è£… Cocoapods å¹¶é‡æ–°æ·»åŠ æº</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sudo gem uninstall cocoapods</div><div class="line"></div><div class="line">sudo gem install -n /usr/local/bin cocoapods</div><div class="line"></div><div class="line">gem sources -a https://gems.ruby-china.org/</div></pre></td></tr></table></figure>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> MacOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CocoaPods, iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Cocoapods ç®¡ç†å¼€æºé¡¹ç›®]]></title>
      <url>/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/</url>
      <content type="html"><![CDATA[<h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>åœ¨è¿›è¡Œä¸‹é¢å·¥ä½œä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ åšäº†ä¸‹é¢ä¸‰ä»¶äº‹æƒ…ï¼š</p>
<p><strong>1. åˆ›å»ºæˆ–è€…å·²ç»æœ‰äº† github è´¦å·.</strong><br><strong>2. äº†è§£å’Œç†Ÿæ‚‰å¦‚ä½•åœ¨ github ä¸Šé¢åˆ›å»º Repository.</strong><br><strong>3. MacOS ä¸Šé¢å®‰è£…äº† Cocoapods.</strong></p>
<p>å¦‚æœä½ è¿˜æ²¡æœ‰ä½¿ç”¨ Cocoapods, å»ºè®®çœ‹çœ‹ <a href="http://www.veryitman.com/2016/11/08/Mac-install-Cocoapods/" target="_blank" rel="noopener">Mac OSX 10.11.1+ å®‰è£… Cocoapods</a> è¿™ç¯‡åšå®¢.</p>
<p>åœ¨åšå®¢ <a href="http://www.veryitman.com/2016/09/25/iOS-%E9%A1%B9%E7%9B%AE-%E6%89%93%E9%80%A0%E6%9C%AC%E5%9C%B0-pod-%E5%BA%93/" target="_blank" rel="noopener">iOS é¡¹ç›®: æ‰“é€ æœ¬åœ° pod åº“</a> é‡Œé¢æœ‰ä»‹ç»å¦‚ä½•æ‰“é€ æœ¬åœ°çš„ pod åº“ï¼Œä¸éœ€è¦å€ŸåŠ©ä»»ä½•ä»“åº“å°±å¯ä»¥å®Œæˆï¼Œæ“ä½œç®€å•ï¼Œé€‚åˆé¡¹ç›®ç»„å†…ä½¿ç”¨ã€‚</p>
<p>ä»Šå¤©ç»™å¤§å®¶åˆ†äº«å¦‚ä½•å°†ä»£ç å¼€æºå¹¶æ”¾åˆ° pod åº“ä¸­ï¼Œä¾›åˆ«äººä½¿ç”¨ã€‚è¿™ç§æ–¹å¼å±äºæ‰“é€ å…¬å…±ï¼ˆPublic repoï¼‰ä»“åº“ï¼Œ ä»»ä½•äººéƒ½å¯ä»¥æœç´¢åˆ°ä½ è´¡çŒ®çš„åº“å¹¶ä½¿ç”¨ä½ çš„åº“ã€‚åé¢ä¼šè·Ÿå¤§å®¶åˆ†äº«å¦‚ä½•æ‰“é€ ç§æœ‰ï¼ˆPrivate repoï¼‰ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p>
<p>è¿™ç¯‡åšå®¢æ˜¯åŸºäºä¸€ä¸ªå®é™…ä¾‹å­ <a href="https://github.com/veryitman/MZInsetLabel" target="_blank" rel="noopener">MZInsetLabel</a> æ¥è¯´æ˜çš„ï¼ŒæœŸå¾…ä¸ä¼˜ç§€çš„ä½ äº¤æµè®¨è®ºã€‚</p>
<h2 id="åˆ›å»º-Repository-å¹¶å®Œå–„é¡¹ç›®"><a href="#åˆ›å»º-Repository-å¹¶å®Œå–„é¡¹ç›®" class="headerlink" title="åˆ›å»º Repository å¹¶å®Œå–„é¡¹ç›®"></a>åˆ›å»º Repository å¹¶å®Œå–„é¡¹ç›®</h2><p><strong>1. åœ¨ Github ä¸Šé¢åˆ›å»º Repositoryï¼Œå–åä¸º MZInsetLabel.</strong></p>
<p><strong>2. å°†è¯¥å·¥ç¨‹ clone åˆ°æœ¬åœ°ç£ç›˜.</strong></p>
<p><strong>3. å†™ä»£ç ï¼Œè¿™é‡Œæˆ‘åªå†™äº† MZInsetLabel.h | .m æ–‡ä»¶.</strong></p>
<p><strong>4. åˆ›å»º podspec æ–‡ä»¶.</strong></p>
<p>ä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼Œå³å¯äº§ç”Ÿè¯¥æ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod spec create MZInsetLabel</div></pre></td></tr></table></figure>
<p>åœ¨å½“å‰ç›®å½•ä¼šç”Ÿæˆ <code>MZInsetLabel.podspec</code> æ–‡ä»¶ã€‚æŒ‰ç…§æ–‡ä»¶è§„èŒƒå’Œå®é™…æƒ…å†µå¡«å†™å³å¯ï¼Œå¦‚æœä¸çŸ¥é“æ€ä¹ˆå¡«å†™ï¼Œå¯ä»¥åœ¨ Github ä¸Šé¢æ‰¾ä¸€ä¸ªå¼€æºé¡¹ç›®å‚è€ƒå³å¯ã€‚</p>
<blockquote>
<p>æ³¨æ„: Tag ç‰ˆæœ¬å·ä¸è¦é”™è¯¯.</p>
</blockquote>
<p>æœ€ç»ˆå†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">Pod::Spec.new do |s|</div><div class="line">  s.name         = &quot;MZInsetLabel&quot;</div><div class="line">  s.version      = &quot;0.2.0&quot;</div><div class="line">  s.summary      = &quot;MZInsetLabel is subClass of UILabel.&quot;</div><div class="line">  s.description  = &lt;&lt;-DESC</div><div class="line">                        MZInsetLabel is a sub class of UILabel that can be set insets.</div><div class="line">                   DESC</div><div class="line">  s.homepage     = &quot;http://www.veryitman.com&quot;</div><div class="line">  s.license      = &quot;MIT&quot;</div><div class="line">  s.author       = &#123; &quot;veryitman&quot; =&gt; &quot;veryitman@126.com&quot; &#125;</div><div class="line">  s.platform     = :ios, &quot;7.0&quot;</div><div class="line">  s.source = &#123; :git =&gt; &quot;https://github.com/veryitman/MZInsetLabel.git&quot;, :tag =&gt; &quot;#&#123;s.version&#125;&quot; &#125;</div><div class="line">  s.source_files  = &quot;*.&#123;h,m&#125;&quot;</div><div class="line">  s.framework  = &quot;UIKit&quot;</div><div class="line">  s.requires_arc = true</div><div class="line">end</div></pre></td></tr></table></figure>
<h2 id="é¡¹ç›®æ£€æµ‹"><a href="#é¡¹ç›®æ£€æµ‹" class="headerlink" title="é¡¹ç›®æ£€æµ‹"></a>é¡¹ç›®æ£€æµ‹</h2><p>æ£€æŸ¥è¯¥ podspec æ–‡ä»¶ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod lib lint MZInsetLabel.podspec</div></pre></td></tr></table></figure>
<blockquote>
<p>â€“verbose å¯ä»¥è¾“å‡ºæ›´åŠ è¯¦ç»†çš„å†…å®¹</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod lib lint MZInsetLabel.podspec --verbose</div></pre></td></tr></table></figure>
<p>æ­£ç¡®çš„è¯, ä½ å¯ä»¥çœ‹åˆ°ä¸‹å›¾å¦‚æ‰€ç¤ºçš„å†…å®¹ï¼š<br><img src="/upload/images/2016/11/1/1.jpg" alt="1"></p>
<p>åœ¨æ£€æµ‹çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰ä¸€äº›è­¦å‘Šå¯¼è‡´æ— æ³•éªŒè¯é€šè¿‡ï¼Œå¯ä»¥ä½¿ç”¨ <code>--allow-warnings</code> å‚æ•°è§„é¿è¿™äº› warningï¼Œä½†æˆ‘è¿˜æ˜¯å»ºè®®å¤§å®¶å°½é‡å°† warning ä¿®æ”¹å¥½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod lib lint --allow-warnings</div></pre></td></tr></table></figure>
<p><code>pod lib lint *.podspec</code> æ˜¯åªä»æœ¬åœ°éªŒè¯ä½ çš„ pod èƒ½å¦é€šè¿‡éªŒè¯.</p>
<p><code>pod spec lint*..podspec</code> æ˜¯ä»æœ¬åœ°å’Œè¿œç¨‹éªŒè¯ä½ çš„ pod èƒ½å¦é€šè¿‡éªŒè¯.</p>
<p>å¤§å®¶å¯è‡ªè¡Œé€‰æ‹©è¿™ä¸¤ç§æ–¹å¼ã€‚</p>
<h2 id="æ·»åŠ é¡¹ç›®åˆ°-Github-Repository"><a href="#æ·»åŠ é¡¹ç›®åˆ°-Github-Repository" class="headerlink" title="æ·»åŠ é¡¹ç›®åˆ°  Github Repository"></a>æ·»åŠ é¡¹ç›®åˆ°  Github Repository</h2><p>å°†æœ¬åœ°çš„ä»£ç  push åˆ° Github çš„ Repository, å°±æ˜¯åˆšæ‰åˆ›å»ºçš„ MZInsetLabel.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git add `æ–‡ä»¶`æˆ–è€…`æ–‡ä»¶å¤¹`</div><div class="line"></div><div class="line">git commit -m &quot;Init&quot;</div><div class="line"></div><div class="line">git push</div></pre></td></tr></table></figure>
<p>åœ¨ä½ çš„ Github Repository ä¸Šé¢åˆ›å»ºä¸€ä¸ª Release ä½œä¸º Tagï¼ˆ0.1.0ç‰ˆæœ¬ï¼‰ï¼Œå¦‚å›¾æ‰€ç¤º:<br><img src="/upload/images/2016/11/1/2.jpg" alt="1"></p>
<h2 id="æ¨é€åˆ°-cocoapods"><a href="#æ¨é€åˆ°-cocoapods" class="headerlink" title="æ¨é€åˆ° cocoapods"></a>æ¨é€åˆ° cocoapods</h2><p><strong>1. æ³¨å†Œ trunk</strong></p>
<blockquote>
<p>pod trunk register ä½ çš„é‚®ç®± â€˜ç”¨æˆ·åâ€™ â€“description=â€™ç®€å•æè¿°â€™</p>
</blockquote>
<p>å®Œæ•´å‘½ä»¤å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod trunk register veryitman@126.com &apos;veryitman&apos; --description=&apos;mark&apos;</div></pre></td></tr></table></figure>
<p><strong>2. æ‰“å¼€é‚®ç®±, æ¿€æ´»é‚®ä»¶, ç‚¹å‡»é“¾æ¥æ¿€æ´»</strong></p>
<p><strong>3. æ£€æŸ¥æ³¨å†Œä¿¡æ¯</strong></p>
<p>æ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod trunk me</div></pre></td></tr></table></figure>
<p><strong>4.æ·»åŠ åˆ° cocoapods</strong></p>
<p>æ‰§è¡Œä¸‹é¢å‘½ä»¤, å³å¯.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod trunk push MZInsetLabel.podspec</div></pre></td></tr></table></figure>
<p>æˆåŠŸçš„æ•ˆæœå›¾:</p>
<p><img src="/upload/images/2016/11/1/3.jpg" alt="1"></p>
<p><img src="/upload/images/2016/11/1/4.png" alt="1"></p>
<h2 id="éªŒè¯ä½¿ç”¨"><a href="#éªŒè¯ä½¿ç”¨" class="headerlink" title="éªŒè¯ä½¿ç”¨"></a>éªŒè¯ä½¿ç”¨</h2><p><strong>1. æ£€æŸ¥æ˜¯å¦å¯ä»¥æœç´¢åˆ°</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod search MZInsetLabel</div></pre></td></tr></table></figure>
<p>å¦‚æœæœç´¢ä¸åˆ°, è¯·æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod setup</div></pre></td></tr></table></figure>
<p><strong>2. åœ¨é¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨è¯¥é¡¹ç›®</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod &apos;MZInsetLabel&apos;, &apos;~&gt; 0.1.0&apos;</div></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ä½ çš„æµ‹è¯•é¡¹ç›®ä¸­ï¼Œæ‰§è¡Œ <code>pod install</code> å³å¯ã€‚</p>
<h2 id="å¯èƒ½é‡åˆ°çš„éº»çƒ¦"><a href="#å¯èƒ½é‡åˆ°çš„éº»çƒ¦" class="headerlink" title="å¯èƒ½é‡åˆ°çš„éº»çƒ¦"></a>å¯èƒ½é‡åˆ°çš„éº»çƒ¦</h2><p><strong>1. æ‰§è¡Œ <code>pod trunk push *.podspec</code> æ—¶, å¥½ä¹…æ²¡ååº”?</strong></p>
<blockquote>
<p>è¿™ç§æƒ…å†µ, å¤§å¤šæ•°éƒ½æ˜¯å› ä¸ºä½ çš„ç½‘ç»œä¸ç»™åŠ›é€ æˆçš„, å¦‚æœä½ ç¡®å®šä½ çš„ç½‘ç»œæ²¡é—®é¢˜, é‚£ä¹ˆè¯·ç¿»å¢™.</p>
</blockquote>
<p><strong>2. æ‰§ è¡Œ <code>pod trunk push *.podspec</code> æ—¶æŠ¥é”™?</strong></p>
<p>æŠ¥é”™ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ERROR | [iOS] unknown: Encountered an unknown error (Simulator iPhone 4s is not available.) during validation.</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸º, æ›´æ–°äº† xcode8 ä¹‹åä¸å†æ”¯æŒ ios7 çš„ç¼˜æ•….</p>
<p>è§£å†³æ–¹æ¡ˆ(æˆ‘çš„), å‡çº§ cocoapods.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install -n /usr/local/bin cocoapods</div></pre></td></tr></table></figure>
<p><strong>3. pod trunk push å¤±è´¥</strong></p>
<p>å¤±è´¥æç¤ºä¿¡æ¯ç±»ä¼¼:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Cloning into &apos;master&apos;...</div><div class="line">error: RPC failed; curl 56 SSLRead() return error -36</div><div class="line">fatal: The remote end hung up unexpectedly</div><div class="line">fatal: early EOF</div><div class="line">fatal: index-pack failed</div></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ¡ˆ: æ›´æ–° gem</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem update --system</div></pre></td></tr></table></figure>
<h2 id="Git-å‘½ä»¤è¡Œæ“ä½œ"><a href="#Git-å‘½ä»¤è¡Œæ“ä½œ" class="headerlink" title="Git å‘½ä»¤è¡Œæ“ä½œ"></a>Git å‘½ä»¤è¡Œæ“ä½œ</h2><p><strong>1. å‘è¿œç¨‹ Repository æ·»åŠ  tag</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git tag -m &quot;æ³¨é‡Š&quot; 0.0.1</div><div class="line"></div><div class="line">git push --tags</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œåï¼Œå¯ä»¥çœ‹åˆ° Github Repository ä¸Šä¼šå¤šä¸€ä¸ªå¯¹åº”çš„ tag ç‰ˆæœ¬ã€‚</p>
<p><strong>2.åˆ é™¤æœ¬åœ° Tag</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git tag --delete [TagName]</div></pre></td></tr></table></figure>
<p>å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git tag --delete 0.0.1</div></pre></td></tr></table></figure>
<p><strong>3. åˆ é™¤è¿œç¨‹ Tag</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push --delete origin [TagName]</div></pre></td></tr></table></figure>
<p>å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push --delete origin 0.0.1</div></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨ Github ä¸Šé¢å¦‚æœä½ ä¸å°å¿ƒæ‰“é”™äº† Release, ç„¶ååˆ é™¤è¯¥ Release.<br>ä½ ä¼šå‘ç°, tag æ— æ³•åˆ é™¤.ä½¿ç”¨ä¸Šé¢æ–¹å¼å¦¥å¦¥çš„è§£å†³.</p>
</blockquote>
<p>å¦‚æœä½ åˆ é™¤ tagï¼Œæƒ³é‡æ–°æ‰“ä¸€ä¸ªç›¸åŒçš„ tagï¼Œéœ€è¦å…ˆåˆ é™¤æœ¬åœ°çš„ tagï¼Œå¦åˆ™ä¼šå¤±è´¥ã€‚</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS cocoapods </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS: è°ˆè°ˆ frame å’Œ bounds]]></title>
      <url>/2016/10/22/iOS-%E8%B0%88%E8%B0%88-frame-%E5%92%8C-bounds/</url>
      <content type="html"><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>å¤§å®¶çŸ¥é“, æˆ‘ä»¬å¯ä»¥è®¾ç½® view çš„å››ä¸ªè§’æˆ–è€…å…¶ä¸­ä¸€ä¸ªæˆ–è€…å‡ ä¸ªä¸ºåœ†è§’.</p>
<p>ä½¿ç”¨çš„æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">+ (instancetype)bezierPathWithRoundedRect:(CGRect)rect </div><div class="line">            byRoundingCorners:(UIRectCorner)corners </div><div class="line">            cornerRadii:(CGSize)cornerRadii;</div></pre></td></tr></table></figure>
<p>æ‹–å¥½ç•Œé¢å…ƒç´ ä¹‹å, åœ¨ä»£ç ä¸­æ¥ä¿®æ”¹å…¶ä¸ºåœ†è§’, å±…ç„¶å¤±è´¥äº†.</p>
<p>æƒ³è¦çš„æ•ˆæœæ˜¯è¿™æ ·çš„:<br><img src="/upload/images/2016/10/23/02.png" alt="1"></p>
<p>ä½†æ˜¯æœ€ç»ˆæ˜¯è¿™æ ·çš„:<br><img src="/upload/images/2016/10/23/01.png" alt="1"></p>
<p>äºæ˜¯æ€»ç»“äº†ä¸€ä¸‹, åˆ†äº«ç»™å¤§å®¶.</p>
<h2 id="è®¾ç½®åœ†è§’"><a href="#è®¾ç½®åœ†è§’" class="headerlink" title="è®¾ç½®åœ†è§’"></a>è®¾ç½®åœ†è§’</h2><p>è¿™é‡Œåˆ†ä¸¤ç§æƒ…å†µ.</p>
<p><strong>ç¬¬ä¸€ç§:</strong> åªæ”¾ç½®æ§ä»¶, ä¸è®¾ç½®çº¦æŸ.</p>
<p>1.storyboard ä¸­æ‹–å¥½æ§ä»¶.</p>
<p>æ³¨æ„: è¿™é‡Œæˆ‘å¹¶æ²¡æœ‰è®¾ç½®ä»»ä½•çº¦æŸ.</p>
<p>2.vc ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">@interface ViewController ()</div><div class="line"></div><div class="line">@property (strong, nonatomic) IBOutlet UILabel *lb;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation ViewController</div><div class="line"></div><div class="line">- (void)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    [self changeLbCorner];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)changeLbCorner</div><div class="line">&#123;</div><div class="line">   UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:self.lb.frame</div><div class="line">                                                  byRoundingCorners:UIRectCornerTopRight|UIRectCornerBottomRight</div><div class="line">                                                        cornerRadii:CGSizeMake(7, 7)];</div><div class="line">   CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];</div><div class="line">   maskLayer.frame = _lb.bounds;</div><div class="line">   maskLayer.path = maskPath.CGPath;</div><div class="line">   self.lb.layer.mask  = maskLayer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>ä»£ç ç¼–è¯‘è¿è¡Œåˆ°æ¨¡æ‹Ÿå™¨(iphone6), çœ‹ä¸åˆ°ä»»ä½•ä¸œè¥¿.</p>
<p>log æ—¥å¿—æ˜¾ç¤º lb çš„ä¿¡æ¯å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[ViewController viewDidLoad]:</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</div></pre></td></tr></table></figure>
<p>ä½ç½®ä¿¡æ¯æ˜¯æ­£ç¡®çš„, å’¨è¯¢æ£€æŸ¥å‘ç°æ˜¯å‚æ•°ä¼ å…¥é”™è¯¯, ä¿®æ”¹ changeLbCorner æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (void)changeLbCorner</div><div class="line">&#123;</div><div class="line">    UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:self.lb.bounds</div><div class="line">                                                   byRoundingCorners:UIRectCornerTopRight|UIRectCornerBottomRight</div><div class="line">                                                         cornerRadii:CGSizeMake(7, 7)];</div><div class="line">    CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];</div><div class="line">    maskLayer.frame = _lb.bounds;</div><div class="line">    maskLayer.path = maskPath.CGPath;</div><div class="line">    self.lb.layer.mask  = maskLayer;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œåªæ˜¯å°† <code>self.lb.frame</code> æ”¹æˆäº† <code>self.lb.bounds</code>.</p>
<p>å†æ¬¡è¿è¡Œå¯ä»¥çœ‹åˆ°æ•ˆæœ:<br><img src="/upload/images/2016/10/23/02.png" alt="1"></p>
<p><strong>ç¬¬äºŒç§:</strong> æ”¾ç½®æ§ä»¶å¹¶è®¾ç½®çº¦æŸ.</p>
<p>1.è®¾ç½® lb è·ç¦»çˆ¶ view å·¦è¾¹å’Œä¸Šè¾¹çš„çº¦æŸ.<br>2.è¿è¡Œä¸Šé¢çš„ä»£ç , å‘ç°, lb å¹¶æ²¡æœ‰è¢«è®¾ç½®ä¸ºåœ†è§’.<br>å¹¶ä¸” lb çš„å®½åº¦å’Œé«˜åº¦å˜å°äº†, å˜æˆäº†æ–‡å­—çš„å®é™…çš„å®½é«˜.<br><img src="/upload/images/2016/10/23/04.png" alt="1"></p>
<p>çœ‹ log:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[ViewController viewDidLoad]:</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</div></pre></td></tr></table></figure>
<p>å…¶å®è¿™ä¸ªæ—¶å€™, (ä»ä¸Šé¢å›¾ä¸­å¯ä»¥çœ‹å‡º) è¿™é‡Œçš„ä¿¡æ¯æ˜¯é”™è¯¯çš„.</p>
<p>æ­£ç¡®çš„ä¿¡æ¯åº”è¯¥æ˜¯è¿™æ ·çš„(åœ¨ viewDidAppear ä¸­)æ‰“å°ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[ViewController viewDidAppear]:</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;58.5, 19.5&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;58.5, 19.5&#125;&#125;</div></pre></td></tr></table></figure>
<p>äºæ˜¯, å°†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[self changeLbCorner];</div></pre></td></tr></table></figure>
<p>æ”¾åˆ° viewDidAppear ä¸­, åœ†è§’å°±æ­£å¸¸äº†.</p>
<p>æ¥ä¸‹æ¥, æˆ‘ä»¬æŠŠ lb çš„å®½é«˜(136*39)çº¦æŸä¹ŸåŠ ä¸Š.</p>
<p>çœ‹ä¸€ä¸‹, viewDidLoad å’Œ viewDidAppear æ–¹æ³•ä¸­æ‰“å°çš„ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[ViewController viewDidLoad]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125;</div><div class="line">[ViewController viewDidAppear:]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡º, viewDidLoad ä¸­é”™çš„ä¸€å¡Œç³Šæ¶‚.</p>
<p>è¿™é‡Œä¹Ÿè¯´æ˜ä¸€ä¸ªé—®é¢˜:</p>
<blockquote>
<p>xib æˆ–è€… storyboard ä¸­è®¾ç½®è¿‡çº¦æŸ(ç°å®å¼€å‘ä¸­, åŸºæœ¬éƒ½ä¼šè®¾ç½®çº¦æŸ)çš„ç»„ä»¶, åœ¨ viewDidLoad ä¸­å¹¶æ²¡æœ‰å®Œå…¨ layout, åªæ˜¯é¢„åŠ è½½äº†è¿™äº›ç»„ä»¶.<br>æƒ³è·å–ç»„ä»¶å¦‚ frame ä½• bounds ä¿¡æ¯, åœ¨ viewDidLoad ä¸­æ˜¯ä¸åˆé€‚ç”šè‡³æ˜¯é”™è¯¯çš„.</p>
</blockquote>
<p>é‚£ä¹ˆ, é—®é¢˜æ¥äº†, å“ªé‡Œåˆé€‚å“ªé‡Œæ­£ç¡®.</p>
<p>ä¸Šé¢å¦‚æœä½ è®¤çœŸçœ‹äº†, åœ¨ viewDidAppear ä¸­æ˜¯å¯ä»¥æ­£ç¡®è·å–çš„, é‚£ä¹ˆè¿˜æœ‰æ²¡æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥è·å–å‘¢?</p>
<h2 id="VC-ç”Ÿå‘½å‘¨æœŸå‡½æ•°"><a href="#VC-ç”Ÿå‘½å‘¨æœŸå‡½æ•°" class="headerlink" title="VC ç”Ÿå‘½å‘¨æœŸå‡½æ•°"></a>VC ç”Ÿå‘½å‘¨æœŸå‡½æ•°</h2><p>è¦å›ç­”ä¸Šé¢çš„é—®é¢˜, å¤§å®¶è¦çŸ¥é“ vc çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°.</p>
<p>ä¸Šé¢çš„ä¾‹å­, å¯ä»¥çœ‹å‡º: å½“å‡½æ•° ViewDidLoad è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒIBQutlets å·²ç»è¢«è¿æ¥ï¼Œä½†View è¿˜æ²¡æœ‰è¢«åŠ è½½å‡ºæ¥ï¼Œæ— æ³•è·å– frame ç­‰ä¿¡æ¯.<br>å¯ä»¥åœ¨ viewDidLoad ä¸­å®Œæˆåœ¨ IB ä¸­ä¸èƒ½å®Œæˆçš„ view çš„è‡ªå®šä¹‰ã€‚</p>
<p>å…³äº loadView å’Œ viewDidLoad åœ¨åé¢åšå®¢è·Ÿå¤§å®¶åˆ†äº«.</p>
<p>ä»Šå¤©è¦è¯´çš„æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">viewDidLayoutSubviews</div></pre></td></tr></table></figure>
<p><code>viewDidLayoutSubviews</code> åœ¨ VC å­è§†å›¾ä½ç½®æˆ–è€…å°ºå¯¸ (position|size) è¢«æ”¹å˜çš„æ—¶å€™è¢«è°ƒç”¨.</p>
<p>ç›´åˆ° AutoLayout å·²ç»å®Œæˆå·¥ä½œçš„æ—¶å€™æ‰ä¼šè¢«ç¡®å®šï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œå®Œ AutoLayout ä¹‹åä¼šè°ƒç”¨æ­¤æ–¹æ³•. æ¢å¥è¯è¯´, view çš„ frame å’Œ bounds è¿™ä¸ªæ—¶å€™æ˜¯æ­£ç¡®å¯ä»¥è·å–çš„.</p>
<p><code>viewDidLayoutSubviews</code> è¿™ä¸ªæ–¹æ³•åœ¨ <code>viewDidAppear</code> ä¹‹å‰è¢«è°ƒç”¨, æœ‰å¯èƒ½ä¼šè¢«è°ƒç”¨å¤šæ¬¡.</p>
<p>å³ä¾èµ– bounds æˆ–è€… frame çš„æ“ä½œï¼Œéƒ½åº”è¯¥æ”¾åœ¨<code>viewDidLayoutSubviews</code> ä¸­ï¼Œè€Œä¸æ˜¯ <code>viewDidLoad</code> æˆ– <code>viewWillAppear</code> ä¸­.</p>
<p>æ”¹å˜åçš„ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">#import &quot;ViewController.h&quot;</div><div class="line"></div><div class="line">#define MZLog(fmt, ...) NSLog((@&quot;%s\n&quot; fmt), __FUNCTION__, ##__VA_ARGS__)</div><div class="line">#define MZLogLbInfo \</div><div class="line">MZLog(@&quot;lb.bounds: %@ \nlb.frame: %@&quot;, NSStringFromCGRect(self.lb.bounds), NSStringFromCGRect(self.lb.frame))</div><div class="line"></div><div class="line">@interface ViewController ()</div><div class="line"></div><div class="line">@property (strong, nonatomic) IBOutlet UILabel *lb;</div><div class="line">@property (strong, nonatomic) IBOutlet UILabel *displayedText;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation ViewController</div><div class="line"></div><div class="line">- (void)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewWillAppear:(BOOL)animated</div><div class="line">&#123;</div><div class="line">    [super viewWillAppear:animated];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewWillLayoutSubviews</div><div class="line">&#123;</div><div class="line">    [super viewWillLayoutSubviews];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidLayoutSubviews</div><div class="line">&#123;</div><div class="line">    [super viewDidLayoutSubviews];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">    </div><div class="line">    [self changeLbCorner];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidAppear:(BOOL)animated</div><div class="line">&#123;</div><div class="line">    [super viewDidAppear:animated];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark Callback.</div><div class="line"></div><div class="line">- (void)changeLbCorner</div><div class="line">&#123;</div><div class="line">    UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:self.lb.bounds</div><div class="line">                                                   byRoundingCorners:UIRectCornerTopRight|UIRectCornerBottomRight</div><div class="line">                                                         cornerRadii:CGSizeMake(7, 7)];</div><div class="line">    CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];</div><div class="line">    maskLayer.frame = _lb.bounds;</div><div class="line">    maskLayer.path = maskPath.CGPath;</div><div class="line">    self.lb.layer.mask  = maskLayer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>æ‰“å°çš„ log å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">[ViewController viewDidLoad]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125;</div><div class="line">[ViewController viewWillAppear:]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125;</div><div class="line">[ViewController viewWillLayoutSubviews]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;0, 0&#125;, &#123;1000, 1000&#125;&#125;</div><div class="line">[ViewController viewDidLayoutSubviews]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</div><div class="line">[ViewController viewWillLayoutSubviews]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</div><div class="line">[ViewController viewDidLayoutSubviews]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</div><div class="line">[ViewController viewDidAppear:]</div><div class="line">lb.bounds: &#123;&#123;0, 0&#125;, &#123;136, 39&#125;&#125; </div><div class="line">lb.frame: &#123;&#123;39, 89&#125;, &#123;136, 39&#125;&#125;</div></pre></td></tr></table></figure>
<h2 id="frame-å’Œ-bounds"><a href="#frame-å’Œ-bounds" class="headerlink" title="frame å’Œ bounds"></a>frame å’Œ bounds</h2><p>ä¸Šé¢çš„ä¾‹å­, å¤§å®¶çœ‹åˆ°ç”±äºä¼ å…¥äº† frame è€Œä¸æ˜¯ bounds é€ æˆè®¾ç½®åœ†è§’å¤±è´¥.</p>
<p>ä¸‹é¢è¯´è¯´ frame å’Œ bounds.</p>
<h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p>ä»ç½‘ä¸Šâ€å·â€è¿‡æ¥çš„å›¾</p>
<p><img src="/upload/images/2016/10/23/03.jpg" alt="1"></p>
<blockquote>
<p>1.frame</p>
</blockquote>
<p>è¯¥ view åœ¨çˆ¶ view åæ ‡ç³»ç»Ÿä¸­çš„ä½ç½®å’Œå¤§å°(å‚ç…§ç‚¹æ˜¯ï¼Œçˆ¶åæ ‡ç³»ç»Ÿ).</p>
<blockquote>
<p>2.bounds</p>
</blockquote>
<p>è¯¥ view åœ¨æœ¬åœ°åæ ‡ç³»ç»Ÿä¸­çš„ä½ç½®å’Œå¤§å°(å‚ç…§ç‚¹æ˜¯ï¼Œæœ¬åœ°åæ ‡ç³»ç»Ÿï¼Œå°±ç›¸å½“äº view è‡ªå·±çš„åæ ‡ç³»ç»Ÿï¼Œä»¥(0,0)ç‚¹ä¸ºèµ·ç‚¹).<br>å…¶å®æœ¬åœ°åæ ‡ç³»ç»Ÿçš„å…³é”®å°±æ˜¯è¦çŸ¥é“çš„å®ƒçš„åŸç‚¹(0,0).</p>
<p>bounds é»˜è®¤å€¼æ˜¯(0, 0, width, height).é™¤éæ‰‹åŠ¨æ”¹å˜ bounds çš„å€¼.</p>
<p>å•çº¯çš„ä»æ¦‚å¿µä¸Šé¢, å¾ˆéš¾ç†è§£äºŒè€…çš„åŒºåˆ«.</p>
<p>æä¾›ä¸€ä¸ªä¾‹å­, ä¾‹å­å¤§æ¦‚æ˜¯è¿™æ ·çš„:<br>redView æ˜¯ yellowView çš„çˆ¶è§†å›¾, yellowView æ˜¯ blueView çš„çˆ¶è§†å›¾.</p>
<p>é€šè¿‡æ”¹å˜ redView çš„ bounds ä¼šå½±å“å­è§†å›¾çš„ä½ç½®(ä¸æ˜¯frame).<br>å°† redView çš„ bounds èµ·ç‚¹è®¾ä¸º(-20, -20), å­è§†å›¾ç›¸å¯¹äº redView çš„æœ¬åœ°åæ ‡(0, 0), ä¹Ÿå°±éœ€è¦å¾€ä¸‹å¢åŠ 20, è¿™æ ·, yellowView å°±å¾€ä¸‹ç§»åŠ¨äº†.</p>
<h3 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾:"></a>æ•ˆæœå›¾:</h3><p><img src="/upload/images/2016/10/23/05.png" alt="1"></p>
<p><img src="/upload/images/2016/10/23/06.png" alt="1"></p>
<p><img src="/upload/images/2016/10/23/07.png" alt="1"></p>
<h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div></pre></td><td class="code"><pre><div class="line">#import &quot;ViewController.h&quot;</div><div class="line"></div><div class="line">#define MZLog(fmt, ...) NSLog((@&quot;%s\n&quot; fmt), __FUNCTION__, ##__VA_ARGS__)</div><div class="line">#define MZLogLbInfo \</div><div class="line">MZLog(@&quot;lb.bounds: %@ \nlb.frame: %@&quot;, NSStringFromCGRect(self.lb.bounds), NSStringFromCGRect(self.lb.frame))</div><div class="line"></div><div class="line">@interface ViewController ()</div><div class="line"></div><div class="line">@property (strong, nonatomic) IBOutlet UILabel *lb;</div><div class="line">@property (strong, nonatomic) IBOutlet UILabel *displayedText;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation ViewController</div><div class="line">&#123;</div><div class="line">    UIView *redView;</div><div class="line">    UIView *yellowView;</div><div class="line">    UIView *blueView;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">    </div><div class="line">    </div><div class="line">    // å°† redView æ·»åŠ åˆ° self.view</div><div class="line">    &#123;</div><div class="line">        redView = [[UIView alloc] initWithFrame:CGRectMake(100, 200, 120, 120)];</div><div class="line">        redView.backgroundColor = [UIColor redColor];</div><div class="line">        [self.view addSubview:redView];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // å°† yellowView æ·»åŠ åˆ° redView</div><div class="line">    &#123;</div><div class="line">        yellowView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 90, 90)];</div><div class="line">        yellowView.backgroundColor = [UIColor yellowColor];</div><div class="line">        [redView addSubview:yellowView];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // å°† blueView æ·»åŠ åˆ° yellowView</div><div class="line">    &#123;</div><div class="line">        blueView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 60, 60)];</div><div class="line">        blueView.backgroundColor = [UIColor blueColor];</div><div class="line">        [yellowView addSubview:blueView];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    [self logViewInfo];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewWillAppear:(BOOL)animated</div><div class="line">&#123;</div><div class="line">    [super viewWillAppear:animated];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewWillLayoutSubviews</div><div class="line">&#123;</div><div class="line">    [super viewWillLayoutSubviews];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidLayoutSubviews</div><div class="line">&#123;</div><div class="line">    [super viewDidLayoutSubviews];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">    </div><div class="line">    [self changeLbCorner];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewDidAppear:(BOOL)animated</div><div class="line">&#123;</div><div class="line">    [super viewDidAppear:animated];</div><div class="line">    </div><div class="line">    MZLogLbInfo;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark Callback.</div><div class="line"></div><div class="line">- (void)changeLbCorner</div><div class="line">&#123;</div><div class="line">    UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:self.lb.bounds</div><div class="line">                                                   byRoundingCorners:UIRectCornerTopRight|UIRectCornerBottomRight</div><div class="line">                                                         cornerRadii:CGSizeMake(7, 7)];</div><div class="line">    CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];</div><div class="line">    maskLayer.frame = _lb.bounds;</div><div class="line">    maskLayer.path = maskPath.CGPath;</div><div class="line">    self.lb.layer.mask  = maskLayer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (IBAction)doResetAction:(id)sender</div><div class="line">&#123;</div><div class="line">    [UIView animateWithDuration:1.0f animations:^&#123;</div><div class="line">        [redView setBounds:CGRectMake(0, 0, 120, 120)];</div><div class="line">        [yellowView setBounds:CGRectMake(0, 0, 90, 90)];</div><div class="line">    &#125; completion:^(BOOL finished) &#123;</div><div class="line">        [self logViewInfo];</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (IBAction)doChangeRedViewBounds:(id)sender</div><div class="line">&#123;</div><div class="line">    [UIView animateWithDuration:1.0f animations:^&#123;</div><div class="line">        [redView setBounds:CGRectMake(-20, -20, 120, 120)];</div><div class="line">    &#125; completion:^(BOOL finished) &#123;</div><div class="line">        [self logViewInfo];</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (IBAction)doChangeYellowViewBounds:(id)sender</div><div class="line">&#123;</div><div class="line">    [UIView animateWithDuration:1.0f animations:^&#123;</div><div class="line">        [yellowView setBounds:CGRectMake(-20, -20, 90, 90)];</div><div class="line">    &#125; completion:^(BOOL finished) &#123;</div><div class="line">        [self logViewInfo];</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark Display Debug Info.</div><div class="line"></div><div class="line">- (void)logViewInfo</div><div class="line">&#123;</div><div class="line">    NSString *log4rView = [NSString stringWithFormat:@&quot;RedView\nframe:%@ \nbounds:%@&quot;,</div><div class="line">                           NSStringFromCGRect(redView.frame), NSStringFromCGRect(redView.bounds)];</div><div class="line">    NSString *log4yView = [NSString stringWithFormat:@&quot;YellowView\nframe:%@ \nbounds:%@&quot;,</div><div class="line">                           NSStringFromCGRect(yellowView.frame), NSStringFromCGRect(yellowView.bounds)];</div><div class="line">    NSString *log4bView = [NSString stringWithFormat:@&quot;BlueView\nframe:%@ \nbounds:%@&quot;,</div><div class="line">                           NSStringFromCGRect(blueView.frame), NSStringFromCGRect(blueView.bounds)];</div><div class="line">    </div><div class="line">    NSString *log = [NSString stringWithFormat:@&quot;%@\n%@\n%@&quot;, log4rView, log4yView, log4bView];</div><div class="line">    [self display:log];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)display:(NSString *)content</div><div class="line">&#123;</div><div class="line">    self.displayedText.text = content;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>frame, æè¿°çš„æ˜¯å½“å‰è§†å›¾åœ¨å…¶çˆ¶è§†å›¾ä¸­çš„ä½ç½®å’Œå¤§å°.<br>bounds, æè¿°çš„æ˜¯å½“å‰è§†å›¾åœ¨å…¶è‡ªèº«åæ ‡ç³»ç»Ÿä¸­çš„ä½ç½®å’Œå¤§å°.</li>
</ul>
<p>æ‰€ä»¥, bounds é»˜è®¤æ˜¯ <code>(0, 0, frame.size.width, frame.size.height)</code></p>
<p>å¦å¤–, è¿˜æœ‰ä¸€ä¸ª <code>center</code> æè¿°çš„æ˜¯å½“å‰è§†å›¾çš„ä¸­å¿ƒç‚¹åœ¨å…¶çˆ¶è§†å›¾ä¸­çš„ä½ç½®.</p>
<ul>
<li>bounds å’Œ frame æ˜¯ä¸¤ä¸ªä¸ç­‰åŒçš„æ¦‚å¿µ, æ”¹å˜ bounds ä¼šå½±å“å­è§†å›¾çš„ä½ç½®(äººçœ¼çœ‹åˆ°å…¶æ”¹å˜äº†ä½ç½®), è®¾ç½® bounds å¯ä»¥ä¿®æ”¹è‡ªå·±åæ ‡ç³»çš„åŸç‚¹ä½ç½®. ä½†æ˜¯ä¸ä¼šæ”¹å˜å­è§†å›¾çš„ bounds å’Œ frame.</li>
</ul>
<blockquote>
<p>æ˜ç™½ä¸Šé¢çš„é“ç†å¾ˆé‡è¦, iOS ä¸­æ»šåŠ¨è§†å›¾èƒ½è®©ä½ çœ‹åˆ°å…¶ä¸­çš„å†…å®¹, æ­£æ˜¯åˆ©ç”¨äº† contentoffset å’Œ bounds å±æ€§.</p>
<p>è¿™é‡Œä»¥ tableView ä¸ºä¾‹å­, å½“æˆ‘ä»¬å‘ä¸Šæ»šåŠ¨ tableView, tableView çš„ contentOffset å’Œ bounds çš„åæ ‡éƒ½æ˜¯æ­£æ•°, ç›¸å½“äºå…¶æœ¬åœ°åæ ‡(0, 0)æ”¹å˜äº†å³å¢åŠ äº†(åæ ‡ç³»å¾€ä¸‹ä¸ºå¢åŠ ), é‚£ä¹ˆå…¶å­è§†å›¾å°±ä¼šå‘ä¸Šå».</p>
<p>å‘ä¸‹æ»‘åŠ¨æ—¶, ä¹Ÿæ˜¯åŒä¸€ä¸ªé“ç†.<br>å¯ä»¥é€šè¿‡è¿è¡Œ <a href="https://github.com/veryitman/iOSDemo/tree/master/na" target="_blank" rel="noopener">å®Œæ•´ Demo</a> ä¸­[æŸ¥çœ‹ TableView]æŒ‰é’®æ¥æ‰“å¼€ä¾‹å­, çœ‹æ—¥å¿—.</p>
</blockquote>
<ul>
<li><p>æ”¹å˜å­è§†å›¾æ‰€æœ‰çˆ¶è§†å›¾çš„ bounds, å­è§†å›¾çš„ä½ç½®æ˜¯ç´¯åŠ æ”¹å˜çš„.<br>å¦‚ä¸Šé¢æ”¹å˜ redView å’Œ yellowView çš„ bounds, blueView çš„ä½ç½®ç›¸å¯¹ redView å¾€ä¸‹ç§»åŠ¨äº† 40.</p>
</li>
<li><p>å½“åŒä¸€ä¸ªè§†å›¾çš„ bounds å¤§äº frame, ä¼šå¯¼è‡´ frame è¢«æ’‘å¤§ï¼Œframe çš„ x, y, width, height éƒ½ä¼šè¢«æ”¹å˜. åä¹‹, bounds å°äº frame, frame ä¹Ÿä¼šå˜å°.</p>
</li>
</ul>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><ol>
<li><p>GitHub ä¸Šé¢å¯ä»¥ä¸‹è½½ <a href="https://github.com/veryitman/iOSDemo/tree/master/na" target="_blank" rel="noopener">å®Œæ•´ Demo</a></p>
</li>
<li><p>æ¨èä¹‹å‰å†™åœ¨ CSDN ä¸Šçš„åšæ–‡: <a href="http://blog.csdn.net/veryitman/article/details/51622235" target="_blank" rel="noopener">iOS UI æŠ€å·§: è§†å›¾æ— æ³•è¢«ç‚¹å‡»
</a></p>
</li>
</ol>
<p>å¯å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·:<br><img src="/upload/me/qrcode_wx.jpg" alt="1"></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS frame bounds </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RN: æ¨¡æ‹Ÿ Mobx]]></title>
      <url>/2016/10/11/RN-%E6%A8%A1%E6%8B%9F-Mobx/</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>çœ‹è¿‡ [React Native ä½¿ç”¨ Mobx] è¿™ç¯‡åšå®¢çš„åŒå­¦, å¯¹ Mobx åº”è¯¥æœ‰äº†ä¸€ä¸ªç®€å•ç›´è§‚çš„è®¤è¯†.</p>
<p>å…¶å®, æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ RN ä¸­çš„ State æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœ.</p>
<p>ä»Šå¤©çš„ä¸»è¦å†…å®¹æ˜¯ä½¿ç”¨ State æ¥æ¨¡æ‹Ÿ Mobx, ä¹Ÿç®—æ˜¯å¯¹ Mobx çš„è¿›ä¸€æ­¥è®¤è¯†.</p>
<p>æ•ˆæœ</p>
<p>å®ç°æ•ˆæœå’Œ [React Native ä½¿ç”¨ Mobx] ä¸­çš„æ•ˆæœä¸€è‡´, åªæ˜¯ä»£ç æ²¡æœ‰ä½¿ç”¨ Mobx æ¡†æ¶.</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="LegacyCounter-js"><a href="#LegacyCounter-js" class="headerlink" title="LegacyCounter.js"></a>LegacyCounter.js</h3><blockquote>
<p>Add å’Œ Minus ä¸¤ä¸ªæŒ‰é’®åˆ†åˆ«è§¦å‘å„è‡ªçš„å›è°ƒ, æ¥æ›´æ–° state.<br>ä½¿ç”¨ state çš„å˜åŒ–æ¥åˆ°è¾¾æ›´æ–° View (è®¡æ•°çš„ Text ä¼šç›¸åº”çš„åšå‡ºå˜åŒ–)çš„ç›®çš„.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * æ¨¡æ‹Ÿ Mobx åœ¨ ReactNative ä¸Šçš„ä¸€ä¸ªå°ä¾‹å­.</div><div class="line"> * </div><div class="line"> * state -&gt; view</div><div class="line"> */</div><div class="line">&apos;use strict&apos;;</div><div class="line">import React, &#123; Component &#125; from &apos;react&apos;;</div><div class="line">import &#123;</div><div class="line">  StyleSheet,</div><div class="line">  View,</div><div class="line">  Text,</div><div class="line">  TouchableHighlight</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line">class LegacyCounter extends Component &#123;</div><div class="line">    //æ„é€ æ–¹æ³•</div><div class="line">    constructor(props) &#123;</div><div class="line">        super(props);</div><div class="line">    </div><div class="line">        this.state = &#123;</div><div class="line">            //è®¡æ•°</div><div class="line">            counter: 0</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">    render () &#123;</div><div class="line">        return (</div><div class="line">          &lt;View style = &#123;styles.container&#125;&gt;</div><div class="line">            &#123;/*åŠ ä¸€*/&#125;</div><div class="line">            &lt;TouchableHighlight</div><div class="line">                onPress = &#123;() =&gt; &#123;this.setState(&#123;</div><div class="line">                    counter: ++this.state.counter</div><div class="line">                &#125;)&#125;&#125;&gt;</div><div class="line">                &lt;Text&gt;Add&lt;/Text&gt;</div><div class="line">            &lt;/TouchableHighlight&gt;</div><div class="line">            &#123;/* æ˜¾ç¤ºå¤„ç†ç»“æœ */&#125;</div><div class="line">            &lt;Text style = &#123;styles.resultTxtStyle&#125;&gt;</div><div class="line">            &#123;this.state.counter&#125;</div><div class="line">            &lt;/Text&gt;</div><div class="line">            &#123;/*å‡ä¸€*/&#125;</div><div class="line">            &lt;TouchableHighlight </div><div class="line">                onPress = &#123;() =&gt; &#123;this.setState(&#123;</div><div class="line">                    counter: --this.state.counter</div><div class="line">                &#125;)&#125;&#125;&gt;</div><div class="line">                &lt;Text&gt;Minus&lt;/Text&gt;</div><div class="line">            &lt;/TouchableHighlight&gt;</div><div class="line">          &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">export default class LegacyComponent extends Component &#123;</div><div class="line">    render () &#123;</div><div class="line">        return (</div><div class="line">            &lt;View style = &#123;&#123;flex: 1, marginTop: 64&#125;&#125;&gt;</div><div class="line">            </div><div class="line">                &lt;LegacyCounter/&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">/* æ ·å¼å®šä¹‰ */</div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">    container: &#123;</div><div class="line">        flexDirection: &apos;row&apos;,</div><div class="line">        justifyContent: &apos;space-around&apos;</div><div class="line">    &#125;,</div><div class="line">    resultTxtStyle: &#123;</div><div class="line">        fontSize: 22, </div><div class="line">        color: &apos;red&apos;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="index-ios-js"><a href="#index-ios-js" class="headerlink" title="index.ios.js"></a>index.ios.js</h3><blockquote>
<p>è¿™ä¸ªæ–‡ä»¶å¾ˆç®€å•, åªæ˜¯è°ƒç”¨ LegacyCounter ä¸­çš„ç»„ä»¶.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">import React, &#123; Component &#125; from &apos;react&apos;;</div><div class="line">//å¼•å…¥è‡ªå®šä¹‰æ¨¡å—</div><div class="line">import LegacyComponent from &apos;./js/Mobx/LegacyCounter&apos;</div><div class="line">import &#123;</div><div class="line">  AppRegistry</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line">class RNMobxDemo extends Component &#123;</div><div class="line">    render() &#123;</div><div class="line">        return(</div><div class="line">            &lt;LegacyComponent/&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">AppRegistry.registerComponent(&apos;RNMobxDemo&apos;, () =&gt; MZRNTutorial);</div></pre></td></tr></table></figure>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº RN ä¸­ State çš„çŸ¥è¯†, è¯·ç§»æ­¥å®˜æ–¹æ–‡æ¡£æŸ¥é˜… State çš„ç”¨æ³•.</p>
<p>åç»­ä¼šç»™å¤§å®¶å¸¦æ¥æ›´å¤šå…³äº RN è¿™äº›æ–¹é¢çš„ä¸œè¥¿.</p>
]]></content>
      
        <categories>
            
            <category> ReactNative </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS Android ReactNative </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RN: ä½¿ç”¨ Mobx]]></title>
      <url>/2016/10/06/RN-%E4%BD%BF%E7%94%A8-Mobx/</url>
      <content type="html"><![CDATA[<h2 id="æ¥ç”±"><a href="#æ¥ç”±" class="headerlink" title="æ¥ç”±"></a>æ¥ç”±</h2><p>åœ¨ <a href="https://jsfiddle.net/24u7juu0/" target="_blank" rel="noopener">JSFiddler</a> ä¸Šé¢çœ‹åˆ° React ç»“åˆ Mobx çš„ä¸€ä¸ªå°ä¾‹å­.</p>
<p>çˆ±ä¸é‡Šæ‰‹, é‚æ‹¿æ¥æ”¹é€ ä¸€ä¸‹, è®©å…¶èƒ½åœ¨ RN ä¸Šé¢ä¸€å±•é›„é£.</p>
<p>ä¹‹å‰å¬è¿‡ Mobx, è¯´æ˜¯è¦æ›¿ä»£ Redux, åæ­£æˆ‘æ˜¯ä¸çŸ¥é“è¿™äº›ä¸œä¸œ, ç¬¬ä¸€æ¬¡å¬è¯´æ²¡æœ‰ä»€ä¹ˆæ„Ÿè§‰!<br>å¦‚ä»Šåˆå†æ¬¡å¶é‡ Mobx, å†³å®šè®¤çœŸå­¦ä¹ ä¸€ä¸‹å®ƒ.</p>
<h2 id="Mobx-ç®€ä»‹"><a href="#Mobx-ç®€ä»‹" class="headerlink" title="Mobx ç®€ä»‹"></a>Mobx ç®€ä»‹</h2><p>Mobx çš„ <a href="https://github.com/mobxjs/mobx" target="_blank" rel="noopener">github</a> åœ°å€.<br>ç›®å‰å…³äºä»–å’Œ React Native çš„(ä¸­æ–‡)èµ„æ–™ä¸å¤š, å¤§å¤šæ•°æ˜¯å…³äº React çš„.</p>
<p>çœ‹æ¥æƒ³å­¦å¥½ React Native, è¿˜æ˜¯è¦åšå¥½ React çš„åŠŸè¯¾å‘€!</p>
<p>å®˜ç½‘ç»™äº†ä¸€ä¸ª Mobx çš„å›¾:<br><img src="/upload/images/2016/10/08/rn_mobx_ef4.png" alt="1"></p>
<p>æˆ‘ä¹Ÿæ˜¯åˆšæ¥è§¦è¿™ä¸ªã€Œç‰›é€¼é—ªé—ªã€çš„ Mobx, å…±å‹‰!</p>
<h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p>ä»Šå¤©çš„ä¾‹å­å¾ˆç®€å•, æ•ˆæœå›¾å¦‚ä¸‹<br><img src="/upload/images/2016/10/08/rn_mobx_ef1.png" alt="1"></p>
<p>ç‚¹å‡» Add<br><img src="/upload/images/2016/10/08/rn_mobx_ef3.png" alt="1"></p>
<p>ç‚¹å‡» Minus<br><img src="/upload/images/2016/10/08/rn_mobx_ef2.png" alt="1"></p>
<p>ä¸‹é¢å…·ä½“è¯´è¯´å¦‚ä½•æå®šè¿™ä¸ª Demo.</p>
<h2 id="å‡†å¤‡ã€Œææ–™ã€"><a href="#å‡†å¤‡ã€Œææ–™ã€" class="headerlink" title="å‡†å¤‡ã€Œææ–™ã€"></a>å‡†å¤‡ã€Œææ–™ã€</h2><p>è¿™é‡Œå‡è®¾ä½ å·²ç»å…·å¤‡ React Native çš„åŸºæœ¬å¼€å‘ç¯å¢ƒ, è‡³å°‘æˆåŠŸè¿è¡Œè¿‡ä¸€æ¬¡ React Native çš„ç¨‹åº.</p>
<h3 id="1-åˆ›å»º-React-Native-é¡¹ç›®"><a href="#1-åˆ›å»º-React-Native-é¡¹ç›®" class="headerlink" title="1.åˆ›å»º React Native é¡¹ç›®"></a>1.åˆ›å»º React Native é¡¹ç›®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native init RNMobxDemo</div></pre></td></tr></table></figure>
<p>ä½ ä¹Ÿå¯ä»¥ç»™ä½ çš„å·¥ç¨‹å–ä¸€ä¸ªä½ å–œæ¬¢çš„åå­—.<br>è¿™é‡Œå§‘ä¸”ç§°ä¹‹ä¸º RNMobxDemo</p>
<h3 id="2-å®‰è£…-mobx-å’Œ-mobx-react"><a href="#2-å®‰è£…-mobx-å’Œ-mobx-react" class="headerlink" title="2.å®‰è£… mobx å’Œ mobx-react"></a>2.å®‰è£… mobx å’Œ mobx-react</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm i mobx mobx-react --save</div></pre></td></tr></table></figure>
<h3 id="3-Counter-js"><a href="#3-Counter-js" class="headerlink" title="3.Counter.js"></a>3.Counter.js</h3><blockquote>
<p>è¯¥æ–‡ä»¶ä½¿ç”¨äº† mobx å’Œ mobx-react çš„ç»„ä»¶.</p>
</blockquote>
<p>å…·ä½“ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">&apos;use strict&apos;;</div><div class="line">import React, &#123; Component &#125; from &apos;react&apos;;</div><div class="line">import &#123;</div><div class="line">  StyleSheet,</div><div class="line">  View,</div><div class="line">  Text,</div><div class="line">  TouchableHighlight</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line">import &#123; observer &#125; from &apos;mobx-react/native&apos;;</div><div class="line">import &#123; observable &#125; from &apos;mobx&apos;;</div><div class="line">// è¢«è§‚å¯Ÿè€…, è§‚å¯Ÿ counter å˜é‡  </div><div class="line">const storer = observable(&#123;</div><div class="line">    counter: 0</div><div class="line">&#125;);</div><div class="line">//---------------------------------</div><div class="line">//  ES6 å†™æ³•: Arrow Function</div><div class="line">//---------------------------------</div><div class="line">storer.plus =  () =&gt; &#123;</div><div class="line">    storer.counter ++;</div><div class="line">&#125;;</div><div class="line">storer.minus = () =&gt; &#123;</div><div class="line">    storer.counter --;</div><div class="line">&#125;;</div><div class="line">class Counter extends Component &#123;</div><div class="line">    render () &#123;</div><div class="line">        return (</div><div class="line">          &lt;View style = &#123;styles.container&#125;&gt;</div><div class="line">            &#123;/*åŠ ä¸€*/&#125;</div><div class="line">            &lt;TouchableHighlight</div><div class="line">                onPress = &#123;() =&gt; &#123;this.props.store.plus()&#125;&#125;&gt;</div><div class="line">                &lt;Text&gt;Add&lt;/Text&gt;</div><div class="line">            &lt;/TouchableHighlight&gt;</div><div class="line">            &#123;/* æ˜¾ç¤ºå¤„ç†ç»“æœ */&#125;</div><div class="line">            &lt;Text style = &#123;styles.resultTxtStyle&#125;&gt;</div><div class="line">            &#123;this.props.store.counter&#125;</div><div class="line">            &lt;/Text&gt;</div><div class="line">            &#123;/*å‡ä¸€*/&#125;</div><div class="line">            &lt;TouchableHighlight </div><div class="line">                onPress = &#123;() =&gt; &#123;storer.minus()&#125;&#125;&gt;</div><div class="line">                &lt;Text&gt;Minus&lt;/Text&gt;</div><div class="line">            &lt;/TouchableHighlight&gt;</div><div class="line">          &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">// ä½¿ç”¨ observer åˆ›å»º</div><div class="line">const CounterComponent = observer(Counter);</div><div class="line">export default class ReactionsComponent extends Component &#123;</div><div class="line">    render () &#123;</div><div class="line">        return (</div><div class="line">            &lt;View style = &#123;&#123;flex: 1, marginTop: 64&#125;&#125;&gt;</div><div class="line">            </div><div class="line">                &lt;CounterComponent store = &#123;storer&#125; /&gt; </div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">/* æ ·å¼å®šä¹‰ */</div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">    container: &#123;</div><div class="line">        flexDirection: &apos;row&apos;,</div><div class="line">        justifyContent: &apos;space-around&apos;</div><div class="line">    &#125;,</div><div class="line">    resultTxtStyle: &#123;</div><div class="line">        fontSize: 22, </div><div class="line">        color: &apos;red&apos;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="4-index-ios-js"><a href="#4-index-ios-js" class="headerlink" title="4.index.ios.js"></a>4.index.ios.js</h3><blockquote>
<p>è¯¥æ–‡ä»¶ä½¿ç”¨è‡ªå®šä¹‰çš„ç»„ä»¶ ReactionsComponent</p>
</blockquote>
<p>å…·ä½“ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">import React, &#123; Component &#125; from &apos;react&apos;;</div><div class="line">//å¼•å…¥è‡ªå®šä¹‰æ¨¡å—</div><div class="line">import ReactionsComponent from &apos;./js/Mobx/Counter&apos;</div><div class="line">import &#123;</div><div class="line">  AppRegistry</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line">class RNMobxDemo extends Component &#123;</div><div class="line">    render() &#123;</div><div class="line">        return(</div><div class="line">            &lt;ReactionsComponent/&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">AppRegistry.registerComponent(&apos;RNMobxDemo&apos;, () =&gt; MZRNTutorial);</div></pre></td></tr></table></figure>
<p>Mobx æ”¯æŒã€Œæ³¨è§£ã€.</p>
<p>è¿™é‡Œçš„æ³¨è§£å°±æ˜¯ ES7 ä¸­çš„ decorators (è£…é¥°è€…æ¨¡å¼).</p>
<p>ä¸‹é¢ä»£ç æ˜¯ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥å£°æ˜, ä½†æ˜¯ä½ éœ€è¦å®‰è£…ç›¸å…³çš„æ’ä»¶(babel plugin)æ¥æ”¯æŒ.</p>
<p>å®‰è£…è¯¥æ’ä»¶å¾ˆç®€å•, åœ¨é¡¹ç›®æ ¹ç›®å½•æŒ‰ç…§ä¸‹é¢æ­¥éª¤å³å¯:</p>
<blockquote>
<p>Step 1: åˆ›å»º .babelrc æ–‡ä»¶</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">touch .babelrc</div></pre></td></tr></table></figure>
<blockquote>
<p>Step 2: ç¼–è¾‘ .babelrc æ–‡ä»¶</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> &apos;presets&apos;: [&apos;react-native&apos;],</div><div class="line"> &apos;plugins&apos;: [&apos;transform-decorators-legacy&apos;]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Step 3: å®‰è£…æ’ä»¶</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm i babel-plugin-transform-decorators-legacy babel-preset-react-native-stage-0 --save-dev</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ã€ŒCounter.jsã€, ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line">&apos;use strict&apos;;</div><div class="line">import React, &#123; Component &#125; from &apos;react&apos;;</div><div class="line">import &#123;</div><div class="line">  StyleSheet,</div><div class="line">  View,</div><div class="line">  Text,</div><div class="line">  TouchableHighlight</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line">import &#123; observer &#125; from &apos;mobx-react/native&apos;;</div><div class="line">import &#123; observable &#125; from &apos;mobx&apos;;</div><div class="line">// è¢«è§‚å¯Ÿè€…, è§‚å¯Ÿ counter å˜é‡  </div><div class="line">const storer = observable(&#123;</div><div class="line">    counter: 0</div><div class="line">&#125;);</div><div class="line">//---------------------------------</div><div class="line">//  ES6 å†™æ³•: Arrow Function</div><div class="line">//---------------------------------</div><div class="line">storer.plus =  () =&gt; &#123;</div><div class="line">    storer.counter ++;</div><div class="line">&#125;;</div><div class="line">storer.minus = () =&gt; &#123;</div><div class="line">    storer.counter --;</div><div class="line">&#125;;</div><div class="line">@observer //ä½¿ç”¨@æ–¹å¼æ¥å‰ç½®å£°æ˜</div><div class="line">class Counter extends Component &#123;</div><div class="line">    render () &#123;</div><div class="line">        return (</div><div class="line">          &lt;View style = &#123;styles.container&#125;&gt;</div><div class="line">            &#123;/*åŠ ä¸€*/&#125;</div><div class="line">            &lt;TouchableHighlight</div><div class="line">                onPress = &#123;() =&gt; &#123;this.props.store.plus()&#125;&#125;&gt;</div><div class="line">                &lt;Text&gt;Add&lt;/Text&gt;</div><div class="line">            &lt;/TouchableHighlight&gt;</div><div class="line">            &#123;/* æ˜¾ç¤ºå¤„ç†ç»“æœ */&#125;</div><div class="line">            &lt;Text style = &#123;styles.resultTxtStyle&#125;&gt;</div><div class="line">            &#123;this.props.store.counter&#125;</div><div class="line">            &lt;/Text&gt;</div><div class="line">            &#123;/*å‡ä¸€*/&#125;</div><div class="line">            &lt;TouchableHighlight </div><div class="line">                onPress = &#123;() =&gt; &#123;storer.minus()&#125;&#125;&gt;</div><div class="line">                &lt;Text&gt;Minus&lt;/Text&gt;</div><div class="line">            &lt;/TouchableHighlight&gt;</div><div class="line">          &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">export default class ReactionsComponent extends Component &#123;</div><div class="line">    render () &#123;</div><div class="line">        return (</div><div class="line">            &lt;View style = &#123;&#123;flex: 1, marginTop: 64&#125;&#125;&gt;</div><div class="line">            </div><div class="line">                &lt;Counter store = &#123;storer&#125; /&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">/* æ ·å¼å®šä¹‰ */</div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">    container: &#123;</div><div class="line">        flexDirection: &apos;row&apos;,</div><div class="line">        justifyContent: &apos;space-around&apos;</div><div class="line">    &#125;,</div><div class="line">    resultTxtStyle: &#123;</div><div class="line">        fontSize: 22, </div><div class="line">        color: &apos;red&apos;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä»ä¾‹å­å¯ä»¥çœ‹å‡º, storer ç›¸å½“äº state, å½“ state å‘ç”Ÿæ”¹å˜äº†, è§†å›¾ View ä¹Ÿè·Ÿç€å˜åŒ–.<br>ä¹Ÿå°±æ˜¯çŠ¶æ€é©±åŠ¨.</p>
<p>Android å¼€å‘çš„åŒå­¦åº”è¯¥çŸ¥é“ Adapter å’Œ notifyDatasetChanged çš„æœºåˆ¶, å½“æ•°æ®æºå‘ç”Ÿå˜åŒ–çš„æ—¶å€™, å¯ä»¥é€šçŸ¥è§†å›¾è¿›è¡Œåˆ·æ–°æ“ä½œ.</p>
<p>è¿™é‡Œçš„ Mobx ä¹Ÿå¯ä»¥è¿™ä¹ˆç®€å•çš„ç†è§£.</p>
<p>Mobx çš„å¼ºå¤§ä¹‹å¤„è¿˜æœ‰å¾ˆå¤š, éœ€è¦æ…¢æ…¢å­¦ä¹ å’ŒæŒ–æ˜.</p>
]]></content>
      
        <categories>
            
            <category> ReactNative </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS Android ReactNative </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RN: 0.34 è¿è¡Œåœ¨ Android çš„é—®é¢˜]]></title>
      <url>/2016/09/26/RN-0-34-%E8%BF%90%E8%A1%8C%E5%9C%A8-Android-%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©é—²æ¥æ— äº‹, æƒ³ä½¿ç”¨ RN å·¥ç¨‹åœ¨ Android è®¾å¤‡ä¸Šé¢è·‘è·‘.</p>
<p>æƒ³çœ‹çœ‹è¿è¡Œæ•ˆæœæ€ä¹ˆæ ·?!</p>
<h2 id="é€‚åˆè¯»è€…"><a href="#é€‚åˆè¯»è€…" class="headerlink" title="é€‚åˆè¯»è€…"></a>é€‚åˆè¯»è€…</h2><ul>
<li>æœ‰ Android å¼€å‘åŸºç¡€.</li>
<li>ä¼šä½¿ç”¨ Android Studio.</li>
<li>åˆçº§ React Native çš„å¼€å‘è€….</li>
</ul>
<h2 id="å¼€å‘ç¯å¢ƒå’Œå·¥å…·"><a href="#å¼€å‘ç¯å¢ƒå’Œå·¥å…·" class="headerlink" title="å¼€å‘ç¯å¢ƒå’Œå·¥å…·"></a>å¼€å‘ç¯å¢ƒå’Œå·¥å…·</h2><ul>
<li>Android Studio 2.2</li>
<li>ReactNative 0.34</li>
<li>Android æ¨¡æ‹Ÿå™¨</li>
<li>Mac æ“ä½œç³»ç»Ÿ</li>
</ul>
<h2 id="é¢„æœŸæ•ˆæœ"><a href="#é¢„æœŸæ•ˆæœ" class="headerlink" title="é¢„æœŸæ•ˆæœ"></a>é¢„æœŸæ•ˆæœ</h2><p>ä¸å‡ºæ‰€æ–™, çœŸçš„ä¸èƒ½ä¸€å¸†é£é¡ºçš„ Run.</p>
<p>åœ¨æˆ‘çš„åšå®¢ ReactNative: ä¸ä¸€æ ·çš„ HelloWorld ä¸­å±•ç¤ºäº† RN åœ¨ iOS ä¸Šé¢çš„è¿è¡Œæƒ…å†µ.</p>
<p>ä»Šå¤©è¿˜æ˜¯è¿™ä¸ªä¾‹å­, éƒ¨ç½²å’Œè¿è¡Œåˆ° Android ä¸Šé¢.</p>
<p>æ•ˆæœå¦‚ä¸‹:<br><img src="/upload/images/2016/9/26/rn_and_eff_01.png" alt="1"></p>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, é‡åˆ°å‡ ä¸ªé—®é¢˜.</p>
<p>ç‰¹æ­¤è®°å½•.</p>
<h2 id="é—®é¢˜æè¿°å’Œè§£å†³"><a href="#é—®é¢˜æè¿°å’Œè§£å†³" class="headerlink" title="é—®é¢˜æè¿°å’Œè§£å†³"></a>é—®é¢˜æè¿°å’Œè§£å†³</h2><h3 id="é—®é¢˜1-ç›´æ¥è¿è¡Œ-crash"><a href="#é—®é¢˜1-ç›´æ¥è¿è¡Œ-crash" class="headerlink" title="é—®é¢˜1: ç›´æ¥è¿è¡Œ crash"></a>é—®é¢˜1: ç›´æ¥è¿è¡Œ crash</h3><p>log æè¿°(éƒ¨åˆ†)</p>
<blockquote>
<p>E/AndroidRuntime: FATAL EXCEPTION: main<br>Process: com.mzrntutorial, PID: 5849<br>java.lang.RuntimeException:<br>Unable to start activity ComponentInfo{com.mzrntutorial/com.mzrntutorial.MainActivity}: java.lang.ClassCastException: android.app.Application cannot be cast to com.facebook.react.ReactApplication<br>at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2416)<br>at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2476)     </p>
</blockquote>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h3><p>Manifest.xml é…ç½® Application åç§°</p>
<p>android:name=â€.MainApplicationâ€</p>
<h3 id="é—®é¢˜2"><a href="#é—®é¢˜2" class="headerlink" title="é—®é¢˜2:"></a>é—®é¢˜2:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">could not get batchedbridge make sure your bundle is packaged correctly</div></pre></td></tr></table></figure>
<p>è§£å†³é—®é¢˜1å, å†æ¬¡è¿è¡Œ, ä¼šæŠ¥é—®é¢˜2.<br>è¯¥é—®é¢˜æ˜¯å› ä¸ºæ²¡æœ‰å¯åŠ¨æœ¬åœ°çš„ server.</p>
<p>ä½¿ç”¨ Xcode å¯ä»¥è‡ªåŠ¨è¿è¡Œæœ¬åœ° server.<br>å¯ä»¥å‚è€ƒåšå®¢ React Native å¦‚ä½•å¯åŠ¨ local server</p>
<h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h3><p>æ‰‹åŠ¨å¯åŠ¨ server.</p>
<p>cd é¡¹ç›®æ ¹ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native start</div></pre></td></tr></table></figure>
<h3 id="é—®é¢˜3"><a href="#é—®é¢˜3" class="headerlink" title="é—®é¢˜3:"></a>é—®é¢˜3:</h3><blockquote>
<p>æ¨¡æ‹Ÿå™¨æ²¡æœ‰ menu æŒ‰é”®, æ— æ³• Reload</p>
</blockquote>
<p>è¿™ä¸ªå…¶å®ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜, ä½†æ˜¯å¯¹äºåˆå­¦è€…, ä¹Ÿç®—æ˜¯ä¸€ä¸ªé—®é¢˜.</p>
<p>æ–°ç‰ˆçš„ Android SDK åˆ›å»ºçš„æ¨¡æ‹Ÿå™¨æ²¡æœ‰ menu æŒ‰é”®äº†</p>
<h3 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h3><p>è¿ç»­æŒ‰ä¸¤æ¬¡å­—æ¯ r å³å¯åˆ·æ–°.</p>
<p>è¿™äº›é—®é¢˜, FB åé¢è‚¯å®šä¼šè§£å†³çš„.<br>é˜¿é—¨!</p>
<h2 id="é™„å½•-ä»£ç "><a href="#é™„å½•-ä»£ç " class="headerlink" title="é™„å½•(ä»£ç )"></a>é™„å½•(ä»£ç )</h2><p>index.ios.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line">import React, &#123; Component &#125; from &apos;react&apos;;</div><div class="line">import &#123;getPlatformString, isIOS&#125; from &apos;./js/Generals/Utils/IDSRNPlatformUtil&apos;;</div><div class="line">import MZButton from &apos;./js/ReactUIKit/MZButton&apos;</div><div class="line">import &#123;</div><div class="line">  AppRegistry,</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  View,</div><div class="line">  Platform,</div><div class="line">  TouchableOpacity,</div><div class="line">  TouchableHighlight</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line">// è°ƒç”¨å…¶ä»–æ¨¡å—æ–¹æ³•</div><div class="line">var os = getPlatformString();</div><div class="line">var iosPlatform = isIOS();//when run on &apos;ios&apos; true</div><div class="line">class MZRNTutorial extends Component &#123;</div><div class="line">  constructor(props)</div><div class="line">  &#123;</div><div class="line">      super(props);</div><div class="line">      this.state = &#123;status:1&#125;;</div><div class="line">  &#125;</div><div class="line">  customPressHandler = () =&gt; &#123;</div><div class="line">      alert(&apos;å½“å‰çŠ¶æ€: &apos; + this.state.status);</div><div class="line">      this.state.status = 2;</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    console.log(&apos;render ...&apos;);</div><div class="line">    return (</div><div class="line">      &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">        &lt;Text style=&#123;styles.welcome&#125;&gt;</div><div class="line">          Near use React Native!</div><div class="line">        &lt;/Text&gt;</div><div class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</div><div class="line">          To get started, edit index.android.js</div><div class="line">        &lt;/Text&gt;</div><div class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</div><div class="line">          Press &apos;R&apos; twice to reload,&#123;&apos;\n&apos;&#125;</div><div class="line">          or shake for dev menu</div><div class="line">        &lt;/Text&gt;</div><div class="line">        &#123;/* æ˜¾ç¤ºå½“å‰å¹³å°ä¿¡æ¯*/&#125;</div><div class="line">        &lt;Text style=&#123;styles.welcome&#125;&gt;</div><div class="line">            current os: &#123;Platform.OS&#125;</div><div class="line">        &lt;/Text&gt;</div><div class="line">        &#123;/*</div><div class="line">        &lt;TouchableOpacity</div><div class="line">            style=&#123;styles.button&#125;</div><div class="line">            onPress=&#123;this.customPressHandler&#125;</div><div class="line">            &gt;</div><div class="line">            &lt;Text style=&#123;styles.buttonText&#125;&gt;ç¡®å®š&lt;/Text&gt;</div><div class="line">        &lt;/TouchableOpacity&gt;</div><div class="line">        */&#125;</div><div class="line">        &lt;MZButton text=&quot;ç¡®å®š?&quot; bgColor=&quot;green&quot; dianjishijian=&#123;()=&gt;&#123;alert(&apos;å±…ç„¶ç‚¹å‡»ç¡®å®š?!&apos;)&#125;&#125;&gt;</div><div class="line">        &lt;/MZButton&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">  button: &#123;</div><div class="line">    height: 40,</div><div class="line">    width: 150,</div><div class="line">    borderRadius: 20,</div><div class="line">    justifyContent: &apos;center&apos;,</div><div class="line">    backgroundColor: &apos;green&apos;,</div><div class="line">    overflow: &apos;hidden&apos;</div><div class="line">  &#125;,</div><div class="line">  buttonText: &#123;</div><div class="line">    textAlign: &apos;center&apos;,</div><div class="line">    color: &apos;white&apos;</div><div class="line">  &#125;,</div><div class="line">  container: &#123;</div><div class="line">    flex: 1,</div><div class="line">    justifyContent: &apos;center&apos;,</div><div class="line">    alignItems: &apos;center&apos;,</div><div class="line">    backgroundColor: &apos;#F5FCFF&apos;,</div><div class="line">  &#125;,</div><div class="line">  welcome: &#123;</div><div class="line">    fontSize: 20,</div><div class="line">    textAlign: &apos;center&apos;,</div><div class="line">    margin: 10,</div><div class="line">  &#125;,</div><div class="line">  instructions: &#123;</div><div class="line">    textAlign: &apos;center&apos;,</div><div class="line">    color: &apos;#333333&apos;,</div><div class="line">    marginBottom: 5,</div><div class="line">  &#125;,</div><div class="line">  flowRight: &#123;</div><div class="line">   flexDirection: &apos;row&apos;,</div><div class="line">   alignItems: &apos;center&apos;,</div><div class="line">   alignSelf: &apos;stretch&apos;</div><div class="line"> &#125;,</div><div class="line">&#125;);</div><div class="line">AppRegistry.registerComponent(&apos;MZRNTutorial&apos;, () =&gt; MZRNTutorial);</div></pre></td></tr></table></figure>
<p>MZButton.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">import React, &#123; Component &#125; from &apos;react&apos;;</div><div class="line">import &#123;</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  View,</div><div class="line">  Platform,</div><div class="line">  TouchableOpacity</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line">//-----------------------------------------------------</div><div class="line">//å¤–éƒ¨ä½¿ç”¨è¯¥æ¨¡å—, ES6éœ€è¦ä½¿ç”¨å…³é”®å­— export default</div><div class="line">//-----------------------------------------------------</div><div class="line">export default class MZButton extends Component</div><div class="line">&#123;</div><div class="line">    constructor(props)</div><div class="line">    &#123;</div><div class="line">        super(props);</div><div class="line">        this.state = &#123;status:1&#125;;</div><div class="line">    &#125;</div><div class="line">    costumPressHandler = () =&gt; &#123;</div><div class="line">        alert(&apos;å½“å‰çŠ¶æ€:&apos; + this.state.status);</div><div class="line">        const &#123;dianjishijian&#125; = this.props;</div><div class="line">        dianjishijian();</div><div class="line">    &#125;;</div><div class="line">    // ä½¿ç”¨å±æ€§å€¼è®¾ç½®èƒŒæ™¯é¢œè‰²</div><div class="line">    // style=&#123;[styles.button], &#123;backgroundColor:this.props.beijingyanse&#125;&#125;</div><div class="line">    render() &#123;</div><div class="line">        //è§£æ„</div><div class="line">        const &#123;text, bgColor&#125; = this.props;</div><div class="line">        return (</div><div class="line">            &lt;TouchableOpacity</div><div class="line">                style=&#123;[styles.button], &#123;backgroundColor:bgColor&#125;&#125;</div><div class="line">                onPress = &#123;this.costumPressHandler&#125;</div><div class="line">                &gt;</div><div class="line">                &lt;Text style=&#123;styles.buttonText&#125;&gt;</div><div class="line">                    &#123;/* ä½¿ç”¨å±æ€§å€¼ */&#125;</div><div class="line">                    &#123;this.props.text&#125;</div><div class="line">                &lt;/Text&gt;</div><div class="line">            &lt;/TouchableOpacity&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">    button: &#123;</div><div class="line">      height: 40,</div><div class="line">      width: 150,</div><div class="line">      borderRadius: 20,</div><div class="line">      justifyContent: &apos;center&apos;,</div><div class="line">      backgroundColor: &apos;green&apos;,</div><div class="line">      overflow: &apos;hidden&apos;</div><div class="line">    &#125;,</div><div class="line">    buttonText: &#123;</div><div class="line">      textAlign: &apos;center&apos;,</div><div class="line">      color: &apos;white&apos;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>IDSRNPlatformUtil.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">import React, &#123; Component &#125; from &apos;react&apos;;</div><div class="line">import &#123;</div><div class="line">    Platform</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line">export function getPlatformString()</div><div class="line">&#123;</div><div class="line">    console.log(Platform.OS);</div><div class="line">    </div><div class="line">    return Platform.OS;</div><div class="line">&#125;</div><div class="line">export function isIOS()</div><div class="line">&#123;</div><div class="line">    return Platform.OS === &apos;ios&apos;;</div><div class="line">&#125;</div><div class="line">export function isAndroid()</div><div class="line">&#123;</div><div class="line">    return Platform.OS == &apos;android&apos;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ReactNative </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android ReactNative </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS é¡¹ç›®: æ‰“é€ æœ¬åœ° pod åº“]]></title>
      <url>/2016/09/25/iOS-%E9%A1%B9%E7%9B%AE-%E6%89%93%E9%80%A0%E6%9C%AC%E5%9C%B0-pod-%E5%BA%93/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡çš„å§Šå¦¹ç¯‡ <a href="http://www.veryitman.com/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/" target="_blank" rel="noopener">Cocoapods ç®¡ç†å¼€æºé¡¹ç›®</a> å·²å‡†å¤‡å®Œæ¯•ï¼Œç›´æˆ³ <a href="http://www.veryitman.com/2016/11/01/Cocoapods-%E7%AE%A1%E7%90%86%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/" target="_blank" rel="noopener">é“¾æ¥</a> å³å¯è¾¾åˆ°ã€‚</p>
<h2 id="Cocoapods-ç®¡ç†ä»£ç çš„å¿…è¦æ€§"><a href="#Cocoapods-ç®¡ç†ä»£ç çš„å¿…è¦æ€§" class="headerlink" title="Cocoapods ç®¡ç†ä»£ç çš„å¿…è¦æ€§"></a>Cocoapods ç®¡ç†ä»£ç çš„å¿…è¦æ€§</h2><p>é¡¹ç›®åˆ°äº†ä¸€å®šè§„æ¨¡, ä»£ç ç»„ç»‡å’Œç»“æ„æ˜¾å¾—å°¤ä¸ºé‡è¦.</p>
<p>é‡æ„é¡¹ç›®ç»“æ„ï¼Œå¯ä»¥ä»åˆ†ç¦»ä»£ç å¼€å§‹ï¼Œä»£ç åˆ†ç¦»ï¼Œå¯ä»¥æŠŠå¸¸ç”¨ç¨³å®šçš„ç»„ä»¶å°è£…æŠ½ç¦»å‡ºæ¥.</p>
<p>åˆ†ç¦»ä»£ç , å¸¸ç”¨çš„æœ‰å‡ ç§æ–¹å¼:</p>
<blockquote>
<ol>
<li>æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹, ç®¡ç†å’Œç»„ç»‡ä»£ç .</li>
<li>ä½¿ç”¨ framework çš„æ–¹å¼, æä¾›ç»™é¡¹ç›®ä½¿ç”¨.</li>
<li>å·¥å…·ç®¡ç†å¦‚ Cocoapods.</li>
</ol>
</blockquote>
<p>è¿™å‡ ç§æ–¹å¼, å„æœ‰æ‰€é•¿, å„æœ‰ä¼˜åŠ£, æ— æ‰€è°“å¥½ä¸å, æ ¹æ®è‡ªå·±çš„é¡¹ç›®ç‰¹ç‚¹æ¥ç»„ç»‡å³å¯.</p>
<p>æˆ‘çš„åšæ³•æ˜¯ä½¿ç”¨ cocoapods æ¥ç®¡ç†.</p>
<p>ä¸‹é¢è¿›å…¥ä»Šå¤©çš„ä¸»é¢˜:</p>
<blockquote>
<p>ä½¿ç”¨ cocoapods ç®¡ç†è‡ªå·±çš„æœ¬åœ°ä»£ç .</p>
</blockquote>
<p>åšå®¢ <a href="http://blog.csdn.net/veryitman/article/details/50769069" target="_blank" rel="noopener">Mac OSX 10.11.1+ å®‰è£… Cocoapods</a><br>ä»‹ç»äº†å¦‚ä½•åœ¨æœ€æ–°ç‰ˆ MacOS ä¸­å®‰è£… Cocoapods ä»¥åŠæ³¨æ„äº‹é¡¹, å¹¶ä¸”ä½œè€…ä¿è¯æŒç»­ã€Œæ›´æ–°, æ›´æ­£ã€å†…å®¹.</p>
<h2 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h2><p>ä½¿ç”¨ Xcode åˆ›å»ºä¸€ä¸ªå·¥ç¨‹, å·¥ç¨‹åå°±èµ·ä¸º <code>TestPods</code> å§.</p>
<blockquote>
<p>å·¥ç¨‹ç›®å½•å¯ä»¥é˜²æ­¢åœ¨æ¡Œé¢æˆ–è€…ä½ å–œæ¬¢çš„ç›®å½•ä¸‹é¢éƒ½å¯ä»¥.</p>
</blockquote>
<p>åœ¨ TestPods ä¸‹é¢åˆ›å»º LocalLib ç›®å½•, ç”¨æ¥æ”¾ç½®åˆ†ç¦»çš„ä»£ç .å½“ç„¶, ä½ ä¹Ÿå¯ä»¥å°† LocalLib è¿™ä¸ªç›®å½•æ”¾åˆ°å…¶ä»–ç›®å½•.</p>
<p>åœ¨ LocalLib ä¸‹é¢, æˆ‘çš„ pod åº“ä»£ç åç§°ä¸º download.</p>
<p>å¯ä»¥æ–°å»ºè¿™ä¸ªç›®å½•.</p>
<p>ç›®å½•å¦‚ä¸‹:<br><img src="/upload/images/2016/9/25/pod_lib_dir.png" alt="1"></p>
<h2 id="åˆ›å»º-podspec-æ–‡ä»¶"><a href="#åˆ›å»º-podspec-æ–‡ä»¶" class="headerlink" title="åˆ›å»º podspec æ–‡ä»¶"></a>åˆ›å»º podspec æ–‡ä»¶</h2><p>åœ¨ download ç›®å½•ä¸‹é¢, åˆ›å»º podspec æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod spec create download</div></pre></td></tr></table></figure>
<p>åˆ›å»ºå®Œæˆå, ä¼šç”Ÿæˆ download.podspec æ–‡ä»¶.</p>
<p>å…·ä½“å†…å®¹, åˆ›å»ºå, å¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹.</p>
<h2 id="ä¿®æ”¹-podspec-æ–‡ä»¶"><a href="#ä¿®æ”¹-podspec-æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹ podspec æ–‡ä»¶"></a>ä¿®æ”¹ podspec æ–‡ä»¶</h2><p>ä¿®æ”¹ download.podspec, ä¸»è¦ä¿®æ”¹å‡ ä¸ªå…³é”®åœ°æ–¹:</p>
<blockquote>
<p>æºç ä½ç½®<br>æºç ç‰ˆæœ¬</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">â€•â€•â€• Source Location â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•#</div><div class="line">  #</div><div class="line">  #  Specify the location from where the source should be retrieved.</div><div class="line">  #  Supports git, hg, bzr, svn and HTTP.</div><div class="line">  #</div><div class="line">  s.source       = &#123; :git =&gt; &quot;&quot;, :tag =&gt; &quot;0.0.1&quot; &#125;</div><div class="line">  # â€•â€•â€• Source Code â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•#</div><div class="line">  #</div><div class="line">  #  CocoaPods is smart about how it includes source code. For source files</div><div class="line">  #  giving a folder will include any swift, h, m, mm, c &amp; cpp files.</div><div class="line">  #  For header files it will include any header in the folder.</div><div class="line">  #  Not including the public_header_files will make all headers public.</div><div class="line">  #</div><div class="line">  s.source_files  = &quot;Source&quot;, &quot;Source/**/*.&#123;h,m&#125;&quot;</div><div class="line">  s.exclude_files = &quot;Source/Exclude&quot;</div></pre></td></tr></table></figure>
<p>å¦å¤–, é…ç½®å¥½ç›¸å…³æè¿°ä¿¡æ¯, ä¸è¦åŒ…å« â€˜Exampleâ€™ çš„å­—æ ·, ä¸ç„¶, æ–°ç‰ˆçš„ Cocoapods æ‰§è¡Œ pod install æ—¶å€™, ä¼šæŠ¥å‡ºè­¦å‘Šå’Œé”™è¯¯.</p>
<p>è¿™æ ·, å·¥ç¨‹å¯ä»¥ä½¿ç”¨ pods åº“äº†.</p>
<h2 id="å·¥ç¨‹ä½¿ç”¨-pod-åº“"><a href="#å·¥ç¨‹ä½¿ç”¨-pod-åº“" class="headerlink" title="å·¥ç¨‹ä½¿ç”¨ pod åº“"></a>å·¥ç¨‹ä½¿ç”¨ pod åº“</h2><p>å°† TestPods æ”¹ä¸º cocoapods é¡¹ç›®.</p>
<p>åœ¨ TestPods ç›®å½•, æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod init</div></pre></td></tr></table></figure>
<p>ä¼šç”Ÿæˆ Podfile ç­‰æ–‡ä»¶.</p>
<p>ä¿®æ”¹ Podfile æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># Uncomment this line to define a global platform for your project</div><div class="line"># platform :ios, &apos;7.0&apos;</div><div class="line"># Uncomment this line if you&apos;re using Swift</div><div class="line"># use_frameworks!</div><div class="line">target &apos;TestPods&apos; do</div><div class="line">pod &apos;download&apos;, :path =&gt; &apos;./LocalLib/download/&apos;</div><div class="line">#pod &apos;core_lib_spec&apos;, :svn =&gt; &apos;http://svn.ids111.com/o2o/client/ios/trunks/master/Frameworks/CoreLibrary&apos;</div><div class="line">end</div><div class="line">target &apos;TestPodsTests&apos; do</div><div class="line">end</div><div class="line">target &apos;TestPodsUITests&apos; do</div><div class="line">end</div></pre></td></tr></table></figure>
<p>å…³é”®æ˜¯æŒ‡æ˜ pod åº“çš„ä½ç½®.<br>è·¯å¾„ä¸€å®šè¦æ­£ç¡®.å¦åˆ™æ— æ³•æ‰¾åˆ°è¯¥åº“.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod &apos;download&apos;, :path =&gt; &apos;./LocalLib/download/&apos;</div></pre></td></tr></table></figure>
<p>åœ¨ TestPods ä¸‹é¢, pod install å³å¯.</p>
<p>å¦‚æœ, pod install æŠ¥é”™, ä¸€èˆ¬éƒ½æ˜¯ä½ çš„ pod åº“çš„é…ç½®æ–‡ä»¶(.podspec)é‡Œé¢å†™çš„ä¸ç¬¦åˆè¦æ±‚.</p>
<p>æ ¹æ®æŠ¥é”™ä¿¡æ¯, åŠ ä»¥ä¿®æ”¹å³å¯.</p>
<p>xcode æ‰“å¼€å·¥ç¨‹.<br><img src="/upload/images/2016/9/25/pod_lib_pro.png" alt="1"></p>
<h2 id="ç¤ºä¾‹ä¸‹è½½"><a href="#ç¤ºä¾‹ä¸‹è½½" class="headerlink" title="ç¤ºä¾‹ä¸‹è½½"></a>ç¤ºä¾‹ä¸‹è½½</h2><p>å·¥ç¨‹ç¤ºä¾‹ä»£ç , å¯ä»¥ <a href="http://download.csdn.net/download/androidbluetooth/9520262" target="_blank" rel="noopener">æˆ³è¿™é‡Œä¸‹è½½</a> ç©è€!</p>
<hr>
<p><strong>æ‰«ç å…³æ³¨ï¼Œä½ æˆ‘å°±å„å¤šä¸€ä¸ªæœ‹å‹~</strong></p>
<p><img src="/upload/me/qrcode_wx.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS Cocoapods </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RN: å¦‚ä½•å¯åŠ¨ local server]]></title>
      <url>/2016/09/22/RN-%E5%A6%82%E4%BD%95%E5%90%AF%E5%8A%A8-local-server/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨ <code>react-native init</code> åˆ›å»ºçš„å·¥ç¨‹, åœ¨ xcode ä¸­è¿è¡Œä¼šè‡ªåŠ¨å¯åŠ¨ä¸€ä¸ª RN çš„æœ¬åœ° Server.</p>
<p>åƒä¸‹é¢å›¾ç‰‡å±•ç¤ºè¿™æ ·:<br><img src="/upload/images/2016/9/22/rn_1.png" alt="1"></p>
<p>é‚£ä¹ˆ, è¿™é‡Œé—®é¢˜æ¥äº†.</p>
<p>æ¯”å¦‚, æˆ‘æƒ³æš‚æ—¶ä¸å¯åŠ¨è¿™ä¸ªæœ¬åœ° Server, é‚£ä¹ˆå¦‚ä½•å…³é—­å‘¢?</p>
<p>ä¸‹é¢è·Ÿå¤§å®¶ä¸€èµ·æ¢è®¨å’Œè¿½ç©¶ä¸€ä¸‹.</p>
<h2 id="æ‰¾åˆ°å¯åŠ¨çš„æ ¹æº"><a href="#æ‰¾åˆ°å¯åŠ¨çš„æ ¹æº" class="headerlink" title="æ‰¾åˆ°å¯åŠ¨çš„æ ¹æº"></a>æ‰¾åˆ°å¯åŠ¨çš„æ ¹æº</h2><p>å¯åŠ¨è¿™ä¸ªç»ˆç«¯çš„æ˜¯åœ¨ä¸€ä¸ª React.xcodeproj å·¥ç¨‹çš„ ã€ŒBuild Phasesã€ä¸­è„šæœ¬é‡Œé¢é…ç½®çš„.</p>
<p>è„šæœ¬å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">if nc -w 5 -z localhost 8081 ; then</div><div class="line">  if ! curl -s &quot;http://localhost:8081/status&quot; | grep -q &quot;packager-status:running&quot; ; then</div><div class="line">    echo &quot;Port 8081 already in use, packager is either not running or not running correctly&quot;</div><div class="line">    exit 2</div><div class="line">  fi</div><div class="line">else</div><div class="line">  open &quot;$SRCROOT/../packager/launchPackager.command&quot; || echo &quot;Can&apos;t start packager automatically&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>çœŸæ­£èµ·ä½œç”¨çš„æ˜¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open &quot;$SRCROOT/../packager/launchPackager.command&quot;</div></pre></td></tr></table></figure>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å…³é—­è¿™ä¸ªè‡ªå¯åŠ¨äº†, ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">if nc -w 5 -z localhost 8081 ; then</div><div class="line">  if ! curl -s &quot;http://localhost:8081/status&quot; | grep -q &quot;packager-status:running&quot; ; then</div><div class="line">    echo &quot;Port 8081 already in use, packager is either not running or not running correctly&quot;</div><div class="line">    exit 2</div><div class="line">  fi</div><div class="line">else</div><div class="line">#open &quot;$SRCROOT/../packager/launchPackager.command&quot; || echo &quot;Can&apos;t start packager automatically&quot;</div><div class="line">    echo &quot;Nothing...&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<h2 id="çœ‹çœ‹-launchPackager-command"><a href="#çœ‹çœ‹-launchPackager-command" class="headerlink" title="çœ‹çœ‹ launchPackager.command"></a>çœ‹çœ‹ launchPackager.command</h2><p>è¿™ä¸ªæ–‡ä»¶åœ¨ã€Œnode_modules/react-native/packager/ã€ä¸‹é¢.</p>
<p>è¯¥æ–‡ä»¶æ˜¯å¯åŠ¨å¦å¤–ä¸€ä¸ªè„šæœ¬ packager.sh, æ ¸å¿ƒä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source ./packager.sh</div></pre></td></tr></table></figure>
<p>æœ€ç»ˆæ‰§è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">node &quot;$THIS_DIR/../local-cli/cli.js&quot; start &quot;$@&quot;</div></pre></td></tr></table></figure>
<p>å¤§å®¶æœ‰å…´è¶£å¯ä»¥å»çœ‹çœ‹æºç , ä¸€æ¢ç©¶ç«Ÿ.</p>
]]></content>
      
        <categories>
            
            <category> ReactNative </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ReactNative iOS Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RN: åˆ›å»ºiOSå·¥ç¨‹ä»£ç çš„indenté—®é¢˜]]></title>
      <url>/2016/09/19/RN-%E5%88%9B%E5%BB%BAiOS%E5%B7%A5%E7%A8%8B%E4%BB%A3%E7%A0%81%E7%9A%84indent%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>ä½¿ç”¨æœ€æ–°ç‰ˆRN(0.33)æ¥åˆ›å»ºå·¥ç¨‹, å¤§å®¶å¯ä»¥å‘ç°, OC ä»£ç çš„é€€æ ¼å˜æˆäº†ä¸¤ä¸ªç©ºæ ¼.<br>å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</div><div class="line">&#123;</div><div class="line">  NSURL *jsCodeLocation;</div><div class="line">  jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@&quot;index.ios&quot; fallbackResource:nil];</div><div class="line">  RCTRootView *rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation</div><div class="line">                                                      moduleName:@&quot;Mark&quot;</div><div class="line">                                               initialProperties:nil</div><div class="line">                                                   launchOptions:launchOptions];</div><div class="line">  rootView.backgroundColor = [[UIColor alloc] initWithRed:1.0f green:1.0f blue:1.0f alpha:1];</div><div class="line">  self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];</div><div class="line">  UIViewController *rootViewController = [UIViewController new];</div><div class="line">  rootViewController.view = rootView;</div><div class="line">  self.window.rootViewController = rootViewController;</div><div class="line">  [self.window makeKeyAndVisible];</div><div class="line">  return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ— è®ºä½ å›è½¦æˆ–è€… tab æˆ–è€…æ ¼å¼åŒ–(<code>å³é”®/Structure/Re-Indent</code>)ä»£ç , ä¼šå‘ç°, éƒ½æ˜¯è¿™ç§è°ƒè°ƒ.</p>
<p>é¢å¯¹è¿™çªå¦‚å…¶æ¥çš„å˜åŒ–, æˆ‘å¼€å§‹è§‰å¾—æœ‰ç‚¹æ·¡æ·¡çš„å¿§ä¼¤.</p>
<p>å¯¹äºä¸€ç›´ä½¿ç”¨ <code>tab width = 4</code> çš„æˆ‘æ¥è¯´, æ— æ³•å¿å—. å¿…é¡»æ”¹è¿‡æ¥.</p>
<h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>æ‰“å¼€ Xcode çš„ preferences, çœ‹åˆ°å…¶ã€è®¾ç½®ã€æ­£å¸¸çš„ä¸è¦ä¸è¦çš„.</p>
<p>æ‰€ä»¥å¯ä»¥æ–­å®šä¸æ˜¯ Xcode çš„é—®é¢˜.</p>
<p><img src="/upload/images/2016/9/19/xcode_pref.png" alt="1"></p>
<p>å› ä¸ºå‡çº§äº† Xcode åˆ°æœ€æ–°ç‰ˆ Xcode8, è¿˜ä»¥ä¸ºæ˜¯ Xcode8 çš„ bug, æ‰“å¼€ä¹‹å‰çš„ React Native å·¥ç¨‹æˆ–è€…å…¶ä»– Xcode å·¥ç¨‹, å°±æ²¡æœ‰è¿™ä¸ªã€Œè›‹ç–¼ã€çš„é—®é¢˜.</p>
<p>æœ€ç»ˆçŒœæƒ³æ˜¯å·¥ç¨‹é…ç½®æ–‡ä»¶å¼•èµ·çš„â€¦</p>
<h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ—¢ç„¶å’Œ Xcode æ²¡æœ‰å…³ç³», é‚£ä¹ˆé—®é¢˜å°±ä¸€å®šå‡ºç°åœ¨é…ç½®æ–‡ä»¶ä¸Šé¢.</p>
<p>ç½ªé­ç¥¸é¦– <code>project.pbxproj</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">indentWidth = 2;</div><div class="line">sourceTree = &quot;&lt;group&gt;&quot;;</div><div class="line">tabWidth = 2;</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¸º:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">indentWidth = 4;</div><div class="line">sourceTree = &quot;&lt;group&gt;&quot;;</div><div class="line">tabWidth = 4;</div></pre></td></tr></table></figure>
<p>æˆ–è€…ç›´æ¥åˆ é™¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">indentWidth = 2;</div><div class="line">tabWidth = 2;</div></pre></td></tr></table></figure>
<p>å…³é—­å·¥ç¨‹, é‡å¯ Xcode å°±å¯ä»¥äº†.</p>
]]></content>
      
        <categories>
            
            <category> ReactNative </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ReactNative iOS Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RN: Mac é…ç½® ES6 ç®€æ˜“å¼€å‘ç¯å¢ƒ]]></title>
      <url>/2016/09/16/RN-Mac-%E9%85%8D%E7%BD%AE-ES6-%E7%AE%80%E6%98%93%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
      <content type="html"><![CDATA[<h2 id="åˆ›å»ºæ–‡ä»¶å¤¹-ES6"><a href="#åˆ›å»ºæ–‡ä»¶å¤¹-ES6" class="headerlink" title="åˆ›å»ºæ–‡ä»¶å¤¹ ES6"></a>åˆ›å»ºæ–‡ä»¶å¤¹ ES6</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ES6</div><div class="line">-lib</div><div class="line">-src</div></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥ä»»æ„å–ä¸€ä¸ªä½ å–œæ¬¢çš„ç›®å½•åç§°.</p>
<h3 id="åˆå§‹åŒ–é¡¹ç›®"><a href="#åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="åˆå§‹åŒ–é¡¹ç›®"></a>åˆå§‹åŒ–é¡¹ç›®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm init</div></pre></td></tr></table></figure>
<p>å¡«å†™é¡¹ç›®ä¿¡æ¯.</p>
<p>æŸ¥çœ‹ä¸€ä¸‹ package.json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat package.json</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;name&quot;: &quot;es6tutorials&quot;,</div><div class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</div><div class="line">  &quot;description&quot;: &quot;Tutorial&quot;,</div><div class="line">  &quot;main&quot;: &quot;index.js&quot;,</div><div class="line">  &quot;scripts&quot;: &#123;</div><div class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</div><div class="line">  &#125;,</div><div class="line">  &quot;keywords&quot;: [</div><div class="line">    &quot;es6&quot;,</div><div class="line">    &quot;.etc&quot;</div><div class="line">  ],</div><div class="line">  &quot;author&quot;: &quot;mark.zhang&quot;,</div><div class="line">  &quot;license&quot;: &quot;MIT&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç›®å½•ç»“æ„å¦‚ä¸‹</p>
<p><img src="/upload/images/2016/9/10/1.jpg" alt="1"></p>
<h3 id="å®‰è£…-babel-cli"><a href="#å®‰è£…-babel-cli" class="headerlink" title="å®‰è£… babel-cli"></a>å®‰è£… babel-cli</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev babel-cli</div></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥å…¨å±€å®‰è£…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install babel-cli -g</div></pre></td></tr></table></figure>
<p>å…¨å±€å®‰è£…ä¸Šåï¼Œä¼šå®‰è£…å¦‚ä¸‹å››ä¸ªç¨‹åºåˆ°å…¨å±€ç¯å¢ƒä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">babel</div><div class="line">babel-node</div><div class="line">babel-doctor</div><div class="line">babel-external-helpers</div></pre></td></tr></table></figure>
<h2 id="å®‰è£…-babel-core"><a href="#å®‰è£…-babel-core" class="headerlink" title="å®‰è£… babel-core"></a>å®‰è£… babel-core</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install babel-core --save</div></pre></td></tr></table></figure>
<h2 id="å®‰è£…-ES2015-æ’ä»¶"><a href="#å®‰è£…-ES2015-æ’ä»¶" class="headerlink" title="å®‰è£… ES2015 æ’ä»¶"></a>å®‰è£… ES2015 æ’ä»¶</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install babel-preset-es2015</div></pre></td></tr></table></figure>
<p>ç¼–å†™é…ç½®æ–‡ä»¶ .babelrc</p>
<p>æ³¨æ„è¯¥æ–‡ä»¶æœ‰ä¸ªç‚¹ç¬¦å·.</p>
<p>åœ¨å·¥ç¨‹ç›®å½•ä¸‹æ–°å»ºè¯¥æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">touch .babelrc</div></pre></td></tr></table></figure>
<p>å†™å…¥å¦‚ä¸‹å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;presets&quot;: [</div><div class="line">      &quot;es2015&quot;,</div><div class="line">    ],</div><div class="line">    &quot;plugins&quot;: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¼–å†™æµ‹è¯•ä»£ç  tutorials.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">function test()</div><div class="line">&#123;</div><div class="line">    console.log(a);</div><div class="line">    var a = 0;</div><div class="line">&#125;</div><div class="line">test();</div><div class="line">var a = [];</div><div class="line">for (var i = 0; i &lt; 10; i++) &#123;</div><div class="line">  var c = i;</div><div class="line">  a[i] = function () &#123;</div><div class="line">    console.log(c);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line">a[6](); // 9</div><div class="line">var b = [];</div><div class="line">for (var i=0; i&lt;10; i++) &#123;</div><div class="line">    let c = i; //let æ˜¯ es6ä¸­çš„å…³é”®å­—</div><div class="line">    b[i] = function() &#123;</div><div class="line">        console.log(c)</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">b[6]();</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">babel src/tutorials.js</div></pre></td></tr></table></figure>
<p>è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">babel-node src/tutorials.js</div></pre></td></tr></table></figure>
<p><img src="/upload/images/2016/9/10/2.jpg" alt="1"></p>
<p>è¿™é‡Œå¯ä»¥ä¸‹è½½ <a href="https://github.com/veryitman/ES6Tutorials" target="_blank" rel="noopener">å·¥ç¨‹æºç </a>.</p>
<h2 id="å…¶ä»–æ“ä½œ"><a href="#å…¶ä»–æ“ä½œ" class="headerlink" title="å…¶ä»–æ“ä½œ"></a>å…¶ä»–æ“ä½œ</h2><h3 id="1-å°†-ES6-è¯­æ³•çš„æ–‡ä»¶è½¬æ¢ä¸º-ES5-çš„è¯­æ³•"><a href="#1-å°†-ES6-è¯­æ³•çš„æ–‡ä»¶è½¬æ¢ä¸º-ES5-çš„è¯­æ³•" class="headerlink" title="1.å°† ES6 è¯­æ³•çš„æ–‡ä»¶è½¬æ¢ä¸º ES5 çš„è¯­æ³•"></a>1.å°† ES6 è¯­æ³•çš„æ–‡ä»¶è½¬æ¢ä¸º ES5 çš„è¯­æ³•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">babel -d lib/ src/</div></pre></td></tr></table></figure>
<p>åœ¨ lib ç›®å½•ä¸‹ä¼šç”Ÿæˆ src ç›®å½•ä¸­å¯¹åº”çš„æ–‡ä»¶.</p>
<h3 id="2-è¿›å…¥äº¤äº’æ¨¡å¼"><a href="#2-è¿›å…¥äº¤äº’æ¨¡å¼" class="headerlink" title="2.è¿›å…¥äº¤äº’æ¨¡å¼"></a>2.è¿›å…¥äº¤äº’æ¨¡å¼</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">babel-node</div></pre></td></tr></table></figure>
<p>ä¸¤æ¬¡ ctrl+c é€€å‡º</p>
<h3 id="3-æ£€æŸ¥babelçŠ¶å†µ"><a href="#3-æ£€æŸ¥babelçŠ¶å†µ" class="headerlink" title="3.æ£€æŸ¥babelçŠ¶å†µ"></a>3.æ£€æŸ¥babelçŠ¶å†µ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">babel-doctor</div></pre></td></tr></table></figure>
<p>æ£€æŸ¥ä»¥ä¸‹å†…å®¹</p>
<ul>
<li><p>é…ç½®æ–‡ä»¶.babelrc</p>
</li>
<li><p>æ˜¯å¦æœ‰é‡å¤çš„babelå®‰è£…åŒ…ï¼Œæ¯”å¦‚è¯´å®‰è£…äº†5å’Œ6</p>
</li>
<li><p>babelå®‰è£…åŒ…æ˜¯å¦å·²ç»å‡çº§åˆ°äº†æœ€æ–°ç‰ˆ</p>
</li>
<li><p>npm &gt;= 3.3.0</p>
</li>
</ul>
<p><img src="/upload/images/2016/9/10/3.jpg" alt="1"></p>
<h3 id="4-å¸è½½å…¨å±€çš„-babel-cli"><a href="#4-å¸è½½å…¨å±€çš„-babel-cli" class="headerlink" title="4.å¸è½½å…¨å±€çš„ babel-cli"></a>4.å¸è½½å…¨å±€çš„ babel-cli</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm uninstall --global babel-cli</div></pre></td></tr></table></figure>
<h2 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h2><ul>
<li><p><a href="https://babeljs.io/docs/usage/cli/" target="_blank" rel="noopener">Babel comes with a built-in CLI which can be used to compile files from the command line.</a></p>
</li>
<li><p>é˜®ä¸€å³°è€å¸ˆçš„ <a href="https://www.gitbook.com/book/wohugb/ecmascript-6/details" target="_blank" rel="noopener">ECMAScript 6å…¥é—¨</a></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> ReactNative </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ReactNative </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS: æ‰‹æœºæ˜¯å¦è®¾ç½®ç½‘ç»œä»£ç†]]></title>
      <url>/2016/09/16/iOS-%E6%89%8B%E6%9C%BA%E6%98%AF%E5%90%A6%E8%AE%BE%E7%BD%AE%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86/</url>
      <content type="html"><![CDATA[<h2 id="æƒ…æ™¯"><a href="#æƒ…æ™¯" class="headerlink" title="æƒ…æ™¯"></a>æƒ…æ™¯</h2><p>é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­, ä¼šé‡åˆ°ä¸‹é¢è¿™æ ·ä¸€ç§æƒ…æ™¯:</p>
<blockquote>
<p>äº§å“æˆ–è€…è®¾è®¡åŒäº‹éœ€è¦ä½“éªŒç›®å‰äº§å“å¼€å‘çš„è¿›åº¦, ç„¶åè¦æ±‚å¼€å‘äººå‘˜, å°†ç°åœ¨çš„ç‰ˆæœ¬ç»™ä»–ä»¬ä½“éªŒ.<br>åšè¿‡ç¨‹åºå¼€å‘çš„äººéƒ½çŸ¥é“, å¼€å‘ç‰ˆæœ¬ä¼šæœ‰ä¸å°‘é—®é¢˜.<br>è¿™æ—¶, äº§å“å’Œè®¾è®¡åŒäº‹å°±ä¼šæŠ±æ€¨, æ€ä¹ˆç™»å½•ä¸äº†, è¿™é‡Œæ²¡æœ‰æ•°æ®äº†!<br>æœ‰ä¸ªå°ä¼™ä¼´è¢«æŠ˜è…¾çš„å®åœ¨å—ä¸äº†, è¿ç½‘é¡µéƒ½æ‰“ä¸å¼€äº†.<br>æœ€åæ‰¾åˆ°åŸå› :<br>ä»–æ‰‹æœºè¢«ä¹‹å‰çš„ç¨‹åºçŒ¿è®¾ç½®äº†ç½‘ç»œä»£ç†, ä»£ç†åˆ°ç¨‹åºçŒ¿å“¥å“¥çš„ç”µè„‘ä¸Šæ¥æŠ“åŒ…è°ƒè¯•é—®é¢˜, å¿˜è®°å–æ¶ˆè®¾ç½®äº†.</p>
</blockquote>
<p>å‡å¦‚å¯ä»¥åˆ¤æ–­å½“å‰æ‰‹æœºæ˜¯å¦è®¾ç½®äº†ç½‘ç»œä»£ç†, å°±å¯ä»¥å¾ˆå¥½åœ°è§£å†³ä¸Šé¢æƒ…æ™¯ä¸­æåˆ°çš„é—®é¢˜äº†.</p>
<h2 id="æ‰¾åˆ°çº¿ç´¢"><a href="#æ‰¾åˆ°çº¿ç´¢" class="headerlink" title="æ‰¾åˆ°çº¿ç´¢"></a>æ‰¾åˆ°çº¿ç´¢</h2><p>åœ¨ ASIHttpRequest ä¸­æ‰¾åˆ°å¦‚ä¸‹æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">- (BOOL)configureProxies</div><div class="line">&#123;</div><div class="line">    // Have details of the proxy been set on this request</div><div class="line">    if (![self isPACFileRequest] &amp;&amp; (![self proxyHost] &amp;&amp; ![self proxyPort])) &#123;</div><div class="line">        // If not, we need to figure out what they&apos;ll be</div><div class="line">        NSArray *proxies = nil;</div><div class="line">        // Have we been given a proxy auto config file?</div><div class="line">        if ([self PACurl]) &#123;</div><div class="line">            // If yes, we&apos;ll need to fetch the PAC file asynchronously, so we stop this request to wait until we have the proxy details.</div><div class="line">            [self fetchPACFile];</div><div class="line">            return NO;</div><div class="line">            // Detect proxy settings and apply them</div><div class="line">        &#125; else &#123;</div><div class="line">#if TARGET_OS_IPHONE</div><div class="line">            NSDictionary *proxySettings = [NSMakeCollectable(CFNetworkCopySystemProxySettings()) autorelease];</div><div class="line">#else</div><div class="line">            NSDictionary *proxySettings = [NSMakeCollectable(SCDynamicStoreCopyProxies(NULL)) autorelease];</div><div class="line">#endif</div><div class="line">            proxies = [NSMakeCollectable(CFNetworkCopyProxiesForURL((CFURLRef)[self url], (CFDictionaryRef)proxySettings)) autorelease];</div><div class="line">            // Now check to see if the proxy settings contained a PAC url, we need to run the script to get the real list of proxies if so</div><div class="line">            NSDictionary *settings = [proxies objectAtIndex:0];</div><div class="line">            if ([settings objectForKey:(NSString *)kCFProxyAutoConfigurationURLKey]) &#123;</div><div class="line">                [self setPACurl:[settings objectForKey:(NSString *)kCFProxyAutoConfigurationURLKey]];</div><div class="line">                [self fetchPACFile];</div><div class="line">                return NO;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        if (!proxies) &#123;</div><div class="line">            [self setReadStream:nil];</div><div class="line">            [self failWithError:[NSError errorWithDomain:NetworkRequestErrorDomain code:ASIInternalErrorWhileBuildingRequestType userInfo:[NSDictionary dictionaryWithObjectsAndKeys:@&quot;Unable to obtain information on proxy servers needed for request&quot;,NSLocalizedDescriptionKey,nil]]];</div><div class="line">            return NO;</div><div class="line">        &#125;</div><div class="line">        // I don&apos;t really understand why the dictionary returned by CFNetworkCopyProxiesForURL uses different key names from CFNetworkCopySystemProxySettings/SCDynamicStoreCopyProxies</div><div class="line">        // and why its key names are documented while those we actually need to use don&apos;t seem to be (passing the kCF* keys doesn&apos;t seem to work)</div><div class="line">        if ([proxies count] &gt; 0) &#123;</div><div class="line">            NSDictionary *settings = [proxies objectAtIndex:0];</div><div class="line">            [self setProxyHost:[settings objectForKey:(NSString *)kCFProxyHostNameKey]];</div><div class="line">            [self setProxyPort:[[settings objectForKey:(NSString *)kCFProxyPortNumberKey] intValue]];</div><div class="line">            [self setProxyType:[settings objectForKey:(NSString *)kCFProxyTypeKey]];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¸ç ´é“é‹æ— è§…å¤„â€¦</p>
<p>åˆ¤æ–­ iphone æ˜¯å¦è®¾ç½®ç½‘ç»œä»£ç†çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">+ (BOOL)hasSetProxy</div><div class="line">&#123;</div><div class="line">    BOOL proxy = NO;</div><div class="line">    </div><div class="line">    NSDictionary *proxySettings = (__bridge NSDictionary *)(CFNetworkCopySystemProxySettings());</div><div class="line">    NSURL *url = [NSURL URLWithString:@&quot;http://www.baidu.com&quot;];</div><div class="line">    NSArray *proxies = (__bridge NSArray *)(CFNetworkCopyProxiesForURL((__bridge CFURLRef)(url),</div><div class="line">                                                                       (__bridge CFDictionaryRef)(proxySettings)));</div><div class="line">    MZLOG(@&quot;proxies:%@&quot;, proxies);</div><div class="line">    NSDictionary *settings = proxies[0];</div><div class="line">    MZLOG(@&quot;kCFProxyHostNameKey: %@&quot;, [settings objectForKey:(NSString *)kCFProxyHostNameKey]);</div><div class="line">    MZLOG(@&quot;kCFProxyPortNumberKey: %@&quot;, [settings objectForKey:(NSString *)kCFProxyPortNumberKey]);</div><div class="line">    MZLOG(@&quot;kCFProxyTypeKey: %@&quot;, [settings objectForKey:(NSString *)kCFProxyTypeKey]);</div><div class="line">    if ([[settings objectForKey:(NSString *)kCFProxyTypeKey] isEqualToString:@&quot;kCFProxyTypeNone&quot;]) &#123;</div><div class="line">        proxy = NO;</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        proxy = YES;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    return proxy;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ç”¨æˆ·ä½“éªŒ"><a href="#ç”¨æˆ·ä½“éªŒ" class="headerlink" title="ç”¨æˆ·ä½“éªŒ"></a>ç”¨æˆ·ä½“éªŒ</h2><p>åˆ¤æ–­å¦‚æœè®¾ç½®äº†ä»£ç†, æç¤ºç”¨æˆ·, å¸®ä»–ç›´æ¥è·³åˆ° wifi è®¾ç½®ç•Œé¢.</p>
<p>ä¸‹é¢è¯´è¯´å¦‚ä½•è·³åˆ°ç³»ç»Ÿçš„ wifi è®¾ç½®ç•Œé¢.</p>
<p>1.é…ç½® URL TYPES</p>
<p><img src="/upload/images/2016/9/16/1.jpeg" alt="1"></p>
<p>æ³¨æ„è¿™é‡Œçš„é…ç½®æ˜¯ <code>prefs</code>.</p>
<p>2.openURL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">NSString * urlString = @&quot;prefs:root=WIFI&quot;;</div><div class="line">NSURL *url = [NSURL URLWithString:urlString];</div><div class="line">UIApplication *app = [UIApplication sharedApplication];</div><div class="line">if ([app canOpenURL:[NSURL URLWithString:urlString]]) &#123;</div><div class="line"> </div><div class="line">    if ([[UIDevice currentDevice].systemVersion doubleValue] &gt;= 10.0) &#123;</div><div class="line">    </div><div class="line">    	[app openURL:url options:@&#123;&#125; completionHandler:nil];</div><div class="line">    &#125; </div><div class="line">    else &#123;</div><div class="line">    </div><div class="line">    	[app openURL:url];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦å¤–, è·³è½¬åˆ°ç³»ç»Ÿå…¶ä»–ç•Œé¢çš„ URL å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">1.ç³»ç»Ÿè®¾ç½®</div><div class="line">prefs:root=INTERNET_TETHERING</div><div class="line">2.WIFIè®¾ç½®</div><div class="line">prefs:root=WIFI</div><div class="line">3.è“ç‰™è®¾ç½®</div><div class="line">prefs:root=Bluetooth</div><div class="line">4.ç³»ç»Ÿé€šçŸ¥</div><div class="line">prefs:root=NOTIFICATIONS_ID</div><div class="line">5.é€šç”¨è®¾ç½®</div><div class="line">prefs:root=General</div><div class="line">6.æ˜¾ç¤ºè®¾ç½®</div><div class="line">prefs:root=DISPLAY&amp;BRIGHTNESS</div><div class="line">7.å£çº¸è®¾ç½®</div><div class="line">prefs:root=Wallpaper</div><div class="line">8.å£°éŸ³è®¾ç½®</div><div class="line">prefs:root=Sounds</div><div class="line">9.éšç§è®¾ç½®</div><div class="line">prefs:root=privacy</div><div class="line">10.æ‰“å¼€ APP Store</div><div class="line">prefs:root=STORE</div><div class="line">11.æ‰“å¼€ Notes</div><div class="line">prefs:root=NOTES</div><div class="line">12.æ‰“å¼€ Safari</div><div class="line">prefs:root=Safari</div><div class="line">13.æ‰“å¼€ Music</div><div class="line">prefs:root=MUSIC</div><div class="line">14.æ‰“å¼€ photo</div><div class="line">prefs:root=Photos</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS proxy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸ CSDN çš„è¯€åˆ«]]></title>
      <url>/2016/09/10/%E4%B8%8E-CSDN-%E7%9A%84%E8%AF%80%E5%88%AB/</url>
      <content type="html"><![CDATA[<p>å†™è¿™ä¸ªè¯é¢˜, å†…å¿ƒè¿˜æ˜¯è›®æ²‰é‡çš„.</p>
<p>å‡ å¹´å‰ä¸ CSDN ä¸æœŸè€Œé‡, åœ¨é‡Œé¢å„ç§æŠ˜è…¾, ç¿»é˜…å¤§ç‰›ä»¬çš„åšå®¢, å†™è¯„è®º, ç”šè‡³æ‰“å°å‡ºæ¥. åœ¨æŠ€æœ¯è®ºå›ä¸åœåœ°â€çŒæ°´â€, è®¢é˜… CSDN æ‚å¿—, å‡†å¤‡ç»ƒå°±ä¸€èº«æ­¦è‰º.</p>
<p>äº’è”ç½‘çš„è“¬å‹ƒå‘å±•, è®©æˆ‘åŸæ¥ä¸å®‰çš„å¿ƒæœ‰äº†æ›´åŠ ç‹‚èºçš„å†²åŠ¨.</p>
<p>åœ¨æŸä¸ªå¤œæ·±äººé™çš„å¤œæ™š, å¼€å¯äº†å¥‹ç¬”ç–¾ä¹¦çš„å†ç¨‹, è¸ä¸Šäº† CSDN çš„åšå®¢ä¹‹æ—….<br>è¿™ä¹ˆå¤šå¹´ä»¥æ¥, CSDN å°±åƒæˆ‘çš„ä¸€ä¸ªæœ‹å‹, ä¸ç®¡æ˜¯å®¶é•¿é‡ŒçŸ­, è¿˜æ˜¯æŠ€æœ¯è®¨è®º, å„ç§å¿ƒé…¸, æˆ‘éƒ½ä¼šè®°å½•åœ¨é‚£é‡Œ.</p>
<p>ä¸€åšæŒå°±æ˜¯å‡ å¹´â€¦</p>
<p>å¦‚ä»Š, è¦ç¦»å¼€ CSDN çš„åšå®¢äº†, ä¸å‡†å¤‡åœ¨é‚£é‡Œç»§ç»­â€™è€•è€˜â€™äº†.<br>æ€»ç»“èµ·æ¥æœ‰å¦‚ä¸‹å‡ ä¸ªåŸå› :</p>
<blockquote>
<ol>
<li>æ–‡ç« è¢«ä»»æ„çš„è½¬è½½, æ²¡ç»è¿‡æœ¬äººçš„å…è®¸.æˆ‘åœ¨è®ºå›ä¹Ÿé—®è¿‡è¯¥äº‹, æ²¡æœ‰ä»»ä½•å›åº”, å¾ˆå¤±æœ›!</li>
<li>å¹¿å‘Šè¶Šæ¥è¶Šå¤š.</li>
<li>ç›¸æ¯”ä»¥å‰, å¾ˆéš¾æ‰¾åˆ°è®©äººæ»¡æ„çš„æœ‰è´¨é‡çš„æ–‡ç« .</li>
</ol>
</blockquote>
<p>å†è§, CSDN! è¯·åŸè°…æˆ‘çš„ä¸è¾è€Œåˆ«!</p>
]]></content>
      
        <categories>
            
            <category> éšç¬” </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç”Ÿæ´» å†™ä½œ </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
